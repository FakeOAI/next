"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5251],{94107:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(19841),i=r(35250);function o(e){let{percentage:t,thickness:r=1/12,className:o,backgroundStrokeClassName:a="stroke-gray-400",transitionDuration:l,transitionTimingFunction:s,onTransitionEnd:d}=e,u=120*r,c=(120-u)/2,f=2*Math.PI*c;return(0,i.jsxs)("svg",{width:120,height:120,viewBox:"0 0 ".concat(120," ").concat(120),className:o,children:[(0,i.jsx)("circle",{className:(0,n.default)("origin-[50%_50%] -rotate-90",a),strokeWidth:u,fill:"transparent",r:c,cx:60,cy:60}),(0,i.jsx)("circle",{className:"origin-[50%_50%] -rotate-90 transition-[stroke-dashoffset]",stroke:"currentColor",strokeWidth:u,strokeDashoffset:f-t/100*f,strokeDasharray:"".concat(f," ").concat(f),fill:"transparent",r:c,cx:60,cy:60,style:{transitionDuration:l,transitionTimingFunction:s},onTransitionEnd:d})]})}},881:function(e,t,r){r.d(t,{$e:function(){return o},EZ:function(){return a},Ql:function(){return i},dO:function(){return n},xC:function(){return l}});let n=10,i=4,o={duration:20,hasCloseButton:!0},a=512,l=536870912},49030:function(e,t,r){var n,i;r.d(t,{A:function(){return o},X:function(){return a}});let o=((n={})[n.None=0]="None",n[n.Multimodal=1]="Multimodal",n[n.Interpreter=2]="Interpreter",n[n.Retrieval=3]="Retrieval",n[n.ContextConnector=4]="ContextConnector",n[n.ProfilePicture=5]="ProfilePicture",n),a=((i={}).Uploading="uploading",i.Ready="ready",i)},80289:function(e,t,r){r.d(t,{R3:function(){return y},W7:function(){return m},cT:function(){return v},lU:function(){return w},po:function(){return g}});var n=r(58554),i=r(71727),o=r(83117),a=r(53265),l=r(52866),s=r(68498),d=r(38578),u=r(65733),c=r(14760),f=r(3395);let p={duration:20,hasCloseButton:!0};function m(e){return JSON.stringify({file:e.name,modified:e.lastModified,currentTime:new Date().toString()})}function g(e){return new Promise((t,r)=>{let n=new FileReader,i=new Image;n.onload=()=>{i.onload=()=>t(i),i.onerror=e=>r(e),i.src=n.result},n.readAsDataURL(e)})}async function v(e,t,r,s,c,f){var m,g,v;let y=d.N.getState().resetRateLimits,w=n.EG.Initial;a.A.logEvent(l.M.uploadFileInitiated,{client:"web",useCase:s.kind});let M=f.usesRetrievalIndex?performance.now():void 0;try{let{file_id:o,upload_url:a}=await i.Z.createFile(t.name,t.size,s,!!y);c.onFileCreated(e,o,a),w=n.EG.FileCreated;let l=s.kind===n.Ei.Gizmo?s.gizmoId:void 0,d=null!==(m=f.shouldUpdateProgress)&&void 0!==m&&m,v=null!==(g=f.usesRetrievalIndex)&&void 0!==g&&g,_=await i.Z.uploadFileToAzureStorage(t,a,t=>{d&&c.onFileUploadProgress(e,10+80*t)});if(c.onFileUploadProgress(e,90),201!==_.status&&x(_,o,v),w=n.EG.FileUploaded,await i.Z.processFileUpload(o,{gizmoId:l}),w=n.EG.FileProcessed,f.usesRetrievalIndex){let t=await h(o,l);(null==t?void 0:t.status)===n.Xf.Skipped&&u.m.danger(r.formatMessage(E.retrievalSkippedFile,{fileName:t.name}),p),c.onFileUploaded(e,o,void 0,{fileTokenSize:t.file_size_tokens}),w=n.EG.RetrievalIndexCreated}else c.onFileUploaded(e,o,f.imageDimensions);null!=M&&i.Z.postRetrievalTiming({e2eLatencyMs:performance.now()-M})}catch(i){_(r,t.name,i);let n="NotInstanceOfError";i instanceof o.gK?n=i.name:i instanceof o.Q0?n="FatalServerError_type_".concat(null!==(v=i.type)&&void 0!==v?v:"undefined"):i instanceof Error?n=i.name:i instanceof o.vq&&(n=i.name),c.onError(e,"error",n,s,w)}}async function y(e,t,r,a,l){let s=n.EG.Initial;try{let d=await i.Z.uploadConnectorAPI(e,a.contextConnector,r,t,void 0,a.o365DriveId);switch(d.type){case"error":throw function(e){let{status_code:t,error_code:r,error_message:n}=e;if(!t||!(t<500))return new o.Q0(n);{let e="internal_error";return r?e=r:404==t?e="file_not_found":403==t&&(e="permission_error"),new o.vq(n,e)}}(d.error);case"file":switch(c.MP.onFileCreated(e,d.file.id,""),s=n.EG.FileProcessed,r.kind){case n.Ei.MyFiles:{c.MP.onFileUploadProgress(e,90);let t=await h(d.file.file_id);(null==t?void 0:t.status)===n.Xf.Skipped&&u.m.danger(l.formatMessage(E.retrievalSkippedFile,{fileName:t.name}),p),c.MP.onFileUploaded(e,d.file.file_id,void 0,{fileTokenSize:t.file_size_tokens,mimeType:d.file.mime_type}),s=n.EG.RetrievalIndexCreated;break}case n.Ei.Multimodal:c.MP.onFileUploaded(e,d.file.file_id,{width:512,height:512},{mimeType:d.file.mime_type});break;case n.Ei.AceUpload:c.MP.onFileUploaded(e,d.file.file_id,void 0,{mimeType:d.file.mime_type});break;case n.Ei.DalleAgent:case n.Ei.Gizmo:case n.Ei.ProfilePicture:throw new o.vq("Use case not supported by cloud doc: ".concat(r.kind))}break;case"folder":throw new o.vq("Folder type not supported")}}catch(i){_(l,(0,f.Ad)(t.name,null==a?void 0:a.syntheticExtension),i);let r="NotInstanceOfError";if(i instanceof o.Q0){var d;r="FatalServerError_type_".concat(null!==(d=i.type)&&void 0!==d?d:"undefined")}else(i instanceof o.gK||i instanceof Error||i instanceof o.vq)&&(r=i.name);c.MP.onError(e,"error",r,{kind:n.Ei.MyFiles},s)}}async function w(e,t,r,n,i){let{width:o,height:a}=await g(t);return v(e,t,r,{kind:n},i,{imageDimensions:{width:o,height:a}})}async function h(e,t){let r=Date.now()+6e4,a=e=>new Promise(t=>setTimeout(t,e)),l=0;for(;Date.now()<r;){let r=await i.Z.getRetrievalStatus(e,t);if(r.status===n.Xf.Success||r.status===n.Xf.Skipped)return r;if(r.status===n.Xf.Failed)throw new o.vq("Context extraction failed",r.error_code);l++,await a(Math.min(1e3,100*l))}throw new o.vq("Retrieval indexing timed out")}async function x(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="Unknown error";try{n=await e.data}catch(e){}throw r&&i.Z.markFileUploadFailed(t,{error:n}),new o.vq("File upload to blobstore failed","failed_upload_to_blobstore")}function _(e,t,r){let n=(0,f.kr)(e,"default_upload_error",{fileName:t});r instanceof o.vq&&null!=r.code&&(n=(0,f.kr)(e,r.code)),u.m.danger(n,p)}let E=(0,s.vU)({retrievalSkippedFile:{id:"useFilePickerState.retrievalSkippedFile",defaultMessage:'Unable to extract text from "{fileName}"'}})},14760:function(e,t,r){r.d(t,{Dw:function(){return x},HR:function(){return h},MP:function(){return _},gF:function(){return w}});var n=r(72438),i=r(58554),o=r(53265),a=r(52866),l=r(86705),s=r(68498),d=r(78103),u=r(65733),c=r(881),f=r(49030),p=r(80289),m=r(3395);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let y={files:[],connectorFileData:{}},w=(0,d.ZP)(()=>y),h={hasUploadInProgress:e=>{let{files:t}=e;return t.some(e=>e.status===f.X.Uploading)},getReadyFiles:e=>{let{files:t}=e;return t.filter(e=>e.status===f.X.Ready)}},x={reset:()=>{w.setState(y)},uploadFile:async function(e,t,r,n,s){let d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},g=arguments.length>6?arguments[6]:void 0,v=arguments.length>7?arguments[7]:void 0,{gizmoId:y}=d,h=w.getState().files,x=(0,m.xs)(r,t.name,t.type,null==v?void 0:v.contextConnector,g),M={tempId:e,gizmoId:d.gizmoId,status:f.X.Uploading,file:t,progress:1,fileId:null,cdnUrl:null,contextConnectorInfo:v};if(h.length===c.dO)o.A.logEvent(a.M.uploadedMaxFilesError),u.m.danger(s.formatMessage(E.maxUploadsAtATime,{maxUploads:c.dO,fileName:t.name}),c.$e);else{let r;w.setState(e=>{let{files:t}=e;return{files:[...t,M]}});let o={};if(n.includes(t.type)){if(r={kind:i.Ei.Multimodal},!v){let{width:e,height:r}=await (0,p.po)(t);if(e>2048||r>2048)try{let n=await (0,m.Tu)(t,2048),i=await (0,p.po)(n);e=i.width,r=i.height,t=n}catch(e){l.U.addError(Error("Error resizing image:",{cause:e}))}o.imageDimensions={width:e,height:r}}}else switch(x){case f.A.Multimodal:throw Error("Multimodal file upload not supported mime type, ".concat(t.type,"\nSupported mime types: ")+n.join(", "));case f.A.Interpreter:r={kind:i.Ei.AceUpload};break;case f.A.Retrieval:r={kind:i.Ei.MyFiles},o.usesRetrievalIndex=!0;break;case f.A.ProfilePicture:throw Error("cannot upload profile picture via uploadFile");case f.A.ContextConnector:case f.A.None:return}null!=y&&(r={kind:i.Ei.Gizmo,gizmoId:y}),d.skipUpload||(v?await (0,p.R3)(e,t,r,v,s):await (0,p.cT)(e,t,s,r,_,o))}},createFileCompleted:(e,t,r)=>{let n=w.getState().files,i=n.findIndex(t=>t.tempId===e),o=n[i];if(i>=0&&o.status===f.X.Uploading){let e=[...n];e.splice(i,1,v(v({},o),{},{progress:10,fileId:t,cdnUrl:r})),w.setState({files:e})}},updateProgress:(e,t)=>{let r=w.getState().files,n=r.findIndex(t=>t.tempId===e),i=r[n];if(n>=0&&i.status===f.X.Uploading){let e=[...r];e.splice(n,1,v(v({},i),{},{progress:t})),w.setState({files:e})}},uploadCompleted:(e,t,r,n,i)=>{let l=w.getState().files,s=l.findIndex(t=>t.tempId===e);if(s>=0&&l[s].status===f.X.Uploading&&null!==l[s].fileId){var d,u;let t=l[s],c=[...l],p=v(v({},t),{},{tempId:e,status:f.X.Ready,progress:100,fileSpec:v(v({name:t.file.name,id:t.fileId,size:t.file.size,contextConnectorInfo:t.contextConnectorInfo,mimeType:null!==(d=null!==(u=null==n?void 0:n.mimeType)&&void 0!==u?u:t.file.type)&&void 0!==d?d:(0,m.s1)(t.file.name)},r||{}),n||{})});c.splice(s,1,p);let g=v({},w.getState().connectorFileData);i&&(g[null==i?void 0:i.file_id]=i),w.setState({files:c,connectorFileData:g}),o.A.logEvent(a.M.uploadFileCompleted,{status:t.status,fileId:t.fileId})}},remove:(e,t,r,n,i)=>{let l=w.getState().files,s=l.findIndex(t=>t.tempId===e);if(s>=0){let e=l[s];"error"===t?o.A.logEvent(a.M.uploadFileError,{status:e.status,fileId:e.fileId,client:"web",errorClassName:null!=r?r:"undefined",useCaseType:n,uploadStatus:null!=i?i:"undefined"}):o.A.logEvent(a.M.removeFile,{status:e.status,fileId:e.fileId});let d=[...l];d.splice(s,1),w.setState({files:d})}}},_={onFileCreated:x.createFileCompleted,onFileUploadProgress:x.updateProgress,onFileUploaded:x.uploadCompleted,onError:x.remove},E=(0,s.vU)({maxUploadsAtATime:{id:"useFilePickerState.maxUploadsAtATime",defaultMessage:"Unable to upload {fileName}. Max {maxUploads} uploads at a time"}})},3395:function(e,t,r){r.d(t,{$H:function(){return g},$p:function(){return b},Ad:function(){return N},B:function(){return O},BV:function(){return S},CO:function(){return I},Iy:function(){return p},KL:function(){return U},L8:function(){return m},O6:function(){return w},Tu:function(){return T},VF:function(){return y},Vm:function(){return P},WI:function(){return A},YN:function(){return x},Z8:function(){return C},Zp:function(){return F},_0:function(){return M},kr:function(){return v},p0:function(){return k},s1:function(){return _},ww:function(){return h},xs:function(){return E}});var n=r(58554),i=r(61145),o=r(71727),a=r(2829),l=r(86705),s=r(70079),d=r(9063),u=r(68498),c=r(65733),f=r(49030);function p(e){return e.replace("file-service://","")}function m(e){return"file-service://"+e}function g(e){return e.startsWith("file-service://")}function v(e,t,r){switch(t){case"file_zero_bytes":return e.formatMessage(D.fileZeroBytes,r);case"file_too_large":return e.formatMessage(D.fileTooLarge,r);case"over_user_quota":return e.formatMessage(D.overUserQuota,r);case"file_not_found":case"file_expired":return e.formatMessage(D.fileNotFound,r);case"file_timed_out":return e.formatMessage(D.fileTimedOut,r);case"ace_pod_expired":return e.formatMessage(D.codeInterpreterSessionTimeout,r);case"permission_error":return e.formatMessage(D.permissionError,r);case"default_upload_error":case"file_rejected":return e.formatMessage(D.defaultCreateEntryError,r);case"default_download_link_error":return e.formatMessage(D.defaultDownloadLinkError,r);case"file_empty":return e.formatMessage(D.fileEmpty,r);case"too_many_tokens":return e.formatMessage(D.fileTooManyTokens,r);case"file_encrypted":return e.formatMessage(D.fileEncrypted,r);case"file_corrupted":return e.formatMessage(D.fileCorrupted,r);case"failed_upload_to_blobstore":return e.formatMessage(D.failedUploadToBlobStore,r);default:return e.formatMessage(D.unknownError)}}function y(){let e=(0,d.Z)();return(0,s.useCallback)((t,r)=>v(e,t,r),[e])}function w(){let{session:e}=(0,a.kP)(),t=(0,d.Z)();return async(r,i)=>{if(null==e)return c.m.danger(t.formatMessage(D.fileDownloadFailed)),!1;try{var a;let e=await o.Z.getFileDownloadLink(r);if(e.status!==n.KF.Success)throw Error("File is not ready to download: "+JSON.stringify(e));let t=null===(a=e.metadata)||void 0===a||null===(a=a.context_connector)||void 0===a?void 0:a.url;if(null!=t)window.open(t,"_blank");else{let t=e.download_url,r=document.createElement("a");r.href=t,r.download=i,r.click(),window.open(t,"_blank")}}catch(e){return c.m.danger(t.formatMessage(D.fileDownloadFailed)),!1}return!0}}function h(e,t){if((null==t?void 0:t.kind)===i.OL.GizmoInteraction||(null==t?void 0:t.kind)===i.OL.GizmoTest){var r;return null===(r=t.gizmo)||void 0===r?void 0:r.product_features}return null==e?void 0:e.product_features}function x(e,t){var r,i,o,a;let l=h(e,t);return(null==l||null===(r=l.attachments)||void 0===r?void 0:r.type)===n.Cd.CodeInterpreter?f.A.Interpreter:(null==l||null===(i=l.attachments)||void 0===i?void 0:i.type)===n.Cd.Multimodal?f.A.Multimodal:(null==l||null===(o=l.attachments)||void 0===o?void 0:o.type)===n.Cd.Retrieval?f.A.Retrieval:(null==l||null===(a=l.attachments)||void 0===a?void 0:a.type)===n.Cd.ContextConnector?f.A.ContextConnector:f.A.None}function _(e){var t;let r=null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase();return({md:"text/markdown",java:"text/x-java",py:"text/x-script.python",c:"text/x-c",cpp:"text/x-c++",h:"text/x-c++",php:"text/x-php",rb:"text/x-ruby",tex:"application/x-latext",ts:"text/x-typescript",cs:"text/x-csharp"})[null!=r?r:""]||""}function E(e,t,r,n,i){if(null==i)return e;let o=_(t);o&&(r=o),n&&(r=function(e){switch(e){case"application/vnd.google-apps.spreadsheet":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"application/vnd.google-apps.document":return"text/plain";default:return e}}(r));let{accepted_mime_types:a,can_accept_all_mime_types:l}=i;return null!=a&&0!==a.length&&l?a.includes(r)?e:f.A.Interpreter:e}function M(e,t,r){var i,o,a;let l=""!==t?t:_(r),s=null==e||null===(i=e.product_features)||void 0===i?void 0:i.attachments;return null==s?void 0:null!==(o=s.accepted_mime_types)&&void 0!==o&&o.includes(l)?s.type:null!==(a=s.image_mime_types)&&void 0!==a&&a.includes(l)?n.Cd.Multimodal:n.Cd.CodeInterpreter}function F(e,t){var r,n;let i=h(e,t);return null!=i&&null!==(r=i.attachments)&&void 0!==r&&r.can_accept_all_mime_types?void 0:null==i||null===(n=i.attachments)||void 0===n?void 0:n.accepted_mime_types}function k(e,t){let r=h(e,t),{attachments:n}=null!=r?r:{};if(null!=n&&n.image_mime_types)return n.image_mime_types;if((null==n?void 0:n.type)==="multimodal"){var i;return null!==(i=n.accepted_mime_types)&&void 0!==i?i:U}return[]}let U=["image/png","image/jpeg","image/gif","image/webp"];function C(e){return(0,s.useMemo)(()=>{if(void 0===e)return{};let t={"image/jpeg":[".jpg",".jpeg"],"image/svg+xml":[".svg"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"]};return{accept:e.reduce((e,r)=>(r in t?e[r]=t[r]:r.includes("/")&&(e[r]=[".".concat(r.split("/")[1])]),e),{})}},[e])}function b(e){var t;return null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase()}function I(e){let t=b(e);return null!=t&&["jpg","jpeg","png","gif","webp"].includes(t)}function P(e){let t=b(e);return null!=t&&["xls","xlsx","csv"].includes(t)}function S(e){let t=b(e);return null!=t&&["xls","xlsx"].includes(t)}function T(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fit";return new Promise((n,i)=>{let o=new FileReader;o.onerror=e=>{l.U.addError(Error("File reading has failed:",{cause:e})),i(Error("Failed to read the file."))},o.onload=o=>{let a=new Image;a.onerror=e=>{l.U.addError(Error("Image loading has failed:",{cause:e})),i(Error("Failed to load the image."))},a.onload=()=>{let o=document.createElement("canvas"),s,d=0,u=0;switch(r){case"fill":case"square":s=t/Math.min(a.width,a.height);break;case"fit":s=t/Math.max(a.width,a.height)}let c=a.width*s,f=a.height*s;"square"===r?(o.width=t,o.height=t,d=(t-c)/2,u=(t-f)/2):(o.width=c,o.height=f);let p=o.getContext("2d");if(null==p){l.U.addError("Canvas context creation failed. Your environment might not fully support HTML5 canvas."),i(Error("Failed to create canvas context."));return}p.drawImage(a,d,u,c,f);let m=e.type||"image/png";o.toBlob(t=>{t?n(new File([t],e.name,{type:m})):(l.U.addError("Blob creation failed. Blob is null."),i(Error("Failed to create blob from image data.")))},m)},null==o.target?(l.U.addError("Event target is null. Failed to load image."),i("Failed to load image.")):a.src=o.target.result},o.readAsDataURL(e)})}function A(e,t){return T(e,t,"square")}function O(e){var t,r;let n=null!==(t=e.name.split("/"))&&void 0!==t?t:[];return(null!==(r=n[n.length-1])&&void 0!==r?r:"").replace(/[-_]/g," ").split(".")[0]}function N(e,t){return t?e.slice(0,-t.length-1):e}let D=(0,u.vU)({defaultCreateEntryError:{id:"fileUpload.defaultCreateEntryError",defaultMessage:"Unable to upload {fileName}"},defaultDownloadLinkError:{id:"fileUpload.defaultDownloadLinkError",defaultMessage:"Failed to get upload status for {fileName}"},unknownError:{id:"fileUpload.unknownError",defaultMessage:"Unknown error occurred"},fileZeroBytes:{id:"fileUpload.fileZeroBytes",defaultMessage:"File is empty"},fileTooLarge:{id:"fileUpload.fileTooLarge",defaultMessage:"File is too large"},overUserQuota:{id:"fileUpload.overUserQuota",defaultMessage:"User quota exceeded"},fileNotFound:{id:"fileUpload.fileNotFound",defaultMessage:"File not found"},fileTimedOut:{id:"fileUpload.fileTimedOut",defaultMessage:"File upload timed out. Please try again."},fileEmpty:{id:"fileUpload.fileEmpty",defaultMessage:"No text could be extracted from this file."},fileTooManyTokens:{id:"fileUpload.fileTooManyTokens",defaultMessage:"This file contains too much text content. Please try again with a smaller file."},fileEncrypted:{id:"fileUpload.fileEncrypted",defaultMessage:"This file is encrypted/requires a password to access. Please try again with an unencrypted file."},fileCorrupted:{id:"fileUpload.fileCorrupted",defaultMessage:"This file is corrupted. Please ensure the file is not corrupted and try again."},codeInterpreterSessionTimeout:{id:"fileUpload.codeInterpreterSessionTimeout",defaultMessage:"Code interpreter session expired"},permissionError:{id:"fileUpload.permissionError",defaultMessage:"Missing permission to access file"},fileDownloadFailed:{id:"filesModal.fileDownloadFailed",defaultMessage:"File download failed. Please try again."},failedUploadToBlobStore:{id:"fileUpload.failedUploadToBlobStore",defaultMessage:"Failed upload to files.oaiusercontent.com. Please ensure your network settings allow access to this site or contact your network administrator."}})},38578:function(e,t,r){r.d(t,{J:function(){return i},N:function(){return o}});var n=r(78103);let i={label:"Auto",value:""},o=(0,n.ZP)(()=>({forceParagen:!1,forceNulligen:!1,forceParagenModel:i,forceRateLimit:!1,resetRateLimits:!1,showDebugConversationTurns:!1,rebaseSystemMessageContent:null}))}}]);
//# sourceMappingURL=5251-cd06fa59d5fa4958.js.map