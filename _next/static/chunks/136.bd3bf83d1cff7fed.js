"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[136],{80136:function(t,e,i){i.d(e,{q:function(){return r}});var s=i(60314),o=i(70348);function r(t={}){return new s.Sy({view:e=>new l(e,t)})}class l{constructor(t,e){var i;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(i=e.width)&&void 0!==i?i:1,this.color=!1===e.color?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(e=>{let i=t=>{this[e](t)};return t.dom.addEventListener(e,i),{name:e,handler:i}})}destroy(){this.handlers.forEach(({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e))}update(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t,e,i=this.editorView.state.doc.resolve(this.cursorPos),s=!i.parent.inlineContent,o;if(s){let t=i.nodeBefore,e=i.nodeAfter;if(t||e){let i=this.editorView.nodeDOM(this.cursorPos-(t?t.nodeSize:0));if(i){let s=i.getBoundingClientRect(),r=t?s.bottom:s.top;t&&e&&(r=(r+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),o={left:s.left,right:s.right,top:r-this.width/2,bottom:r+this.width/2}}}}if(!o){let t=this.editorView.coordsAtPos(this.cursorPos);o={left:t.left-this.width/2,right:t.left+this.width/2,top:t.top,bottom:t.bottom}}let r=this.editorView.dom.offsetParent;if(!this.element&&(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",s),this.element.classList.toggle("prosemirror-dropcursor-inline",!s),r&&(r!=document.body||"static"!=getComputedStyle(r).position)){let i=r.getBoundingClientRect();t=i.left-r.scrollLeft,e=i.top-r.scrollTop}else t=-pageXOffset,e=-pageYOffset;this.element.style.left=o.left-t+"px",this.element.style.top=o.top-e+"px",this.element.style.width=o.right-o.left+"px",this.element.style.height=o.bottom-o.top+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),i=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),s=i&&i.type.spec.disableDropCursor,r="function"==typeof s?s(this.editorView,e,t):s;if(e&&!r){let t=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let e=(0,o.nj)(this.editorView.state.doc,t,this.editorView.dragging.slice);null!=e&&(t=e)}this.setCursor(t),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}}}]);
//# sourceMappingURL=136.bd3bf83d1cff7fed.js.map