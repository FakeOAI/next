(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7563],{97563:function(t,e,n){"use strict";n.r(e),n.d(e,{RichTextInput:function(){return D},WrapProsemirrorComposerController:function(){return P}});var r=n(19841),i=n(92379),o=n(36348),a=n(83798),s=n.n(a),c=n(59749),u=n(12498),l=n(4684),d=n(74263),f=n(80326),p=n(81171),h=n(60314),y=n(59231),g=n(70310),v=n(15913),w=n(17167),m=n(81945),b=n(91399);let x=["p",0],S=["br"],O=new p.V_({nodes:{paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p",preserveWhitespace:"full"}],toDOM:()=>x},text:{group:"inline"},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>S},[b.L]:b.ow,doc:{content:"block+"}},marks:{}});var k=n(70879),E=n(651);let M=[(0,r.default)([s()["prosemirror-parent"],"text-token-text-primary","max-h-[25dvh]","max-h-52","overflow-auto"])],P=t=>{let{children:e}=t,{0:n}=(0,i.useState)(()=>(function(){let t=new EventTarget,e=new y.tk(null,{state:h.yy.create({schema:O,plugins:[(0,d.m8)(),(0,w._)({submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[" "]}),(0,m.c)(""),(0,b.e5)(),(0,f.h)({"Shift-Enter":(t,e)=>(0,g.n)(t,e),Enter:(t,e)=>!(window.innerWidth>v.cG[v._G.Medium])&&(0,g.n)(t,e)}),(0,f.h)({"Mod-z":d.Yw,"Mod-y":d.KX,"Mod-Shift-z":d.KX}),(0,f.h)(u.YR),(0,c.Vk)(t),(0,l.d)()]}),dispatchTransaction(n){let r=e.state.apply(n);e.updateState(r),n.docChanged&&t.dispatchEvent(new Event(c.Bi))},handlePaste(t,e){let n=e.clipboardData?.getData("text/plain");return void 0!==n&&((0,g.oV)(t,n),!0)},clipboardTextSerializer:t=>(0,g.Fd)(t.content)});return e})()),{0:r}=(0,i.useState)(()=>new o.F(n));return e(r)},D=t=>{let{composerController:e,placeholder:n}=t;if(!(e instanceof o.F))throw Error(`Expected instance of ProseMirrorComposerController but got ${e.constructor.name}`);let a=(0,i.useRef)(null);return(0,i.useEffect)(()=>{a.current.appendChild(e.view.dom)},[]),(0,i.useEffect)(()=>{let t=e.view.dom;t&&(t.id=k.hB,e.focus())},[e]),(0,i.useEffect)(()=>{e.setPlaceholder(n)},[n,e]),(0,i.useEffect)(()=>{e.logPageMount()},[]),(0,E.jsx)("div",{ref:a,className:(0,r.default)(M)})}},36348:function(t,e,n){"use strict";n.d(e,{F:function(){return l}});var r=n(59749),i=n(92379),o=n(70310),a=n(17167),s=n(81945),c=n(91399),u=n(48710);class l extends u.N{constructor(t){super(),this.view=t}isEmpty(){return!this.view.state.doc.textContent}trimLeadingText(t){let e=this.view.state.tr,n=!1,r=!1;return e.doc.descendants((i,o)=>{!n&&i.isText&&(n=!0,i.text?.startsWith(t)&&(r=!0,e.insertText(i.text.replace(t,""),o,o+i.text.length)))}),r&&this.view.dispatch(e),r}replaceAll(t,e){let n=this.view.state.tr,r=[],i=0;n.doc.descendants((t,e)=>{t.isText&&void 0!==t.text&&(r.push({node:t,pos:e}),i=Math.max(i,e))}),r.reverse(),r.forEach(r=>{let{node:i,pos:o}=r;i.isText&&void 0!==i.text&&i.text.includes(t)&&n.insertText(i.text.replaceAll(t,e),o,o+i.text.length)}),this.view.dispatch(n)}appendText(t){this.view.dispatch(this.view.state.tr.insertText(t))}focus(){this.view.dom.focus()}setText(t){let{tr:e,schema:n}=this.view.state,r=t?n.nodes.paragraph.create(null,n.text(t)):n.nodes.paragraph.create();this.view.dispatch(e.replaceWith(0,this.view.state.doc.content.size,r))}getCurrentText(){return this.view.state.doc.textContent}getTextToSend(){return(0,o.B_)(this.view)}resize(){}isReady(){return!!this.view.state.doc}setPlaceholder(t){this.view.dispatch(this.view.state.tr.setMeta(s.e,{placeholder:t}))}getSelectionStart(){return this.view.state.selection.ranges[0].$from.pos}acceptLegacyKeydown(){return!a.Mw.getState(this.view.state).active}subscribe(t,e){return this.view.dom?.addEventListener(t,e),()=>{this.view.dom?.removeEventListener(t,e)}}useState(t){return(0,i.useSyncExternalStore)(t=>(0,r.qv)(this.view,t),()=>t(this))}getSystemHints(){let t=(0,c.C6)(this.view.state.tr.doc);return t.length?[t[0]]:[]}}},70310:function(t,e,n){"use strict";n.d(e,{B_:function(){return o},Fd:function(){return i},n:function(){return a},oV:function(){return s}});var r=n(12498);function i(t){let e="",n=!1;return t.descendants(t=>(function t(r){if(n=!1,"paragraph"===r.type.name)return r.descendants(e=>t(e)),e+="\n",n=!0,!1;r.isText&&(e+=r.text)})(t)),n&&e.endsWith("\n")&&(e=e.slice(0,-1)),e}function o(t){return i(t.state.doc)}let a=(0,r.QF)(r.mD,r.X0,r.JA);function s(t,e){let n=t.state.schema;e.split("\n").forEach((e,r)=>{if(0===r)t.dispatch(t.state.tr.insertText(e));else{a(t.state,t.dispatch);let r=e?n.nodes.paragraph.create(null,n.text(e)):n.nodes.paragraph.create();t.dispatch(t.state.tr.replaceSelectionWith(r))}})}},17167:function(t,e,n){"use strict";n.d(e,{$b:function(){return u},Mw:function(){return s},_:function(){return l},am:function(){return c}});var r=n(98601),i=n(60314);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){(0,r.Z)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}let s=new i.H$("menuSelectorPlugin");function c(t){t.dispatch(t.state.tr.setMeta(s,{active:!1,onMenuAction:void 0}))}function u(t,e){t.dispatch(t.state.tr.setMeta(s,{active:!0,onMenuAction:e}))}function l(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[]};return new i.Sy({key:s,state:{init:()=>a(a({},t),{},{active:!1}),apply(t,e){let n=t.getMeta(s);return n?a(a({},e),n):e}},props:{handleKeyDown(t,e){let n=s.getState(t.state);return!!n.active&&(n.submitKeys.includes(e.key)?(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),n.onMenuAction?.("submit"),c(t),!0):n.cancelKeys.includes(e.key)?(e.preventDefault(),n.onMenuAction?.("cancel"),u(t,n.onMenuAction),!0):"ArrowUp"===e.key?(e.preventDefault(),n.onMenuAction?.("up"),!0):"ArrowDown"===e.key?(e.preventDefault(),n.onMenuAction?.("down"),!0):(n.checkStrictMatchKeys.includes(e.key)&&n.onMenuAction?.("checkMatch"),!1))}}})}},81945:function(t,e,n){"use strict";n.d(e,{c:function(){return a},e:function(){return o}});var r=n(60314),i=n(59231);let o=new r.H$("placeholderPlugin");function a(t){return new r.Sy({key:o,state:{init:()=>({placeholder:t}),apply:(t,e)=>t.getMeta(o)?{placeholder:t.getMeta(o).placeholder}:e},props:{decorations(t){let{doc:e}=t;if(1===e.childCount&&e.firstChild?.isTextblock&&0===e.firstChild.content.size){let n=[],{placeholder:r}=o.getState(t);return t.doc.descendants((t,e)=>{let o=i.p.node(e,e+t.nodeSize,{class:"placeholder","data-placeholder":r});n.push(o)}),i.EH.create(e,n)}}}})}},91399:function(t,e,n){"use strict";n.d(e,{C6:function(){return f},L:function(){return s},e5:function(){return p},o4:function(){return u},ow:function(){return c},vt:function(){return d}});var r=n(98601),i=n(60314);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){(0,r.Z)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}let s="command_token",c={group:"inline",inline:!0,atom:!0,content:"text*",attrs:{id:"",hint:""},selectable:!1,draggable:!1,toDOM:t=>["span",{"data-mention-id":t.attrs.id,"data-mention-hint":t.attrs.hint,class:"shimmer-blue"},t.attrs.hint],parseDOM:[{tag:"span[data-mention-id][data-mention-hint]",getAttrs:t=>({id:t.getAttribute("data-mention-id"),hint:t.getAttribute("data-mention-hint")})}]},u=new i.H$("slashCommandPlugin");function l(){return{queryText:"",active:!1,range:void 0}}function d(t,e,n,r){let i=t.state.schema.nodes[s].create(a({},e),t.state.schema.text(e.hint)),o=t.state.tr.replaceWith(n.from,n.to,i);r&&o.insertText(" ",n.from+i.nodeSize),t.dispatch(o)}function f(t){let e=[];return t.descendants(t=>{t.type.name===s&&"string"==typeof t.attrs?.id&&e.push(t.attrs.id)}),e}function p(){return new i.Sy({key:u,state:{init:()=>l(),apply(t,e){let n=t.getMeta(u),r=t.selection,i=function(t){if(0===t.depth)return;let e=t.before(),n=t.doc.textBetween(e,t.pos,"\n","\0").match(new RegExp(/(^|\s)\/(\w*)$/));if(n&&void 0!==n.index){let e=n[0].startsWith(" ")?n.index+1:n.index,r=n[0].startsWith(" ")?n[0].length-1:n[0].length,i=t.start()+e;return{range:{from:i,to:i+r},queryText:n[2]}}}(r.$from),o=a(a(a({},l()),e),n);return r.from!==r.to||(o.active=!!i,i&&(o.queryText=i.queryText,o.range=i.range)),function(t){let{active:e,range:n,queryText:r,onHintMatch:i}=t;i?i(e&&n?{text:r,range:n}:void 0):void 0}(o),o}}})}},59749:function(t,e,n){"use strict";n.d(e,{Bi:function(){return o},Vk:function(){return s},qv:function(){return a}});var r=n(60314);let i=new r.H$("transactionEventPlugin"),o="prosemirrorDispatchTransaction";function a(t,e){let{eventTarget:n}=i.getState(t.state);return n.addEventListener(o,e),()=>{n.removeEventListener(o,e)}}function s(t){return new r.Sy({key:i,state:{init:()=>({eventTarget:t}),apply:(t,e)=>e}})}},83798:function(t){t.exports={"prosemirror-parent":"prompt-prosemirror_prosemirror-parent__K7XB4"}},80326:function(t,e,n){"use strict";n.d(e,{$:function(){return c},h:function(){return s}});var r=n(21865),i=n(60314);let o="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function a(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function s(t){return new i.Sy({props:{handleKeyDown:c(t)}})}function c(t){let e=function(t){let e=Object.create(null);for(let n in t)e[function(t){let e,n,r,i,a=t.split(/-(?!$)/),s=a[a.length-1];"Space"==s&&(s=" ");for(let t=0;t<a.length-1;t++){let s=a[t];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))o?i=!0:n=!0;else throw Error("Unrecognized modifier name: "+s)}return e&&(s="Alt-"+s),n&&(s="Ctrl-"+s),i&&(s="Meta-"+s),r&&(s="Shift-"+s),s}(n)]=t[n];return e}(t);return function(t,n){let i=(0,r.YG)(n),o,s=e[a(i,n)];if(s&&s(t.state,t.dispatch,t))return!0;if(1==i.length&&" "!=i){if(n.shiftKey){let r=e[a(i,n,!1)];if(r&&r(t.state,t.dispatch,t))return!0}if((n.shiftKey||n.altKey||n.metaKey||i.charCodeAt(0)>127)&&(o=r.ue[n.keyCode])&&o!=i){let r=e[a(o,n)];if(r&&r(t.state,t.dispatch,t))return!0}}return!1}}},21865:function(t,e,n){"use strict";n.d(e,{YG:function(){return u},uY:function(){return i},ue:function(){return r}});for(var r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},i={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},o="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),a="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),s=0;s<10;s++)r[48+s]=r[96+s]=String(s);for(var s=1;s<=24;s++)r[s+111]="F"+s;for(var s=65;s<=90;s++)r[s]=String.fromCharCode(s+32),i[s]=String.fromCharCode(s);for(var c in r)i.hasOwnProperty(c)||(i[c]=r[c]);function u(t){var e=!(o&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||a&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?i:r)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}}}]);
//# sourceMappingURL=7563.6be709047a3bf7ee.js.map