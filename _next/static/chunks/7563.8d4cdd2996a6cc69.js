(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7563],{97563:function(t,e,r){"use strict";r.r(e),r.d(e,{RichTextInput:function(){return M},WrapProsemirrorComposerController:function(){return O}});var n=r(19841),i=r(92379),o=r(36348),a=r(83798),s=r.n(a),c=r(74263),u=r(80326),l=r(81171),f=r(60314),d=r(59231),p=r(17167),h=r(81945),y=r(91399);let g=["p",0],w=["br"],m=new l.V_({nodes:{paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>g},text:{group:"inline"},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>w},[y.L]:y.ow,doc:{content:"block+"}},marks:{}});var v=r(70879),b=r(651);let x=[(0,n.default)([s()["prosemirror-parent"]])],O=t=>{let{children:e}=t,{0:r}=(0,i.useState)(()=>new d.tk(null,{state:f.yy.create({schema:m,plugins:[(0,c.m8)(),(0,p._)({submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[" "]}),(0,h.c)(""),(0,y.e5)(),(0,u.h)({"Shift-Enter":(t,e)=>(e?.(t.tr.replaceSelectionWith(m.nodes.hard_break.create()).scrollIntoView()),!0)}),(0,u.h)({"Mod-z":c.Yw,"Mod-y":c.KX,"Mod-Shift-z":c.KX})]})})),{0:n}=(0,i.useState)(()=>new o.F(r));return e(n)},M=t=>{let{composerController:e,placeholder:r}=t;if(!(e instanceof o.F))throw Error(`Expected instance of ProseMirrorComposerController but got ${e.constructor.name}`);let a=(0,i.useRef)(null);(0,i.useEffect)(()=>{a.current.appendChild(e.view.dom)},[]);let s=e.view.dom;return(0,i.useEffect)(()=>{s&&(s.id=v.hB)},[s]),(0,i.useEffect)(()=>{e.setPlaceholder(r)},[r,e]),(0,i.useEffect)(()=>{e.logPageMount()},[]),(0,b.jsx)("div",{ref:a,className:(0,n.default)(x)})}},36348:function(t,e,r){"use strict";r.d(e,{F:function(){return s}});var n=r(17167),i=r(81945),o=r(91399),a=r(48710);class s extends a.N{constructor(t){super(),this.view=t}isEmpty(){return!this.view.state.doc.textContent}trimLeadingText(t){let e=this.view.state.tr,r=!1,n=!1;return e.doc.descendants((i,o)=>{!r&&i.isText&&(r=!0,i.text?.startsWith(t)&&(n=!0,e.insertText(i.text.replace(t,""),o,o+i.text.length)))}),n&&this.view.dispatch(e),n}replaceAll(t,e){let r=this.view.state.tr,n=[],i=0;r.doc.descendants((t,e)=>{t.isText&&void 0!==t.text&&(n.push({node:t,pos:e}),i=Math.max(i,e))}),n.reverse(),n.forEach(n=>{let{node:i,pos:o}=n;i.isText&&void 0!==i.text&&i.text.includes(t)&&r.insertText(i.text.replaceAll(t,e),o,o+i.text.length)}),this.view.dispatch(r)}appendText(t){this.view.dispatch(this.view.state.tr.insertText(t))}focus(){this.view.dom.focus()}setText(t){let{tr:e,schema:r}=this.view.state,n=t?r.nodes.paragraph.create(null,r.text(t)):r.nodes.paragraph.create();this.view.dispatch(e.replaceWith(0,this.view.state.doc.content.size,n))}getCurrentText(){return this.view.state.doc.textContent}resize(){}isReady(){return!!this.view.state.doc}setPlaceholder(t){this.view.dispatch(this.view.state.tr.setMeta(i.e,{placeholder:t}))}getSelectionStart(){return this.view.state.selection.ranges[0].$from.pos}acceptLegacyKeydown(){return!n.Mw.getState(this.view.state).active}subscribe(t,e){return this.view.dom?.addEventListener(t,e),()=>{this.view.dom?.removeEventListener(t,e)}}getSystemHints(){let t=(0,o.C6)(this.view.state.tr.doc);return t.length?[t[0]]:[]}}},17167:function(t,e,r){"use strict";r.d(e,{$b:function(){return u},Mw:function(){return s},_:function(){return l},am:function(){return c}});var n=r(98601),i=r(60314);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach(function(e){(0,n.Z)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}let s=new i.H$("menuSelectorPlugin");function c(t){t.dispatch(t.state.tr.setMeta(s,{active:!1,onMenuAction:void 0}))}function u(t,e){t.dispatch(t.state.tr.setMeta(s,{active:!0,onMenuAction:e}))}function l(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[]};return new i.Sy({key:s,state:{init:()=>a(a({},t),{},{active:!1}),apply(t,e){let r=t.getMeta(s);return r?a(a({},e),r):e}},props:{handleKeyDown(t,e){let r=s.getState(t.state);return!!r.active&&(r.submitKeys.includes(e.key)?(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),r.onMenuAction?.("submit"),c(t),!0):r.cancelKeys.includes(e.key)?(e.preventDefault(),r.onMenuAction?.("cancel"),u(t,r.onMenuAction),!0):"ArrowUp"===e.key?(e.preventDefault(),r.onMenuAction?.("up"),!0):"ArrowDown"===e.key?(e.preventDefault(),r.onMenuAction?.("down"),!0):(r.checkStrictMatchKeys.includes(e.key)&&r.onMenuAction?.("checkMatch"),!1))}}})}},81945:function(t,e,r){"use strict";r.d(e,{c:function(){return a},e:function(){return o}});var n=r(60314),i=r(59231);let o=new n.H$("placeholderPlugin");function a(t){return new n.Sy({key:o,state:{init:()=>({placeholder:t}),apply:(t,e)=>t.getMeta(o)?{placeholder:t.getMeta(o).placeholder}:e},props:{decorations(t){let{doc:e}=t;if(1===e.childCount&&e.firstChild?.isTextblock&&0===e.firstChild.content.size){let r=[],{placeholder:n}=o.getState(t);return t.doc.descendants((t,e)=>{let o=i.p.node(e,e+t.nodeSize,{class:"placeholder","data-placeholder":n});r.push(o)}),i.EH.create(e,r)}}}})}},91399:function(t,e,r){"use strict";r.d(e,{C6:function(){return d},L:function(){return s},e5:function(){return p},o4:function(){return u},ow:function(){return c},vt:function(){return f}});var n=r(98601),i=r(60314);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach(function(e){(0,n.Z)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}let s="command_token",c={group:"inline",inline:!0,atom:!0,content:"text*",attrs:{id:"",hint:""},selectable:!1,draggable:!1,toDOM:t=>["span",{"data-mention-id":t.attrs.id,"data-mention-hint":t.attrs.hint,class:"shimmer-blue"},t.attrs.hint],parseDOM:[{tag:"span[data-mention-id][data-mention-hint]",getAttrs:t=>({id:t.getAttribute("data-mention-id"),hint:t.getAttribute("data-mention-hint")})}]},u=new i.H$("slashCommandPlugin");function l(){return{queryText:"",active:!1,range:void 0}}function f(t,e,r,n){let i=t.state.schema.nodes[s].create(a({},e),t.state.schema.text(e.hint)),o=t.state.tr.replaceWith(r.from,r.to,i);n&&o.insertText(" ",r.from+i.nodeSize),t.dispatch(o)}function d(t){let e=[];return t.descendants(t=>{t.type.name===s&&"string"==typeof t.attrs?.id&&e.push(t.attrs.id)}),e}function p(){return new i.Sy({key:u,state:{init:()=>l(),apply(t,e){let r=t.getMeta(u),n=t.selection,i=function(t){let e=t.before(),r=t.doc.textBetween(e,t.pos,"\n","\0").match(new RegExp(/(^|\s)\/(\w*)$/));if(r&&void 0!==r.index){let e=r[0].startsWith(" ")?r.index+1:r.index,n=r[0].startsWith(" ")?r[0].length-1:r[0].length,i=t.start()+e;return{range:{from:i,to:i+n},queryText:r[2]}}}(n.$from),o=a(a(a({},l()),e),r);return n.from!==n.to||(o.active=!!i,i&&(o.queryText=i.queryText,o.range=i.range)),function(t){let{active:e,range:r,queryText:n,onHintMatch:i}=t;i?i(e&&r?{text:n,range:r}:void 0):void 0}(o),o}}})}},83798:function(t){t.exports={"prosemirror-parent":"prompt-prosemirror_prosemirror-parent__K7XB4"}},80326:function(t,e,r){"use strict";r.d(e,{$:function(){return c},h:function(){return s}});var n=r(21865),i=r(60314);let o="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function a(t,e,r=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r&&e.shiftKey&&(t="Shift-"+t),t}function s(t){return new i.Sy({props:{handleKeyDown:c(t)}})}function c(t){let e=function(t){let e=Object.create(null);for(let r in t)e[function(t){let e,r,n,i,a=t.split(/-(?!$)/),s=a[a.length-1];"Space"==s&&(s=" ");for(let t=0;t<a.length-1;t++){let s=a[t];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))r=!0;else if(/^s(hift)?$/i.test(s))n=!0;else if(/^mod$/i.test(s))o?i=!0:r=!0;else throw Error("Unrecognized modifier name: "+s)}return e&&(s="Alt-"+s),r&&(s="Ctrl-"+s),i&&(s="Meta-"+s),n&&(s="Shift-"+s),s}(r)]=t[r];return e}(t);return function(t,r){let i=(0,n.YG)(r),o,s=e[a(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(1==i.length&&" "!=i){if(r.shiftKey){let n=e[a(i,r,!1)];if(n&&n(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=n.ue[r.keyCode])&&o!=i){let n=e[a(o,r)];if(n&&n(t.state,t.dispatch,t))return!0}}return!1}}},21865:function(t,e,r){"use strict";r.d(e,{YG:function(){return u},uY:function(){return i},ue:function(){return n}});for(var n={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},i={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},o="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),a="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),s=0;s<10;s++)n[48+s]=n[96+s]=String(s);for(var s=1;s<=24;s++)n[s+111]="F"+s;for(var s=65;s<=90;s++)n[s]=String.fromCharCode(s+32),i[s]=String.fromCharCode(s);for(var c in n)i.hasOwnProperty(c)||(i[c]=n[c]);function u(t){var e=!(o&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||a&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?i:n)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}}}]);
//# sourceMappingURL=7563.8d4cdd2996a6cc69.js.map