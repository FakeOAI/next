"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3489,9042],{87381:function(e,t,n){n.r(t),n.d(t,{__N_SSP:function(){return l},default:function(){return i},sandboxReadyPhrase:function(){return a}});var s=n(92379),r=n(651),l=!0;let a="sandbox-ready";function i(){let{0:e,1:t}=(0,s.useState)(""),n=(0,s.useCallback)(e=>{t(e.data)},[t]);return(0,s.useEffect)(()=>{globalThis?.window?.parent==globalThis?.window&&(location.href="/")},[]),(0,s.useEffect)(()=>{let e=new MessageChannel;return window.parent.postMessage(a,"https://chatgpt.com",[e.port2]),e.port1.onmessage=n,()=>void(e.port1.onmessage=null)},[n]),(0,r.jsx)("iframe",{srcDoc:e,sandbox:"allow-scripts",style:{position:"fixed",top:0,left:0,width:"100vh",height:"100vw",border:0}})}},84513:function(e,t,n){n.d(t,{a:function(){return a}});var s=n(87381),r=n(92379),l=n(651);let a=(0,r.memo)(function(e){let t=(0,r.useRef)(null),{0:n,1:a}=(0,r.useState)(null),i=(0,r.useCallback)(e=>{e.source===t?.current?.contentWindow&&e.data===s.sandboxReadyPhrase&&a(e.ports[0])},[]);return(0,r.useEffect)(()=>(window.addEventListener("message",i),()=>window.removeEventListener("message",i)),[i]),(0,r.useEffect)(()=>{n&&void 0!==e.srcDoc&&n.postMessage(e.srcDoc)},[n,e.srcDoc]),(0,l.jsx)("iframe",{className:e.className,src:"/sandbox",ref:t})})},9033:function(e,t,n){n.d(t,{Kd:function(){return g},v_:function(){return b}});var s=n(59725),r=n(98095),l=n(28146),a=n(15913),i=n(38482),o=n.n(i),c=n(34977),d=n(44425),u=n(26925),x=n(97193),f=n(51837),h=n(651);let m=o()(()=>Promise.all([n.e(8682),n.e(6481)]).then(n.bind(n,9760)).then(e=>e.AvatarButtons),{ssr:!1,loadableGenerated:{webpack:()=>[9760]}}),j=r.Z.Item;function p(){let e=u.ne.useStore();return(0,a.e2)()?(0,h.jsx)(j,{onClick:()=>{e.setState({shouldShowAddToHomePopover:!0})},icon:(0,h.jsx)(l.IAe,{className:"icon-md-heavy text-token-text-primary"}),children:"Add to home screen"}):null}function g(e){let{className:t,iconSize:n,children:s}=e,a=(0,f.L)(),i=(0,c.useRouter)();return(0,h.jsxs)(r.Z.Root,{modal:!1,children:[(0,h.jsx)(v,{className:t,iconSize:n,children:s}),(0,h.jsx)(r.Z.Portal,{children:(0,h.jsxs)(r.Z.Content,{collisionPadding:10,children:[(0,h.jsx)(j,{onClick:()=>x.vm.toggleSettingsModalOpen(),icon:(0,h.jsx)(l.SWE,{className:"icon-md-heavy text-token-text-primary"}),children:"Settings"}),(0,h.jsx)(j,{onClick:()=>window.open(d._A,"_blank"),icon:(0,h.jsx)(l.Jmo,{className:"icon-md-heavy text-token-text-primary"}),children:"About SearchGPT"}),(0,h.jsx)(j,{onClick:()=>window.open("https://chatgpt.com","_blank"),icon:(0,h.jsx)(l.Pfi,{className:"icon-md-heavy text-token-text-primary"}),children:"Open ChatGPT"}),(0,h.jsx)(p,{}),(0,h.jsx)(r.Z.Separator,{}),(0,h.jsx)(j,{onClick:()=>i.push("/auth/logout",void 0,{shallow:!0}),icon:(0,h.jsx)(l.iz5,{className:"icon-md-heavy text-token-text-primary"}),children:"Log out"}),a&&(0,h.jsx)(m,{})]})})]})}function b(e){let{className:t,iconSize:n}=e,s=(0,c.useRouter)();return(0,h.jsxs)(r.Z.Root,{modal:!1,children:[(0,h.jsx)(v,{className:t,iconSize:n}),(0,h.jsx)(r.Z.Portal,{children:(0,h.jsx)(r.Z.Content,{collisionPadding:10,children:(0,h.jsx)(j,{onClick:()=>s.push("/auth/logout",void 0,{shallow:!0}),icon:(0,h.jsx)(l.iz5,{className:"icon-md-heavy text-token-text-primary"}),children:"Log out"})})})]})}function v(e){let{className:t,iconSize:n,children:l}=e;return(0,h.jsx)(r.Z.Trigger,{className:"group border-0 !bg-transparent p-0",children:(0,h.jsx)("div",{className:"rounded-full",children:l??(0,h.jsx)(s.zf,{iconSize:n,className:t})})})}},19042:function(e,t,n){n.r(t),n.d(t,{DebugJsonViewer:function(){return T},DebugModal:function(){return y},DebugModalContents:function(){return P}});var s=n(11550),r=n(39358),l=n(30115),a=n(28146),i=n(24434),o=n(67330),c=n(91111),d=n(97193),u=n(27313),x=n(5132),f=n(30757),h=n(79746),m=n(19841),j=n(38482),p=n.n(j),g=n(92379),b=n(15478),v=n(19229),k=n(651);let N=p()(()=>Promise.all([n.e(3904),n.e(6476)]).then(n.bind(n,16476)).then(e=>e.default),{ssr:!1,loadableGenerated:{webpack:()=>[16476]}});function y(e){let{threadId:t,threadUserId:n}=e;return(0,d.W6)(d.bM.isDebugModalOpen)&&(0,k.jsx)(i.Z,{isOpen:!0,onClose:()=>d.vm.toggleDebugModalOpen(),type:"success",size:"fullscreen",noPadding:!0,rootClassName:"z-50",children:(0,k.jsx)(P,{threadId:t,threadUserId:n,onClose:()=>d.vm.toggleDebugModalOpen()})})}let w=(e,t)=>{let n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),s=window.URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=e,r.click(),window.URL.revokeObjectURL(s)},O="<|im_start|>",C="<|im_sep|>",S="<|im_end|>";function E(e){let{prompt:t}=e,n=[],s=0;for(;;){let e=t.indexOf(O,s);if(-1===e)break;let r=t.indexOf(C,e);if(-1===r)break;let l=t.indexOf(S,r),a=t.indexOf("<|fim_suffix|>",r);if(-1!==a&&(-1===l||a<l)&&(l=a),-1===l)break;let i=t.substring(e+O.length,r),o=t.substring(r+C.length,l);n.push((0,k.jsxs)("div",{children:[(0,k.jsxs)("span",{className:"font-semibold",children:["[",i,"]"]})," ",o]},e)),s=l+S.length}return n}let _=b.Z.div`mb-[-5px] px-2 pb-1 font-semibold uppercase border-b-2 ${e=>{let{$isSelected:t}=e;return t?"border-black dark:border-white":"border-transparent"}}`;function P(e){let{threadId:t,threadUserId:n,message:r,onClose:i}=e,{sessionUser:d}=(0,c.A)(),{0:h,1:j}=(0,g.useState)(r?"message":"json"),{data:p,isLoading:b,refetch:v}=(0,u.Y)({threadId:t,threadUserId:n,refetchOnMount:"always"}),N=p?.thread;if((0,g.useEffect)(()=>{j(r?"message":N?.turns.length?`turn${N?.turns.length-1}`:"thread")},[N?.turns.length,r]),!b&&!N&&!r)return(0,k.jsxs)(o.bW,{onClickRetry:()=>v(),children:["Failed to load."," "]});if(b)return(0,k.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:"Loading..."});let y=N?.turns,O=N?.turns[N.turns.length-1]?.artifacts__?.model_snapshots?.default_id,C=n&&t?(0,x.t5)(n,t):null;return(0,k.jsx)("div",{className:"flex flex-col gap-2 break-words font-mono text-xs",children:(0,k.jsxs)(f.fC,{orientation:"vertical",value:h,onValueChange:e=>j(e),children:[(0,k.jsxs)(f.aV,{className:"flex items-center justify-center gap-2 px-4 py-1",children:[r&&(0,k.jsx)(f.xz,{value:"message",children:(0,k.jsx)(_,{$isSelected:"message"===h,children:"Message"})},"message"),N&&(0,k.jsx)(f.xz,{value:"thread",children:(0,k.jsx)(_,{$isSelected:"thread"===h,children:"Thread"})},"thread"),y?.map((e,t)=>k.jsxs(g.Fragment,{children:[k.jsx(f.xz,{value:`turn${t}`,children:k.jsxs(_,{$isSelected:h===`turn${t}`,children:["Turn[",t,"]"]})},t),e.artifacts__?.debug_ddtrace_urls?.map(e=>k.jsx(_,{$isSelected:!1,children:k.jsxs("a",{target:"_blank",href:e,className:"text-nowrap",children:["Trace[",t,"] â†—"]})},e))]},t)),(0,k.jsx)("div",{className:"flex-grow"}),O&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(I,{name:"Model",id:O})," ",(0,k.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),d&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(I,{name:"User ID",id:d.id})," ",(0,k.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),C&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(I,{name:"Permalink",id:C}),(0,k.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),N&&(0,k.jsxs)(s.z,{size:"small",color:"secondary",onClick:()=>w("thread.json",N),children:[(0,k.jsx)(a._8t,{className:"icon-sm"})," thread.json"]}),(0,k.jsx)(l.P,{onClick:i})]}),y?.map((e,t)=>k.jsxs(f.VY,{value:`turn${t}`,className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth",children:[k.jsxs("div",{className:m.default("flex flex-col gap-1 p-6",e.index%2==0&&"bg-token-main-surface-tertiary"),children:[k.jsx(E,{prompt:e.artifacts__?.debug_info?.main_model_response?.prompt_string??""}),k.jsxs("div",{children:[k.jsx("span",{className:"font-semibold",children:"[assistant]"})," ",e.model_response?.text]})]})," "]},t)),N&&(0,k.jsx)(f.VY,{value:"thread",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-6",children:(0,k.jsx)(T,{data:N,collapsed:4})}),r&&(0,k.jsx)(f.VY,{value:"message",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-6",children:(0,k.jsx)(T,{data:r,collapsed:4})})]},N?.turns.length??"message")})}function T(e){let{data:t,collapsed:n}=e,{0:s,1:r}=(0,g.useState)(n??!0);return(0,k.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,k.jsx)("button",{onClick:()=>r(!s),className:"flex items-center gap-1",children:s?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(v.rIY,{size:14})," Expand all"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(v.NsE,{size:14})," Collapse all"]})}),(0,k.jsx)("div",{className:"w-full",children:(0,k.jsx)(N,{json:t,jsonViewProps:{collapsed:s,shortenTextAfterLength:0}},String(s))})]})}function I(e){let{name:t,id:n}=e,s=(0,g.useCallback)(()=>{(0,h.v)(n)},[n]);return(0,k.jsxs)("div",{className:"flex items-center gap-2 truncate",children:[(0,k.jsxs)("span",{className:"text-nowrap font-semibold",children:[t,":"]}),(0,k.jsx)("span",{title:n,className:"truncate text-gray-500 dark:text-white",children:n}),(0,k.jsx)(r.Z,{onCopy:s})]})}},67330:function(e,t,n){n.d(t,{aE:function(){return d},bW:function(){return c},jj:function(){return o}});var s=n(82363),r=n(92379),l=n(64925),a=n(95204),i=n(651);function o(e){let{children:t}=e;return(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,i.jsxs)("div",{className:"flex flex-col items-center gap-1 text-sm font-semibold text-token-text-tertiary",children:[(0,i.jsx)(a.Z,{className:"icon-2xl"}),t]})})}function c(e){let{onClickRetry:t,children:n}=e;return(0,i.jsxs)(o,{children:[(0,i.jsxs)("div",{children:["Error."," ",(0,i.jsx)("button",{onClick:t,className:"inline font-semibold text-token-text-primary hover:opacity-70",children:"Try again?"})]}),n]})}function d(e){let{resetError:t,componentStack:n,error:a}=e;return(0,r.useEffect)(()=>{s.U.addError(a)},[a]),(0,i.jsxs)(c,{onClickRetry:t,children:[(0,i.jsx)("div",{className:"fixed left-2 top-2",children:(0,i.jsx)(l.WU,{})}),(0,i.jsx)("div",{className:"fixed right-2 top-2",children:(0,i.jsx)(l.z0,{})}),!1]})}},64925:function(e,t,n){n.d(t,{Au:function(){return L},rm:function(){return Z},WU:function(){return I},z0:function(){return D}});var s=n(25162),r=n(19841),l=n(24098),a=n.n(l),i=n(92379),o=n(15478),c=n(9033),d=n(30853),u=n(91981),x=n(651);let f={[u.kQ.CONNECTING]:"Connecting",[u.kQ.OPEN]:"Open",[u.kQ.CLOSING]:"Closing",[u.kQ.CLOSED]:"Closed",[u.kQ.UNINSTANTIATED]:"Uninstantiated"};function h(e){let{readyState:t,className:n}=e,{0:s,1:l}=(0,i.useState)(!0);return((0,i.useEffect)(()=>{setTimeout(()=>{l(!0)},1e3)},[]),t!==u.kQ.OPEN&&s)?(0,x.jsx)("div",{className:(0,r.default)("flex items-center gap-2 p-3 text-sm",n),children:(0,x.jsx)(d.u,{label:f[t],sideOffset:0,side:"right",children:(0,x.jsx)("div",{className:(0,r.default)("h-2 w-2 rounded-full",(t===u.kQ.CLOSING||t===u.kQ.CONNECTING)&&"bg-yellow-500",(t===u.kQ.CLOSED||t===u.kQ.UNINSTANTIATED)&&"bg-red-500",s?"block":"hidden")})})}):null}var m=n(98601),j=n(71522),p=n(28146),g=n(87387);function b(e){let{label:t,labelSide:n="right",className:s,onClick:l,children:a}=e;return(0,x.jsx)(d.E,{label:t,sideOffset:0,side:n,disabled:!t,children:(0,x.jsx)("button",{onClick:l,className:(0,r.default)("flex items-center justify-center p-1.5 text-token-text-tertiary hover:text-token-text-primary",s),children:a})})}var v=n(26925),k=n(97193),N=n(10798),y=n(65925),w=n.n(y),O=n(99661);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(t){(0,m.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(e,t){return Object.keys(e).reduce((n,s)=>(w()(e[s],t[s])||(n[s]=t[s]),n),{})}function _(){let{setTheme:e,resolvedTheme:t}=(0,O.F)(),n=v.ne.useState(v.ne.selectAgentSettingsOverrides),[s]=(0,N.OR)(),l=E(g.sH,n),a=E(N.Ws,s),i=S(S({},l),a),o=Object.keys(i).length>0;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(b,{label:"Debug (Internal)",onClick:()=>k.vm.toggleDebugModalOpen(),children:(0,x.jsx)(p.reV,{className:"icon-sm-heavy"})}),(0,x.jsx)(b,{label:"Theme (Internal)",onClick:()=>{e("dark"===t?"light":"dark")},children:(0,x.jsxs)(j.ZP,{children:["dark"===t&&(0,x.jsx)(p.NWY,{className:"icon-md-heavy"}),"light"===t&&(0,x.jsx)(p.kLh,{className:"icon-md-heavy"})]})}),(0,x.jsx)(b,{label:o?["Config (Internal) - Changes:",Object.keys(i).join(", ")].join("\n"):"Config (Internal)",onClick:()=>k.vm.toggleInternalSettingsModalOpen(),children:(0,x.jsx)(p.KAl,{className:(0,r.default)(o?"icon-lg-heavy":"icon-md-heavy",{"text-red-500":o})})})]})}var P=n(91111),T=n(51837);function I(e){let{hideReadyState:t=!1,onResultsPage:n=!1,children:l}=e,{readyState:i,resetSearch:o}=(0,P.A)(),c=(0,T.L)();return(0,x.jsxs)("div",{className:(0,r.default)("hidden w-20 shrink-0 flex-col items-center justify-between border-r py-6 sm:flex",n?"relative border-token-border-light":"absolute bottom-0 left-0 top-0 border-transparent"),children:[(0,x.jsxs)(a(),{onClick:()=>o(),href:"/search",className:"text-token-text-primary hover:text-token-text-secondary",title:"Go to SearchGPT",children:[(0,x.jsx)(s.nI,{className:"h-8 w-8"}),c&&!t&&(0,x.jsx)(h,{readyState:i})]}),c&&(0,x.jsx)("div",{className:"flex flex-col items-center gap-2",children:(0,x.jsx)(_,{})}),(0,x.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2",children:l})]})}function D(){return(0,x.jsx)("div",{className:"absolute right-5 top-5 hidden sm:block",children:(0,x.jsx)(c.Kd,{className:"h-8 w-8"})})}function L(){return(0,x.jsx)(z,{$side:"left",children:(0,x.jsx)(s.nI,{className:"h-8 w-8"})})}function Z(e){let{className:t}=e;return(0,x.jsx)(z,{$side:"right",className:`${t}`,children:(0,x.jsx)(c.v_,{className:"h-8 w-8"})})}let z=o.Z.div`absolute ${e=>"left"===e.$side?"left-5":"right-5"} bottom-5 top-5 z-10 w-10 flex-col justify-between items-center hidden sm:flex`},44425:function(e,t,n){n.d(t,{_A:function(){return s}});let s="https://openai.com/index/searchgpt-prototype/"},51837:function(e,t,n){n.d(t,{L:function(){return r}});var s=n(45120);function r(){return s.fW("2000076788")?.value}},27313:function(e,t,n){n.d(t,{Y:function(){return i},v:function(){return o}});var s=n(84760),r=n(92379),l=n(81014),a=n(12381);function i(e){let{threadId:t,threadUserId:n,refetchOnMount:r}=e;return(0,s.a)({queryKey:["thread",t,n],queryFn:async()=>{if(!t)return{thread:null,turns:null};let e=await (0,l.K8)({threadId:t,threadUserId:n}),s=e.turns;return{thread:e,turns:s}},enabled:!!t,refetchOnMount:r})}function o(e){let{threadId:t,threadUserId:n}=e,s=i({threadId:t,threadUserId:n}),l=s.data;return(0,r.useEffect)(()=>{t&&a.P3.setThread(t,l?.turns??[])},[t,l]),{query:s.data?.turns[0]?.user_query,refetch:s.refetch,isLoading:s.isLoading,isError:s.isError}}},51942:function(e,t,n){n.d(t,{F:function(){return h}});var s=n(16757),r=n(27742),l=n(74301),a=n(67437),i=n(92745),o=n(79857),c=n(38924),d=n(97834),u=n(52978),x=n(91530),f=n.n(x);function h(e){let t=(0,a.j8)(),n=(0,r.W)(e),x=(0,a.Bv)(e)??t.id,h=(0,l.Z)(e,void 0,f());return async function(t){let r=i.tQ.getThreadCurrentLeafId(e),l=`${r}-nextPrompt`;i.tQ.updateTree(e,e=>{e.addNode(l," ",r,s.uU.User)});let a=performance.now(),f=await (0,d.rS)(),[m,j,p]=await Promise.all([o.ZP.getEnforcementToken(f),u.Z.getEnforcementToken(f),c.Z.getEnforcementToken(f)]);h({model:x,completionType:s.Os.Next,parentNodeId:l,metadata:{eventSource:"mouse"},completionMetadata:{conversationMode:n},chatReq:f,arkoseToken:m??null,turnstileToken:j??null,proofToken:p??null,preflightTime:performance.now()-a,appendMessages:t})}}}}]);
//# sourceMappingURL=3489.9c9574dea9e043bc.js.map