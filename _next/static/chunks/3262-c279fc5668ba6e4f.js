"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3262],{22594:function(e,t,n){n.d(t,{D:function(){return x},Z:function(){return m}});var r=n(21389),s=n(88600),i=n(89678),a=n.n(i),o=n(92379),l=n(49764),u=n(75325),d=n(15478),c=n(11550),h=n(6440),f=n(11433),p=n(24434),g=n(651);function m(e){let{tagOptions:t,onSubmit:n,onMoreClicked:i,onCancel:d,maxInlineTags:m=5,modalOnly:y=!1,modalTitle:b,multiple:v,children:w,allowEmptySubmit:C=!1}=e,_=(0,l.Z)(),{0:T,1:M}=(0,o.useState)(y?"modal":"inline"),{0:P,1:j}=(0,o.useState)([]),{0:O,1:N}=(0,o.useState)(void 0),k=(0,o.useCallback)(e=>{n(e),M("submitted"),setTimeout(()=>{M("closed")},1500)},[n]),A=(0,o.useMemo)(()=>a()(k,500),[k]),S=e=>{let t=[];return j(t=v?P.includes(e)?P.filter(t=>t!==e):[...P,e]:[e]),t},R=()=>{k({tags:P,textFeedback:O,tagChoices:F,source:"modal"})},F=t.map(e=>e.value),L=function(e){let t={};return e.forEach(e=>{let n=e.group??"Default";t[n]||(t[n]=[]),t[n].push(e)}),t}(t),D=Object.keys(L);return(0,g.jsxs)(g.Fragment,{children:[!y&&(0,g.jsx)(r.M,{children:"closed"!==T&&(0,g.jsxs)(s.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"min-h-[96px] w-full",children:["submitted"===T&&(0,g.jsx)(s.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"text-center",children:(0,g.jsx)("div",{className:"inline-flex rounded-lg border border-token-border-light p-4",children:(0,g.jsx)("div",{className:"text-sm",children:(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.submitted",defaultMessage:"Thanks for your feedback!"})})})}),["inline","modal"].includes(T)&&(0,g.jsxs)("div",{className:"relative mt-2 flex w-full flex-col gap-3 rounded-lg border border-token-border-light p-4",children:[(0,g.jsx)("button",{className:"absolute right-4 top-4 text-sm font-bold",onClick:()=>{M("closed"),A.cancel(),d?.()},children:(0,g.jsx)(f.tPq,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})}),(0,g.jsx)("div",{className:"text-sm text-token-text-secondary",children:(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.inlineTitle",defaultMessage:"Tell us more:"})}),(0,g.jsxs)("div",{className:"flex flex-wrap gap-3",children:[t.slice(0,m).map(e=>(0,g.jsx)(x,{$selected:P.includes(e.value),onClick:()=>{A({tags:S(e.value),tagChoices:F,source:"inline"})},children:e.label},e.value)),(0,g.jsx)(x,{onClick:()=>{i?.(),A.cancel(),M("modal")},children:(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.moreOptions.1",defaultMessage:"More..."})})]})]})]},"main")}),"modal"===T&&(0,g.jsxs)(p.Z,{type:"success",isOpen:!0,className:"max-w-xl",size:"custom",title:b??(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.modalTitle",defaultMessage:"Provide additional feedback"}),onClose:()=>{j([]),M(y?"closed":"inline"),y&&d?.()},showCloseButton:!0,primaryButton:(0,g.jsx)(c.z,{color:"primary",disabled:0===P.length&&!O&&!C,onClick:R,children:(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.submit",defaultMessage:"Submit"})}),rootClassName:"z-50",children:[(0,g.jsx)("div",{className:"flex flex-col gap-6",children:D.map(e=>(0,g.jsxs)("div",{children:[D.length>1&&(0,g.jsx)("div",{className:"mb-3 text-sm font-semibold",children:e}),(0,g.jsx)("div",{className:"flex flex-wrap gap-3",children:L[e].map(e=>(0,g.jsx)(x,{$selected:P.includes(e.value),onClick:()=>S(e.value),children:e.label},e.value))},e)]},e))}),(0,g.jsx)(h.Z,{name:"feedback",type:"text",className:"mt-6",placeholder:_.formatMessage({id:"ConversationTurnInlineMessageFeedback.feedbackPlaceholder.1",defaultMessage:"(Optional) Feel free to add specific details"}),value:O??"",onChange:e=>N(e.target.value),onPressEnter:R}),w]})]})}let x=d.Z.button`
  rounded-lg border border-token-border-light px-3 py-1 text-sm text-token-text-secondary hover:text-token-text-primary hover:bg-token-main-surface-secondary
  ${e=>{let{$selected:t}=e;return t&&"!bg-token-text-primary !text-token-main-surface-primary"}}
`},47313:function(e,t,n){n.d(t,{G:function(){return r}});let r=(0,n(92379).createContext)(void 0)},65994:function(e,t,n){n.d(t,{b:function(){return r}});let r="contentReference"},76482:function(e,t,n){n.d(t,{lx:function(){return a},rc:function(){return i}});var r=n(38482),s=n.n(r);let i=s()(()=>Promise.all([n.e(6835),n.e(6617),n.e(6895),n.e(1981),n.e(893),n.e(7398),n.e(4169),n.e(5904),n.e(9027),n.e(555)]).then(n.bind(n,1457)).then(e=>e.FormattedText),{loadableGenerated:{webpack:()=>[1457]}});t.ZP=i;let a=s()(()=>Promise.all([n.e(6835),n.e(6617),n.e(6895),n.e(1981),n.e(893),n.e(7398),n.e(4169),n.e(5904),n.e(9027),n.e(555)]).then(n.bind(n,1457)).then(e=>e.UserFormattedText),{loadableGenerated:{webpack:()=>[1457]}})},44885:function(e,t,n){n.d(t,{R3:function(){return d},Zl:function(){return f},eX:function(){return u},fL:function(){return c}});var r=n(98601),s=n(23763),i=n.n(s),a=n(56290);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}class l{constructor(e,t,n,s){this.textMessageParts=e,this.updateReactComponentDisplay=t,this.isActivelyStreaming=n,(0,r.Z)(this,"displayedTextLength",void 0),(0,r.Z)(this,"textMessagePartsTextLength",void 0),(0,r.Z)(this,"requestUpdateRaf",null),(0,r.Z)(this,"prevBuffer",void 0),(0,r.Z)(this,"nextBuffer",void 0),this.textMessagePartsTextLength=(0,a.Vh)(e).length,this.displayedTextLength=s?0:this.textMessagePartsTextLength,s&&!s.isComplete()&&(s.nextBuffer=this,this.prevBuffer=s)}onMessagePartsUpdated(e,t){this.textMessageParts=e,this.textMessagePartsTextLength=(0,a.Vh)(e).length,this.isActivelyStreaming=t,this.shouldUpdate()&&this.updateBufferedState()}shouldUpdate(){return!this.prevBuffer&&this.isBuffering()}isBuffering(){return this.displayedTextLength<this.textMessagePartsTextLength}isComplete(){return!this.isActivelyStreaming&&!this.isBuffering()}getNumBufferedChars(){let e=this.textMessagePartsTextLength,t=this.nextBuffer;for(;t;)e+=t.textMessagePartsTextLength,t=t.nextBuffer;return e-this.displayedTextLength}requestUpdate(){this.requestUpdateRaf||(this.requestUpdateRaf=window.requestAnimationFrame(()=>{this.requestUpdateRaf=null,this.updateReactComponentDisplay((0,a.$w)(this.textMessageParts,this.displayedTextLength),this.isComplete()),this.isComplete()&&this.resolveDependency()}))}resolveDependency(){if(this.nextBuffer){let e=this.nextBuffer;this.nextBuffer=e.prevBuffer=void 0,e.shouldUpdate()&&e.updateBufferedState()}}destroy(){this.resolveDependency(),this.requestUpdateRaf&&(window.cancelAnimationFrame(this.requestUpdateRaf),this.requestUpdateRaf=null)}}class u extends l{constructor(e,t,n,s){super(e,t,n,s),this.updateReactComponentDisplay=t,(0,r.Z)(this,"frameRequestId",void 0),(0,r.Z)(this,"prevAddFrameTime",void 0)}updateBufferedState(){if(!this.frameRequestId){let e=this.getNumBufferedChars();if(e>0){let t=Math.max(u.MIN_BUFFERING_CHAR_PER_MS,e/u.MAX_BUFFERING_LAG_MS);this.frameRequestId=window.requestAnimationFrame(e=>{this.frameRequestId=void 0;let n=Math.floor(t*(void 0===this.prevAddFrameTime?2/u.MIN_BUFFERING_CHAR_PER_MS:e-this.prevAddFrameTime));n>0&&(this.prevAddFrameTime=e,this.displayedTextLength=Math.min(this.displayedTextLength+n,this.textMessagePartsTextLength),this.requestUpdate()),this.shouldUpdate()&&this.updateBufferedState()})}}}destroy(){super.destroy(),this.frameRequestId&&window.cancelAnimationFrame(this.frameRequestId)}}(0,r.Z)(u,"MAX_BUFFERING_LAG_MS",500),(0,r.Z)(u,"MIN_BUFFERING_CHAR_PER_MS",1/30);class d extends l{constructor(e,t,n,s){super(e,t,n,s),this.updateReactComponentDisplay=t,(0,r.Z)(this,"displayNextChunkTimeout",void 0)}updateBufferedState(){let e=this.getNumBufferedChars(),t=e<d.MIN_CHARS_BEHIND_TO_CATCHUP?this.textMessagePartsTextLength-this.displayedTextLength:Math.ceil(e*d.UPDATE_FREQUENCY_MS/d.CATCHUP_TIME_MS);this.displayedTextLength=Math.min(this.displayedTextLength+t,this.textMessagePartsTextLength),this.requestUpdate(),this.displayNextChunkTimeout||(this.displayNextChunkTimeout=window.setTimeout(()=>{this.displayNextChunkTimeout=void 0,this.shouldUpdate()&&this.updateBufferedState()},d.UPDATE_FREQUENCY_MS))}destroy(){super.destroy(),window.clearTimeout(this.displayNextChunkTimeout)}}(0,r.Z)(d,"MIN_CHARS_BEHIND_TO_CATCHUP",20),(0,r.Z)(d,"CATCHUP_TIME_MS",300),(0,r.Z)(d,"UPDATE_FREQUENCY_MS",30);class c extends l{constructor(e,t,n,s,l){super(e,t,n,s),this.updateReactComponentDisplay=t,(0,r.Z)(this,"LAG_FACTORS",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({".":15,"!":15,"?":15,"\n":15,",":8,":":8,";":8,DEFAULT_LAG_FACTOR:.9,BUFFER_FACTOR:.08},window.__PUNCTUATION_BUFFER_LAG_FACTORS)),(0,r.Z)(this,"concatenatedText",void 0),(0,r.Z)(this,"displayNextCharTimeout",void 0),(0,r.Z)(this,"debug",void 0),(0,r.Z)(this,"streamStartMs",void 0),(0,r.Z)(this,"averageMsPerChar",void 0),(0,r.Z)(this,"_throttledDebugLog",i()(e=>{console.debug(e)},500,{leading:!0,trailing:!0})),this.concatenatedText=(0,a.Vh)(this.textMessageParts),this.debug=l?.debug??!1,this.streamStartMs=0,this.averageMsPerChar=0,this.debug&&console.debug(`PunctuationBuffer:
[lagFactors: ${JSON.stringify(this.LAG_FACTORS,null,2)}]`)}displayNextChar(){this.displayNextCharTimeout=void 0,this.shouldUpdate()&&(this.displayedTextLength++,this.requestUpdate(),this.displayNextCharTimeout=window.setTimeout(()=>this.displayNextChar(),this._getNextCharDelayMs()))}updateBufferedState(){this.concatenatedText=(0,a.Vh)(this.textMessageParts),0===this.streamStartMs?this.streamStartMs=Date.now():this.averageMsPerChar=(Date.now()-this.streamStartMs)/this.textMessagePartsTextLength,this.displayNextCharTimeout||this.displayNextChar()}destroy(){super.destroy(),window.clearTimeout(this.displayNextCharTimeout)}_getNextCharDelayMs(){let e=this.concatenatedText[this.displayedTextLength-1],t=this.getNumBufferedChars(),n=1/Math.max(t*this.LAG_FACTORS.BUFFER_FACTOR,1),r=(this.LAG_FACTORS[e]??this.LAG_FACTORS.DEFAULT_LAG_FACTOR)*n,s=this.averageMsPerChar*r;return this.debug&&this._throttledDebugLog(`PunctuationBuffer:
[lagMs: ${s}]
[lastChar: "${e}"]
[averageMsPerChar: ${this.averageMsPerChar}]
[lagFactor: ${r}]
[bufferLagFactor: ${n}]
[numBufferedChars: ${t}]
===`),s}}function h(e){return"text"===e.type}class f{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;(0,r.Z)(this,"buffer",void 0),(0,r.Z)(this,"text",void 0),this.buffer=new e([n],(e,n)=>{t(e.filter(h).map(e=>e.text).join(""),n)},s,i),this.text=n}setText(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.text=e,this.buffer.onMessagePartsUpdated([this.text],t)}isBuffering(){return this.buffer.isBuffering()}isComplete(){return this.buffer.isComplete()}destroy(){return this.buffer.destroy()}}},56290:function(e,t,n){n.d(t,{$w:function(){return a},Lm:function(){return o},Qq:function(){return i},Vh:function(){return s},xz:function(){return l}});var r=n(16757);function s(e){return e.map(e=>"string"==typeof e?e:"").join("")}function i(e){return e.map(e=>"text"===e.type?e.text:"").join("\n")}function a(e,t){let n=[],s=0;for(let i=0;i<e.length;i++){let a=e[i];if("string"==typeof a){if(null!=t&&t<s+a.length){n.push({type:"text",text:a.slice(0,t-s)});break}n.push({type:"text",text:a}),s+=a.length}else if(a.content_type===r.wW.ImageAssetPointer){let e=i>0?n[i-1]:null;e?.type==="images"?e.imageAssets.push(a):n.push({type:"images",imageAssets:[a]})}else a.content_type===r.wW.AudioTranscription&&n.push({type:"transcription",text:a.text})}return n}function o(e){let{isUserTurn:t,parts:n}=e;if(!t)return a(n);let s={text:[],images:[]};for(let e=0;e<n.length;e++){let t=n[e];"string"==typeof t?t.trim().length>0&&s.text.push({type:"text",text:t}):t.content_type===r.wW.AudioTranscription?s.text.push({type:"transcription",text:t.text}):t.content_type===r.wW.ImageAssetPointer&&s.images.push(t)}let i=[];return s.images.length>0&&i.unshift({type:"images",imageAssets:s.images}),i.push(...s.text.map(e=>({type:e.type,text:e.text}))),i}function l(e){let t=e&&new Date(e),n=t&&new Date(t);return n?`after ${n.getHours()%12||12}:${10>n.getMinutes()?"0":""}${n.getMinutes()} ${n.getHours()>=12?"PM":"AM"}`:"later"}},40833:function(e,t,n){n.d(t,{v:function(){return f}});var r=n(98601),s=n(10449),i=n(19841),a=n(92379),o=n(75325),l=n(47584),u=n(11433),d=n(651);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function f(e){let{align:t,arrowPadding:n,alignOffset:r,show:l,onDismiss:c,children:f,title:g,side:m,sideOffset:x,theme:y="default",badge:b="new",description:v,dismissOnOutsideClick:w=!1}=e,C=(0,a.useRef)(null);return(0,d.jsxs)(s.fC,{open:l,onOpenChange:e=>{e||c()},children:[(0,d.jsx)(s.xz,{asChild:!0,onClick:()=>{c()},ref:C,children:f}),(0,d.jsx)(s.h_,{children:(0,d.jsxs)(s.VY,{arrowPadding:n,alignOffset:r,align:t,side:m,sideOffset:x,onOpenAutoFocus:e=>{e.preventDefault()},onCloseAutoFocus:e=>{e.preventDefault()},onInteractOutside:e=>{e.target instanceof Element&&C.current?.contains(e.target)?e.preventDefault():w?c():e.preventDefault()},updatePositionStrategy:"always",className:(0,i.default)("relative z-10 animate-slideLeftAndFade select-none rounded-xl p-4 text-sm shadow-sm","default"===y?"bg-gray-900 text-white dark:bg-gray-50 dark:text-gray-700":"bg-blue-400 text-white"),children:[(0,d.jsxs)("div",{className:"flex max-w-xs flex-col gap-1",children:[(0,d.jsxs)("div",{className:"mb-0.5 flex gap-2",children:["new"===b?(0,d.jsx)("span",{className:(0,i.default)("rounded px-1.5 py-0.5 text-[10px] font-semibold uppercase leading-normal","default"===y?"bg-green-500 text-white":"bg-white text-blue-selection"),children:(0,d.jsx)(o.Z,h({},p.new))}):"beta"===b&&(0,d.jsx)("span",{className:"rounded-full bg-blue-100 px-1.5 text-[10px] font-semibold text-blue-600",children:(0,d.jsx)(o.Z,h({},p.beta))}),(0,d.jsx)("div",{className:"grow font-semibold",children:g}),(0,d.jsx)(s.x8,{className:"-my-1 -mr-1 p-1 opacity-70 transition hover:opacity-100",children:(0,d.jsx)(u.tPq,{className:"icon-sm"})})]}),void 0!==v&&(0,d.jsx)("div",{className:"",children:v})]}),(0,d.jsx)(s.Eh,{asChild:!0,children:(0,d.jsx)("div",{className:(0,i.default)("relative top-[-6px] h-3 w-3 rotate-45 transform rounded-br-sm","default"===y?"bg-gray-900 dark:bg-gray-50":"bg-blue-400")})})]})})]})}let p=(0,l.vU)({new:{id:"announcementTooltip.new",defaultMessage:"New"},beta:{id:"announcementTooltip.beta",defaultMessage:"Beta"}})},5132:function(e,t,n){n.d(t,{W4:function(){return l},XB:function(){return c},XM:function(){return d},ri:function(){return h},t5:function(){return f},to:function(){return i}});var r=n(16757),s=n(65012);let i=2592e3,a="last_checked_loc",o="last_denied_loc";function l(e){return e.author.metadata?.real_author===r.d1.ToolWeb}let u={latitude:null,longitude:null,locationAccuracy:null};async function d(){return navigator?.permissions?await navigator.permissions.query({name:"geolocation"}):null}async function c(e){let{enabled:t}=e;if(!t)return h();if((await d())?.state!=="granted"){let e=localStorage.getItem(a);if(e){let t=Number(e);if(Date.now()-864e5<t)try{return JSON.parse(s.bX.getCookie(s.cn.LastLocation))}catch{}}}let n=localStorage.getItem(o);if(n){let e=Number(n);if(Date.now()-36e5<e)return null}return await new Promise(e=>{navigator.geolocation.getCurrentPosition(t=>{let n={latitude:t.coords.latitude,longitude:t.coords.longitude,locationAccuracy:t.coords.accuracy};s.bX.setCookie(s.cn.LastLocation,JSON.stringify(n),{maxAge:i}),localStorage.setItem(a,Date.now().toString()),e(n)},()=>{localStorage.setItem(o,Date.now().toString()),e(h())},{enableHighAccuracy:!0,maximumAge:0})})}function h(){return s.bX.setCookie(s.cn.LastLocation,JSON.stringify(u),{maxAge:i}),localStorage.removeItem(a),localStorage.removeItem(o),null}function f(e,t){return`https://chatgpt.com/search/evals/permalink/${e}/${t}`}},31353:function(e,t,n){n.d(t,{AW:function(){return p},Cp:function(){return c}});var r=n(98601),s=n(65994),i=n(22433),a=n(85302),o=n(18939),l=n.n(o);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,o=0,u=!1,c=!1,h=[...n].sort((e,t)=>e.start_idx-t.start_idx||e.end_idx-t.end_idx).reduce((t,n)=>{let r,i;if(n.end_idx>e.length)return t;switch(n.type){case"invalid":case"hidden":r=d(d({},n),{},{type:"hidden",invalid:"invalid"===n.type});break;case"image_v2":case"nav_list":case"tldr":case"optimistic_image_citation":case"sources_footnote":i="block",r=d({},n);break;case"file":case"title_citation":case"location_search":case"time":i="inline",r=d({},n);break;case"webpage":case"webpage_extended":i="inline",r={type:"grouped_webpages",items:[d(d({},n),{},{type:"webpage"})]};break;case"calculator":case"stock":case"forecast":case"sports":i="block",u=!0,c="stock"===n.type,r=d({},n);break;default:r=d(d({},n),{},{type:"hidden",invalid:!0}),i="alt"}return t.push({originalContentReference:n,newContentReference:r,index:o++,displayType:i}),s&&t.push({originalContentReference:n,newContentReference:d({type:"debug",matched_text:n.matched_text.replace(/(^【|】$)/g,"")},"webpage_extended"===n.type&&n.pub_date&&{pub_date:new Date(1e3*n.pub_date).toLocaleString()}),index:o++}),t},[]);!function(e){let t=new Map;e.forEach((n,r)=>{let{originalContentReference:s,newContentReference:i,index:a}=n;if("grouped_webpages"!==i.type)return;i.items=i.items.map(e=>(t.has(e.url)||t.set(e.url,{index:a??r}),d(d({},e),{},{index:t.get(e.url)?.index})));let o=e[r+1];if(null==o)return;let{newContentReference:l,originalContentReference:u}=o;"grouped_webpages"===l.type&&s.end_idx+1>=u.start_idx&&(l.items=[...i.items.map(e=>d(d({},e),{},{index:a??void 0})),...l.items],n.displayType=void 0)})}(h);let g=l()(h.filter(e=>{let{index:t,displayType:n}=e;return null!=t&&n}).map(e=>{let{newContentReference:t}=e;return t})),m=function(e,t){let n="",r=0,s=(0,a.km)(t),i=new Set(["forecast"]),o=-1,l=0;for(let t of e){let{originalContentReference:e,displayType:u}=t;i.has(e.type)&&(o=l);let{start_idx:d,end_idx:c}=e,h=s.slice(r,d);if(n+=(0,a.dP)(h),r=c,u){switch(u){case"block":n+=f(l,"leaf","newline","newline");break;case"inline":{let e=0!==n.length&&n[n.length-1].match(/\s/)?void 0:"zero-width-space";n+=f(l,"inline",e);break}case"alt":n+=e.alt??""}l++}}return n+=(0,a.dP)(s.slice(r)),o>-1&&(n=f(o,"leaf")),n}(h,e);return m=p(m),t=g,g=u?t.map(e=>"tldr"===e.type?d(d({},e),{},{url:""}):e):t,c&&(g=function(e,t){let n=(t??[]).find(e=>"tldr"===e.type);return n?.url?e.map(e=>"stock"===e.type?d(d({},e),{},{url:e.url??n.url??""}):e):e}(g,n)),r&&({updatedText:m,updatedReferences:g}=function(e,t,n){let r=e.find(e=>(0,i.rH)(e)===i.Cs.CodeInterpreter),s=e.find(e=>(0,i.rH)(e)===i.Cs.CodeInterpreterTool);if(null!=r&&null!=s){let e=t.length;n.endsWith("```")&&(n+="\n"),n+=" "+f(e,"inline","zero-width-space","zero-width-space"),t.push({type:"code_execution",codeMessage:r,codeExecutionOutputMessage:s})}return{updatedText:n,updatedReferences:t}}(r,g,m)),{processedText:m,displayedContentReferences:g}}let h="&#8203;";function f(e,t,n,r){let i=`${s.b}[oaicite:${e}]{index=${e}}`;return`${"zero-width-space"===n?h:"newline"===n?"\n":""}${"leaf"===t?"::":":"}${i}${"zero-width-space"===r?h:"newline"===n?"\n":""}`}function p(e){let t=e,n=(t=t.replace(/【[^】]*$/g,"")).match(/(\n|^):::/g);return n&&n.length%2==1&&(t+="\n:::"),t=t.replace(/^\d+$/,"")}},85302:function(e,t,n){function r(e){try{let t=new Intl.Segmenter("en-US",{granularity:"grapheme"}).segment(e),n=[];for(let e of t)n.push(e.segment);return n}catch{return e.split("")}}function s(e){let t=[];for(let n=0;n<e.length;n++){let r=e.codePointAt(n);void 0!==r&&(t.push(r),r>65535&&n++)}return t}function i(e){return String.fromCodePoint(...e)}n.d(t,{Jx:function(){return r},dP:function(){return i},km:function(){return s}})},39696:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(92379);function s(e,t){let n=(0,r.useRef)(e);(0,r.useEffect)(()=>{n.current=e},[e]),(0,r.useEffect)(()=>{if(null!=t){let e=window.setInterval(function(){n.current()},t);return()=>clearInterval(e)}},[t])}}}]);
//# sourceMappingURL=3262-c279fc5668ba6e4f.js.map