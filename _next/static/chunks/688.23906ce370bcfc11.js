"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[688,9042],{87381:function(e,t,s){s.r(t),s.d(t,{__N_SSP:function(){return a},default:function(){return o},sandboxReadyPhrase:function(){return l}});var n=s(92379),r=s(651),a=!0;let l="sandbox-ready";function o(){let{0:e,1:t}=(0,n.useState)(""),s=(0,n.useCallback)(e=>{t(e.data)},[t]);return(0,n.useEffect)(()=>{globalThis?.window?.parent==globalThis?.window&&(location.href="/")},[]),(0,n.useEffect)(()=>{let e=new MessageChannel;return window.parent.postMessage(l,"https://chatgpt.com",[e.port2]),e.port1.onmessage=s,()=>void(e.port1.onmessage=null)},[s]),(0,r.jsx)("iframe",{srcDoc:e,sandbox:"allow-scripts",style:{position:"fixed",top:0,left:0,width:"100vh",height:"100vw",border:0}})}},84513:function(e,t,s){s.d(t,{a:function(){return l}});var n=s(87381),r=s(92379),a=s(651);let l=(0,r.memo)(function(e){let t=(0,r.useRef)(null),{0:s,1:l}=(0,r.useState)(null),o=(0,r.useCallback)(e=>{e.source===t?.current?.contentWindow&&e.data===n.sandboxReadyPhrase&&l(e.ports[0])},[]);return(0,r.useEffect)(()=>(window.addEventListener("message",o),()=>window.removeEventListener("message",o)),[o]),(0,r.useEffect)(()=>{s&&void 0!==e.srcDoc&&s.postMessage(e.srcDoc)},[s,e.srcDoc]),(0,a.jsx)("iframe",{className:e.className,src:"/sandbox",ref:t})})},89905:function(e,t,s){s.d(t,{Z:function(){return h}});var n=s(99333),r=s(47416),a=s(58025),l=s(79746),o=s(19841),i=s(92379),c=s(49764),d=s(75325),u=s(15478),f=s(39358),m=s(16779),p=s(651);function h(e){let{children:t,className:s,language:n,content:a,shouldWrapCode:o}=e,d=(0,i.useCallback)(()=>{(0,l.v)(a)},[a]),u=(0,c.Z)(),{isWithinDataAnalysisToolMessage:m}=(0,i.useContext)(r.c);return(0,p.jsx)(g,{title:n,shouldWrapCode:o,headerDecoration:(0,p.jsxs)("div",{className:"flex items-center",children:[m&&(0,p.jsx)(x,{}),(0,p.jsx)(f.Z,{buttonText:u.formatMessage({id:"zIa6ZQ",defaultMessage:"Copy code"}),onCopy:d})]}),codeClassName:s,children:t})}function x(){let e=(0,a.Gt)(),{data:t=!1}=(0,a.R1)(n.sh.ShowExpandedCodeView),s=(0,c.Z)();return(0,p.jsxs)("div",{className:"mr-2 flex items-center gap-2 border-r border-token-border-medium pr-2",children:[(0,p.jsx)("label",{htmlFor:"ada-always-show",children:(0,p.jsx)(d.Z,{defaultMessage:"Always show details",id:"message.tools.codeInterpreter.alwaysShowAnalysis"})}),(0,p.jsx)(m.Z,{id:"ada-always-show",size:"small",onChange:t=>{e.mutate({setting:n.sh.ShowExpandedCodeView,value:t})},enabled:t,label:t?s.formatMessage({defaultMessage:"Toggle to always expand detail view for code analysis on",id:"message.tools.codeInterpreter.alwaysShowAnalysis.enabled"}):s.formatMessage({defaultMessage:"Toggle to always expand detail view for code analysis off",id:"message.tools.codeInterpreter.alwaysShowAnalysis.disabled"})})]})}function g(e){let{children:t,title:s,headerDecoration:n,shouldWrapCode:r=!1,className:a,codeContainerClassName:l,codeClassName:o}=e;return(0,p.jsxs)(j,{className:a,children:[(null!=s||null!=n)&&(0,p.jsxs)(b,{children:[s&&(0,p.jsx)("span",{children:s}),n]}),(0,p.jsx)(y,{className:l,children:(0,p.jsx)(w,{$shouldWrap:r,className:o,children:t})})]})}let j=u.Z.div`dark bg-gray-950 rounded-md border-[0.5px] border-token-border-medium`,b=u.Z.div`flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md`,y=function(e){let{children:t,className:s}=e;return(0,p.jsx)("div",{className:(0,o.default)("overflow-y-auto p-4",s),dir:"ltr",children:t})},w=u.Z.code`${e=>e.$shouldWrap?"!whitespace-pre-wrap":"!whitespace-pre"}`},39358:function(e,t,s){s.d(t,{Z:function(){return h}});var n=s(98601),r=s(92379),a=s(47584),l=s(75325),o=s(15478),i=s(15174),c=s(30853),d=s(28146),u=s(651);function f(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,n)}return s}function m(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?f(Object(s),!0).forEach(function(t){(0,n.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let p=(0,a.vU)({copy:{id:"CopyButton.copy",defaultMessage:"Copy"},copied:{id:"CopyButton.copied",defaultMessage:"Copied!"}});function h(e){let{buttonText:t,shouldChangeText:s=!0,iconClassName:n="icon-sm",onCopy:a,className:o}=e,{0:f,1:h}=(0,r.useState)(!1),g=(0,i.Z)(),j=(0,r.useCallback)(e=>{e.stopPropagation(),a(),h(!0),setTimeout(()=>{g()&&h(!1)},2e3)},[g,a]),b=t;return s&&f?b=(0,u.jsx)(l.Z,m({},p.copied)):!0===t&&(b=(0,u.jsx)(l.Z,m({},p.copy))),(0,u.jsxs)(u.Fragment,{children:[!f&&(0,u.jsx)(c.u,{label:(0,u.jsx)(l.Z,{id:"CopyButton.copyTooltip",defaultMessage:"Copy"}),sideOffset:0,children:(0,u.jsxs)(x,{onClick:j,className:o,children:[(0,u.jsx)(d.TIy,{className:n}),b]})}),f&&(0,u.jsxs)(x,{className:o,children:[(0,u.jsx)(d.$As,{className:n}),b]})]})}let x=o.Z.button`flex gap-1 items-center`},7243:function(e,t,s){s.d(t,{HK:function(){return f},Lw:function(){return p},l$:function(){return u}});var n=s(98601);s(39696);var r=s(19841),a=s(88600),l=s(92379),o=s(15478),i=s(651);function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,n)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach(function(t){(0,n.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function u(e){let{lines:t=1,variance:s=0,size:n="base",width:o=50,widthVariance:c=50,className:d}=e,{0:u}=(0,l.useState)(Array.from({length:t+Math.random()*(s??0)},()=>o+Math.random()*c)),f="";switch(n){case"sm":f="h-3 mb-2 mt-0.5";break;case"base":f="h-4 my-2";break;case"lg":f="h-5 my-2"}return(0,i.jsx)(i.Fragment,{children:u.map((e,t)=>(0,i.jsx)("div",{className:(0,r.default)("relative w-full overflow-hidden rounded-md bg-token-sidebar-surface-secondary",f,d),style:{width:`${e}%`},children:(0,i.jsx)(a.E.div,{className:"absolute left-0 top-0 h-full w-full rotate-45 bg-gradient-to-r from-transparent via-black/20 to-transparent opacity-50 dark:via-white/5",animate:{x:["-100%","100%"],opacity:[1,0,1],transition:{repeat:1/0,repeatType:"loop",duration:1.5+t}}})},t))})}function f(e){let{lines:t=1,indexOffset:s=0,variance:n=0,width:a=50,widthVariance:o=50,gapFrequency:c=0,scaleUpAnimation:d,className:u}=e,f=(0,l.useMemo)(()=>Array.from({length:t+Math.random()*(n??0)},()=>a+Math.random()*o),[t,n,a,o]);return(0,i.jsx)(m,{className:u,children:f.map((e,t)=>(0,i.jsx)(p,{index:t+s,width:e,className:(0,r.default)(c>0&&(t+1)%c==0&&"mb-snc-1"),customAnimation:d?{initial:{scaleX:d.initialScaleX},animate:{scaleX:1},transition:{scaleX:{duration:d.duration,ease:"easeInOut",delay:.07*t}}}:void 0},t))})}let m=o.Z.div`flex flex-col items-start gap-2`;function p(e){let{index:t,width:s,className:n,customAnimation:l}=e,{initial:o,animate:c,transition:u}=l??{initial:{},animate:{},transition:{}};return(0,i.jsx)(a.E.div,{className:(0,r.default)("h-5 origin-left rounded-md bg-token-border-light dark:bg-white/10",n),style:{width:`${s}%`},initial:d({opacity:1},o),animate:d({opacity:[1,.4]},c),transition:d({opacity:{repeat:1/0,repeatType:"reverse",duration:.85,ease:"easeInOut",delay:.07*t}},u)})}},19042:function(e,t,s){s.r(t),s.d(t,{DebugJsonViewer:function(){return S},DebugModal:function(){return k},DebugModalContents:function(){return E}});var n=s(11550),r=s(39358),a=s(30115),l=s(28146),o=s(24434),i=s(67330),c=s(91111),d=s(97193),u=s(27313),f=s(5132),m=s(30757),p=s(79746),h=s(19841),x=s(38482),g=s.n(x),j=s(92379),b=s(15478),y=s(19229),w=s(651);let v=g()(()=>Promise.all([s.e(3904),s.e(6476)]).then(s.bind(s,16476)).then(e=>e.default),{ssr:!1,loadableGenerated:{webpack:()=>[16476]}});function k(e){let{threadId:t,threadUserId:s}=e;return(0,d.W6)(d.bM.isDebugModalOpen)&&(0,w.jsx)(o.Z,{isOpen:!0,onClose:()=>d.vm.toggleDebugModalOpen(),type:"success",size:"fullscreen",noPadding:!0,rootClassName:"z-50",children:(0,w.jsx)(E,{threadId:t,threadUserId:s,onClose:()=>d.vm.toggleDebugModalOpen()})})}let O=(e,t)=>{let s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=window.URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download=e,r.click(),window.URL.revokeObjectURL(n)},N="<|im_start|>",C="<|im_sep|>",M="<|im_end|>";function P(e){let{prompt:t}=e,s=[],n=0;for(;;){let e=t.indexOf(N,n);if(-1===e)break;let r=t.indexOf(C,e);if(-1===r)break;let a=t.indexOf(M,r),l=t.indexOf("<|fim_suffix|>",r);if(-1!==l&&(-1===a||l<a)&&(a=l),-1===a)break;let o=t.substring(e+N.length,r),i=t.substring(r+C.length,a);s.push((0,w.jsxs)("div",{children:[(0,w.jsxs)("span",{className:"font-semibold",children:["[",o,"]"]})," ",i]},e)),n=a+M.length}return s}let _=b.Z.div`mb-[-5px] px-2 pb-1 font-semibold uppercase border-b-2 ${e=>{let{$isSelected:t}=e;return t?"border-black dark:border-white":"border-transparent"}}`;function E(e){let{threadId:t,threadUserId:s,message:r,onClose:o}=e,{sessionUser:d}=(0,c.A)(),{0:p,1:x}=(0,j.useState)(r?"message":"json"),{data:g,isLoading:b,refetch:y}=(0,u.Y)({threadId:t,threadUserId:s,refetchOnMount:"always"}),v=g?.thread;if((0,j.useEffect)(()=>{x(r?"message":v?.turns.length?`turn${v?.turns.length-1}`:"thread")},[v?.turns.length,r]),!b&&!v&&!r)return(0,w.jsxs)(i.bW,{onClickRetry:()=>y(),children:["Failed to load."," "]});if(b)return(0,w.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:"Loading..."});let k=v?.turns,N=v?.turns[v.turns.length-1]?.artifacts__?.model_snapshots?.default_id,C=s&&t?(0,f.t5)(s,t):null;return(0,w.jsx)("div",{className:"flex flex-col gap-2 break-words font-mono text-xs",children:(0,w.jsxs)(m.fC,{orientation:"vertical",value:p,onValueChange:e=>x(e),children:[(0,w.jsxs)(m.aV,{className:"flex items-center justify-center gap-2 px-4 py-1",children:[r&&(0,w.jsx)(m.xz,{value:"message",children:(0,w.jsx)(_,{$isSelected:"message"===p,children:"Message"})},"message"),v&&(0,w.jsx)(m.xz,{value:"thread",children:(0,w.jsx)(_,{$isSelected:"thread"===p,children:"Thread"})},"thread"),k?.map((e,t)=>w.jsxs(j.Fragment,{children:[w.jsx(m.xz,{value:`turn${t}`,children:w.jsxs(_,{$isSelected:p===`turn${t}`,children:["Turn[",t,"]"]})},t),e.artifacts__?.debug_ddtrace_urls?.map(e=>w.jsx(_,{$isSelected:!1,children:w.jsxs("a",{target:"_blank",href:e,className:"text-nowrap",children:["Trace[",t,"] â†—"]})},e))]},t)),(0,w.jsx)("div",{className:"flex-grow"}),N&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Z,{name:"Model",id:N})," ",(0,w.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),d&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Z,{name:"User ID",id:d.id})," ",(0,w.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),C&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Z,{name:"Permalink",id:C}),(0,w.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),v&&(0,w.jsxs)(n.z,{size:"small",color:"secondary",onClick:()=>O("thread.json",v),children:[(0,w.jsx)(l._8t,{className:"icon-sm"})," thread.json"]}),(0,w.jsx)(a.P,{onClick:o})]}),k?.map((e,t)=>w.jsxs(m.VY,{value:`turn${t}`,className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth",children:[w.jsxs("div",{className:h.default("flex flex-col gap-1 p-6",e.index%2==0&&"bg-token-main-surface-tertiary"),children:[w.jsx(P,{prompt:e.artifacts__?.debug_info?.main_model_response?.prompt_string??""}),w.jsxs("div",{children:[w.jsx("span",{className:"font-semibold",children:"[assistant]"})," ",e.model_response?.text]})]})," "]},t)),v&&(0,w.jsx)(m.VY,{value:"thread",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-6",children:(0,w.jsx)(S,{data:v,collapsed:4})}),r&&(0,w.jsx)(m.VY,{value:"message",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-6",children:(0,w.jsx)(S,{data:r,collapsed:4})})]},v?.turns.length??"message")})}function S(e){let{data:t,collapsed:s}=e,{0:n,1:r}=(0,j.useState)(s??!0);return(0,w.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,w.jsx)("button",{onClick:()=>r(!n),className:"flex items-center gap-1",children:n?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(y.rIY,{size:14})," Expand all"]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(y.NsE,{size:14})," Collapse all"]})}),(0,w.jsx)("div",{className:"w-full",children:(0,w.jsx)(v,{json:t,jsonViewProps:{collapsed:n,shortenTextAfterLength:0}},String(n))})]})}function Z(e){let{name:t,id:s}=e,n=(0,j.useCallback)(()=>{(0,p.v)(s)},[s]);return(0,w.jsxs)("div",{className:"flex items-center gap-2 truncate",children:[(0,w.jsxs)("span",{className:"text-nowrap font-semibold",children:[t,":"]}),(0,w.jsx)("span",{title:s,className:"truncate text-gray-500 dark:text-white",children:s}),(0,w.jsx)(r.Z,{onCopy:n})]})}},27313:function(e,t,s){s.d(t,{Y:function(){return o},v:function(){return i}});var n=s(84760),r=s(92379),a=s(81014),l=s(12381);function o(e){let{threadId:t,threadUserId:s,refetchOnMount:r}=e;return(0,n.a)({queryKey:["thread",t,s],queryFn:async()=>{if(!t)return{thread:null,turns:null};let e=await (0,a.K8)({threadId:t,threadUserId:s}),n=e.turns;return{thread:e,turns:n}},enabled:!!t,refetchOnMount:r})}function i(e){let{threadId:t,threadUserId:s}=e,n=o({threadId:t,threadUserId:s}),a=n.data;return(0,r.useEffect)(()=>{t&&l.P3.setThread(t,a?.turns??[])},[t,a]),{query:n.data?.turns[0]?.user_query,refetch:n.refetch,isLoading:n.isLoading,isError:n.isError}}},51942:function(e,t,s){s.d(t,{F:function(){return p}});var n=s(16757),r=s(27742),a=s(74301),l=s(67437),o=s(92745),i=s(79857),c=s(38924),d=s(97834),u=s(52978),f=s(91530),m=s.n(f);function p(e){let t=(0,l.j8)(),s=(0,r.W)(e),f=(0,l.Bv)(e)??t.id,p=(0,a.Z)(e,void 0,m());return async function(t){let r=o.tQ.getThreadCurrentLeafId(e),a=`${r}-nextPrompt`;o.tQ.updateTree(e,e=>{e.addNode(a," ",r,n.uU.User)});let l=performance.now(),m=await (0,d.rS)(),[h,x,g]=await Promise.all([i.ZP.getEnforcementToken(m),u.Z.getEnforcementToken(m),c.Z.getEnforcementToken(m)]);p({model:f,completionType:n.Os.Next,parentNodeId:a,metadata:{eventSource:"mouse"},completionMetadata:{conversationMode:s},chatReq:m,arkoseToken:h??null,turnstileToken:x??null,proofToken:g??null,preflightTime:performance.now()-l,appendMessages:t})}}}}]);
//# sourceMappingURL=688.23906ce370bcfc11.js.map