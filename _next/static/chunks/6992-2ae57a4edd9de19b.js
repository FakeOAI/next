"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6992],{38417:function(t,e,n){var r=n(48538),a=n(5443),i=n(33481),o=n(651);e.Z=t=>{let{label:e,value:n,onCopied:l}=t,c=()=>{(0,r.v)(n),l()};return(0,o.jsxs)("div",{className:"flex flex-col space-y-2",children:[void 0!==e&&(0,o.jsx)("label",{className:"font-semibold",children:e}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("div",{onClick:c,className:"w-full cursor-pointer break-all rounded-lg bg-token-main-surface-tertiary px-4 py-2 font-mono text-sm text-token-text-primary",children:n}),(0,o.jsx)(a.z,{color:"ghost",onClick:c,icon:i.TIy})]})]})}},83252:function(t,e,n){n.d(e,{M:function(){return s},Z:function(){return c}});var r=n(55257),a=n(33481),i=n(82823),o=n(16645),l=n(651);function c(t){let{isFirstParty:e,src:n,alt:i,className:o}=t;return(0,l.jsx)("div",{className:o,children:null!=n?(0,l.jsx)("div",{className:"gizmo-shadow-stroke overflow-hidden rounded-full",children:(0,l.jsx)("img",{src:n,className:"h-full w-full bg-token-main-surface-secondary",alt:null!=i?i:"GPT",width:80,height:80})}):(0,l.jsx)("div",{className:"gizmo-shadow-stroke relative flex h-full items-center justify-center rounded-full bg-token-main-surface-primary text-token-text-primary",children:e?(0,l.jsx)(r.nI,{className:"h-2/3 w-2/3"}):(0,l.jsx)(a.uy2,{className:"h-2/3 w-2/3 text-gray-400"})})})}function s(t){var e,n;let{gizmoId:r,className:a}=t,{data:s}=(0,i.b9)(r);return(0,l.jsx)(c,{src:null==s?void 0:s.gizmo.display.profile_picture_url,isFirstParty:null!==(e=null==s||null===(n=s.gizmo.tags)||void 0===n?void 0:n.includes(o.U9.FirstParty))&&void 0!==e&&e,className:a})}},83650:function(t,e,n){n.d(e,{$L:function(){return u},Up:function(){return d},doConnectorOauthRedirect:function(){return f},sd:function(){return h},wP:function(){return p}});var r=n(94521),a=n(93223),i=n(92379),o=n(2630),l=n(99642);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach(function(e){(0,r.Z)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function u(t,e){let n=l.V;e.setQueriesData({queryKey:n},e=>{if(!e)return e;let n=e.items.findIndex(e=>e.id===t.id);if(-1===n)return e;let r=[...e.items];return r[n]=t,s(s({},e),{},{items:r})})}async function d(t,e){let n="".concat("https://chat.openai.com","/aip/").concat(t.id,"/oauth/callback"),r=await a.Z.pluginOauthRedirect(t.id,n,e);window.location.href=r.redirect_uri}async function f(t,e){let n="".concat(window.location.origin,"/ccc/").concat(t.id,"/oauth/callback"),r=await a.Z.connectorOauthRedirect(t.id,n,e);window.location.href=r.redirect_uri}async function p(t){await a.Z.deleteUserConnectedApp(t),window.location.reload()}function h(){let{0:t,1:e}=(0,i.useState)(!1);return{fetchManifestAndSpec:(0,i.useCallback)(async t=>{let{domain:n,manifestAccessToken:r,onSuccess:i,onError:l}=t,c=(0,o.NB)(n);try{if(e(!0),null!=c){let t=await (0,o.Zb)(c);if(void 0===t)return;let{plugin:e,manifest_validation_info:n,api_validation_info:r}=t;i({domain:c,scrapeManifestResponse:{plugin:e,manifest_validation_info:n},apiValidationInfo:r})}else{let t;let e=await a.Z.scrapePluginManifest({domain:n,manifestAccessToken:r});if(e.plugin)try{t=(await a.Z.getPluginApi({id:e.plugin.id})).api_validation_info}catch(t){}i({domain:n,scrapeManifestResponse:e,apiValidationInfo:t,manifestAccessToken:r})}}catch(t){l(null!=c?t:void 0)}finally{e(!1)}},[]),isLoading:t}}n(6774)},2630:function(t,e,n){n.d(e,{NB:function(){return y},Zb:function(){return m},cf:function(){return h},qZ:function(){return f},wR:function(){return d}});var r=n(94521),a=n(85734),i=n(93223),o=n(44529),l=n(8844),c=n(94982);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach(function(e){(0,r.Z)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function d(t){var e,n,r;let i=null!==(e=null===(n=t.metadata)||void 0===n||null===(n=n.invoked_plugin)||void 0===n?void 0:n.http_api_call_data)&&void 0!==e?e:null===(r=t.metadata)||void 0===r?void 0:r.http_api_call_data;if(void 0!==i){if(t.author.role!==a.uU.Assistant){o.U.addError("Refusing to make localhost plugin HTTP call from non-assistant message",t);return}if("object"!=typeof i||"string"!=typeof i.namespace||0===i.namespace.length||"string"!=typeof i.function_name||0===i.function_name.length||"string"!=typeof i.parent_message_id||0===i.parent_message_id.length||"string"!=typeof i.url||0===i.url.length||"string"!=typeof i.method||!["get","post","put","delete","patch"].includes(i.method)||!Array.isArray(i.qs_params)||i.qs_params.some(t=>!Array.isArray(t)||2!==t.length||"string"!=typeof t[0]||"string"!=typeof t[1])||"object"!=typeof i.headers||Object.keys(i.headers).some(t=>"string"!=typeof t)||Object.values(i.headers).some(t=>"string"!=typeof t)||!(null===i.body||"object"==typeof i.body&&Object.keys(i.body).every(t=>"string"==typeof t))||"string"!=typeof i.api_function_type||!["kwargs","chat"].includes(i.api_function_type)){o.U.addError("Refusing to make localhost plugin HTTP call with invalid metadata",t);return}if(!/^https?:\/\/localhost:/.test(i.url)){o.U.addError("Refusing to make localhost plugin HTTP call with non-localhost URL",t);return}return i}}async function f(t){try{return await p(t)}catch(t){return o.U.addError(Error("Error making localhost plugin HTTP call",{cause:t})),[{id:(0,l.Z)(),author:{role:a.uU.Tool,name:"plugin_service"},content:{content_type:a.PX.Text,parts:["Error making localhost plugin HTTP call: ".concat(t)]},recipient:"all"}]}}async function p(t){let e;function n(t){return Object.keys(t).map(t=>t.toLowerCase())}let r={"content-type":"application/json"};if(!function(t){let e=t.flat();return new Set(e).size===e.length}([n(t.headers),n(r)]))throw Error("Refusing to make localhost plugin HTTP call with duplicate header keys");let i=t.url;t.qs_params.length>0&&(i=i+"?"+new URLSearchParams(t.qs_params)),null!==t.body&&(e=JSON.stringify(t.body));let o=await fetch(i,{method:t.method,headers:u(u({},r),t.headers),body:e}),c=await o.text();if("chat"===t.api_function_type)return[JSON.parse(c)];if("kwargs"===t.api_function_type)return[{id:(0,l.Z)(),author:{role:a.uU.Tool,name:"".concat(t.namespace,".").concat(t.function_name)},content:{content_type:a.PX.Text,parts:[c]},recipient:"all"}];throw Error("Not implemented")}function h(t){return!!y(t.domain)}function y(t){return/^localhost:\d+$/.test(t)?"http://".concat(t):/^https?:\/\/localhost:\d+$/.test(t)?t:null}async function m(t){var e;let r,a,o;try{let e=await fetch(t+"/.well-known/ai-plugin.json");r=await e.json()}catch(t){c.m.danger("Failed to fetch localhost manifest. Check to ensure your localhost is running and your localhost server has CORS enabled.");return}let l=null===(e=r)||void 0===e||null===(e=e.api)||void 0===e?void 0:e.url;if(null==l){c.m.danger("Localhost manifest is missing OpenAPI spec URL.");return}let s=function(t){try{return new URL(t),"full url"}catch(e){if(t.startsWith("/"))return"pathname";return"neither"}}(l);if("pathname"===s)l=t+l;else if("neither"===s){c.m.danger("Localhost manifest OpenAPI spec URL is not a valid URL or path.");return}try{let t=await fetch(l);a=await t.text()}catch(t){c.m.danger("Failed to fetch localhost OpenAPI spec.");return}try{o=(await Promise.all([n.e(4984),n.e(1703)]).then(n.bind(n,1703))).parse(a)}catch(t){}try{o=JSON.parse(a)}catch(t){}if(null==o){c.m.danger("Failed to parse localhost OpenAPI spec as JSON or YAML.");return}try{return await i.Z.createOrUpdateLocalhostPlugin({localhost:t,manifest:r,openapiSpec:o})}catch(e){c.m.danger("Failed to create or update localhost plugin at ".concat(t))}}},99642:function(t,e,n){n.d(e,{V:function(){return r}}),n(21904),n(35966),n(93223),n(4702),n(44529);let r=["approvedAip"]},6774:function(t,e,n){n.d(e,{C:function(){return d},Z:function(){return u}});var r=n(21904),a=n(35966),i=n(93223),o=n(4702),l=n(14816),c=n(44529),s=n(92379);let u=["installedAip"];function d(){let t=(0,o.hz)(),e=(0,a.Nw)(r.ev.PLUGINS,t),{data:n,isLoading:d}=(0,l.a)({queryKey:u,queryFn:()=>i.Z.getPlugins({offset:0,limit:250,isInstalled:!0}).catch(t=>{throw c.U.addError(t),t}),enabled:e});return(0,s.useMemo)(()=>({installedPlugins:n?n.items:[],isLoading:d}),[n,d])}}}]);
//# sourceMappingURL=6992-2ae57a4edd9de19b.js.map