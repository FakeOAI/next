"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[991],{57098:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(84760),a=n(82363),i=n(651);function s(e){let{url:t,size:n=16,minSize:r,fallback:s,className:u}=e,d=function(e,t){if(!e)return null;try{let{origin:n}=new URL(e);return"https://www.google.com/s2/favicons?domain=".concat(n,"&sz=").concat(t)}catch(e){return a.U.addError(e),null}}(t,n);return null==d?null!=s?s:null:null!=r?(0,i.jsx)(l,{faviconUrl:d,size:n,minSize:r,fallback:s,className:u}):(0,i.jsx)(o,{faviconUrl:d,size:n,className:u})}function l(e){let{faviconUrl:t,size:n,minSize:a,fallback:s,className:l}=e,{data:u,isLoading:d}=(0,r.a)({queryKey:["imageSize",t],queryFn:()=>new Promise((e,n)=>{let r=new Image;r.onload=()=>{e(Math.min(r.width,r.height))},r.onerror=()=>{n()},r.src=t})});return d?(0,i.jsx)("div",{className:l}):null==u||u<a?null!=s?s:null:(0,i.jsx)(o,{faviconUrl:t,size:n,className:l})}function o(e){let{faviconUrl:t,size:n,className:r}=e;return(0,i.jsx)("img",{src:t,alt:"Favicon",width:n,height:n,className:r})}},22594:function(e,t,n){n.d(t,{D:function(){return v},Z:function(){return y}});var r,a=n(2346),i=n(21389),s=n(88600),l=n(89678),o=n.n(l),u=n(92379),d=n(75172),c=n(62984),p=n(15478),f=n(11550),h=n(6440),g=n(77748),m=n(24434),x=n(651);function y(e){let{tagOptions:t,onSubmit:n,onMoreClicked:r,onCancel:a,maxInlineTags:l=5,modalOnly:p=!1,modalTitle:y,multiple:b,children:w,allowEmptySubmit:_=!1}=e,M=(0,d.Z)(),{0:C,1:T}=(0,u.useState)(p?"modal":"inline"),{0:j,1:P}=(0,u.useState)([]),{0:k,1:O}=(0,u.useState)(void 0),N=(0,u.useCallback)(e=>{n(e),T("submitted"),setTimeout(()=>{T("closed")},1500)},[n]),E=(0,u.useMemo)(()=>o()(N,500),[N]),F=e=>{let t=[];return P(t=b?j.includes(e)?j.filter(t=>t!==e):[...j,e]:[e]),t},U=()=>{N({tags:j,textFeedback:k,tagChoices:L,source:"modal"})},L=t.map(e=>e.value),R=function(e){let t={};return e.forEach(e=>{var n;let r=null!==(n=e.group)&&void 0!==n?n:"Default";t[r]||(t[r]=[]),t[r].push(e)}),t}(t),D=Object.keys(R);return(0,x.jsxs)(x.Fragment,{children:[!p&&(0,x.jsx)(i.M,{children:"closed"!==C&&(0,x.jsxs)(s.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"min-h-[96px] w-full",children:["submitted"===C&&(0,x.jsx)(s.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"text-center",children:(0,x.jsx)("div",{className:"inline-flex rounded-lg border border-token-border-light p-4",children:(0,x.jsx)("div",{className:"text-sm",children:(0,x.jsx)(c.Z,{id:"ConversationTurnInlineMessageFeedback.submitted",defaultMessage:"Thanks for your feedback!"})})})}),["inline","modal"].includes(C)&&(0,x.jsxs)("div",{className:"relative mt-2 flex w-full flex-col gap-3 rounded-lg border border-token-border-light p-4",children:[(0,x.jsx)("button",{className:"absolute right-4 top-4 text-sm font-bold",onClick:()=>{T("closed"),E.cancel(),null==a||a()},children:(0,x.jsx)(g.tPq,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})}),(0,x.jsx)("div",{className:"text-sm text-token-text-secondary",children:(0,x.jsx)(c.Z,{id:"ConversationTurnInlineMessageFeedback.inlineTitle",defaultMessage:"Tell us more:"})}),(0,x.jsxs)("div",{className:"flex flex-wrap gap-3",children:[t.slice(0,l).map(e=>(0,x.jsx)(v,{$selected:j.includes(e.value),onClick:()=>{E({tags:F(e.value),tagChoices:L,source:"inline"})},children:e.label},e.value)),(0,x.jsx)(v,{onClick:()=>{null==r||r(),E.cancel(),T("modal")},children:(0,x.jsx)(c.Z,{id:"ConversationTurnInlineMessageFeedback.moreOptions.1",defaultMessage:"More..."})})]})]})]},"main")}),"modal"===C&&(0,x.jsxs)(m.Z,{type:"success",isOpen:!0,className:"max-w-xl",size:"custom",title:null!=y?y:(0,x.jsx)(c.Z,{id:"ConversationTurnInlineMessageFeedback.modalTitle",defaultMessage:"Provide additional feedback"}),onClose:()=>{P([]),T(p?"closed":"inline"),p&&(null==a||a())},showCloseButton:!0,primaryButton:(0,x.jsx)(f.z,{color:"primary",disabled:0===j.length&&!k&&!_,onClick:U,children:(0,x.jsx)(c.Z,{id:"ConversationTurnInlineMessageFeedback.submit",defaultMessage:"Submit"})}),rootClassName:"z-50",children:[(0,x.jsx)("div",{className:"flex flex-col gap-6",children:D.map(e=>(0,x.jsxs)("div",{children:[D.length>1&&(0,x.jsx)("div",{className:"mb-3 text-sm font-semibold",children:e}),(0,x.jsx)("div",{className:"flex flex-wrap gap-3",children:R[e].map(e=>(0,x.jsx)(v,{$selected:j.includes(e.value),onClick:()=>F(e.value),children:e.label},e.value))},e)]},e))}),(0,x.jsx)(h.Z,{name:"feedback",type:"text",className:"mt-6",placeholder:M.formatMessage({id:"ConversationTurnInlineMessageFeedback.feedbackPlaceholder.1",defaultMessage:"(Optional) Feel free to add specific details"}),value:null!=k?k:"",onChange:e=>O(e.target.value),onPressEnter:U}),w]})]})}let v=p.Z.button(r||(r=(0,a.Z)(["\n  rounded-lg border border-token-border-light px-3 py-1 text-sm text-token-text-secondary hover:text-token-text-primary hover:bg-token-main-surface-secondary\n  ","\n"])),e=>{let{$selected:t}=e;return t&&"!bg-token-text-primary !text-token-main-surface-primary"})},42606:function(e,t,n){n.d(t,{I:function(){return i},o:function(){return s}});let r=["xlsx","pptx","docx"],a={"application/vnd.google-apps.spreadsheet":"xlsx","application/vnd.google-apps.presentation":"pptx","application/vnd.google-apps.document":"docx"};function i(e){var t;return e&&null!==(t=a[e.split(";")[0]])&&void 0!==t?t:null}function s(e){return e&&r.includes(e)?e:null}},93866:function(e,t,n){n.d(t,{AJ:function(){return s},XX:function(){return o},xA:function(){return l}});var r,a,i=n(42606);let s=((r={})[r.None=0]="None",r[r.Multimodal=1]="Multimodal",r[r.Interpreter=2]="Interpreter",r[r.Retrieval=3]="Retrieval",r[r.ContextConnector=4]="ContextConnector",r[r.ProfilePicture=5]="ProfilePicture",r);function l(e){if(e)return{contextConnector:e.context_connector,sourceUrl:e.source_url,syntheticExtension:(0,i.o)(e.synthetic_extension),type:e.type}}let o=((a={}).Uploading="uploading",a.Ready="ready",a)},66114:function(e,t,n){n.d(t,{$H:function(){return m},$p:function(){return O},Ad:function(){return D},B:function(){return R},BV:function(){return F},CO:function(){return N},Iy:function(){return h},KL:function(){return P},L8:function(){return g},O6:function(){return v},Tu:function(){return U},VF:function(){return y},Vm:function(){return E},WI:function(){return L},YN:function(){return w},Z8:function(){return k},Zp:function(){return T},_0:function(){return C},kr:function(){return x},p0:function(){return j},s1:function(){return _},ww:function(){return b},xs:function(){return M}});var r=n(99333),a=n(16757),i=n(2721),s=n(86025),l=n(58695),o=n(82363),u=n(92379),d=n(75172),c=n(68306),p=n(24740),f=n(93866);function h(e){return e.replace("file-service://","")}function g(e){return"file-service://"+e}function m(e){return e.startsWith("file-service://")}function x(e,t,n){switch(t){case"file_zero_bytes":return e.formatMessage(A.fileZeroBytes,n);case"file_too_large":return e.formatMessage(A.fileTooLarge,n);case"over_user_quota":return e.formatMessage(A.overUserQuota,n);case"file_not_found":case"file_expired":return e.formatMessage(A.fileNotFound,n);case"file_timed_out":return e.formatMessage(A.fileTimedOut,n);case"ace_pod_expired":return e.formatMessage(A.codeInterpreterSessionTimeout,n);case"permission_error":return e.formatMessage(A.permissionError,n);case"default_upload_error":case"file_rejected":return e.formatMessage(A.defaultCreateEntryError,n);case"default_download_link_error":return e.formatMessage(A.defaultDownloadLinkError,n);case"file_empty":return e.formatMessage(A.fileEmpty,n);case"too_many_tokens":return e.formatMessage(A.fileTooManyTokens,n);case"file_encrypted":return e.formatMessage(A.fileEncrypted,n);case"file_corrupted":return e.formatMessage(A.fileCorrupted,n);case"failed_upload_to_blobstore":return e.formatMessage(A.failedUploadToBlobStore,n);default:return e.formatMessage(A.unknownError)}}function y(){let e=(0,d.Z)();return(0,u.useCallback)((t,n)=>x(e,t,n),[e])}function v(){let{session:e}=(0,l.kP)(),{isUnauthenticated:t}=(0,s.u)(),n=(0,d.Z)();return async(a,s)=>{if(!t&&null==e)return p.m.danger(n.formatMessage(A.fileDownloadFailed)),!1;try{let e=await i.Z.getFileDownloadLink(a,void 0,t);if(e.status!==r.KF.Success)throw Error("File is not ready to download: "+JSON.stringify(e));let n=e.download_url,l=document.createElement("a");l.href=n,l.download=s,l.click(),window.open(n,"_blank")}catch(e){return p.m.danger(n.formatMessage(A.fileDownloadFailed)),!1}return!0}}function b(e,t){if((null==t?void 0:t.kind)===a.OL.GizmoInteraction||(null==t?void 0:t.kind)===a.OL.GizmoTest){var n;return null===(n=t.gizmo)||void 0===n?void 0:n.product_features}return null==e?void 0:e.product_features}function w(e,t){var n,a,i,s;let l=b(e,t);return(null==l||null===(n=l.attachments)||void 0===n?void 0:n.type)===r.Cd.CodeInterpreter?f.AJ.Interpreter:(null==l||null===(a=l.attachments)||void 0===a?void 0:a.type)===r.Cd.Multimodal?f.AJ.Multimodal:(null==l||null===(i=l.attachments)||void 0===i?void 0:i.type)===r.Cd.Retrieval?f.AJ.Retrieval:(null==l||null===(s=l.attachments)||void 0===s?void 0:s.type)===r.Cd.ContextConnector?f.AJ.ContextConnector:f.AJ.None}function _(e){var t;let n=null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase();return({md:"text/markdown",java:"text/x-java",py:"text/x-script.python",c:"text/x-c",cpp:"text/x-c++",h:"text/x-c++",php:"text/x-php",rb:"text/x-ruby",tex:"application/x-latext",ts:"text/x-typescript",cs:"text/x-csharp"})[null!=n?n:""]||""}function M(e,t,n,r,a){if(null==a)return e;let i=_(t);i&&(n=i),r&&(n=function(e){switch(e){case"application/vnd.google-apps.spreadsheet":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"application/vnd.google-apps.document":case"application/vnd.google-apps.presentation":return"text/plain";default:return e}}(n));let{accepted_mime_types:s,can_accept_all_mime_types:l}=a;return null!=s&&0!==s.length&&l?s.includes(n)?e:f.AJ.Interpreter:e}function C(e,t,n){var a,i,s;let l=""!==t?t:_(n),o=null==e||null===(a=e.product_features)||void 0===a?void 0:a.attachments;return null==o?void 0:null!==(i=o.accepted_mime_types)&&void 0!==i&&i.includes(l)?o.type:null!==(s=o.image_mime_types)&&void 0!==s&&s.includes(l)?r.Cd.Multimodal:r.Cd.CodeInterpreter}function T(e,t){var n,r;let a=b(e,t);return null!=a&&null!==(n=a.attachments)&&void 0!==n&&n.can_accept_all_mime_types?void 0:null==a||null===(r=a.attachments)||void 0===r?void 0:r.accepted_mime_types}function j(e,t){let n=b(e,t),{attachments:r}=null!=n?n:{};if(null!=r&&r.image_mime_types)return r.image_mime_types;if((null==r?void 0:r.type)==="multimodal"){var a;return null!==(a=r.accepted_mime_types)&&void 0!==a?a:P}return[]}let P=["image/png","image/jpeg","image/gif","image/webp"];function k(e){return(0,u.useMemo)(()=>{if(void 0===e)return{};let t={"image/jpeg":[".jpg",".jpeg"],"image/svg+xml":[".svg"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"]};return{accept:e.reduce((e,n)=>(n in t?e[n]=t[n]:n.includes("/")&&(e[n]=[".".concat(n.split("/")[1])]),e),{})}},[e])}function O(e){var t;return null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase()}function N(e){let t=O(e);return null!=t&&["jpg","jpeg","png","gif","webp"].includes(t)}function E(e){let t=O(e);return null!=t&&["xls","xlsx","csv"].includes(t)}function F(e){let t=O(e);return null!=t&&["xls","xlsx"].includes(t)}function U(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fit";return new Promise((r,a)=>{let i=new FileReader;i.onerror=e=>{o.U.addError(Error("File reading has failed:",{cause:e})),a(Error("Failed to read the file."))},i.onload=i=>{let s=new Image;s.onerror=e=>{o.U.addError(Error("Image loading has failed:",{cause:e})),a(Error("Failed to load the image."))},s.onload=()=>{let i=document.createElement("canvas"),l,u=0,d=0;switch(n){case"fill":case"square":l=t/Math.min(s.width,s.height);break;case"fit":l=t/Math.max(s.width,s.height)}let c=s.width*l,p=s.height*l;"square"===n?(i.width=t,i.height=t,u=(t-c)/2,d=(t-p)/2):(i.width=c,i.height=p);let f=i.getContext("2d");if(null==f){o.U.addError("Canvas context creation failed. Your environment might not fully support HTML5 canvas."),a(Error("Failed to create canvas context."));return}f.drawImage(s,u,d,c,p);let h=e.type||"image/png";i.toBlob(t=>{t?r(new File([t],e.name,{type:h})):(o.U.addError("Blob creation failed. Blob is null."),a(Error("Failed to create blob from image data.")))},h)},null==i.target?(o.U.addError("Event target is null. Failed to load image."),a("Failed to load image.")):s.src=i.target.result},i.readAsDataURL(e)})}function L(e,t){return U(e,t,"square")}function R(e){var t,n;let r=null!==(t=e.name.split("/"))&&void 0!==t?t:[];return(null!==(n=r[r.length-1])&&void 0!==n?n:"").replace(/[-_]/g," ").split(".")[0]}function D(e,t){return t?e.slice(0,-t.length-1):e}let A=(0,c.vU)({defaultCreateEntryError:{id:"fileUpload.defaultCreateEntryError",defaultMessage:"Unable to upload {fileName}"},defaultDownloadLinkError:{id:"fileUpload.defaultDownloadLinkError",defaultMessage:"Failed to get upload status for {fileName}"},unknownError:{id:"fileUpload.unknownError",defaultMessage:"Unknown error occurred"},fileZeroBytes:{id:"fileUpload.fileZeroBytes",defaultMessage:"File is empty"},fileTooLarge:{id:"fileUpload.fileTooLarge",defaultMessage:"File is too large"},overUserQuota:{id:"fileUpload.overUserQuota",defaultMessage:"User quota exceeded"},fileNotFound:{id:"fileUpload.fileNotFound",defaultMessage:"File not found"},fileTimedOut:{id:"fileUpload.fileTimedOut",defaultMessage:"File upload timed out. Please try again."},fileEmpty:{id:"fileUpload.fileEmpty",defaultMessage:"No text could be extracted from this file."},fileTooManyTokens:{id:"fileUpload.fileTooManyTokens",defaultMessage:"This file contains too much text content. Please try again with a smaller file."},fileEncrypted:{id:"fileUpload.fileEncrypted",defaultMessage:"This file is encrypted/requires a password to access. Please try again with an unencrypted file."},fileCorrupted:{id:"fileUpload.fileCorrupted",defaultMessage:"This file is corrupted. Please ensure the file is not corrupted and try again."},codeInterpreterSessionTimeout:{id:"fileUpload.codeInterpreterSessionTimeout",defaultMessage:"Code interpreter session expired"},permissionError:{id:"fileUpload.permissionError",defaultMessage:"Missing permission to access file"},fileDownloadFailed:{id:"filesModal.fileDownloadFailed",defaultMessage:"File download failed. Please try again."},failedUploadToBlobStore:{id:"fileUpload.failedUploadToBlobStore",defaultMessage:"Failed upload to files.oaiusercontent.com. Please ensure your network settings allow access to this site or contact your network administrator."}})},47313:function(e,t,n){n.d(t,{G:function(){return r}});let r=(0,n(92379).createContext)(void 0)},65994:function(e,t,n){n.d(t,{b:function(){return r}});let r="contentReference"},76482:function(e,t,n){n.d(t,{lx:function(){return s}});var r=n(38482),a=n.n(r);let i=a()(()=>Promise.all([n.e(6835),n.e(6617),n.e(893),n.e(6731),n.e(1981),n.e(4169),n.e(9027),n.e(9373),n.e(3347)]).then(n.bind(n,31343)).then(e=>e.FormattedText),{loadableGenerated:{webpack:()=>[31343]}});t.ZP=i;let s=a()(()=>Promise.all([n.e(6835),n.e(6617),n.e(893),n.e(6731),n.e(1981),n.e(4169),n.e(9027),n.e(9373),n.e(3347)]).then(n.bind(n,31343)).then(e=>e.UserFormattedText),{loadableGenerated:{webpack:()=>[31343]}})},44885:function(e,t,n){n.d(t,{R3:function(){return d},Zl:function(){return f},fL:function(){return c}});var r=n(98601),a=n(23763),i=n.n(a),s=n(56290);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}class o{constructor(e,t){(0,r.Z)(this,"requestUpdateRaf",null),(0,r.Z)(this,"_requestUpdate",()=>{this.requestUpdateRaf||(this.requestUpdateRaf=window.requestAnimationFrame(()=>{this._update(),this.requestUpdateRaf=null}))}),this.updateReactComponentDisplay=t}destroy(){this.requestUpdateRaf&&(window.cancelAnimationFrame(this.requestUpdateRaf),this.requestUpdateRaf=null)}}class u extends o{constructor(e,t){super(e,t),(0,r.Z)(this,"_update",()=>{this.updateReactComponentDisplay((0,s.$w)(this.textMessageParts,this.displayedTextLength))}),this.updateReactComponentDisplay=t,this.textMessageParts=e,this.textMessagePartsTextLength=(0,s.Vh)(this.textMessageParts).length,this.displayedTextLength=this.textMessagePartsTextLength,this.displayNextCharDelayMs=u.MAX_BUFFERING_MS_PER_CHAR}displayNextChar(){this.displayNextCharTimeout=void 0,this.isBuffering()&&(this.displayedTextLength++,this._requestUpdate(),this.displayNextCharTimeout=window.setTimeout(()=>this.displayNextChar(),this.displayNextCharDelayMs))}isBuffering(){return this.displayedTextLength<this.textMessagePartsTextLength}onMessagePartsUpdated(e){this.textMessageParts=e,this.textMessagePartsTextLength=(0,s.Vh)(this.textMessageParts).length;let t=this.textMessagePartsTextLength-this.displayedTextLength;if(t>0){let e=u.MAX_BUFFERING_LAG_MS/t;this.displayNextCharDelayMs=Math.min(e,u.MAX_BUFFERING_MS_PER_CHAR)}null==this.displayNextCharTimeout&&this.displayNextChar()}destroy(){super.destroy(),window.clearTimeout(this.displayNextCharTimeout)}}(0,r.Z)(u,"MAX_BUFFERING_LAG_MS",500),(0,r.Z)(u,"MAX_BUFFERING_MS_PER_CHAR",30);class d extends o{constructor(e,t){super(e,t),(0,r.Z)(this,"_update",()=>{this.updateReactComponentDisplay((0,s.$w)(this.textMessageParts,this.displayedTextLength))}),this.updateReactComponentDisplay=t,this.textMessageParts=e,this.textMessagePartsTextLength=(0,s.Vh)(this.textMessageParts).length,this.displayedTextLength=this.textMessagePartsTextLength,this.chunkLength=0}displayNextChunk(){this.displayNextChunkTimeout=void 0,this.isBuffering()&&(this.displayedTextLength=Math.min(this.displayedTextLength+this.chunkLength,this.textMessagePartsTextLength),this._requestUpdate(),this.displayNextChunkTimeout=window.setTimeout(()=>this.displayNextChunk(),d.UPDATE_FREQUENCY_MS))}isBuffering(){return this.displayedTextLength<this.textMessagePartsTextLength}onMessagePartsUpdated(e){this.textMessageParts=e,this.textMessagePartsTextLength=(0,s.Vh)(this.textMessageParts).length;let t=this.textMessagePartsTextLength-this.displayedTextLength;t>=d.MIN_CHARS_BEHIND_TO_CATCHUP?(this.chunkLength=Math.ceil(t*d.UPDATE_FREQUENCY_MS/d.CATCHUP_TIME_MS),null==this.displayNextChunkTimeout&&this.displayNextChunk()):(this.displayNextChunkTimeout=void 0,window.clearTimeout(this.displayNextChunkTimeout),this.displayedTextLength=this.textMessagePartsTextLength,this.updateReactComponentDisplay((0,s.$w)(this.textMessageParts,this.displayedTextLength)))}destroy(){super.destroy(),window.clearTimeout(this.displayNextChunkTimeout)}}(0,r.Z)(d,"MIN_CHARS_BEHIND_TO_CATCHUP",20),(0,r.Z)(d,"CATCHUP_TIME_MS",300),(0,r.Z)(d,"UPDATE_FREQUENCY_MS",30);class c extends o{constructor(e,t,n){var a;super(e,t),(0,r.Z)(this,"LAG_FACTORS",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({".":15,"!":15,"?":15,"\n":15,",":8,":":8,";":8,DEFAULT_LAG_FACTOR:.9,BUFFER_FACTOR:.08},window.__PUNCTUATION_BUFFER_LAG_FACTORS)),(0,r.Z)(this,"_update",()=>{let e=(0,s.$w)(this.textMessageParts,this.displayedTextLength);this.updateReactComponentDisplay(e)}),(0,r.Z)(this,"_throttledDebugLog",i()(e=>{this.debug&&console.debug(e)},500,{leading:!0,trailing:!0})),this.updateReactComponentDisplay=t,this.textMessageParts=e,this.textMessagePartsTextLength=(0,s.Vh)(this.textMessageParts).length,this.displayedTextLength=this.textMessagePartsTextLength,this.concatenatedText=(0,s.Vh)(this.textMessageParts),this.isActivelyStreaming=!1,this.debug=null!==(a=null==n?void 0:n.debug)&&void 0!==a&&a,this.streamStartMs=0,this.averageMsPerChar=0,this.debug&&console.debug(["PunctuationBuffer:","[lagFactors: ".concat(JSON.stringify(this.LAG_FACTORS,null,2),"]")].join("\n"))}displayNextChar(){this.displayNextCharTimeout=void 0,this.isBuffering()&&(this.displayedTextLength++,this._requestUpdate(),this.displayNextCharTimeout=window.setTimeout(()=>this.displayNextChar(),this._getNextCharDelayMs()))}isBuffering(){return this.displayedTextLength<this.textMessagePartsTextLength}onMessagePartsUpdated(e,t){this.textMessageParts=e,this.isActivelyStreaming=t;let n=(0,s.Vh)(this.textMessageParts);this.concatenatedText=n,this.textMessagePartsTextLength=n.length,0===this.streamStartMs?this.streamStartMs=Date.now():this.averageMsPerChar=(Date.now()-this.streamStartMs)/this.textMessagePartsTextLength,this.displayNextCharTimeout||this.displayNextChar()}destroy(){super.destroy(),window.clearTimeout(this.displayNextCharTimeout)}_getNextCharDelayMs(){var e;let t=this.concatenatedText[this.displayedTextLength-1],n=this.textMessagePartsTextLength-this.displayedTextLength,r=1/Math.max(n*this.LAG_FACTORS.BUFFER_FACTOR,1),a=(null!==(e=this.LAG_FACTORS[t])&&void 0!==e?e:this.LAG_FACTORS.DEFAULT_LAG_FACTOR)*r,i=this.averageMsPerChar*a;return this._throttledDebugLog(["PunctuationBuffer:","[lagMs: ".concat(i,"]"),'[lastChar: "'.concat(t,'"]'),"[averageMsPerChar: ".concat(this.averageMsPerChar,"]"),"[lagFactor: ".concat(a,"]"),"[bufferLagFactor: ".concat(r,"]"),"[numBufferedChars: ".concat(n,"]"),"==="].join("\n")),i}}function p(e){return"text"===e.type}class f{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";(0,r.Z)(this,"updateReactComponentDisplay",e=>{let t=e.filter(p).map(e=>e.text).join("");this.onFlush(t)}),this.buffer=new e([n],this.updateReactComponentDisplay),this.onFlush=t,this.text=n}appendText(e){this.text+=e,this.buffer.onMessagePartsUpdated([this.text],!0)}setText(e){this.text=e,this.buffer.onMessagePartsUpdated([this.text],!0)}isBuffering(){return this.buffer.isBuffering()}}},41871:function(e,t,n){n.d(t,{O1:function(){return w},XX:function(){return h},Xt:function(){return m},cm:function(){return f},i$:function(){return v},xB:function(){return g}});var r=n(16757),a=n(66114),i=n(76482),s=n(82363),l=n(19841),o=n(99661),u=n(92379),d=n(75172),c=n(59122),p=n(651);let f=(0,u.createContext)({isWithinDataAnalysisToolMessage:!1});function h(e){let{message:t}=e,{resolvedTheme:n}=(0,o.F)();return(0,p.jsx)(f.Provider,{value:{isWithinDataAnalysisToolMessage:!0},children:(0,p.jsx)(i.ZP,{className:(0,l.default)("markdown prose w-full break-words dark:prose-invert","dark"===n?"dark":"light"),children:g(t)})})}function g(e){function t(e,t){return"```".concat(t,"\n").concat(e,"\n```")}if("code"===e.content.content_type)return t(e.content.text,"python");if("python"===e.recipient){if("text"!==e.content.content_type)throw Error("Unexpected content type for code message");let n=e.content.parts;if(1!==n.length||"string"!=typeof n[0])throw Error("Unexpected parts for code message");return t(n[0],"python")}throw Error("Unexpected code message format")}function m(e){var t;let{message:n}=e,a=(0,d.Z)();if(n.content.content_type!==r.PX.ExecutionOutput)return null;let i=null===(t=n.metadata)||void 0===t?void 0:t.aggregate_result;if(!i)return s.U.addError("Corrupt code execution result message"),null;let l=i.messages.filter(b),o=l.length>0,u=null!=i.final_expression_output,c=null!=i.in_kernel_exception;return(0,p.jsxs)(p.Fragment,{children:[o&&(0,p.jsx)(x,{label:"STDOUT/STDERR",output:l.map((e,t)=>(0,p.jsx)("span",{className:"stderr"===e.stream_name?"text-red-500":"",children:e.text},"".concat(t)))}),u&&(0,p.jsx)(x,{label:a.formatMessage({id:"codeInterpreterMessage.resultLabel",defaultMessage:"Result"}),output:i.final_expression_output}),c&&(0,p.jsx)(y,{traceback:i.in_kernel_exception.traceback.join("")})]})}function x(e){let{label:t,output:n}=e;return(0,p.jsxs)("div",{className:"bg-gray-700 p-4 text-xs",children:[(0,p.jsx)("div",{className:"mb-1 text-gray-400",children:t}),(0,p.jsx)("div",{className:"prose flex flex-col-reverse text-white",children:(0,p.jsx)("pre",{className:"shrink-0",children:n})})]})}function y(e){let{traceback:t}=e;return(0,p.jsx)("div",{className:"overflow-auto border-t border-gray-500 text-white",children:(0,p.jsx)("div",{className:"border-l-4 border-red-500 p-2 text-xs",children:(0,p.jsx)("div",{className:"scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-700 flex max-h-64 flex-col-reverse",children:(0,p.jsx)("pre",{className:"shrink-0",children:t})})})})}function v(e){var t;let{message:n}=e;if(n.content.content_type!==r.PX.ExecutionOutput)return null;let a=null===(t=n.metadata)||void 0===t?void 0:t.aggregate_result;return a?(0,p.jsx)(p.Fragment,{children:a.messages.filter(w).map((e,t)=>(0,p.jsx)(c.Z,{jupyterMessage:e},t))}):(s.U.addError("Corrupt code execution result message"),null)}function b(e){return"stream"===e.message_type}function w(e){return"image"===e.message_type||"image_url"in e&&(0,a.$H)(e.image_url+"")}},59122:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(98601),a=n(99333),i=n(77748),s=n(66114),l=n(2721),o=n(92745),u=n(84760),d=n(92379),c=n(75172),p=n(62984),f=n(68306),h=n(651);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){let{jupyterMessage:t}=e,n=(0,o.h9)(),a=(0,c.Z)();if(n)return(0,h.jsxs)("div",{className:"my-1 flex h-52 w-full max-w-xs flex-col items-center justify-center gap-2 rounded-md border-black/5 bg-gray-100 p-7 text-center text-token-text-tertiary dark:border-white/10",children:[(0,h.jsx)(i.zS0,{className:"icon-lg"}),(0,h.jsx)(p.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},v.imageNotSupported))]});if(null!=t.image_payload)return(0,h.jsx)("img",{className:"my-1",src:"data:image/png;base64,".concat(t.image_payload),alt:a.formatMessage(v.altText)});if(null!=t.image_url){let e=(0,s.Iy)(t.image_url);return(0,h.jsx)(y,{fileId:e})}return null}let x=Math.log(151)/Math.log(1.5);function y(e){let{fileId:t}=e,n=(0,c.Z)(),{data:r,isLoading:i,refetch:s}=(0,u.a)({queryKey:["getFileDownloadLink",t],queryFn:()=>l.Z.getFileDownloadLink(t),refetchInterval:e=>{var t;let n=e.state.dataUpdateCount;return(null===(t=e.state.data)||void 0===t?void 0:t.status)!==a.KF.Success&&!(n>x)&&e.state.status!==a.KF.Error&&100*Math.pow(1.5,n)}});return((0,d.useEffect)(()=>{if((null==r?void 0:r.status)===a.KF.Success){let e=new URL(r.download_url,location.toString()).searchParams.get("se");null!=e&&!i&&new Date>new Date(e)&&s()}},[r,i,s]),(null==r?void 0:r.status)!==a.KF.Success)?null:(0,h.jsx)("img",{src:r.download_url,className:"my-1 max-h-full max-w-full",alt:n.formatMessage(v.altText)})}let v=(0,f.vU)({imageNotSupported:{id:"CodeExecutionOutputImage.imageNotSupported",defaultMessage:"Image output is not supported in a shared chat"},altText:{id:"CodeExecutionOutputImage.altText",defaultMessage:"Output image"}})},40833:function(e,t,n){n.d(t,{v:function(){return f}});var r=n(98601),a=n(10449),i=n(19841),s=n(92379),l=n(62984),o=n(68306),u=n(77748),d=n(651);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function f(e){let{align:t,arrowPadding:n,alignOffset:r,show:o,onDismiss:c,children:f,title:g,side:m,sideOffset:x,theme:y="default",badge:v="new",description:b,dismissOnOutsideClick:w=!1}=e,_=(0,s.useRef)(null);return(0,d.jsxs)(a.fC,{open:o,onOpenChange:e=>{e||c()},children:[(0,d.jsx)(a.xz,{asChild:!0,onClick:()=>{c()},ref:_,children:f}),(0,d.jsx)(a.h_,{children:(0,d.jsxs)(a.VY,{arrowPadding:n,alignOffset:r,align:t,side:m,sideOffset:x,onOpenAutoFocus:e=>{e.preventDefault()},onCloseAutoFocus:e=>{e.preventDefault()},onInteractOutside:e=>{var t;e.target instanceof Element&&(null===(t=_.current)||void 0===t?void 0:t.contains(e.target))?e.preventDefault():w?c():e.preventDefault()},updatePositionStrategy:"always",className:(0,i.default)("relative z-10 animate-slideLeftAndFade select-none rounded-xl p-4 text-sm shadow-sm","default"===y?"bg-gray-900 text-white dark:bg-gray-50 dark:text-gray-700":"bg-blue-400 text-white"),children:[(0,d.jsxs)("div",{className:"flex max-w-xs flex-col gap-1",children:[(0,d.jsxs)("div",{className:"mb-0.5 flex gap-2",children:["new"===v?(0,d.jsx)("span",{className:(0,i.default)("rounded px-1.5 py-0.5 text-[10px] font-semibold uppercase leading-normal","default"===y?"bg-green-500 text-white":"bg-white text-blue-selection"),children:(0,d.jsx)(l.Z,p({},h.new))}):"beta"===v&&(0,d.jsx)("span",{className:"rounded-full bg-blue-100 px-1.5 text-[10px] font-semibold text-blue-600",children:(0,d.jsx)(l.Z,p({},h.beta))}),(0,d.jsx)("div",{className:"grow font-semibold",children:g}),(0,d.jsx)(a.x8,{className:"-my-1 -mr-1 p-1 opacity-70 transition hover:opacity-100",children:(0,d.jsx)(u.tPq,{className:"icon-sm"})})]}),void 0!==b&&(0,d.jsx)("div",{className:"",children:b})]}),(0,d.jsx)(a.Eh,{asChild:!0,children:(0,d.jsx)("div",{className:(0,i.default)("relative top-[-6px] h-3 w-3 rotate-45 transform rounded-br-sm","default"===y?"bg-gray-900 dark:bg-gray-50":"bg-blue-400")})})]})})]})}let h=(0,o.vU)({new:{id:"announcementTooltip.new",defaultMessage:"New"},beta:{id:"announcementTooltip.beta",defaultMessage:"Beta"}})},31353:function(e,t,n){n.d(t,{AW:function(){return h},Cp:function(){return c}});var r=n(98601),a=n(65994),i=n(22433),s=n(85302),l=n(18939),o=n.n(l);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0,u=0,c=!1,p=!1,g=[...n].sort((e,t)=>e.start_idx-t.start_idx||e.end_idx-t.end_idx).reduce((t,n)=>{let r,i;if(n.end_idx>e.length)return t;switch(n.type){default:case"invalid":case"hidden":r=d(d({},n),{},{type:"hidden",invalid:"invalid"===n.type});break;case"image_v2":case"nav_list":case"tldr":case"optimistic_image_citation":i="block",r=d({},n);break;case"file":case"title_citation":case"location_search":case"time":i="inline",r=d({},n);break;case"webpage":case"webpage_extended":i="inline",r=l?{type:"grouped_webpages",items:[d(d({},n),{},{type:"webpage"})]}:d(d({},n),{},{type:"webpage"});break;case"calculator":case"stock":case"forecast":i="block",c=!0,p="stock"===n.type,r=d({},n);break;case"optimistic_image_inline":i="block",r="done"===n.status?d(d({},n),{},{type:"optimistic_image_citation"}):d(d({},n),{},{images:null!=n.image?[n.image]:[],type:"image_v2"})}return t.push({originalContentReference:n,newContentReference:r,index:u++,displayType:i}),a&&t.push({originalContentReference:n,newContentReference:d({type:"debug",matched_text:n.matched_text.replace(/(^【|】$)/g,"")},"webpage_extended"===n.type&&n.pub_date&&{pub_date:new Date(1e3*n.pub_date).toLocaleString()}),index:u++}),t},[]);l&&function(e){let t=new Map;e.forEach((n,r)=>{let{originalContentReference:a,newContentReference:i,index:s}=n;if("grouped_webpages"!==i.type)return;i.items=i.items.map(e=>{var n;return t.has(e.url)||t.set(e.url,{index:null!=s?s:r}),d(d({},e),{},{index:null===(n=t.get(e.url))||void 0===n?void 0:n.index})});let l=e[r+1];if(null==l)return;let{newContentReference:o,originalContentReference:u}=l;"grouped_webpages"===o.type&&a.end_idx+1>=u.start_idx&&(o.items=[...i.items.map(e=>d(d({},e),{},{index:null!=s?s:void 0})),...o.items],n.displayType=void 0)})}(g);let m=o()(g.filter(e=>{let{index:t,displayType:n}=e;return null!=t&&n}).map(e=>{let{newContentReference:t}=e;return t})),x=function(e,t){let n="",r=0,a=(0,s.J)(t),i=new Set(["forecast"]),l=-1,o=0;for(let t of e){let{originalContentReference:e,displayType:s}=t;i.has(e.type)&&(l=o);let{start_idx:u,end_idx:d}=e;if(n+=a.slice(r,u).join(""),r=d,s){if("block"===s)n+=f(o,"leaf","newline","newline");else{let e=0!==n.length&&n[n.length-1].match(/\s/)?void 0:"zero-width-space";n+=f(o,"inline",e)}o++}}return n+=a.slice(r).join(""),l>-1&&(n=f(l,"leaf")),n}(g,e);return x=h(x),t=m,m=c?t.map(e=>"tldr"===e.type?d(d({},e),{},{url:""}):e):t,p&&(m=function(e,t){let n=(null!=t?t:[]).find(e=>"tldr"===e.type);return null!=n&&n.url?e.map(e=>{if("stock"===e.type){var t,r;return d(d({},e),{},{url:null!==(t=null!==(r=e.url)&&void 0!==r?r:n.url)&&void 0!==t?t:""})}return e}):e}(m,n)),r&&({updatedText:x,updatedReferences:m}=function(e,t,n){let r=e.find(e=>(0,i.rH)(e)===i.Cs.CodeInterpreter),a=e.find(e=>(0,i.rH)(e)===i.Cs.CodeInterpreterTool);if(null!=r&&null!=a){let e=t.length;n.endsWith("```")&&(n+="\n"),n+=" "+f(e,"inline","zero-width-space","zero-width-space"),t.push({type:"code_execution",codeMessage:r,codeExecutionOutputMessage:a})}return{updatedText:n,updatedReferences:t}}(r,m,x)),{processedText:x,displayedContentReferences:m}}let p="&#8203;";function f(e,t,n,r){let i="".concat(a.b,"[oaicite:").concat(e,"]{index=").concat(e,"}"),s="zero-width-space"===n?p:"newline"===n?"\n":"";return"".concat(s).concat("leaf"===t?"::":":").concat(i).concat("zero-width-space"===r?p:"newline"===n?"\n":"")}function h(e){let t=e,n=(t=t.replace(/【[^】]*$/g,"")).match(/(\n|^):::/g);return n&&n.length%2==1&&(t+="\n:::"),t=t.replace(/^\d+$/,"")}},39696:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(92379);function a(e,t){let n=(0,r.useRef)(e);(0,r.useEffect)(()=>{n.current=e},[e]),(0,r.useEffect)(()=>{if(null!=t){let e=window.setInterval(function(){n.current()},t);return()=>clearInterval(e)}},[t])}},15174:function(e,t,n){var r=n(92379);t.Z=function(){let e=(0,r.useRef)(!1);return(0,r.useEffect)(()=>(e.current=!0,()=>{e.current=!1}),[]),(0,r.useCallback)(()=>e.current,[])}}}]);
//# sourceMappingURL=991-a3e9d694c5d4366d.js.map