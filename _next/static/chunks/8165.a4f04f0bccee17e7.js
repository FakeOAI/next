"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8165],{8165:function(e,a,t){t.r(a),t.d(a,{default:function(){return es}});var i,l,n,s,r=t(41141),o=t(94521),d=t(19841),u=t(26123),c=t(25940),g=t(74091),m=t(85734),f=t(5443),h=t(81412),x=t(98506),p=t(79931);t(59031);var v=t(7290),b=t(556),j=t(92379),y=t(44230),w=t(651),I=((i=I||{})[i.Left=-1]="Left",i[i.Right=1]="Right",i[i.None=0]="None",i);let M={enter:e=>({zIndex:0,x:e===I.Left?"10%":"-10%",opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:e=>({zIndex:0,x:e===I.Right?"10%":"-10%",opacity:0})},k={enter:{opacity:0,y:"10%"},visible:{opacity:1,y:0},exit:{opacity:0,y:"10%"}},E=(e,a)=>Math.abs(e)*a;function N(e){var a;let t=(0,u.Z)(),i=(0,x.dQ)(),l=[x._G.Small,x._G.Mobile].includes(i),{0:n,1:s}=(0,j.useState)({width:0,height:0}),{0:r,1:o}=(0,j.useState)(!1),{0:c,1:g}=(0,j.useState)(e.image),{0:m,1:N}=(0,j.useState)(!1),C=n.width>0&&n.height>0,S=(0,j.useRef)(null),{0:O,1:L}=(0,j.useState)(I.None);function A(){g(a=>{let t=(e.images.findIndex(e=>e.url===a.url)+1)%e.images.length;return e.images[t]}),L(I.Left)}function R(){g(a=>{let t=e.images.findIndex(e=>e.url===a.url),i=t>0?(t-1)%e.images.length:e.images.length-1;return e.images[i]}),L(I.Right)}function V(e){"ArrowLeft"===e.key?R():"ArrowRight"===e.key&&A()}(0,j.useEffect)(()=>{if(!c.url)throw Error("ExpandableImage requires a src");let e=new Image;e.onload=()=>{s({width:e.naturalWidth,height:e.naturalHeight})},e.onerror=()=>{},e.src=c.url},[c.url]),(0,j.useEffect)(()=>{let a=S.current;if(m)return null==a||a.addEventListener("keydown",V),()=>{null==a||a.removeEventListener("keydown",V)};g(e.image)},[m]);let z=e.images.findIndex(e=>e.url===c.url);return(0,w.jsxs)(p.fC,{onOpenChange:function(a){var t;N(a),a&&(null===(t=e.onOpen)||void 0===t||t.call(e,c))},children:[(0,w.jsx)(p.xz,{disabled:!C,className:e.className,"aria-label":t.formatMessage(_.showImage),children:e.children}),(0,w.jsx)(p.h_,{children:(0,w.jsx)(p.aV,{className:"fixed inset-0 flex items-center justify-center bg-black/90 backdrop-blur-xl radix-state-open:animate-show",children:(0,w.jsxs)(p.VY,{className:(0,d.default)("relative flex h-[100dvh] w-screen justify-stretch divide-x divide-white/10 focus:outline-none radix-state-open:animate-contentShow"),ref:S,children:[(0,w.jsx)("div",{className:(0,d.default)("flex flex-1 transition-[flex-basis]",!r&&"md:basis-[75vw]"),children:(0,w.jsxs)("div",{className:"flex flex-1 flex-col md:p-6",children:[(0,w.jsxs)("div",{className:"flex justify-between px-6 py-2 pt-6 text-white sm:mb-4 md:mt-2 md:px-0 md:py-2",children:[(0,w.jsx)(p.x8,{asChild:!0,children:(0,w.jsx)("button",{"aria-label":t.formatMessage(_.closeModal),children:(0,w.jsx)(h.v7,{})})}),(0,w.jsx)("div",{children:!l&&(0,w.jsxs)(w.Fragment,{children:[null===(a=e.getActions)||void 0===a||null===(a=a.call(e,c))||void 0===a?void 0:a.map((e,a)=>(0,w.jsx)(f.z,{color:"ghost",size:"small",onClick:e.onClick,"aria-label":e.ariaLabel,disabled:e.disabled,icon:e.icon},a)),(0,w.jsx)(f.z,{color:"ghost",size:"small",onClick:()=>o(e=>!e),"aria-label":t.formatMessage(_.toggleSidebar),className:"md:inline-flex",icon:y.szr})]})})]}),(0,w.jsx)("div",{className:"relative flex flex-1 flex-col items-center justify-center overflow-hidden",children:(0,w.jsx)(v.M,{initial:!1,custom:O,children:(0,w.jsxs)(b.E.div,{className:"absolute grid h-full w-full grid-rows-2",custom:O,variants:M,drag:"x",dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(e,a)=>{let{offset:t,velocity:i}=a,l=E(t.x,i.x);l<-1e3?A():l>1e3&&R()},children:[(0,w.jsx)(b.E.img,{src:c.url,alt:c.alt,className:"row-span-4 mx-auto h-full object-scale-down",onPanEnd:(e,a)=>{let{offset:t,velocity:i}=a,l=E(t.y,i.y);l<-1e3?o(!0):l>1e3&&o(!1)}},c.url),l&&r&&(0,w.jsx)(b.E.div,{className:"flex text-white",variants:k,initial:"enter",animate:"visible",exit:"exit",transition:{y:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2}},children:e.metadataRenderer(c)})]},c.url)})}),e.images.length>1?(0,w.jsxs)("div",{className:"flex items-center justify-center gap-4 p-8 text-white",children:[(0,w.jsx)(f.z,{color:"ghost",size:"small",onClick:R,"aria-label":t.formatMessage(_.previousImage),icon:y.Y4O}),e.images.map((e,a)=>{var i;return(0,w.jsx)("img",{src:e.url,alt:null!==(i=e.alt)&&void 0!==i?i:"",className:(0,d.default)("h-12 w-12 cursor-pointer rounded object-cover transition duration-300 hover:opacity-100",e.url===c.url?"ring-2 ring-white ring-offset-4 ring-offset-black":"opacity-25"),onClick:()=>{g(e),L(a<z?I.Right:I.Left)},"aria-label":t.formatMessage(_.showImage),role:"button"},e.url)}),(0,w.jsx)(f.z,{color:"ghost",size:"small",onClick:A,"aria-label":t.formatMessage(_.nextImage),icon:y.LZ3})]}):null]})}),(0,w.jsx)("div",{className:(0,d.default)("hidden items-center justify-start overflow-hidden bg-gray-900 text-white transition-[flex-basis] duration-500 md:flex",r?"md:basis-[25vw]":"md:basis-0"),children:(0,w.jsx)("div",{className:"w-[25vw] min-w-[25vw]",children:e.metadataRenderer(c)})})]})})})]})}let _=(0,c.vU)({showImage:{id:"imageViewer.showImage",defaultMessage:"Show Image"},closeModal:{id:"imageViewer.closeModal",defaultMessage:"Close Modal"},toggleSidebar:{id:"imageViewer.toggleSidebar",defaultMessage:"Toggle Sidebar"},nextImage:{id:"imageViewer.nextImage",defaultMessage:"Next Image"},previousImage:{id:"imageViewer.previousImage",defaultMessage:"Previous Image"}});var C=t(58543),S=t(72500),O=t(70522),L=t(16645),A=t(77047),R=t(75973),V=t(88568),z=t(62004),D=t(4702),P=t(27603),T=t(86021),G=t(24040),F=t(20408),Z=t(93747),B=t(15236),Q=t(48538),U=t(48580),W=t(53090),X=t(81354),q=t(79499),H=t.n(q);function $(e){var a;let t=null===(a=e.matchTextColor)||void 0===a||a,i=(0,j.useRef)(null),{0:l,1:n}=(0,j.useState)(null);(0,j.useEffect)(()=>{if(!i.current||!t)return;let e=()=>{i.current&&n(getComputedStyle(i.current).color)},a=new MutationObserver(()=>{e()});return a.observe(window.document.documentElement,{attributes:!0,attributeFilter:["class","style"]}),a.observe(i.current,{attributes:!0,attributeFilter:["class","style"]}),e(),()=>a.disconnect()},[t]);let s=(0,j.useMemo)(()=>{var a;if(!t)return e.animationData;let i=null==l||null===(a=l.match(/\d+/g))||void 0===a?void 0:a.map(Number).map(e=>e/255);if(!i)return null;i.push(1);let n=e.animationData;return"layers"in n&&Array.isArray(n.layers)&&n.layers.forEach(e=>{"ty"in e&&4===e.ty&&"shapes"in e&&Array.isArray(e.shapes)&&e.shapes.forEach(e=>{"it"in e&&Array.isArray(e.it)&&e.it.forEach(e=>{"fl"===e.ty&&(e.c.k=i)})})}),n},[e.animationData,l,t]);return(0,w.jsx)("div",{ref:i,className:e.className,children:(0,w.jsx)(H(),{animationData:s,loop:!0,autoplay:!0},l)})}var Y=t(26669);function K(e){let{id:a,withLottie:t}=e;return(0,w.jsxs)("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full",children:[t?(0,w.jsx)($,{className:"h-6 w-6",animationData:Y}):(0,w.jsx)(y.q$4,{className:"h-6 w-6"}),(0,w.jsx)(J,{id:a})]})}function J(e){let{id:a}=e,t=ea(a);return(0,w.jsx)(X.Z,{percentage:t,thickness:1.25/23,className:"absolute left-1/2 top-1/2 h-10 w-10 -translate-x-1/2 -translate-y-1/2",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:"".concat((100-t)/100*.2,"s"),transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"})}let ee=new Map,ea=function(e){var a;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e3,i=function(e){if("number"==typeof e)return e;let a=0;if(0===e.length)return a;for(let t=0;t<e.length;t++)a=(a<<5)-a+e.charCodeAt(t)|0;return a}(e),{0:l,1:n}=(0,j.useState)(null!==(a=ee.get(e))&&void 0!==a?a:0);return(0,j.useEffect)(()=>{let a=0,l=setInterval(()=>{a+=100,n(n=>{let s=1.5;if(a<t){let e=.1*Math.sin(i+n/100)+1;s=(1-Math.log10(1+n/10))*e}let r=n+s;return r>=100?(clearInterval(l),100):(ee.set(e,r),r)})},100);return()=>{clearInterval(l),ee.delete(e)}},[i,e,t]),l};var et=t(33423),ei=t(72427);function el(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);a&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function en(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?el(Object(t),!0).forEach(function(a){(0,o.Z)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):el(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function es(e){var a;let{messages:t,clientThreadId:i}=e,[l,n]=t,s=(0,ei.We)(l.message),r=(0,W.t9)(),o=t.some(e=>r.has(e.message.id)),d=null;null!=n&&F.U.isMultimodalTextMessage(n.message)&&(d=F.U.getImageAssetPointers(n.message));let u=et.X.Running;return null!=d?u=et.X.Finished:null!=n?u=et.X.Error:s&&(u=et.X.Stopped),(0,w.jsx)(w.Fragment,{children:!o&&(0,w.jsx)(eo,{imageAssets:null!==(a=d)&&void 0!==a?a:[],clientThreadId:i,toolStatus:u,toolMessage:null==n?void 0:n.message,messageId:l.message.id})})}var er=((l=er||{}).WIDE="1792x1024",l.SQUARE="1024x1024",l.TALL="1024x1792",l);let eo=e=>{let{imageAssets:a,clientThreadId:t,toolMessage:i,toolStatus:l,messageId:n}=e,s=(0,u.Z)(),r=(0,R.H)(a);if((null==i?void 0:i.content.content_type)===m.PX.SystemError)return null;let o=ep(a[0]),d=r.map(e=>e.data).filter(e=>null!=e),c=d.map(e=>en(en({},e),{},{alt:(0,V.hG)(e)})),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"".concat(n,"-image-").concat(e)};return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(ex,{$numItems:r.length,className:"my-1 transition-opacity duration-300",children:[0===r.length&&l===et.X.Running&&(0,w.jsx)(eu,{layoutId:"loading:placeholder",shape:o,isToolRunning:!0},"loading"),r.map((e,a)=>{let{isLoading:l,data:n,error:r}=e;if(l)return(0,w.jsx)(eu,{shape:o,layoutId:g(a)},a);if(null!=r||(null==n?void 0:n.url)==null)return(0,w.jsx)(eg,{layoutId:g(a),className:"text-sm text-token-text-tertiary",shape:o,children:(0,w.jsx)("div",{className:"flex min-h-full flex-col items-center justify-center gap-3 px-4 pb-5",children:s.formatMessage(ev.imageLoadError)})},a);if(i&&n){let e=en(en({},n),{},{alt:(0,V.hG)(n)});return(0,w.jsx)(ed,{image:e,allImages:c,clientThreadId:t,toolMessage:i,index:a,onOpenImageEditor:()=>{O.RT.setFocusedObject({type:O.zG.Image,image:e,allImages:d,messageId:i.id})}},a)}})]})})};function ed(e){let{toolMessage:a,clientThreadId:t,allImages:i,image:l,index:n,onOpenImageEditor:s}=e,r=(0,u.Z)(),o=(0,T.XK)(t),d=(0,D.hz)(),c=(0,x.w$)(),g=(0,z.W)(t),m=ep(l),{0:f,1:p}=(0,j.useState)({}),v=g&&"gizmo"in g?g.gizmo:void 0,b=(null==v?void 0:v.gizmo.id)===L.qL,y=c&&!!(null==d?void 0:d.includes(P.L0.D3Editor))&&(null==v||b||!!(null==d?void 0:d.includes(P.L0.D3EditorAllGpts)));async function I(e){(0,V.HR)(e,o,a.id)}function M(e,t){var i,l,n,s,r,d;p(a=>en(en({},a),{},{[e.asset_pointer]:t})),U.m9.logEvent(B.M.dalleImageRating,t?"like":"dislike",{liked:t?"true":"false",sourceOperation:null!==(i=null===(l=e.metadata)||void 0===l||null===(l=l.dalle)||void 0===l?void 0:l.edit_op)&&void 0!==i?i:"none",hasParent:null!==(n=e.metadata)&&void 0!==n&&null!==(n=n.dalle)&&void 0!==n&&n.parent_gen_id?"true":"false"}),Z.A.logEvent(B.M.dalleImageRating,{liked:t,conversationId:o,messageId:a.id,generationId:null===(s=e.metadata)||void 0===s||null===(s=s.dalle)||void 0===s?void 0:s.gen_id,parentGenerationId:null===(r=e.metadata)||void 0===r||null===(r=r.dalle)||void 0===r?void 0:r.parent_gen_id,fileId:(0,C.Iy)(e.asset_pointer),sourceOperation:null===(d=e.metadata)||void 0===d||null===(d=d.dalle)||void 0===d?void 0:d.edit_op})}let k=(0,w.jsx)(em,{image:l,shape:m,rating:f[l.asset_pointer],onDownload:()=>I(l),onRate:(e,a)=>M(e,a),clientThreadId:t,layoutId:void 0});return k=y?(0,w.jsx)("div",{role:"button",onClick:s,children:k}):(0,w.jsx)(N,{image:l,images:i,metadataRenderer:e=>(0,w.jsx)(ec,{image:e}),onOpen:function(e){var t,i,l,n,s,r;U.m9.logEvent("chatgpt_dalle_image_view_full",null,{sourceOperation:null!==(t=null===(i=e.metadata)||void 0===i||null===(i=i.dalle)||void 0===i?void 0:i.edit_op)&&void 0!==t?t:"none",hasParent:null!==(l=e.metadata)&&void 0!==l&&null!==(l=l.dalle)&&void 0!==l&&l.parent_gen_id?"true":"false"}),Z.A.logEvent(B.M.dalleImageViewFull,{conversationId:o,messageId:a.id,generationId:null===(n=e.metadata)||void 0===n||null===(n=n.dalle)||void 0===n?void 0:n.gen_id,parentGenerationId:null===(s=e.metadata)||void 0===s||null===(s=s.dalle)||void 0===s?void 0:s.parent_gen_id,fileId:(0,C.Iy)(e.asset_pointer),sourceOperation:null===(r=e.metadata)||void 0===r||null===(r=r.dalle)||void 0===r?void 0:r.edit_op})},getActions:function(e){let a=f[e.asset_pointer],t={label:r.formatMessage(ev.likeImage),onClick:()=>M(e,!0),disabled:!0===a,ariaLabel:r.formatMessage(ev.likeImage),icon:h.ib},i={label:r.formatMessage(ev.dislikeImage),onClick:()=>M(e,!1),disabled:!1===a,ariaLabel:r.formatMessage(ev.dislikeImage),icon:h.Q7};return[!1!==a&&t,!0!==a&&i,{label:r.formatMessage(ev.downloadImage),onClick:()=>I(e),ariaLabel:r.formatMessage(ev.downloadImage),icon:h.Sg}].filter(Boolean)},children:k}),(0,w.jsx)("div",{className:"flex",children:k},n)}function eu(e){let{shape:a,layoutId:t,isToolRunning:i=!1}=e;return(0,w.jsx)(eg,{shape:a,layoutId:t,children:(0,w.jsx)("div",{className:"flex min-h-full items-center justify-center",children:(0,w.jsx)(K,{id:t,withLottie:i})})},"loading")}function ec(e){let{image:a}=e,t=(0,u.Z)(),{0:i,1:l}=(0,j.useState)(!1);return(0,w.jsxs)("div",{className:"flex flex-col items-start gap-3 p-6",children:[(0,w.jsx)("div",{className:"text-sm text-gray-300 sm:text-base",children:t.formatMessage(ev.imageViewerMetadataTitle)}),(0,w.jsx)("div",{className:"max-h-32 overflow-y-auto text-sm md:max-h-[80vh] md:text-lg",children:(0,V.hG)(a)}),(0,w.jsx)(f.z,{color:"primary",onClick:function(){let e=(0,V.hG)(a);l(!0),(0,Q.v)(e),setTimeout(()=>{l(!1)},2e3)},disabled:i,className:"hidden sm:block",icon:y.TIy,children:i?t.formatMessage(ev.imageViewerMetadataCopyButtonCopied):t.formatMessage(ev.imageViewerMetadataCopyButton)})]})}function eg(e){let{children:a,shape:t,className:i,layoutId:l}=e;return(0,w.jsxs)(b.E.div,{layoutId:l,className:(0,d.default)("relative",i,t===er.WIDE&&"aspect-[7/4]",t===er.SQUARE&&"aspect-square max-w-[400px]",t===er.TALL&&"aspect-[4/7] max-w-xs","juice:overflow-hidden juice:rounded-2xl"),children:[(0,w.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-token-main-surface-secondary"}),(0,w.jsx)("div",{className:"relative h-full",children:a})]})}function em(e){let{image:a,shape:t,rating:i,onDownload:l,onRate:n,clientThreadId:s,layoutId:r}=e,o=(0,T.h9)(),u=(0,G.ec)(G.F_.isBusinessWorkspace),c=(0,T.WA)(s),g=(0,S.Ex)(),f=(0,O.rE)(),x=(null==f?void 0:f.type)===O.zG.Image&&f.image.asset_pointer===a.asset_pointer,{url:p,width:v,height:b}=a,j=!o&&!u&&(null==c?void 0:c.kind)!==m.OL.GizmoMagicCreate;return(0,w.jsxs)(eg,{shape:t,className:"group/dalle-image",layoutId:x?void 0:r,children:[(0,w.jsx)(R.sH,{alt:(0,V.hG)(a),src:p,width:v,height:b}),(0,w.jsx)("div",{className:(0,d.default)("pointer-events-none absolute inset-0 shadow-[inset_0_0_0_1px_rgba(0,0,0,0.1)] juice:rounded-2xl dark:shadow-[inset_0_0_0_1px_rgba(255,255,255,0.1)]",x?"bg-black/50 group-hover/dalle-image:bg-black/70":"group-hover/dalle-image:bg-black/20 juice:group-hover/dalle-image:bg-transparent")}),g?!x&&(0,w.jsx)("div",{className:"pointer-events-none invisible absolute right-3 top-3 text-white group-hover/dalle-image:visible",children:(0,w.jsx)(A.Qq,{})}):(0,w.jsxs)(w.Fragment,{children:[j&&(0,w.jsxs)(ef,{children:[!1!==i&&(0,w.jsx)(eh,{icon:h.ib,selected:!0===i,onClick:e=>{e.stopPropagation(),n(a,!0)}}),!0!==i&&(0,w.jsx)(eh,{icon:h.Q7,selected:!1===i,onClick:e=>{e.stopPropagation(),n(a,!1)}})]}),(0,w.jsx)(ef,{$rightAlign:!0,children:(0,w.jsx)(eh,{icon:h.Sg,onClick:e=>{e.stopPropagation(),l()}})})]})]})}let ef=g.Z.div(n||(n=(0,r.Z)(["invisible absolute top-3 flex gap-1 group-hover/dalle-image:visible\n",""])),e=>{let{$rightAlign:a}=e;return a?"right-3":"left-3"});function eh(e){let{icon:a,selected:t,onClick:i}=e;return(0,w.jsx)("button",{className:(0,d.default)("flex h-8 w-8 items-center justify-center rounded",t?"bg-gray-100":"bg-black/50 hover:opacity-70"),onClick:i,disabled:t,children:(0,w.jsx)(a,{className:(0,d.default)("icon-md",t?"text-gray-700":"text-white")})})}let ex=g.Z.div(s||(s=(0,r.Z)(["grid gap-2\n",""])),e=>{let{$numItems:a}=e;return a<=1?"grid-cols-1":"grid-cols-2"});function ep(e){if(!e)return er.SQUARE;let{width:a,height:t}=e;return a>t?er.WIDE:a<t?er.TALL:er.SQUARE}let ev=(0,c.vU)({creatingImages:{id:"dalleMessage.creatingImagesV2",defaultMessage:"Creating image"},stopped:{id:"dalleMessage.stoppedV3",defaultMessage:"Stopped creating image"},errorCreating:{id:"dalleMessage.errorCreatingV2",defaultMessage:"Error creating image"},imageLoadError:{id:"dalleMessage.imageLoadError",defaultMessage:"Error loading image"},imageViewerMetadataTitle:{id:"dalleMessage.imageViewerMetadataTitle",defaultMessage:"Prompt"},imageViewerMetadataCopyButton:{id:"dalleMessage.imageViewerMetadataCopyButton",defaultMessage:"Copy"},imageViewerMetadataCopyButtonCopied:{id:"dalleMessage.imageViewerMetadataCopyButtonCopied",defaultMessage:"Copied!"},imageEditButton:{id:"dalleMessage.imageEditButton",defaultMessage:"Edit"},downloadImage:{id:"imageViewer.downloadImage",defaultMessage:"Download Image"},likeImage:{id:"imageViewer.likeImage",defaultMessage:"Like Image"},dislikeImage:{id:"imageViewer.dislikeImage",defaultMessage:"Dislike Image"}})}}]);
//# sourceMappingURL=8165.a4f04f0bccee17e7.js.map