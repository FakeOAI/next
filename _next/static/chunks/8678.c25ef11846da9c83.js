"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8678],{8678:function(e,a,t){t.r(a),t.d(a,{default:function(){return en}});var i,l,n,s,r=t(15316),o=t(97410),d=t(19841),u=t(75172),c=t(68306),g=t(15478),m=t(88628),f=t(9519),h=t(26693),x=t(66583);t(7569);var p=t(21389),v=t(88600),b=t(92379),j=t(48198),y=t(651),w=((i=w||{})[i.Left=-1]="Left",i[i.Right=1]="Right",i[i.None=0]="None",i);let I={enter:e=>({zIndex:0,x:e===w.Left?"10%":"-10%",opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:e=>({zIndex:0,x:e===w.Right?"10%":"-10%",opacity:0})},M={enter:{opacity:0,y:"10%"},visible:{opacity:1,y:0},exit:{opacity:0,y:"10%"}},k=(e,a)=>Math.abs(e)*a;function E(e){var a;let t=(0,u.Z)(),i=(0,h.dQ)(),l=[h._G.Small,h._G.Mobile].includes(i),{0:n,1:s}=(0,b.useState)({width:0,height:0}),{0:r,1:o}=(0,b.useState)(!1),{0:c,1:g}=(0,b.useState)(e.image),{0:m,1:E}=(0,b.useState)(!1),N=n.width>0&&n.height>0,C=(0,b.useRef)(null),{0:O,1:L}=(0,b.useState)(w.None);function S(){g(a=>{let t=(e.images.findIndex(e=>e.url===a.url)+1)%e.images.length;return e.images[t]}),L(w.Left)}function A(){g(a=>{let t=e.images.findIndex(e=>e.url===a.url),i=t>0?(t-1)%e.images.length:e.images.length-1;return e.images[i]}),L(w.Right)}function R(e){"ArrowLeft"===e.key?A():"ArrowRight"===e.key&&S()}(0,b.useEffect)(()=>{if(!c.url)throw Error("ExpandableImage requires a src");let e=new Image;e.onload=()=>{s({width:e.naturalWidth,height:e.naturalHeight})},e.onerror=()=>{},e.src=c.url},[c.url]),(0,b.useEffect)(()=>{let a=C.current;if(m)return null==a||a.addEventListener("keydown",R),()=>{null==a||a.removeEventListener("keydown",R)};g(e.image)},[m]);let V=e.images.findIndex(e=>e.url===c.url);return(0,y.jsxs)(x.fC,{onOpenChange:function(a){var t;E(a),a&&(null===(t=e.onOpen)||void 0===t||t.call(e,c))},children:[(0,y.jsx)(x.xz,{disabled:!N,className:e.className,"aria-label":t.formatMessage(_.showImage),children:e.children}),(0,y.jsx)(x.h_,{children:(0,y.jsx)(x.aV,{className:"fixed inset-0 flex items-center justify-center bg-black/90 backdrop-blur-xl radix-state-open:animate-show",children:(0,y.jsxs)(x.VY,{className:(0,d.default)("relative flex h-[100dvh] w-screen justify-stretch divide-x divide-white/10 focus:outline-none radix-state-open:animate-contentShow"),ref:C,children:[(0,y.jsx)("div",{className:(0,d.default)("flex flex-1 transition-[flex-basis]",!r&&"md:basis-[75vw]"),children:(0,y.jsxs)("div",{className:"flex flex-1 flex-col md:p-6",children:[(0,y.jsxs)("div",{className:"flex justify-between px-6 py-2 pt-6 text-white sm:mb-4 md:mt-2 md:px-0 md:py-2",children:[(0,y.jsx)(x.x8,{asChild:!0,children:(0,y.jsx)("button",{"aria-label":t.formatMessage(_.closeModal),children:(0,y.jsx)(j.tPq,{})})}),(0,y.jsx)("div",{children:!l&&(0,y.jsxs)(y.Fragment,{children:[null===(a=e.getActions)||void 0===a||null===(a=a.call(e,c))||void 0===a?void 0:a.map((e,a)=>(0,y.jsx)(f.z,{color:"ghost",size:"small",onClick:e.onClick,"aria-label":e.ariaLabel,disabled:e.disabled,icon:e.icon},a)),(0,y.jsx)(f.z,{color:"ghost",size:"small",onClick:()=>o(e=>!e),"aria-label":t.formatMessage(_.toggleSidebar),className:"md:inline-flex",icon:j.szr})]})})]}),(0,y.jsx)("div",{className:"relative flex flex-1 flex-col items-center justify-center overflow-hidden",children:(0,y.jsx)(p.M,{initial:!1,custom:O,children:(0,y.jsxs)(v.E.div,{className:"absolute grid h-full w-full grid-rows-2",custom:O,variants:I,drag:"x",dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(e,a)=>{let{offset:t,velocity:i}=a,l=k(t.x,i.x);l<-1e3?S():l>1e3&&A()},children:[(0,y.jsx)(v.E.img,{src:c.url,alt:c.alt,className:"row-span-4 mx-auto h-full object-scale-down",onPanEnd:(e,a)=>{let{offset:t,velocity:i}=a,l=k(t.y,i.y);l<-1e3?o(!0):l>1e3&&o(!1)}},c.url),l&&r&&(0,y.jsx)(v.E.div,{className:"flex text-white",variants:M,initial:"enter",animate:"visible",exit:"exit",transition:{y:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2}},children:e.metadataRenderer(c)})]},c.url)})}),e.images.length>1?(0,y.jsxs)("div",{className:"flex items-center justify-center gap-4 p-8 text-white",children:[(0,y.jsx)(f.z,{color:"ghost",size:"small",onClick:A,"aria-label":t.formatMessage(_.previousImage),icon:j.Y4O}),e.images.map((e,a)=>{var i;return(0,y.jsx)("img",{src:e.url,alt:null!==(i=e.alt)&&void 0!==i?i:"",className:(0,d.default)("h-12 w-12 cursor-pointer rounded object-cover transition duration-300 hover:opacity-100",e.url===c.url?"ring-2 ring-white ring-offset-4 ring-offset-black":"opacity-25"),onClick:()=>{g(e),L(a<V?w.Right:w.Left)},"aria-label":t.formatMessage(_.showImage),role:"button"},e.url)}),(0,y.jsx)(f.z,{color:"ghost",size:"small",onClick:S,"aria-label":t.formatMessage(_.nextImage),icon:j.LZ3})]}):null]})}),(0,y.jsx)("div",{className:(0,d.default)("hidden items-center justify-start overflow-hidden bg-gray-900 text-white transition-[flex-basis] duration-500 md:flex",r?"md:basis-[25vw]":"md:basis-0"),children:(0,y.jsx)("div",{className:"w-[25vw] min-w-[25vw]",children:e.metadataRenderer(c)})})]})})})]})}let _=(0,c.vU)({showImage:{id:"imageViewer.showImage",defaultMessage:"Show Image"},closeModal:{id:"imageViewer.closeModal",defaultMessage:"Close Modal"},toggleSidebar:{id:"imageViewer.toggleSidebar",defaultMessage:"Toggle Sidebar"},nextImage:{id:"imageViewer.nextImage",defaultMessage:"Next Image"},previousImage:{id:"imageViewer.previousImage",defaultMessage:"Previous Image"}});var N=t(11655),C=t(11036),O=t(82830),L=t(18114),S=t(82964),A=t(60905),R=t(68442),V=t(69015),z=t(44575),P=t(85029),D=t(94867),T=t(25968),G=t(72986),Z=t(99140),F=t(66943),B=t(93647),W=t(90681),U=t(23163),X=t(67459);let q=new Map,Q=function(e){var a;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e3,i=function(e){if("number"==typeof e)return e;let a=0;if(0===e.length)return a;for(let t=0;t<e.length;t++)a=(a<<5)-a+e.charCodeAt(t)|0;return a}(e),{0:l,1:n}=(0,b.useState)(null!==(a=q.get(e))&&void 0!==a?a:0);return(0,b.useEffect)(()=>{let a=0,l=setInterval(()=>{a+=100,n(n=>{let s=1.5;if(a<t){let e=.1*Math.sin(i+n/100)+1;s=(1-Math.log10(1+n/10))*e}let r=n+s;return r>=100?(clearInterval(l),100):(q.set(e,r),r)})},100);return()=>{clearInterval(l),q.delete(e)}},[i,e,t]),l};var H=t(47453);let $=t.n(H)()(()=>Promise.all([t.e(3656),t.e(3125)]).then(t.t.bind(t,63125,23)),{loadableGenerated:{webpack:()=>[63125]}});function Y(e){var a;let t=null===(a=e.matchTextColor)||void 0===a||a,i=(0,b.useRef)(null),{0:l,1:n}=(0,b.useState)(null);(0,b.useEffect)(()=>{if(!i.current||!t)return;let e=()=>{i.current&&n(getComputedStyle(i.current).color)},a=new MutationObserver(()=>{e()});return a.observe(window.document.documentElement,{attributes:!0,attributeFilter:["class","style"]}),a.observe(i.current,{attributes:!0,attributeFilter:["class","style"]}),e(),()=>a.disconnect()},[t]);let s=(0,b.useMemo)(()=>{var a;if(!t)return e.animationData;let i=null==l||null===(a=l.match(/\d+/g))||void 0===a?void 0:a.map(Number).map(e=>e/255);if(!i)return null;i.push(1);let n=e.animationData;return"layers"in n&&Array.isArray(n.layers)&&n.layers.forEach(e=>{"ty"in e&&4===e.ty&&"shapes"in e&&Array.isArray(e.shapes)&&e.shapes.forEach(e=>{"it"in e&&Array.isArray(e.it)&&e.it.forEach(e=>{"fl"===e.ty&&(e.c.k=i)})})}),n},[e.animationData,l,t]);return(0,y.jsx)("div",{ref:i,className:e.className,children:(0,y.jsx)($,{animationData:s,loop:!0,autoplay:!0},l)})}var K=t(26669);function J(e){let{id:a,withLottie:t}=e;return(0,y.jsxs)("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full",children:[t?(0,y.jsx)(Y,{className:"h-6 w-6",animationData:K}):(0,y.jsx)(j.q$4,{className:"h-6 w-6"}),(0,y.jsx)(ee,{id:a})]})}function ee(e){let{id:a}=e,t=Q(a);return(0,y.jsx)(X.Z,{percentage:t,thickness:1.25/23,className:"absolute left-1/2 top-1/2 h-10 w-10 -translate-x-1/2 -translate-y-1/2",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:"".concat((100-t)/100*.2,"s"),transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"})}var ea=t(10318),et=t(66356);function ei(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);a&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function el(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?ei(Object(t),!0).forEach(function(a){(0,o.Z)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ei(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function en(e){var a;let{messages:t,clientThreadId:i}=e,[l,n]=t,s=(0,et.We)(l.message),r=(0,U.t9)(),o=t.some(e=>r.has(e.message.id)),d=null;null!=n&&G.U.isMultimodalTextMessage(n.message)&&(d=G.U.getImageAssetPointers(n.message));let u=ea.X.Running;return null!=d?u=ea.X.Finished:null!=n?u=ea.X.Error:s&&(u=ea.X.Stopped),(0,y.jsx)(y.Fragment,{children:!o&&(0,y.jsx)(er,{imageAssets:null!==(a=d)&&void 0!==a?a:[],clientThreadId:i,toolStatus:u,toolMessage:null==n?void 0:n.message,messageId:l.message.id})})}var es=((l=es||{}).WIDE="1792x1024",l.SQUARE="1024x1024",l.TALL="1024x1792",l);let er=e=>{let{imageAssets:a,clientThreadId:t,toolMessage:i,toolStatus:l,messageId:n}=e,s=(0,u.Z)(),r=(0,A.H)(a);if((null==i?void 0:i.content.content_type)===m.PX.SystemError)return null;let o=ex(a[0]),d=r.map(e=>e.data).filter(e=>null!=e),c=d.map(e=>el(el({},e),{},{alt:(0,R.hG)(e)})),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"".concat(n,"-image-").concat(e)};return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(eh,{$numItems:r.length,className:"my-1 transition-opacity duration-300",children:[0===r.length&&l===ea.X.Running&&(0,y.jsx)(ed,{layoutId:"loading:placeholder",shape:o,isToolRunning:!0},"loading"),r.map((e,a)=>{let{isLoading:l,data:n,error:r}=e;if(l)return(0,y.jsx)(ed,{shape:o,layoutId:g(a)},a);if(null!=r||(null==n?void 0:n.url)==null)return(0,y.jsx)(ec,{layoutId:g(a),className:"text-sm text-token-text-tertiary",shape:o,children:(0,y.jsx)("div",{className:"flex min-h-full flex-col items-center justify-center gap-3 px-4 pb-5",children:s.formatMessage(ep.imageLoadError)})},a);if(i&&n){let e=el(el({},n),{},{alt:(0,R.hG)(n)});return(0,y.jsx)(eo,{image:e,allImages:c,clientThreadId:t,toolMessage:i,index:a,onOpenImageEditor:()=>{O.RT.setFocusedObject({type:O.zG.Image,image:e,allImages:d,messageId:i.id})}},a)}})]})})};function eo(e){let{toolMessage:a,clientThreadId:t,allImages:i,image:l,index:n,onOpenImageEditor:s}=e,r=(0,u.Z)(),o=(0,D.XK)(t),d=(0,z.hz)(),c=(0,h.w$)(),g=(0,V.W)(t),m=ex(l),{0:f,1:x}=(0,b.useState)({}),p=g&&"gizmo"in g?g.gizmo:void 0,v=(null==p?void 0:p.gizmo.id)===L.qL,w=c&&!!(null==d?void 0:d.includes(P.L0.D3Editor))&&(null==p||v||!!(null==d?void 0:d.includes(P.L0.D3EditorAllGpts)));async function I(e){(0,R.HR)(e,o,a.id)}function M(e,t){var i,l,n,s,r,d;x(a=>el(el({},a),{},{[e.asset_pointer]:t})),W.m9.logEvent(F.M.dalleImageRating,t?"like":"dislike",{liked:t?"true":"false",sourceOperation:null!==(i=null===(l=e.metadata)||void 0===l||null===(l=l.dalle)||void 0===l?void 0:l.edit_op)&&void 0!==i?i:"none",hasParent:null!==(n=e.metadata)&&void 0!==n&&null!==(n=n.dalle)&&void 0!==n&&n.parent_gen_id?"true":"false"}),Z.A.logEvent(F.M.dalleImageRating,{liked:t,conversationId:o,messageId:a.id,generationId:null===(s=e.metadata)||void 0===s||null===(s=s.dalle)||void 0===s?void 0:s.gen_id,parentGenerationId:null===(r=e.metadata)||void 0===r||null===(r=r.dalle)||void 0===r?void 0:r.parent_gen_id,fileId:(0,N.Iy)(e.asset_pointer),sourceOperation:null===(d=e.metadata)||void 0===d||null===(d=d.dalle)||void 0===d?void 0:d.edit_op})}let k=(0,y.jsx)(eg,{image:l,shape:m,rating:f[l.asset_pointer],onDownload:()=>I(l),onRate:(e,a)=>M(e,a),clientThreadId:t,layoutId:void 0});return k=w?(0,y.jsx)("div",{role:"button",onClick:s,children:k}):(0,y.jsx)(E,{image:l,images:i,metadataRenderer:e=>(0,y.jsx)(eu,{image:e}),onOpen:function(e){var t,i,l,n,s,r;W.m9.logEvent("chatgpt_dalle_image_view_full",null,{sourceOperation:null!==(t=null===(i=e.metadata)||void 0===i||null===(i=i.dalle)||void 0===i?void 0:i.edit_op)&&void 0!==t?t:"none",hasParent:null!==(l=e.metadata)&&void 0!==l&&null!==(l=l.dalle)&&void 0!==l&&l.parent_gen_id?"true":"false"}),Z.A.logEvent(F.M.dalleImageViewFull,{conversationId:o,messageId:a.id,generationId:null===(n=e.metadata)||void 0===n||null===(n=n.dalle)||void 0===n?void 0:n.gen_id,parentGenerationId:null===(s=e.metadata)||void 0===s||null===(s=s.dalle)||void 0===s?void 0:s.parent_gen_id,fileId:(0,N.Iy)(e.asset_pointer),sourceOperation:null===(r=e.metadata)||void 0===r||null===(r=r.dalle)||void 0===r?void 0:r.edit_op})},getActions:function(e){let a=f[e.asset_pointer],t={label:r.formatMessage(ep.likeImage),onClick:()=>M(e,!0),disabled:!0===a,ariaLabel:r.formatMessage(ep.likeImage),icon:j.Z7j},i={label:r.formatMessage(ep.dislikeImage),onClick:()=>M(e,!1),disabled:!1===a,ariaLabel:r.formatMessage(ep.dislikeImage),icon:j.C_W};return[!1!==a&&t,!0!==a&&i,{label:r.formatMessage(ep.downloadImage),onClick:()=>I(e),ariaLabel:r.formatMessage(ep.downloadImage),icon:j._8t}].filter(Boolean)},children:k}),(0,y.jsx)("div",{className:"flex",children:k},n)}function ed(e){let{shape:a,layoutId:t,isToolRunning:i=!1}=e;return(0,y.jsx)(ec,{shape:a,layoutId:t,children:(0,y.jsx)("div",{className:"flex min-h-full items-center justify-center",children:(0,y.jsx)(J,{id:t,withLottie:i})})},"loading")}function eu(e){let{image:a}=e,t=(0,u.Z)(),{0:i,1:l}=(0,b.useState)(!1);return(0,y.jsxs)("div",{className:"flex flex-col items-start gap-3 p-6",children:[(0,y.jsx)("div",{className:"text-sm text-gray-300 sm:text-base",children:t.formatMessage(ep.imageViewerMetadataTitle)}),(0,y.jsx)("div",{className:"max-h-32 overflow-y-auto text-sm md:max-h-[80vh] md:text-lg",children:(0,R.hG)(a)}),(0,y.jsx)(f.z,{color:"primary",onClick:function(){let e=(0,R.hG)(a);l(!0),(0,B.v)(e),setTimeout(()=>{l(!1)},2e3)},disabled:i,className:"hidden sm:block",icon:j.TIy,children:i?t.formatMessage(ep.imageViewerMetadataCopyButtonCopied):t.formatMessage(ep.imageViewerMetadataCopyButton)})]})}function ec(e){let{children:a,shape:t,className:i,layoutId:l}=e;return(0,y.jsxs)(v.E.div,{layoutId:l,className:(0,d.default)("relative",i,t===es.WIDE&&"aspect-[7/4]",t===es.SQUARE&&"aspect-square max-w-[400px]",t===es.TALL&&"aspect-[4/7] max-w-xs","overflow-hidden rounded-2xl"),children:[(0,y.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-token-main-surface-secondary"}),(0,y.jsx)("div",{className:"relative h-full",children:a})]})}function eg(e){let{image:a,shape:t,rating:i,onDownload:l,onRate:n,clientThreadId:s,layoutId:r}=e,o=(0,D.h9)(),u=(0,T.ec)(T.F_.isBusinessWorkspace),c=(0,D.WA)(s),g=(0,C.E)(),f=(0,O.rE)(),h=(null==f?void 0:f.type)===O.zG.Image&&f.image.asset_pointer===a.asset_pointer,{url:x,width:p,height:v}=a,b=!o&&!u&&(null==c?void 0:c.kind)!==m.OL.GizmoMagicCreate;return(0,y.jsxs)(ec,{shape:t,className:"group/dalle-image",layoutId:h?void 0:r,children:[(0,y.jsx)(A.sH,{alt:(0,R.hG)(a),src:x,width:p,height:v}),(0,y.jsx)("div",{className:(0,d.default)("pointer-events-none absolute inset-0 rounded-2xl shadow-[inset_0_0_0_1px_rgba(0,0,0,0.1)] dark:shadow-[inset_0_0_0_1px_rgba(255,255,255,0.1)]",h?"bg-black/50 group-hover/dalle-image:bg-black/70":"group-hover/dalle-image:bg-transparent")}),g?!h&&(0,y.jsx)("div",{className:"pointer-events-none invisible absolute right-3 top-3 text-white group-hover/dalle-image:visible",children:(0,y.jsx)(S.Qq,{})}):(0,y.jsxs)(y.Fragment,{children:[b&&(0,y.jsxs)(em,{children:[!1!==i&&(0,y.jsx)(ef,{icon:j.Z7j,selected:!0===i,onClick:e=>{e.stopPropagation(),n(a,!0)}}),!0!==i&&(0,y.jsx)(ef,{icon:j.C_W,selected:!1===i,onClick:e=>{e.stopPropagation(),n(a,!1)}})]}),(0,y.jsx)(em,{$rightAlign:!0,children:(0,y.jsx)(ef,{icon:j._8t,onClick:e=>{e.stopPropagation(),l()}})})]})]})}let em=g.Z.div(n||(n=(0,r.Z)(["invisible absolute top-3 flex gap-1 group-hover/dalle-image:visible\n",""])),e=>{let{$rightAlign:a}=e;return a?"right-3":"left-3"});function ef(e){let{icon:a,selected:t,onClick:i}=e;return(0,y.jsx)("button",{className:(0,d.default)("flex h-8 w-8 items-center justify-center rounded",t?"bg-gray-100":"bg-black/50 hover:opacity-70"),onClick:i,disabled:t,children:(0,y.jsx)(a,{className:(0,d.default)("icon-md",t?"text-gray-700":"text-white")})})}let eh=g.Z.div(s||(s=(0,r.Z)(["grid gap-2\n",""])),e=>{let{$numItems:a}=e;return a<=1?"grid-cols-1":"grid-cols-2"});function ex(e){if(!e)return es.SQUARE;let{width:a,height:t}=e;return a>t?es.WIDE:a<t?es.TALL:es.SQUARE}let ep=(0,c.vU)({creatingImages:{id:"dalleMessage.creatingImagesV2",defaultMessage:"Creating image"},stopped:{id:"dalleMessage.stoppedV3",defaultMessage:"Stopped creating image"},errorCreating:{id:"dalleMessage.errorCreatingV2",defaultMessage:"Error creating image"},imageLoadError:{id:"dalleMessage.imageLoadError",defaultMessage:"Error loading image"},imageViewerMetadataTitle:{id:"dalleMessage.imageViewerMetadataTitle",defaultMessage:"Prompt"},imageViewerMetadataCopyButton:{id:"dalleMessage.imageViewerMetadataCopyButton",defaultMessage:"Copy"},imageViewerMetadataCopyButtonCopied:{id:"dalleMessage.imageViewerMetadataCopyButtonCopied",defaultMessage:"Copied!"},imageEditButton:{id:"dalleMessage.imageEditButton",defaultMessage:"Edit"},downloadImage:{id:"imageViewer.downloadImage",defaultMessage:"Download Image"},likeImage:{id:"imageViewer.likeImage",defaultMessage:"Like Image"},dislikeImage:{id:"imageViewer.dislikeImage",defaultMessage:"Dislike Image"}})}}]);
//# sourceMappingURL=8678.c25ef11846da9c83.js.map