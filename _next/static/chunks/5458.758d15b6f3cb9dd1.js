"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5458],{12498:function(e,t,n){n.d(t,{N0:function(){return u},QF:function(){return C},YR:function(){return I},uJ:function(){return y},uo:function(){return f},w9:function(){return w},ym:function(){return v}});var r=n(70348),o=n(81171),i=n(60314);let l=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function s(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)break}return!1}function p(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function a(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function c(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}let f=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),l=n.indexAfter(-1),s=c(o.contentMatchAt(l));if(!s||!o.canReplaceWith(l,l,s))return!1;if(t){let r=n.after(),o=e.tr.replaceWith(r,r,s.createAndFill());o.setSelection(i.Y1.near(o.doc.resolve(r),1)),t(o.scrollIntoView())}return!0},u=(e,t)=>{let{$from:n,to:r}=e.selection,o,l=n.sharedDepth(r);return 0!=l&&(o=n.before(l),t&&t(e.tr.setSelection(i.qv.create(e.doc,o))),!0)};function d(e,t,n){let l,p,a,c=t.nodeBefore,f=t.nodeAfter,u,d;if(c.type.spec.isolating||f.type.spec.isolating)return!1;if(l=t.nodeBefore,p=t.nodeAfter,a=t.index(),l&&p&&l.type.compatibleContent(p.type)&&(!l.content.size&&t.parent.canReplace(a-1,a)?(n&&n(e.tr.delete(t.pos-l.nodeSize,t.pos).scrollIntoView()),!0):!!(t.parent.canReplace(a,a+1)&&(p.isTextblock||(0,r.Mn)(e.doc,t.pos)))&&(n&&n(e.tr.clearIncompatible(t.pos,l.type,l.contentMatchAt(l.childCount)).join(t.pos).scrollIntoView()),!0)))return!0;let h=t.parent.canReplace(t.index(),t.index()+1);if(h&&(u=(d=c.contentMatchAt(c.childCount)).findWrapping(f.type))&&d.matchType(u[0]||f.type).validEnd){if(n){let i=t.pos+f.nodeSize,l=o.HY.empty;for(let e=u.length-1;e>=0;e--)l=o.HY.from(u[e].create(null,l));l=o.HY.from(c.copy(l));let s=e.tr.step(new r.FC(t.pos-1,i,t.pos,i,new o.p2(l,1,0),u.length,!0)),p=i+2*u.length;(0,r.Mn)(s.doc,p)&&s.join(p),n(s.scrollIntoView())}return!0}let m=i.Y1.findFrom(t,1),g=m&&m.$from.blockRange(m.$to),v=g&&(0,r.k9)(g);if(null!=v&&v>=t.depth)return n&&n(e.tr.lift(g,v).scrollIntoView()),!0;if(h&&s(f,"start",!0)&&s(c,"end")){let i=c,l=[];for(;l.push(i),!i.isTextblock;)i=i.lastChild;let s=f,p=1;for(;!s.isTextblock;s=s.firstChild)p++;if(i.canReplace(i.childCount,i.childCount,s.content)){if(n){let i=o.HY.empty;for(let e=l.length-1;e>=0;e--)i=o.HY.from(l[e].copy(i));n(e.tr.step(new r.FC(t.pos-l.length,t.pos+f.nodeSize,t.pos+p,t.pos+f.nodeSize-p,new o.p2(i,l.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function h(e){return function(t,n){let r=t.selection,o=e<0?r.$from:r.$to,l=o.depth;for(;o.node(l).isInline;){if(!l)return!1;l--}return!!o.node(l).isTextblock&&(n&&n(t.tr.setSelection(i.Bs.create(t.doc,e<0?o.start(l):o.end(l)))),!0)}}let m=h(-1),g=h(1);function v(e,t=null){return function(n,o){let{$from:i,$to:l}=n.selection,s=i.blockRange(l),p=s&&(0,r.nd)(s,e,t);return!!p&&(o&&o(n.tr.wrap(s,p).scrollIntoView()),!0)}}function y(e,t=null){return function(n,r){let o=!1;for(let r=0;r<n.selection.ranges.length&&!o;r++){let{$from:{pos:i},$to:{pos:l}}=n.selection.ranges[r];n.doc.nodesBetween(i,l,(r,i)=>{if(o)return!1;if(!(!r.isTextblock||r.hasMarkup(e,t))){if(r.type==e)o=!0;else{let t=n.doc.resolve(i),r=t.index();o=t.parent.canReplaceWith(r,r+1,e)}}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:l}}=n.selection.ranges[r];o.setBlockType(i,l,e,t)}r(o.scrollIntoView())}return!0}}function w(e,t=null){return function(n,r){let{empty:o,$cursor:i,ranges:l}=n.selection;if(o&&!i||!function(e,t,n){for(let r=0;r<t.length;r++){let{$from:o,$to:i}=t[r],l=0==o.depth&&e.inlineContent&&e.type.allowsMarkType(n);if(e.nodesBetween(o.pos,i.pos,e=>{if(l)return!1;l=e.inlineContent&&e.type.allowsMarkType(n)}),l)return!0}return!1}(n.doc,l,e))return!1;if(r){if(i)r(e.isInSet(n.storedMarks||i.marks())?n.tr.removeStoredMark(e):n.tr.addStoredMark(e.create(t)));else{let o=!1,i=n.tr;for(let t=0;!o&&t<l.length;t++){let{$from:r,$to:i}=l[t];o=n.doc.rangeHasMark(r.pos,i.pos,e)}for(let n=0;n<l.length;n++){let{$from:r,$to:s}=l[n];if(o)i.removeMark(r.pos,s.pos,e);else{let n=r.pos,o=s.pos,l=r.nodeAfter,p=s.nodeBefore,a=l&&l.isText?/^\s*/.exec(l.text)[0].length:0,c=p&&p.isText?/\s*$/.exec(p.text)[0].length:0;n+a<o&&(n+=a,o-=c),i.addMark(n,o,e.create(t))}}r(i.scrollIntoView())}}return!0}}function C(...e){return function(t,n,r){for(let o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}let k=C(l,(e,t,n)=>{let l=function(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("backward",e):!(n.parentOffset>0))?n:null}(e,n);if(!l)return!1;let a=p(l);if(!a){let n=l.blockRange(),o=n&&(0,r.k9)(n);return null!=o&&(t&&t(e.tr.lift(n,o).scrollIntoView()),!0)}let c=a.nodeBefore;if(!c.type.spec.isolating&&d(e,a,t))return!0;if(0==l.parent.content.size&&(s(c,"end")||i.qv.isSelectable(c))){let n=(0,r.dR)(e.doc,l.before(),l.after(),o.p2.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(s(c,"end")?i.Y1.findFrom(r.doc.resolve(r.mapping.map(a.pos,-1)),-1):i.qv.create(r.doc,a.pos-c.nodeSize)),t(r.scrollIntoView())}return!0}}return!!c.isAtom&&a.depth==l.depth-1&&(t&&t(e.tr.delete(a.pos-c.nodeSize,a.pos).scrollIntoView()),!0)},(e,t,n)=>{let{$head:r,empty:o}=e.selection,l=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;l=p(r)}let s=l&&l.nodeBefore;return!!(s&&i.qv.isSelectable(s))&&(t&&t(e.tr.setSelection(i.qv.create(e.doc,l.pos-s.nodeSize)).scrollIntoView()),!0)}),b=C(l,(e,t,n)=>{let l=function(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("forward",e):!(n.parentOffset<n.parent.content.size))?n:null}(e,n);if(!l)return!1;let p=a(l);if(!p)return!1;let c=p.nodeAfter;if(d(e,p,t))return!0;if(0==l.parent.content.size&&(s(c,"start")||i.qv.isSelectable(c))){let n=(0,r.dR)(e.doc,l.before(),l.after(),o.p2.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(s(c,"start")?i.Y1.findFrom(r.doc.resolve(r.mapping.map(p.pos)),1):i.qv.create(r.doc,r.mapping.map(p.pos))),t(r.scrollIntoView())}return!0}}return!!c.isAtom&&p.depth==l.depth-1&&(t&&t(e.tr.delete(p.pos,p.pos+c.nodeSize).scrollIntoView()),!0)},(e,t,n)=>{let{$head:r,empty:o}=e.selection,l=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;l=a(r)}let s=l&&l.nodeAfter;return!!(s&&i.qv.isSelectable(s))&&(t&&t(e.tr.setSelection(i.qv.create(e.doc,l.pos)).scrollIntoView()),!0)}),x={Enter:C((e,t)=>{let{$head:n,$anchor:r}=e.selection;return!!(n.parent.type.spec.code&&n.sameParent(r))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)},(e,t)=>{let n=e.selection,{$from:r,$to:o}=n;if(n instanceof i.C1||r.parent.inlineContent||o.parent.inlineContent)return!1;let l=c(o.parent.contentMatchAt(o.indexAfter()));if(!l||!l.isTextblock)return!1;if(t){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,s=e.tr.insert(n,l.createAndFill());s.setSelection(i.Bs.create(s.doc,n+1)),t(s.scrollIntoView())}return!0},(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if((0,r.Ax)(e.doc,o))return t&&t(e.tr.split(o).scrollIntoView()),!0}let o=n.blockRange(),i=o&&(0,r.k9)(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)},(e,t)=>{let{$from:n,$to:o}=e.selection;if(e.selection instanceof i.qv&&e.selection.node.isBlock)return!!(n.parentOffset&&(0,r.Ax)(e.doc,n.pos))&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.parent.isBlock)return!1;if(t){let l=o.parentOffset==o.parent.content.size,s=e.tr;(e.selection instanceof i.Bs||e.selection instanceof i.C1)&&s.deleteSelection();let p=0==n.depth?null:c(n.node(-1).contentMatchAt(n.indexAfter(-1))),a,f=a?[a]:l&&p?[{type:p}]:void 0,u=(0,r.Ax)(s.doc,s.mapping.map(n.pos),1,f);if(!f&&!u&&(0,r.Ax)(s.doc,s.mapping.map(n.pos),1,p?[{type:p}]:void 0)&&(p&&(f=[{type:p}]),u=!0),u&&(s.split(s.mapping.map(n.pos),1,f),!l&&!n.parentOffset&&n.parent.type!=p)){let e=s.mapping.map(n.before()),t=s.doc.resolve(e);p&&n.node(-1).canReplaceWith(t.index(),t.index()+1,p)&&s.setNodeMarkup(s.mapping.map(n.before()),p)}t(s.scrollIntoView())}return!0}),"Mod-Enter":f,Backspace:k,"Mod-Backspace":k,"Shift-Backspace":k,Delete:b,"Mod-Delete":b,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new i.C1(e.doc))),!0)},M={"Ctrl-h":x.Backspace,"Alt-Backspace":x["Mod-Backspace"],"Ctrl-d":x.Delete,"Ctrl-Alt-Backspace":x["Mod-Delete"],"Alt-Delete":x["Mod-Delete"],"Alt-d":x["Mod-Delete"],"Ctrl-a":m,"Ctrl-e":g};for(let e in x)M[e]=x[e];let I=("undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&!!os.platform&&"darwin"==os.platform())?M:x},4684:function(e,t,n){n.d(t,{Q:function(){return s},d:function(){return a}});var r=n(80326),o=n(60314),i=n(81171),l=n(59231);class s extends o.Y1{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return s.valid(n)?new s(n):o.Y1.near(n)}content(){return i.p2.empty}eq(e){return e instanceof s&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for GapCursor.fromJSON");return new s(e.resolve(t.pos))}getBookmark(){return new p(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0==n){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&s.valid(e))return e;let r=e.pos,i=null;for(let n=e.depth;;n--){let o=e.node(n);if(t>0?e.indexAfter(n)<o.childCount:e.index(n)>0){i=o.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let l=e.doc.resolve(r);if(s.valid(l))return l}for(;;){let l=t>0?i.firstChild:i.lastChild;if(!l){if(i.isAtom&&!i.isText&&!o.qv.isSelectable(i)){e=e.doc.resolve(r+i.nodeSize*t),n=!1;continue e}break}i=l,r+=t;let p=e.doc.resolve(r);if(s.valid(p))return p}return null}}}s.prototype.visible=!1,s.findFrom=s.findGapCursorFrom,o.Y1.jsonID("gapcursor",s);class p{constructor(e){this.pos=e}map(e){return new p(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return s.valid(t)?new s(t):o.Y1.near(t)}}function a(){return new o.Sy({props:{decorations:h,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&s.valid(n)?new s(n):null,handleClick:u,handleKeyDown:c,handleDOMEvents:{beforeinput:d}}})}let c=(0,r.$)({ArrowLeft:f("horiz",-1),ArrowRight:f("horiz",1),ArrowUp:f("vert",-1),ArrowDown:f("vert",1)});function f(e,t){let n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,i){let l=e.selection,p=t>0?l.$to:l.$from,a=l.empty;if(l instanceof o.Bs){if(!i.endOfTextblock(n)||0==p.depth)return!1;a=!1,p=e.doc.resolve(t>0?p.after():p.before())}let c=s.findGapCursorFrom(p,t,a);return!!c&&(r&&r(e.tr.setSelection(new s(c))),!0)}}function u(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!s.valid(r))return!1;let i=e.posAtCoords({left:n.clientX,top:n.clientY});return!(i&&i.inside>-1&&o.qv.isSelectable(e.state.doc.nodeAt(i.inside)))&&(e.dispatch(e.state.tr.setSelection(new s(r))),!0)}function d(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof s))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let l=i.HY.empty;for(let e=r.length-1;e>=0;e--)l=i.HY.from(r[e].createAndFill(null,l));let p=e.state.tr.replace(n.pos,n.pos,new i.p2(l,0,0));return p.setSelection(o.Bs.near(p.doc.resolve(n.pos+1))),e.dispatch(p),!1}function h(e){if(!(e.selection instanceof s))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",l.EH.create(e.doc,[l.p.widget(e.selection.head,t,{key:"gapcursor"})])}},74263:function(e,t,n){n.d(t,{m8:function(){return w},KX:function(){return b},AH:function(){return M},Yw:function(){return k},of:function(){return x}});var r=function(){};r.prototype.append=function(e){return e.length?(e=r.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},r.prototype.prepend=function(e){return e.length?r.from(e).append(this):this},r.prototype.appendInner=function(e){return new i(this,e)},r.prototype.slice=function(e,t){return(void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t)?r.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},r.prototype.get=function(e){if(!(e<0)&&!(e>=this.length))return this.getInner(e)},r.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},r.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},r.from=function(e){return e instanceof r?e:e&&e.length?new o(e):r.empty};var o=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(r);r.empty=new o([]);var i=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;if(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r)||n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;if(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o)||n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))return!1},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(r),l=n(70348),s=n(60314);class p{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){let n,r,o,i;if(0==this.eventCount)return null;let l=this.items.length;for(;;l--)if(this.items.get(l-1).selection){--l;break}t&&(r=(n=this.remapping(l,this.items.length)).maps.length);let s=e.tr,c=[],f=[];return this.items.forEach((e,t)=>{if(!e.step){n||(r=(n=this.remapping(l,t+1)).maps.length),r--,f.push(e);return}if(n){f.push(new a(e.map));let t=e.step.map(n.slice(r)),o;t&&s.maybeStep(t).doc&&(o=s.mapping.maps[s.mapping.maps.length-1],c.push(new a(o,void 0,void 0,c.length+f.length))),r--,o&&n.appendMap(o,r)}else s.maybeStep(e.step);if(e.selection)return o=n?e.selection.map(n.slice(r)):e.selection,i=new p(this.items.slice(0,l).append(f.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:i,transform:s,selection:o}}addTransform(e,t,n,r){var o,i;let l,s=[],c=this.eventCount,u=this.items,d=!r&&u.length?u.get(u.length-1):null;for(let n=0;n<e.steps.length;n++){let o=e.steps[n].invert(e.docs[n]),i=new a(e.mapping.maps[n],o,t),l;(l=d&&d.merge(i))&&(i=l,n?s.pop():u=u.slice(0,u.length-1)),s.push(i),t&&(c++,t=void 0),r||(d=i)}let h=c-n.depth;return h>f&&(o=u,i=h,o.forEach((e,t)=>{if(e.selection&&0==i--)return l=t,!1}),u=o.slice(l),c-=h),new p(u.append(s),c)}remapping(e,t){let n=new l.vs;return this.items.forEach((t,r)=>{let o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,o)},e,t),n}addMaps(e){return 0==this.eventCount?this:new p(this.items.append(e.map(e=>new a(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,l=this.eventCount;this.items.forEach(e=>{e.selection&&l--},r);let s=t;this.items.forEach(t=>{let r=o.getMirror(--s);if(null==r)return;i=Math.min(i,r);let p=o.maps[r];if(t.step){let i=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(o.slice(s+1,r));c&&l++,n.push(new a(p,i,c))}else n.push(new a(p))},r);let c=[];for(let e=t;e<i;e++)c.push(new a(o.maps[e]));let f=new p(this.items.slice(0,r).append(c).append(n),l);return f.emptyItemCount()>500&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{!t.step&&e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,o=[],i=0;return this.items.forEach((r,l)=>{if(l>=e)o.push(r),r.selection&&i++;else if(r.step){let e=r.step.map(t.slice(n)),l=e&&e.getMap();if(n--,l&&t.appendMap(l,n),e){let s=r.selection&&r.selection.map(t.slice(n));s&&i++;let p=new a(l.invert(),e,s),c,f=o.length-1;(c=o.length&&o[f].merge(p))?o[f]=c:o.push(p)}}else r.map&&n--},this.items.length,0),new p(r.from(o.reverse()),i)}}p.empty=new p(r.empty,0);class a{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new a(t.getMap().invert(),t,this.selection)}}}class c{constructor(e,t,n,r,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}let f=20;function u(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,o)=>t.push(r,o));return t}function d(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}let h=!1,m=null;function g(e){let t=e.plugins;if(m!=t){h=!1,m=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){h=!0;break}}return h}let v=new s.H$("history"),y=new s.H$("closeHistory");function w(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new s.Sy({key:v,state:{init:()=>new c(p.empty,p.empty,null,0,-1),apply:(t,n,r)=>(function(e,t,n,r){let o=n.getMeta(v),i;if(o)return o.historyState;n.getMeta(y)&&(e=new c(e.done,e.undone,null,0,-1));let l=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(l&&l.getMeta(v))return l.getMeta(v).redo?new c(e.done.addTransform(n,void 0,r,g(t)),e.undone,u(n.mapping.maps),e.prevTime,e.prevComposition):new c(e.done,e.undone.addTransform(n,void 0,r,g(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||l&&!1===l.getMeta("addToHistory"))return(i=n.getMeta("rebased"))?new c(e.done.rebased(n,i),e.undone.rebased(n,i),d(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new c(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),d(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let o=n.getMeta("composition"),i=0==e.prevTime||!l&&e.prevComposition!=o&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)}),n}(n,e.prevRanges)),s=l?d(e.prevRanges,n.mapping):u(n.mapping.maps);return new c(e.done.addTransform(n,i?t.selection.getBookmark():void 0,r,g(t)),p.empty,s,n.time,null==o?e.prevComposition:o)}})(n,r,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?k:"historyRedo"==n?b:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}function C(e,t){return(n,r)=>{let o=v.getState(n);if(!o||0==(e?o.undone:o.done).eventCount)return!1;if(r){let i=function(e,t,n){let r=g(t),o=v.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,r);if(!i)return null;let l=i.selection.resolve(i.transform.doc),s=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),o,r),p=new c(n?s:i.remaining,n?i.remaining:s,null,0,-1);return i.transform.setSelection(l).setMeta(v,{redo:n,historyState:p})}(o,n,e);i&&r(t?i.scrollIntoView():i)}return!0}}let k=C(!1,!0),b=C(!0,!0);function x(e){let t=v.getState(e);return t?t.done.eventCount:0}function M(e){let t=v.getState(e);return t?t.undone.eventCount:0}C(!1,!1),C(!0,!1)},71307:function(e,t,n){n.d(t,{Hw:function(){return l},S0:function(){return a},VK:function(){return i},dU:function(){return p},zK:function(){return c}});var r=n(60314),o=n(70348);class i{constructor(e,t,n={}){this.match=e,this.match=e,this.handler="string"==typeof t?function(e,n,r,o){let i=t;if(n[1]){let e=n[0].lastIndexOf(n[1]);i+=n[0].slice(e+n[1].length);let t=(r+=e)-o;t>0&&(i=n[0].slice(e-t,e)+i,r=o)}return e.tr.insertText(i,r,o)}:t,this.undoable=!1!==n.undoable,this.inCode=n.inCode||!1}}function l({rules:e}){let t=new r.Sy({state:{init:()=>null,apply(e,t){return e.getMeta(this)||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:(n,r,o,i)=>s(n,r,o,i,e,t),handleDOMEvents:{compositionend:n=>{setTimeout(()=>{let{$cursor:r}=n.state.selection;r&&s(n,r.pos,r.pos,"",e,t)})}}},isInputRules:!0});return t}function s(e,t,n,r,o,i){if(e.composing)return!1;let l=e.state,s=l.doc.resolve(t),p=s.parent.textBetween(Math.max(0,s.parentOffset-500),s.parentOffset,null,"￼")+r;for(let a=0;a<o.length;a++){let c=o[a];if(s.parent.type.spec.code){if(!c.inCode)continue}else if("only"===c.inCode)continue;let f=c.match.exec(p),u=f&&c.handler(l,f,t-(f[0].length-r.length),n);if(u)return c.undoable&&u.setMeta(i,{transform:u,from:t,to:n,text:r}),e.dispatch(u),!0}return!1}let p=(e,t)=>{let n=e.plugins;for(let r=0;r<n.length;r++){let o=n[r],i;if(o.spec.isInputRules&&(i=o.getState(e))){if(t){let n=e.tr,r=i.transform;for(let e=r.steps.length-1;e>=0;e--)n.step(r.steps[e].invert(r.docs[e]));if(i.text){let t=n.doc.resolve(i.from).marks();n.replaceWith(i.from,i.to,e.schema.text(i.text,t))}else n.delete(i.from,i.to);t(n)}return!0}}return!1};function a(e,t,n=null,r){return new i(e,(e,i,l,s)=>{let p=n instanceof Function?n(i):n,a=e.tr.delete(l,s),c=a.doc.resolve(l).blockRange(),f=c&&(0,o.nd)(c,t,p);if(!f)return null;a.wrap(c,f);let u=a.doc.resolve(l-1).nodeBefore;return u&&u.type==t&&(0,o.Mn)(a.doc,l-1)&&(!r||r(i,u))&&a.join(l-1),a})}function c(e,t,n=null){return new i(e,(e,r,o,i)=>{let l=e.doc.resolve(o),s=n instanceof Function?n(r):n;return l.node(-1).canReplaceWith(l.index(-1),l.indexAfter(-1),t)?e.tr.delete(o,i).setBlockType(o,o,t,s):null})}new i(/--$/,"—"),new i(/\.\.\.$/,"…"),new i(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),new i(/"$/,"”"),new i(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),new i(/'$/,"’")},80326:function(e,t,n){n.d(t,{$:function(){return p},h:function(){return s}});var r=n(21865),o=n(60314);let i="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function l(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function s(e){return new o.Sy({props:{handleKeyDown:p(e)}})}function p(e){let t=function(e){let t=Object.create(null);for(let n in e)t[function(e){let t,n,r,o,l=e.split(/-(?!$)/),s=l[l.length-1];"Space"==s&&(s=" ");for(let e=0;e<l.length-1;e++){let s=l[e];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))i?o=!0:n=!0;else throw Error("Unrecognized modifier name: "+s)}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}(n)]=e[n];return t}(e);return function(e,n){let o=(0,r.YG)(n),i,s=t[l(o,n)];if(s&&s(e.state,e.dispatch,e))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){let r=t[l(o,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.shiftKey||n.altKey||n.metaKey||o.charCodeAt(0)>127)&&(i=r.ue[n.keyCode])&&i!=o){let r=t[l(i,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}}}]);
//# sourceMappingURL=5458.758d15b6f3cb9dd1.js.map