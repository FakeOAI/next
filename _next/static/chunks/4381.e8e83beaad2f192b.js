"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4381,8539],{95638:function(e,t,a){a.d(t,{Z:function(){return l}});var n=a(24421),i=a(67629),s=a(51516);function l(e,t){(0,s.Z)(2,arguments);var a=(0,i.Z)(e),l=(0,i.Z)(t);return Math.round((a.getTime()-(0,n.Z)(a)-(l.getTime()-(0,n.Z)(l)))/864e5)}},26430:function(e,t,a){a.d(t,{Z:function(){return s}});var n=a(28734),i=a(51516);function s(e,t){return(0,i.Z)(2,arguments),(0,n.Z)(e).getTime()-(0,n.Z)(t).getTime()}},21508:function(e,t,a){a.d(t,{Z:function(){return s}});var n=a(28734),i=a(51516);function s(e){(0,i.Z)(1,arguments);var t=(0,n.Z)(e);return t.setHours(23,59,59,999),t}},60804:function(e,t,a){a.r(t),a.d(t,{default:function(){return F}});var n,i=a(2346),s=a(98601),l=a(17247),r=a(47563),o=a(93951),c=a(92745),d=a(31498),u=a(15913),f=a(92379),x=a(58695),m=a(99976),p=a(61619),j=a(82363),h=a(19841),v=a(88600),b=a(21389),y=a(62984),g=a(15478),w=a(97537),k=a(73062),N=a(30853),O=a(3430),Z=a(17004),E=a(39995),z=a(59122),A=a(1313),M=a(94925),D=a(57575),I=a(44851),_=a(93561),C=a(88521),P=a(17007),S=a(651);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach(function(t){(0,s.Z)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function F(e){let{visualization:t,clientThreadId:a,expanded:n=!1}=e;return"chart"===t.type?null==t.fallback_image?(j.U.addError("Chart visualizations require a fallback image message"),null):t.fallback_to_image?null==t.fallback_image?(j.U.addError("No fallback image message provided for fallback chart"),null):(0,S.jsx)(Q,{visualization:t,expanded:n}):(0,S.jsx)(q,{visualization:t,clientThreadId:a,expanded:n}):"table"===t.type?(0,S.jsx)(G,{visualization:t,expanded:n}):(j.U.addError("Unsupported visualization type",t.type),null)}function G(e){let t,{visualization:a,expanded:n}=e,i=(0,Z.E)(),s=i&&!n,{isLoading:l,data:r,isError:o}=(0,C.CJ)(a),{0:c,1:d}=(0,f.useState)(),u=(0,f.useCallback)(()=>{r&&(0,P.W)(r.download_url)},[r]),{0:x,1:m}=(0,f.useState)(0),{0:p,1:j}=(0,f.useState)(0),h=(0,f.useRef)(null);if(r){if(Array.isArray(r.content)){var v;t=null!==(v=r.content.find(e=>e.name===c))&&void 0!==v?v:r.content[0]}else t=r.content}let b=()=>{h.current&&j(h.current.offsetWidth)};return((0,f.useEffect)(()=>(b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)),[]),(0,f.useEffect)(()=>{let e=()=>{m(window.innerHeight-48)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),o)?(0,S.jsx)(B,{fileName:a.title}):(0,S.jsx)(U,{ref:h,focusObject:{type:E.zG.ADAVisualization,visualization:a},title:(0,S.jsxs)(S.Fragment,{children:[a.title,!s&&Array.isArray(null==r?void 0:r.content)&&(0,S.jsxs)(k.Z.Root,{defaultValue:c,onValueChange:e=>{d(e)},children:[(0,S.jsxs)(k.Z.Trigger,{className:"m-0 h-4 bg-transparent p-1 text-xs font-semibold",children:[null!=c?c:r.content[0].name,(0,S.jsx)(k.Z.Icon,{})]}),(0,S.jsx)(k.Z.Portal,{children:(0,S.jsx)(k.Z.Content,{children:r.content.map(e=>{var t;return(0,S.jsx)(k.Z.Item,{className:"text-xs font-semibold",value:null!==(t=e.name)&&void 0!==t?t:"",children:e.name},e.name)})})})]})]}),onDownload:u,expanded:n,children:l||null==t?(0,S.jsx)("div",{className:"flex w-full items-center justify-center",children:(0,S.jsx)(w.Z,{})}):(0,S.jsx)("div",{className:"border-t border-token-border-light",children:(0,S.jsx)(M.Z,{table:V(V({},t),{},{name:a.title,sheetName:c}),height:n?x:300,width:p,isInFocusedView:i})})})}function L(e){let{showStatic:t,setShowStatic:a}=e;return(0,S.jsx)(N.u,{side:"top",sideOffset:4,label:t?(0,S.jsx)(y.Z,{id:"o0thnT",defaultMessage:"Switch to interactive chart"}):(0,S.jsx)(y.Z,{id:"cigiQO",defaultMessage:"Switch to static chart"}),children:(0,S.jsx)("button",{className:"flex",onClick:()=>{a(!t)},children:t?(0,S.jsx)(r.aoh,{className:"icon-md text-token-text-tertiary hover:text-token-text-primary"}):(0,S.jsx)(r.D2w,{className:"icon-md text-token-text-tertiary hover:text-token-text-primary"})})})}function R(e){let{type:t}=e;return(0,S.jsx)(W,{children:"chart"===t?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(y.Z,{id:"XBhWwK",defaultMessage:"Now interactive! (Beta)"})," ",(0,S.jsx)(r.D2w,{className:"icon-md"})]}):(0,S.jsx)(y.Z,{id:"N0TMRs",defaultMessage:"Now interactive!"})})}let W=g.Z.div(n||(n=(0,i.Z)(["flex flex-shrink-0 cursor-pointer flex-nowrap items-center gap-1 rounded-lg bg-blue-selection/[0.1] py-1 pl-2 pr-1.5 text-xs font-semibold text-blue-selection"])));function q(e){let{visualization:t,clientThreadId:a,expanded:n}=e,{isLoading:i,data:s,isError:l}=(0,C.VX)(t),r=(0,f.useRef)(null),u=(0,d.aF)(),j=(0,o.t)(),h=j&&u&&!(0,x.yl)(u)&&j.isEnterprise(),{0:v,1:b}=(0,f.useState)(!h),y=(0,f.useCallback)(async()=>{if(v&&t.fallback_image)m.A.logEvent(p.M.adaDownloadedStaticChart),await (0,P.d)(t.fallback_image);else if(r.current){let e=r.current.getBase64Image();e&&(m.A.logEvent(p.M.adaDownloadedInteractiveChart),(0,P.W)(e,"".concat(t.title,".png")))}},[t.fallback_image,v,r,t.title]),{0:g,1:k}=(0,f.useState)(void 0),N=(0,c.XK)(a),O=function(e){let t=(0,f.useRef)(!1);return()=>{t.current||(e(),t.current=!0)}}(()=>{m.A.logEvent(p.M.adaToggledInteractiveChart,{conversationId:N})});return((0,f.useEffect)(()=>{m.A.logEvent(p.M.adaInteractiveChartShown)},[]),(0,f.useEffect)(()=>{if(s&&s.content!==g){let{chart_type:e,datasets:t,labels:a}=s.content,n=s.content;n.datasets=t.map((t,a)=>{let n=(0,I.i)(e,t,a);return V(V({},t),{},{colors:n})}),n.labels=Array.isArray(a)?a:[a],k(n)}},[g,s]),l)?(0,S.jsx)(B,{fileName:t.title}):(0,S.jsx)(U,{focusObject:{type:E.zG.ADAVisualization,visualization:t},title:t.title,onDownload:y,additionalActions:[(0,S.jsx)(L,{showStatic:v,setShowStatic:e=>{O(),b(e)}},0),(0,S.jsx)(D.t,{chartData:g,setChartData:k},1)],expanded:n,children:i||null==g?(0,S.jsx)("div",{className:"flex w-full items-center justify-center",children:(0,S.jsx)(w.Z,{})}):v&&t.fallback_image?(0,S.jsx)(z.Z,{jupyterMessage:t.fallback_image}):(0,S.jsx)(A.Z,{ref:r,chart:g})})}function Q(e){let{visualization:t,expanded:a}=e,{0:n,1:i}=(0,f.useState)(!1),s=(0,C.BR)(),r=(0,f.useCallback)(async()=>{t.fallback_image&&await (0,P.d)(t.fallback_image)},[t.fallback_image]);return null==t.fallback_image?null:(0,S.jsx)(U,{focusObject:{type:E.zG.ADAVisualization,visualization:t},title:t.title,onDownload:r,expanded:a,children:(0,S.jsx)("div",{className:(0,h.default)("h-full w-full",a&&"cursor-pointer items-center justify-center"),onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:(0,S.jsxs)("div",{className:(0,h.default)("relative flex h-full cursor-pointer items-center justify-center",!a&&"w-full"),children:[(0,S.jsx)(z.Z,{jupyterMessage:t.fallback_image}),s&&(0,S.jsx)(l.$,{isHovered:n})]})})})}let U=f.forwardRef((e,t)=>{var a;let{focusObject:n,title:i="",onDownload:s=()=>{},additionalActions:l=[],expanded:c=!1,children:d}=e,f=(0,Z.E)(),x=(0,E.rE)(),m=x&&x.type===E.zG.ADAVisualization&&x.type===n.type&&x.visualization.file_id===n.visualization.file_id&&n.visualization.title===x.visualization.title,p=(0,o.t)(),j=n.visualization.type,[g,w]=(0,C.qc)(j,null!==(a=null==p?void 0:p.id)&&void 0!==a?a:""),k=(0,u.BL)(),z=n.visualization.type,{sourceUrl:A,contextConnectorName:M}=(0,_.W)(n.visualization);if(f&&!c||k)return(0,S.jsx)(X,{focusObject:n,title:i,type:z,isFocused:null!=m&&m,disabled:k});let D=(0,S.jsxs)(S.Fragment,{children:[l.map((e,t)=>(0,S.jsx)("div",{className:"flex p-0",children:e},t)),A&&M&&(0,S.jsx)(N.u,{side:"top",sideOffset:4,label:(0,S.jsx)(y.Z,{id:"KG958Q",defaultMessage:"Open in {contextConnectorName}",values:{contextConnectorName:M}}),children:(0,S.jsx)("a",{className:"flex items-center text-xs",href:A,target:"_blank",children:(0,S.jsx)(r.Pfi,{className:(0,h.default)("icon-md text-token-text-tertiary hover:text-token-text-primary")})})}),s&&(0,S.jsx)(N.u,{side:"top",sideOffset:4,label:(0,S.jsx)(y.Z,{id:"X0SJIT",defaultMessage:"Download {type}",values:{type:z}}),children:(0,S.jsx)("button",{onClick:s,className:"flex items-center text-xs",children:(0,S.jsx)(r._8t,{className:(0,h.default)("icon-md text-token-text-tertiary hover:text-token-text-primary")})})}),(0,S.jsx)(N.u,{side:"top",sideOffset:4,label:m?(0,S.jsx)(y.Z,{id:"vilGuu",defaultMessage:"Collapse {type}",values:{type:z}}):(0,S.jsx)(y.Z,{id:"7kLyF5",defaultMessage:"Expand {type}",values:{type:z}}),children:(0,S.jsx)("button",{onClick:()=>{H(null!=m&&m,n)},className:"flex items-center text-xs",children:m?(0,S.jsx)(r.W5x,{className:(0,h.default)("icon-md text-token-text-tertiary hover:text-token-text-primary")}):(0,S.jsx)(r.Qq,{className:(0,h.default)("icon-md text-token-text-tertiary hover:text-token-text-primary")})})})]});return(0,S.jsxs)(v.E.div,V(V({className:(0,h.default)("relative overflow-hidden border-token-border-light text-token-text-primary",!c&&"rounded-2xl border"),ref:t,onMouseEnter:()=>{w(!0)}},O.ee),{},{children:[(0,S.jsxs)("div",{className:(0,h.default)("flex items-center justify-between gap-2 bg-token-main-surface-primary px-4 py-3"),children:[(0,S.jsx)("span",{className:"flex-grow items-center truncate font-semibold capitalize",children:i}),(0,S.jsxs)("div",{className:"flex items-center gap-3",children:[(0,S.jsx)(b.M,{children:!g&&(0,S.jsx)(v.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",ease:"easeInOut",duration:.2},className:"absolute right-3 top-3",children:(0,S.jsx)(R,{type:z})})}),g&&D]})]}),(0,S.jsx)("div",{className:"flex items-center justify-center bg-token-main-surface-primary",style:{height:c?"calc(100vh - 48px)":"".concat("table"===z?300:350,"px")},children:d})]}))});function X(e){let{focusObject:t,title:a="",type:n,isFocused:i,disabled:s=!1}=e,{0:l,1:o}=(0,f.useState)(!1),c="chart"===n?r.X5Q:r.tXQ,d=i||l||s;return(0,S.jsx)(v.E.div,V(V({className:(0,h.default)("relative w-52 overflow-hidden rounded-2xl border",i&&"border-blue-selection/[.3]",d?"text-token-text-primary":"text-token-text-secondary",!s&&"cursor-pointer"),onMouseEnter:()=>{s||o(!0)},onMouseLeave:()=>{s||o(!1)},onClick:()=>{s||H(i,t)}},O.ee),{},{children:(0,S.jsxs)("div",{className:"flex justify-between bg-token-main-surface-primary px-3 py-2",children:[(0,S.jsxs)("div",{className:"my-0 flex w-full items-center gap-2 overflow-hidden text-sm font-semibold capitalize",children:[(0,S.jsx)(c,{className:(0,h.default)("icon-lg flex-shrink-0",d?"text-brand-green-800":"text-token-text-quaternary")}),(0,S.jsx)("span",{className:"flex-grow truncate",children:a})]}),l&&(0,S.jsx)("div",{className:"flex items-center gap-2",children:(0,S.jsx)(N.u,{side:"top",sideOffset:4,label:i?(0,S.jsx)(y.Z,{id:"vilGuu",defaultMessage:"Collapse {type}",values:{type:n}}):(0,S.jsx)(y.Z,{id:"7kLyF5",defaultMessage:"Expand {type}",values:{type:n}}),children:i?(0,S.jsx)(r.W5x,{className:"icon-md icon-md text-token-text-secondary"}):(0,S.jsx)(r.Qq,{className:(0,h.default)("icon-md text-token-text-secondary")})})})]})}))}function B(e){let{fileName:t=""}=e;return(0,S.jsx)("div",{className:"w-full rounded-2xl border border-red-600 p-3",children:(0,S.jsxs)("div",{className:"my-0 flex items-center justify-between",children:[(0,S.jsx)("div",{className:"flex items-center gap-2",children:(0,S.jsx)("p",{className:"m-0 p-0 text-lg font-semibold capitalize",children:t})}),(0,S.jsx)("span",{className:"text-sm text-red-600",children:(0,S.jsx)(y.Z,{id:"ADAVisualzationComponent.unableToLoadOutput",defaultMessage:"Unable to display visualization"})})]})})}U.displayName="ADAVisualizationWrapper";let H=(e,t)=>{m.A.logEvent(p.M.adaFocusModeToggled),e?E.RT.close():E.RT.setFocusedObject(t)}},3430:function(e,t,a){a.d(t,{Jw:function(){return f},ZP:function(){return m},ee:function(){return x}});var n=a(98601),i=a(32242),s=a(21389),l=a(88600),r=a(60825),o=a(17004),c=a(651);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach(function(t){(0,n.Z)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}let f=450,x={transition:{type:"spring",stiffness:300,damping:30,mass:1},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}};function m(e){let{children:t,clientThreadId:a,isOpen:n,onClose:d}=e;return(0,c.jsx)(s.M,{children:n&&(0,c.jsx)(i.f,{children:(0,c.jsx)(o.P.Provider,{value:{isEmbeddedInFocusedView:!0},children:(0,c.jsxs)("div",{className:"absolute inset-0 flex flex-col",children:[(0,c.jsx)(l.E.div,u({className:"h-full w-full bg-token-main-surface-secondary"},x)),(0,c.jsxs)("div",{className:"absolute inset-0 flex",children:[(0,c.jsx)("div",{className:"flex-grow overflow-auto",children:t}),(0,c.jsx)(l.E.div,u(u({className:"relative shrink-0 border-l border-token-border-medium bg-token-main-surface-primary",style:{width:f}},x),{},{children:(0,c.jsx)("div",{className:"h-[100vh] pb-4",children:(0,c.jsx)(r.Z,{clientThreadId:a,hideHeader:!0,hideFooter:!0,hideToolsOverlay:!0,messagesVerticalAlign:"bottom"},a)})}))]})]})})})})}},39995:function(e,t,a){a.d(t,{RT:function(){return p},qN:function(){return j},rE:function(){return m},zG:function(){return f}});var n,i=a(38482),s=a.n(i),l=a(92379),r=a(68810),o=a(3430),c=a(651);let d=s()(()=>a.e(2123).then(a.bind(a,32123)),{loadableGenerated:{webpack:()=>[32123]}}),u=s()(()=>Promise.all([a.e(8690),a.e(1085)]).then(a.bind(a,41085)).then(e=>e.ImageEditor),{loadableGenerated:{webpack:()=>[41085]}}),f=((n={})[n.ADAVisualization=0]="ADAVisualization",n[n.Image=1]="Image",n),x=(0,r.Ue)(()=>({focusedObject:null}));function m(){return x(e=>e.focusedObject)}let p={setFocusedObject:e=>{x.setState({focusedObject:e})},close(){x.setState({focusedObject:null})}};function j(e){let t,{clientThreadId:a}=e,n=m();return(0,l.useEffect)(()=>{p.close()},[a]),(null==n?void 0:n.type)===f.ADAVisualization?t=(0,c.jsx)(d,{clientThreadId:a,visualization:n.visualization}):(null==n?void 0:n.type)===f.Image&&(t=(0,c.jsx)(u,{clientThreadId:a,messageId:n.messageId,image:n.image,allImages:n.allImages},n.image.asset_pointer)),(0,c.jsx)(o.ZP,{clientThreadId:a,isOpen:null!=n,onClose:p.close,children:t})}}}]);
//# sourceMappingURL=4381.e8e83beaad2f192b.js.map