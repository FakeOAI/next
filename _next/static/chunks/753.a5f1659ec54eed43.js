"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[753],{50753:function(e,t,s){s.r(t),s.d(t,{SystemHintSuggestor:function(){return v}});var n=s(92379),a=s(50863),r=s(36348),c=s(11433),l=s(2721),i=s(84760),u=s(19841),o=s(25009),d=s(651);let m=e=>{let{svgString:t,className:s}=e,n=(0,d.jsx)("div",{className:s});return(0,d.jsx)(o.S,{name:"StringToSVG",fallback:n,children:(0,d.jsx)("div",{className:(0,u.default)("[&_svg]:h-full [&_svg]:w-full",s),dangerouslySetInnerHTML:{__html:t}})})};var f=s(67437),x=s(17167),h=s(91399);function p(e){let{composerController:t,clientThreadId:s}=e,r=function(e){let t=(0,i.a)({queryKey:["system-hints"],queryFn:async()=>(await l.Z.getSystemHints()).system_hints.map(e=>{let{name:t,description:s,logo:n,system_hint:a,required_features:r=[]}=e;return{name:t,description:s,logo:n,systemHint:a,requiredFeatures:r}}),select:void 0,staleTime:1/0}),s=(0,f.Xy)(e),a=(0,n.useMemo)(()=>t.isSuccess&&t.data?t.data:[],[t.data,t.isSuccess]);return(0,n.useMemo)(()=>{let e=new Set(s.enabledTools||[]);return a.filter(t=>!t.requiredFeatures.length||t.requiredFeatures.every(t=>e.has(t)))},[a,s])}(s),{0:c,1:u}=(0,n.useState)([]),{0:o,1:p}=(0,n.useState)(void 0),{0:v,1:y}=(0,n.useState)(0);(0,n.useEffect)(()=>{o?u(r.filter(e=>e.name.toLowerCase().includes(o.text.toLowerCase()))):u([])},[o,r]);let w=t.useState(e=>e.getSystemHints().length>0);(0,n.useEffect)(()=>{t.view.dispatch(t.view.state.tr.setMeta(h.o4,{onHintMatch:e=>{p(t=>t&&e&&t.text===e.text&&t.range.from===e.range.to&&t.range.to?t:e)}}))},[t]);let j=w||!r.length||!c.length||!o;(0,n.useEffect)(()=>{j&&y(0)},[j]);let S=c.length,k=(0,n.useCallback)(e=>{y(t=>(e(t)%S+S)%S)},[S]),N=c[v],_=e=>{let{hintToSave:s=N,expectPerfectMatch:n,appendSpace:a=!0}=e;o&&N&&(!n||s.name.toLowerCase()===o.text.toLowerCase())&&((0,h.vt)(t.view,{id:s.systemHint,hint:s.name},o.range,a),(0,x.am)(t.view))},C=(0,n.useRef)(_);C.current=_;let M=(0,n.useRef)(k);M.current=k,(0,n.useRef)(o).current=o;let b=t.view;return((0,n.useEffect)(()=>(j||(0,x.$b)(b,e=>{"up"===e?M.current(e=>e-1):"down"===e?M.current(e=>e+1):"cancel"===e?(0,x.am)(b):"submit"===e?(C.current({expectPerfectMatch:!1}),(0,x.am)(b)):"checkMatch"===e&&C.current({expectPerfectMatch:!0,appendSpace:!1})}),()=>(0,x.am)(b)),[j,b]),j)?null:(0,d.jsx)(a.w5,{className:"max-w-60",children:c.map((e,s)=>(0,d.jsx)("div",{children:(0,d.jsx)(a.gG,{autoFocus:!1,className:"rounded-xl px-1 py-2",spoofHovered:s===v,onMouseOver:()=>y(s),onClick:()=>{_({hintToSave:e,expectPerfectMatch:!1}),t.focus()},children:(0,d.jsx)(g,{title:e.name,description:e.description,icon:(0,d.jsx)(m,{svgString:e.logo,className:"icon-lg text-token-text-secondary"}),checked:!1})})},e.systemHint))})}function g(e){let{title:t,description:s,icon:n,onClick:a,checked:r}=e;return(0,d.jsxs)("div",{className:"inline-flex w-full items-center justify-start gap-1.5 pl-1.5 pr-3",onClick:a,children:[(0,d.jsx)("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:n}),(0,d.jsxs)("div",{className:"shrink grow basis-0",children:[(0,d.jsxs)("span",{className:"text-sm font-normal leading-tight text-token-text-primary",children:[t,(0,d.jsx)("br",{})]}),!!s&&(0,d.jsx)("span",{className:"text-[13px] font-normal leading-[18px] text-token-text-secondary",children:s})]}),r&&(0,d.jsx)(c.kvR,{className:(0,u.default)("icon-md text-token-text-primary",{"group-hover:hidden":!r})})]})}function v(e){let{composerController:t,clientThreadId:s}=e;return t instanceof r.F?(0,d.jsx)(p,{composerController:t,clientThreadId:s}):null}}}]);
//# sourceMappingURL=753.a5f1659ec54eed43.js.map