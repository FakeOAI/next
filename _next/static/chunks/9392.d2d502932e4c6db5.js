"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9392],{75290:function(e,t,a){a.d(t,{RT:function(){return l},rE:function(){return s}});let i=(0,a(68810).Ue)(()=>({focusedObject:null}));function s(){return i(e=>e.focusedObject)}let l={setFocusedObject:e=>{i.setState({focusedObject:e})},close(){i.setState({focusedObject:null})}}},81652:function(e,t,a){var i;a.d(t,{z:function(){return s}});let s=((i={})[i.ADAVisualization=0]="ADAVisualization",i[i.Image=1]="Image",i)},79392:function(e,t,a){a.r(t),a.d(t,{default:function(){return ei}});var i,s,l=a(98601),n=a(19841),r=a(49764),o=a(47584),d=a(15478),c=a(16757),u=a(11550),g=a(15913),m=a(66583);a(52455);var f=a(21389),h=a(88600),x=a(92379),p=a(11433),b=a(651),v=((i=v||{})[i.Left=-1]="Left",i[i.Right=1]="Right",i[i.None=0]="None",i);let j={enter:e=>({zIndex:0,x:e===v.Left?"10%":"-10%",opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:e=>({zIndex:0,x:e===v.Right?"10%":"-10%",opacity:0})},y={enter:{opacity:0,y:"10%"},visible:{opacity:1,y:0},exit:{opacity:0,y:"10%"}},w=(e,t)=>Math.abs(e)*t;function I(e){let t=(0,r.Z)(),a=(0,g.dQ)(),i=[g._G.Small,g._G.Mobile].includes(a),{0:s,1:l}=(0,x.useState)({width:0,height:0}),{0:o,1:d}=(0,x.useState)(!1),{0:c,1:I}=(0,x.useState)(e.image),{0:k,1:E}=(0,x.useState)(!1),_=s.width>0&&s.height>0,N=(0,x.useRef)(null),{0:C,1:O}=(0,x.useState)(v.None);function S(){I(t=>{let a=(e.images.findIndex(e=>e.url===t.url)+1)%e.images.length;return e.images[a]}),O(v.Left)}function A(){I(t=>{let a=e.images.findIndex(e=>e.url===t.url),i=a>0?(a-1)%e.images.length:e.images.length-1;return e.images[i]}),O(v.Right)}function L(e){"ArrowLeft"===e.key?A():"ArrowRight"===e.key&&S()}(0,x.useEffect)(()=>{if(!c.url)throw Error("ExpandableImage requires a src");let e=new Image;e.onload=()=>{l({width:e.naturalWidth,height:e.naturalHeight})},e.onerror=()=>{},e.src=c.url},[c.url]),(0,x.useEffect)(()=>{let t=N.current;if(k)return t?.addEventListener("keydown",L),()=>{t?.removeEventListener("keydown",L)};I(e.image)},[k]);let z=e.images.findIndex(e=>e.url===c.url);return(0,b.jsxs)(m.fC,{onOpenChange:function(t){E(t),t&&e.onOpen?.(c)},children:[(0,b.jsx)(m.xz,{disabled:!_,className:e.className,"aria-label":t.formatMessage(M.showImage),children:e.children}),(0,b.jsx)(m.h_,{children:(0,b.jsx)(m.aV,{className:"fixed inset-0 flex items-center justify-center bg-black/90 backdrop-blur-xl radix-state-open:animate-show",children:(0,b.jsxs)(m.VY,{className:(0,n.default)("relative flex h-[100dvh] w-screen justify-stretch divide-x divide-white/10 focus:outline-none radix-state-open:animate-contentShow"),ref:N,children:[(0,b.jsx)("div",{className:(0,n.default)("flex flex-1 transition-[flex-basis]",!o&&"md:basis-[75vw]"),children:(0,b.jsxs)("div",{className:"flex flex-1 flex-col md:p-6",children:[(0,b.jsxs)("div",{className:"flex justify-between px-6 py-2 pt-6 text-white sm:mb-4 md:mt-2 md:px-0 md:py-2",children:[(0,b.jsx)(m.x8,{asChild:!0,children:(0,b.jsx)("button",{"aria-label":t.formatMessage(M.closeModal),children:(0,b.jsx)(p.tPq,{})})}),(0,b.jsx)("div",{children:!i&&(0,b.jsxs)(b.Fragment,{children:[e.getActions?.(c)?.map((e,t)=>b.jsx(u.z,{color:"ghost",size:"small",onClick:e.onClick,"aria-label":e.ariaLabel,disabled:e.disabled,icon:e.icon},t)),(0,b.jsx)(u.z,{color:"ghost",size:"small",onClick:()=>d(e=>!e),"aria-label":t.formatMessage(M.toggleSidebar),className:"md:inline-flex",icon:p.szr})]})})]}),(0,b.jsx)("div",{className:"relative flex flex-1 flex-col items-center justify-center overflow-hidden",children:(0,b.jsx)(f.M,{initial:!1,custom:C,children:(0,b.jsxs)(h.E.div,{className:"absolute grid h-full w-full grid-rows-2",custom:C,variants:j,drag:"x",dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(e,t)=>{let{offset:a,velocity:i}=t,s=w(a.x,i.x);s<-1e3?S():s>1e3&&A()},children:[(0,b.jsx)(h.E.img,{src:c.url,alt:c.alt,className:"row-span-4 mx-auto h-full object-scale-down",onPanEnd:(e,t)=>{let{offset:a,velocity:i}=t,s=w(a.y,i.y);s<-1e3?d(!0):s>1e3&&d(!1)}},c.url),i&&o&&(0,b.jsx)(h.E.div,{className:"flex text-white",variants:y,initial:"enter",animate:"visible",exit:"exit",transition:{y:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2}},children:e.metadataRenderer(c)})]},c.url)})}),e.images.length>1?(0,b.jsxs)("div",{className:"flex items-center justify-center gap-4 p-8 text-white",children:[(0,b.jsx)(u.z,{color:"ghost",size:"small",onClick:A,"aria-label":t.formatMessage(M.previousImage),icon:p.Y4O}),e.images.map((e,a)=>(0,b.jsx)("img",{src:e.url,alt:e.alt??"",className:(0,n.default)("h-12 w-12 cursor-pointer rounded object-cover transition duration-300 hover:opacity-100",e.url===c.url?"ring-2 ring-white ring-offset-4 ring-offset-black":"opacity-25"),onClick:()=>{I(e),O(a<z?v.Right:v.Left)},"aria-label":t.formatMessage(M.showImage),role:"button"},e.url)),(0,b.jsx)(u.z,{color:"ghost",size:"small",onClick:S,"aria-label":t.formatMessage(M.nextImage),icon:p.LZ3})]}):null]})}),(0,b.jsx)("div",{className:(0,n.default)("hidden items-center justify-start overflow-hidden bg-gray-900 text-white transition-[flex-basis] duration-500 md:flex",o?"md:basis-[25vw]":"md:basis-0"),children:(0,b.jsx)("div",{className:"w-[25vw] min-w-[25vw]",children:e.metadataRenderer(c)})})]})})})]})}let M=(0,o.vU)({showImage:{id:"imageViewer.showImage",defaultMessage:"Show Image"},closeModal:{id:"imageViewer.closeModal",defaultMessage:"Close Modal"},toggleSidebar:{id:"imageViewer.toggleSidebar",defaultMessage:"Toggle Sidebar"},nextImage:{id:"imageViewer.nextImage",defaultMessage:"Next Image"},previousImage:{id:"imageViewer.previousImage",defaultMessage:"Previous Image"}});var k=a(66114),E=a(17004),_=a(75290),N=a(81652),C=a(10080),O=a(92355),S=a(83747),A=a(182),L=a(27742),z=a(93951),V=a(41987),R=a(92745),D=a(31498),P=a(46900),T=a(99976),F=a(61619),G=a(79746),B=a(88667),Z=a(48382),W=a(44395);let U=new Map,$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e3,a=function(e){if("number"==typeof e)return e;let t=0;if(0===e.length)return t;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a)|0;return t}(e),{0:i,1:s}=(0,x.useState)(U.get(e)??0);return(0,x.useEffect)(()=>{let i=0,l=setInterval(()=>{i+=100,s(s=>{let n=1.5;if(i<t){let e=.1*Math.sin(a+s/100)+1;n=(1-Math.log10(1+s/10))*e}let r=s+n;return r>=100?(clearInterval(l),100):(U.set(e,r),r)})},100);return()=>{clearInterval(l),U.delete(e)}},[a,e,t]),i};var X=a(38482);let q=a.n(X)()(()=>Promise.all([a.e(3656),a.e(3125)]).then(a.t.bind(a,63125,23)),{loadableGenerated:{webpack:()=>[63125]}});function Q(e){let t=e.matchTextColor??!0,a=(0,x.useRef)(null),{0:i,1:s}=(0,x.useState)(null);(0,x.useEffect)(()=>{if(!a.current||!t)return;let e=()=>{a.current&&s(getComputedStyle(a.current).color)},i=new MutationObserver(()=>{e()});return i.observe(window.document.documentElement,{attributes:!0,attributeFilter:["class","style"]}),i.observe(a.current,{attributes:!0,attributeFilter:["class","style"]}),e(),()=>i.disconnect()},[t]);let l=(0,x.useMemo)(()=>{if(!t)return e.animationData;let a=i?.match(/\d+/g)?.map(Number).map(e=>e/255);if(!a)return null;a.push(1);let s=e.animationData;return"layers"in s&&Array.isArray(s.layers)&&s.layers.forEach(e=>{"ty"in e&&4===e.ty&&"shapes"in e&&Array.isArray(e.shapes)&&e.shapes.forEach(e=>{"it"in e&&Array.isArray(e.it)&&e.it.forEach(e=>{"fl"===e.ty&&(e.c.k=a)})})}),s},[e.animationData,i,t]);return(0,b.jsx)("div",{ref:a,className:e.className,children:(0,b.jsx)(q,{animationData:l,loop:!0,autoplay:!0},i)})}var H=a(26669);function Y(e){let{id:t,withLottie:a}=e;return(0,b.jsxs)("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full",children:[a?(0,b.jsx)(Q,{className:"h-6 w-6",animationData:H}):(0,b.jsx)(p.q$4,{className:"h-6 w-6"}),(0,b.jsx)(K,{id:t})]})}function K(e){let{id:t}=e,a=$(t);return(0,b.jsx)(W.Z,{percentage:a,thickness:1.25/23,className:"absolute left-1/2 top-1/2 h-10 w-10 -translate-x-1/2 -translate-y-1/2",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-a)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"})}var J=a(99529),ee=a(54028);function et(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function ea(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?et(Object(a),!0).forEach(function(t){(0,l.Z)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):et(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function ei(e){let{messages:t,clientThreadId:a}=e,[i,s]=t,l=(0,ee.We)(i.message),n=(0,Z.t9)(),r=t.some(e=>n.has(e.message.id)),o=null;null!=s&&P.U.isMultimodalTextMessage(s.message)&&(o=P.U.getImageAssetPointers(s.message));let d=J.X.Running;return null!=o?d=J.X.Finished:null!=s?d=J.X.Error:l&&(d=J.X.Stopped),(0,b.jsx)(b.Fragment,{children:!r&&(0,b.jsx)(el,{imageAssets:o??[],clientThreadId:a,toolStatus:d,toolMessage:s?.message,messageId:i.message.id})})}var es=((s=es||{}).WIDE="1792x1024",s.SQUARE="1024x1024",s.TALL="1024x1792",s);let el=e=>{let{imageAssets:t,clientThreadId:a,toolMessage:i,toolStatus:s,messageId:l}=e,n=(0,r.Z)(),o=(0,S.H)(t);if(i?.content.content_type===c.PX.SystemError)return null;let d=ef(t[0]),u=o.map(e=>e.data).filter(e=>null!=e),g=u.map(e=>ea(ea({},e),{},{alt:(0,A.hG)(e)})),m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return`${l}-image-${e}`};return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(em,{$numItems:o.length,className:"my-1 transition-opacity duration-300",children:[0===o.length&&s===J.X.Running&&(0,b.jsx)(er,{layoutId:"loading:placeholder",shape:d,isToolRunning:!0},"loading"),o.map((e,t)=>{let{isLoading:s,data:l,error:r}=e;if(s)return(0,b.jsx)(er,{shape:d,layoutId:m(t)},t);if(null!=r||l?.url==null)return(0,b.jsx)(ed,{layoutId:m(t),className:"text-sm text-token-text-tertiary",shape:d,children:(0,b.jsx)("div",{className:"flex min-h-full flex-col items-center justify-center gap-3 px-4 pb-5",children:n.formatMessage(eh.imageLoadError)})},t);if(i&&l){let e=ea(ea({},l),{},{alt:(0,A.hG)(l)});return(0,b.jsx)(en,{image:e,allImages:g,clientThreadId:a,toolMessage:i,index:t,onOpenImageEditor:()=>{_.RT.setFocusedObject({type:N.z.Image,image:e,allImages:u,messageId:i.id})}},t)}})]})})};function en(e){let{toolMessage:t,clientThreadId:a,allImages:i,image:s,index:l,onOpenImageEditor:n}=e,o=(0,r.Z)(),d=(0,R.XK)(a),c=(0,z.hz)(),{value:u}=(0,B.sB)("2189772492"),m=(0,g.w$)(),f=(0,L.W)(a),h=ef(s),{0:v,1:j}=(0,x.useState)({}),y=f&&"gizmo"in f?f.gizmo:void 0,w=y?.gizmo.id===C.qL,M=m&&u&&!!c?.includes(V.L0.D3Editor)&&(null==y||w||!!c?.includes(V.L0.D3EditorAllGpts));async function E(e){(0,A.HR)(e,d,t.id)}function _(e,a){j(t=>ea(ea({},t),{},{[e.asset_pointer]:a})),B.m9.logEvent(F.M.dalleImageRating,a?"like":"dislike",{liked:a?"true":"false",sourceOperation:e.metadata?.dalle?.edit_op??"none",hasParent:e.metadata?.dalle?.parent_gen_id?"true":"false"}),T.A.logEvent(F.M.dalleImageRating,{liked:a,conversationId:d,messageId:t.id,generationId:e.metadata?.dalle?.gen_id,parentGenerationId:e.metadata?.dalle?.parent_gen_id,fileId:(0,k.Iy)(e.asset_pointer),sourceOperation:e.metadata?.dalle?.edit_op})}let N=(0,b.jsx)(ec,{image:s,shape:h,rating:v[s.asset_pointer],onDownload:()=>E(s),onRate:(e,t)=>_(e,t),clientThreadId:a,layoutId:void 0});return N=M?(0,b.jsx)("div",{role:"button",onClick:n,children:N}):(0,b.jsx)(I,{image:s,images:i,metadataRenderer:e=>(0,b.jsx)(eo,{image:e}),onOpen:function(e){B.m9.logEvent("chatgpt_dalle_image_view_full",null,{sourceOperation:e.metadata?.dalle?.edit_op??"none",hasParent:e.metadata?.dalle?.parent_gen_id?"true":"false"}),T.A.logEvent(F.M.dalleImageViewFull,{conversationId:d,messageId:t.id,generationId:e.metadata?.dalle?.gen_id,parentGenerationId:e.metadata?.dalle?.parent_gen_id,fileId:(0,k.Iy)(e.asset_pointer),sourceOperation:e.metadata?.dalle?.edit_op})},getActions:function(e){let t=v[e.asset_pointer],a={label:o.formatMessage(eh.likeImage),onClick:()=>_(e,!0),disabled:!0===t,ariaLabel:o.formatMessage(eh.likeImage),icon:p.Z7j},i={label:o.formatMessage(eh.dislikeImage),onClick:()=>_(e,!1),disabled:!1===t,ariaLabel:o.formatMessage(eh.dislikeImage),icon:p.C_W};return[!1!==t&&a,!0!==t&&i,{label:o.formatMessage(eh.downloadImage),onClick:()=>E(e),ariaLabel:o.formatMessage(eh.downloadImage),icon:p._8t}].filter(Boolean)},children:N}),(0,b.jsx)("div",{className:"flex",children:N},l)}function er(e){let{shape:t,layoutId:a,isToolRunning:i=!1}=e;return(0,b.jsx)(ed,{shape:t,layoutId:a,children:(0,b.jsx)("div",{className:"flex min-h-full items-center justify-center",children:(0,b.jsx)(Y,{id:a,withLottie:i})})},"loading")}function eo(e){let{image:t}=e,a=(0,r.Z)(),{0:i,1:s}=(0,x.useState)(!1);return(0,b.jsxs)("div",{className:"flex flex-col items-start gap-3 p-6",children:[(0,b.jsx)("div",{className:"text-sm text-gray-300 sm:text-base",children:a.formatMessage(eh.imageViewerMetadataTitle)}),(0,b.jsx)("div",{className:"max-h-32 overflow-y-auto text-sm md:max-h-[80vh] md:text-lg",children:(0,A.hG)(t)}),(0,b.jsx)(u.z,{color:"primary",onClick:function(){let e=(0,A.hG)(t);s(!0),(0,G.v)(e),setTimeout(()=>{s(!1)},2e3)},disabled:i,className:"hidden sm:block",icon:p.TIy,children:i?a.formatMessage(eh.imageViewerMetadataCopyButtonCopied):a.formatMessage(eh.imageViewerMetadataCopyButton)})]})}function ed(e){let{children:t,shape:a,className:i,layoutId:s}=e;return(0,b.jsxs)(h.E.div,{layoutId:s,className:(0,n.default)("relative",i,a===es.WIDE&&"aspect-[7/4]",a===es.SQUARE&&"aspect-square max-w-[400px]",a===es.TALL&&"aspect-[4/7] max-w-xs","overflow-hidden rounded-2xl"),children:[(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-token-main-surface-secondary"}),(0,b.jsx)("div",{className:"relative h-full",children:t})]})}function ec(e){let{image:t,shape:a,rating:i,onDownload:s,onRate:l,clientThreadId:r,layoutId:o}=e,d=(0,R.h9)(),u=(0,D.ec)(D.F_.isBusinessWorkspace),g=(0,R.WA)(r),m=(0,E.E)(),f=(0,_.rE)(),h=f?.type===N.z.Image&&f.image.asset_pointer===t.asset_pointer,{url:x,width:v,height:j}=t,y=!d&&!u&&g?.kind!==c.OL.GizmoMagicCreate;return(0,b.jsxs)(ed,{shape:a,className:"group/dalle-image",layoutId:h?void 0:o,children:[(0,b.jsx)(S.sH,{alt:(0,A.hG)(t),src:x,width:v,height:j}),(0,b.jsx)("div",{className:(0,n.default)("pointer-events-none absolute inset-0 rounded-2xl shadow-[inset_0_0_0_1px_rgba(0,0,0,0.1)] dark:shadow-[inset_0_0_0_1px_rgba(255,255,255,0.1)]",h?"bg-black/50 group-hover/dalle-image:bg-black/70":"group-hover/dalle-image:bg-transparent")}),m?!h&&(0,b.jsx)("div",{className:"pointer-events-none invisible absolute right-3 top-3 text-white group-hover/dalle-image:visible",children:(0,b.jsx)(O.Qq,{})}):(0,b.jsxs)(b.Fragment,{children:[y&&(0,b.jsxs)(eu,{children:[!1!==i&&(0,b.jsx)(eg,{icon:p.Z7j,selected:!0===i,onClick:e=>{e.stopPropagation(),l(t,!0)}}),!0!==i&&(0,b.jsx)(eg,{icon:p.C_W,selected:!1===i,onClick:e=>{e.stopPropagation(),l(t,!1)}})]}),(0,b.jsx)(eu,{$rightAlign:!0,children:(0,b.jsx)(eg,{icon:p._8t,onClick:e=>{e.stopPropagation(),s()}})})]})]})}let eu=d.Z.div`invisible absolute top-3 flex gap-1 group-hover/dalle-image:visible
${e=>{let{$rightAlign:t}=e;return t?"right-3":"left-3"}}`;function eg(e){let{icon:t,selected:a,onClick:i}=e;return(0,b.jsx)("button",{className:(0,n.default)("flex h-8 w-8 items-center justify-center rounded",a?"bg-gray-100":"bg-black/50 hover:opacity-70"),onClick:i,disabled:a,children:(0,b.jsx)(t,{className:(0,n.default)("icon-md",a?"text-gray-700":"text-white")})})}let em=d.Z.div`grid gap-2
${e=>{let{$numItems:t}=e;return t<=1?"grid-cols-1":"grid-cols-2"}}`;function ef(e){if(!e)return es.SQUARE;let{width:t,height:a}=e;return t>a?es.WIDE:t<a?es.TALL:es.SQUARE}let eh=(0,o.vU)({creatingImages:{id:"dalleMessage.creatingImagesV2",defaultMessage:"Creating image"},stopped:{id:"dalleMessage.stoppedV3",defaultMessage:"Stopped creating image"},errorCreating:{id:"dalleMessage.errorCreatingV2",defaultMessage:"Error creating image"},imageLoadError:{id:"dalleMessage.imageLoadError",defaultMessage:"Error loading image"},imageViewerMetadataTitle:{id:"dalleMessage.imageViewerMetadataTitle",defaultMessage:"Prompt"},imageViewerMetadataCopyButton:{id:"dalleMessage.imageViewerMetadataCopyButton",defaultMessage:"Copy"},imageViewerMetadataCopyButtonCopied:{id:"dalleMessage.imageViewerMetadataCopyButtonCopied",defaultMessage:"Copied!"},imageEditButton:{id:"dalleMessage.imageEditButton",defaultMessage:"Edit"},downloadImage:{id:"imageViewer.downloadImage",defaultMessage:"Download Image"},likeImage:{id:"imageViewer.likeImage",defaultMessage:"Like Image"},dislikeImage:{id:"imageViewer.dislikeImage",defaultMessage:"Dislike Image"}})}}]);
//# sourceMappingURL=9392.d2d502932e4c6db5.js.map