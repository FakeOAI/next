"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7558,4620],{74620:function(e,t,s){s.r(t),s.d(t,{default:function(){return h},getCommandsFromMessages:function(){return x},getToolMessages:function(){return p},getVisitedUrl:function(){return M},isBrowseDisplayableCommand:function(){return v}});var a=s(85734),i=s(96243),n=s(11181),r=s(27860),l=s(26123),o=s(25940),d=s(33423),u=s(96294),c=s(58086),g=s(72427),m=s(651);function h(e){let t,{messages:s,clientThreadId:i,isLastMessageInTurn:o,isRequestActive:h,isRetrieval:p}=e,f=(0,l.Z)(),b=s.map(e=>e.message),k=x(b),S=k.filter(e=>v(e,p)),$=(0,n.WA)(i),j=null!=$&&[a.OL.GizmoInteraction,a.OL.GizmoMagicCreate,a.OL.GizmoTest].includes($.kind),F=d.X.Running,E=p?j?y.searchingKnowledge:y.startingRetrieval:y.starting;return(b.some(g.We)?(F=d.X.Stopped,E=p?j?y.searchingKnowledgeStopped:y.retrievalStopped:y.browsingStopped):o&&h?S.length>0&&({displayMessage:E,displayMessageValues:t}=function(e,t,s){switch(e.type){case a.$x.Search:if(t)return s?{displayMessage:y.searchingKnowledge}:{displayMessage:y.startingRetrieval};{var i;let t=null===(i=e.message.metadata)||void 0===i||null===(i=i.args)||void 0===i?void 0:i[0];if(null!=t)return{displayMessage:y.searchingForQuery,displayMessageValues:{query:t}};return{displayMessage:y.searching}}case a.$x.Click:case a.$x.MultiClick:case a.$x.Lookup:case a.$x.OpenUrl:case a.$x.Quote:case a.$x.QuoteFull:case a.$x.QuoteLines:if(t)return s?{displayMessage:y.searchingKnowledge}:{displayMessage:y.readingDocument,displayMessageValues:{filename:w(e)}};{let t=M(e);return{displayMessage:y.visiting,displayMessageValues:{url:null!=t?(0,r.Uq)(t):null}}}case a.$x.Back:case a.$x.Scroll:throw Error("No display string for command: ".concat(e.type))}}(S[S.length-1],p,j)):k.length>0&&k.every(e=>e.didError)?(F=d.X.Error,E=p?j?y.searchingKnowledgeFailed:y.retrievalFailed:y.browsingFailed):(F=d.X.Finished,E=void 0),p)?(0,m.jsx)(d.Z,{conversationMessages:s,icon:p?u.BK:u.ED,status:F,text:E?f.formatMessage(E,t):null,estimatedToolDurationMs:p?c.cf:c.Tv}):F===d.X.Running?(0,m.jsx)("div",{className:"text-message [.text-message+&]:mt-5",children:(0,m.jsx)("div",{className:"result-thinking relative"})}):null}function p(e){return e.filter(e=>e.author.role===a.uU.Tool)}function x(e){return e.map((t,s)=>{if(t.author.role!==a.uU.Tool||s>0&&f(t)&&f(e[s-1]))return null;let i=t.metadata;if(!i)return null;let{command:n,status:r}=i;return n?{type:n,status:r,didError:t.content.content_type===a.PX.SystemError,message:t}:null}).filter(i.l)}function f(e){var t,s,a;return(null===(t=e.metadata)||void 0===t?void 0:t.command)==="quote"||(null===(s=e.metadata)||void 0===s?void 0:s.command)==="quote_full"||(null===(a=e.metadata)||void 0===a?void 0:a.command)==="quote_lines"}function v(e,t){switch(e.type){case a.$x.Search:return!0;case a.$x.Click:case a.$x.Lookup:case a.$x.MultiClick:case a.$x.OpenUrl:case a.$x.Quote:case a.$x.QuoteFull:case a.$x.QuoteLines:return t?null!=w(e):null!=M(e);case a.$x.Back:case a.$x.Scroll:return!1}}function M(e){var t;let s=null===(t=e.message.metadata)||void 0===t||null===(t=t._cite_metadata)||void 0===t?void 0:t.metadata_list[0];return null!=s&&"file"!==s.type?s.url:null}function w(e){var t;let s=null===(t=e.message.metadata)||void 0===t||null===(t=t._cite_metadata)||void 0===t?void 0:t.metadata_list[0];return null!=s&&"file"===s.type?s.name:null}let y=(0,o.vU)({starting:{id:"browsingMessage.startingV3",defaultMessage:"Doing research with Bing"},browsingStopped:{id:"browsingMessage.browsingStopped",defaultMessage:"Stopped browsing"},browsingFailed:{id:"browsingMessage.browsingFailed",defaultMessage:"Error browsing"},searching:{id:"browsingMessage.searching",defaultMessage:"Searching Bing"},searchingForQuery:{id:"browsingMessage.searchingForQuery",defaultMessage:"Searching “{query}”"},visiting:{id:"browsingMessage.visiting",defaultMessage:"Visiting {url}"},startingRetrieval:{id:"browsingMessage.startingRetrieval",defaultMessage:"Reading documents"},retrievalStopped:{id:"browsingMessage.retrievalStopped",defaultMessage:"Stopped reading documents"},retrievalFailed:{id:"browsingMessage.retrievalFailed",defaultMessage:"Error reading documents"},readingDocument:{id:"browsingMessage.readingDocument",defaultMessage:"Reading {filename}"},searchingKnowledge:{id:"browsingMessage.searchingKnowledge",defaultMessage:"Searching my knowledge"},searchingKnowledgeStopped:{id:"browsingMessage.searchingKnowledgeStopped",defaultMessage:"Stopped searching knowledge"},searchingKnowledgeFailed:{id:"browsingMessage.searchingKnowledgeFailed",defaultMessage:"Error searching knowledge"}})},67558:function(e,t,s){s.r(t),s.d(t,{BrowsingMessageSimple:function(){return y}});var a,i=s(41141),n=s(85734),r=s(62538),l=s(33481),o=s(93223),d=s(27860),u=s(91257),c=s(19841),g=s(7290),m=s(58164),h=s(26123),p=s(74091),x=s(74620),f=s(33423),v=s(44512),M=s(72427),w=s(651);function y(e){var t,s;let{messages:a,isRequestActive:i,isLastMessageInTurn:r}=e,l=a.map(e=>e.message),o=(0,x.getCommandsFromMessages)(l),u=o.filter(e=>(0,x.isBrowseDisplayableCommand)(e,!1)),c=null!==(t=u[u.length-1])&&void 0!==t?t:void 0,g=(0,h.Z)();if((0,x.getToolMessages)(l).some(e=>{let{content:t}=e;return t.content_type===n.PX.SystemError}))return null;let m=f.X.Running,p={count:u.length,domain:c?(0,d.SX)(null!==(s=(0,x.getVisitedUrl)(c))&&void 0!==s?s:""):void 0,query:c?S(c):void 0},y=g.formatMessage({id:"message.tools.browse.running",defaultMessage:"Searching the web"});return(l.some(M.We)?(m=f.X.Stopped,y=g.formatMessage({id:"message.tools.browse.stopped",defaultMessage:"Search stopped"})):r&&i?u.length>0&&(y=function(e,t,s){switch(null==s?void 0:s.type){case n.$x.Click:case n.$x.MultiClick:case n.$x.Lookup:case n.$x.OpenUrl:case n.$x.Quote:case n.$x.QuoteFull:case n.$x.QuoteLines:case n.$x.Scroll:case n.$x.Back:return e.formatMessage({id:"message.tools.browse.reading",defaultMessage:"Browsing {domain}"},t);case n.$x.Search:case void 0:return e.formatMessage({id:"message.tools.browse.searching",defaultMessage:'Searching "{query}"'},t)}}(g,p,u[u.length-1])):o.length>0&&o.every(e=>e.didError)?(m=f.X.Error,y=g.formatMessage({id:"message.tools.browse.failed",defaultMessage:"Search failed"})):(m=f.X.Finished,y=0===p.count?g.formatMessage({id:"message.tools.browse.started",defaultMessage:"Searching the web..."}):g.formatMessage({id:"message.tools.browse.finished",defaultMessage:"Searched {count, plural, =0 {0 sites} one {# site} other {# sites}}"},p)),u.length>0&&m!==f.X.Error)?(0,w.jsx)(v.D,{highlightedCommand:y,showWorkUserSetting:!1,status:m,children:0===u.length?null:(0,w.jsx)(b,{commands:u})}):(0,w.jsx)($,{$isError:m===f.X.Error,children:y})}function b(e){let{commands:t}=e,s=(0,h.Z)(),a=t.map(x.getVisitedUrl).filter(e=>null!=e),i=(0,u.u)(a);return(0,w.jsx)("div",{className:"mb-4 divide-y divide-token-border-light rounded-xl border border-token-border-light text-sm",children:(0,w.jsx)(g.M,{initial:!1,children:t.map((e,a)=>{let{icon:u,url:g,title:h,externalLink:p}=function(e){var t;switch(e.type){case n.$x.Search:{let t=S(e);return{icon:l.W1M,url:"bing.com",externalLink:function(e){var t;let s=null===(t=e.message.metadata)||void 0===t||null===(t=t.args)||void 0===t?void 0:t[0];return void 0===s?null:o.Z.getBingLink({query:s})}(e),title:t?"“".concat(t,"”"):{id:"message.tools.browse.querying",defaultMessage:"Querying",description:"Status message when issuing a query"}}}case n.$x.Click:case n.$x.MultiClick:case n.$x.Lookup:case n.$x.OpenUrl:case n.$x.Quote:case n.$x.QuoteFull:case n.$x.QuoteLines:case n.$x.Scroll:return{url:(0,x.getVisitedUrl)(e),title:null!==(t=function(e){var t;let s=null===(t=e.message.metadata)||void 0===t||null===(t=t._cite_metadata)||void 0===t?void 0:t.metadata_list[0];return null!=s&&"file"!==s.type?s.title:null}(e))&&void 0!==t?t:void 0};case n.$x.Back:return{}}}(e),f=g?(0,d.SX)(g):void 0,v=h?"string"==typeof h?h:s.formatMessage(h):null,M=g?i.get(g):null;return(0,w.jsx)(m.E.div,{initial:"collapsed",animate:"open",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:(0,w.jsxs)(k,{url:null!=p?p:g,className:(0,c.default)("flex items-start gap-3 px-4 py-3",h?"text-token-text-secondary":"text-token-text-primary",0===a&&"rounded-t-xl",a===t.length-1&&"rounded-b-xl"),children:[u?(0,w.jsx)(u,{className:"icon-sm mt-0.5 flex-shrink-0 text-token-text-secondary"}):g?(0,w.jsx)(r.Z,{url:g,className:"mt-1"}):null,(0,w.jsxs)("div",{children:[v&&(0,w.jsxs)("div",{className:"line-clamp-1 text-token-text-primary",children:[M&&"".concat(M," — "),v]}),(0,w.jsx)("div",{children:f})]})]})},a)})})})}function k(e){let{url:t,children:s,className:a}=e;return t?(0,w.jsxs)("a",{href:t,target:"_blank",className:(0,c.default)(a,"group relative hover:bg-token-main-surface-secondary"),children:[s,(0,w.jsx)("div",{className:"invisible absolute right-3 bg-gradient-to-l from-token-main-surface-secondary to-transparent pl-4  group-hover:visible",children:(0,w.jsx)(l.Pfi,{className:"icon-md text-token-text-secondary"})})]}):(0,w.jsx)("div",{className:a,children:s})}function S(e){var t;return null===(t=e.message.metadata)||void 0===t||null===(t=t.args)||void 0===t?void 0:t[0]}let $=p.Z.p(a||(a=(0,i.Z)(["juice:first:mt-0 my-1.5 juice:h-8 flex items-center ltr:mr-auto rtl:ml-auto\n",""])),e=>{let{$isError:t}=e;return t?"text-token-text-error":"text-token-text-secondary"})},44512:function(e,t,s){s.d(t,{D:function(){return m}});var a,i=s(41141),n=s(33481),r=s(19841),l=s(7290),o=s(58164),d=s(92379),u=s(74091),c=s(33423),g=s(651);function m(e){let{highlightedCommand:t,status:s,children:a,showWorkUserSetting:i=!1,hideOnlyIfNotInteractedWith:u=!1}=e,m=null!=a,{0:p}=(0,d.useState)(i),{0:x,1:f}=(0,d.useState)(i),{0:v,1:M}=(0,d.useState)(!1);return s!==c.X.Finished&&s!==c.X.Error||!u||p||v?m?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(h,{$canShowWork:!0,children:(0,g.jsx)(l.M,{children:(0,g.jsx)(o.E.button,{onClick:()=>{f(e=>!e),M(!0)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:(0,r.default)(s===c.X.Running&&"loading-shimmer","group absolute left-0 top-0 mr-1.5 h-[26px] overflow-hidden juice:h-8"),children:(0,g.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,g.jsx)("span",{children:t}),x?(0,g.jsx)(n.r0F,{className:"icon-md group-hover:visible md:invisible"}):(0,g.jsx)(n.Tg4,{className:"icon-md group-hover:visible md:invisible"})]})},null==t?void 0:t.toString())})}),(0,g.jsx)(l.M,{children:x&&a&&(0,g.jsx)(o.E.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:a})})]}):(0,g.jsx)(h,{$canShowWork:!1,children:t}):null}let h=u.Z.p(a||(a=(0,i.Z)(["juice:first:mt-0 my-1.5 relative h-[26px] juice:h-8\n",""])),e=>{let{$canShowWork:t}=e;return t?"text-token-text-secondary hover:text-token-text-primary":"text-token-text-secondary"})}}]);
//# sourceMappingURL=7558.a3163acba602524a.js.map