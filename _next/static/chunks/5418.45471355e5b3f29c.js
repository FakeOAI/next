"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5418],{39358:function(e,t,r){r.d(t,{Z:function(){return h}});var n,s=r(2346),a=r(98601),l=r(92379),o=r(68306),i=r(62984),d=r(15478),c=r(15174),u=r(30853),m=r(28146),x=r(651);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let b=(0,o.vU)({copy:{id:"CopyButton.copy",defaultMessage:"Copy"},copied:{id:"CopyButton.copied",defaultMessage:"Copied!"}});function h(e){let{buttonText:t,shouldChangeText:r=!0,iconClassName:n="icon-sm",onCopy:s,className:a}=e,{0:o,1:d}=(0,l.useState)(!1),p=(0,c.Z)(),h=(0,l.useCallback)(e=>{e.stopPropagation(),s(),d(!0),setTimeout(()=>{p()&&d(!1)},2e3)},[p,s]),j=t;return r&&o?j=(0,x.jsx)(i.Z,f({},b.copied)):!0===t&&(j=(0,x.jsx)(i.Z,f({},b.copy))),(0,x.jsxs)(x.Fragment,{children:[!o&&(0,x.jsx)(u.u,{label:(0,x.jsx)(i.Z,{id:"CopyButton.copyTooltip",defaultMessage:"Copy"}),sideOffset:0,children:(0,x.jsxs)(g,{onClick:h,className:a,children:[(0,x.jsx)(m.TIy,{className:n}),j]})}),o&&(0,x.jsxs)(g,{className:a,children:[(0,x.jsx)(m.$As,{className:n}),j]})]})}let g=d.Z.button(n||(n=(0,s.Z)(["flex gap-1 items-center"])))},88301:function(e,t,r){r.d(t,{B1:function(){return x},hj:function(){return p},lX:function(){return b},r:function(){return h},yt:function(){return f}});var n,s,a,l=r(2346),o=r(28146),i=r(30853),d=r(19841),c=r(62984),u=r(15478),m=r(651);let x=u.Z.textarea(n||(n=(0,l.Z)(["w-full text-sm overflow-y-auto rounded-lg border px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium bg-token-main-surface-primary h-32"]))),p=u.Z.div(s||(s=(0,l.Z)(["mb-6"]))),f=u.Z.input(a||(a=(0,l.Z)(["w-full resize-none overflow-y-auto rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 border focus:ring-blue-400 border-token-border-medium h-9 bg-token-main-surface-primary"])));function b(e){let{label:t,description:r,collapsed:n,onClick:s}=e,a=(0,m.jsx)("label",{className:"block font-semibold text-token-text-primary",children:t});return(0,m.jsxs)("div",{className:"mb-1.5 flex items-center",onClick:s,children:[void 0!==n&&(n?(0,m.jsx)(o.r0F,{className:"icon-sm"}):(0,m.jsx)(o.Tg4,{className:"icon-sm"})),r?(0,m.jsx)(i.u,{label:r,sideOffset:4,side:"top",delayDuration:0,children:a}):(0,m.jsx)(m.Fragment,{children:a})]})}function h(e){var t;let{actionTool:r,onShowActionsEditor:n,isDisabled:s}=e,a="metadata"in r?null===(t=r.metadata)||void 0===t?void 0:t.domain:void 0;return(0,m.jsxs)("div",{className:(0,d.default)("flex rounded-lg border border-token-border-medium text-sm hover:cursor-pointer",s?"bg-token-main-surface-secondary":""),onClick:n,children:[(0,m.jsx)("div",{className:"h-9 grow px-3 py-2",children:null!=a?a:(0,m.jsx)("span",{className:"text-red-500",children:(0,m.jsx)(c.Z,{id:"TJYXrY",defaultMessage:"Invalid action"})})}),(0,m.jsx)("div",{className:"w-px bg-token-border-medium"}),(0,m.jsx)("button",{disabled:s,className:"flex h-9 w-9 items-center justify-center rounded-lg rounded-l-none",children:(0,m.jsx)(o.SWE,{className:"icon-sm"})})]})}},65418:function(e,t,r){r.r(t),r.d(t,{DebugConversation:function(){return ex},DebugConversationSidebar:function(){return em},default:function(){return eo},downloadMessages:function(){return ep}});var n,s,a,l,o,i=r(2346),d=r(98601),c=r(16757),u=(r(34095),r(55963)),m=r(88301),x=(r(2721),r(93951)),p=r(92745),f=r(22433),b=r(93180),h=r(46900),g=(r(66290),r(30757)),j=(r(56032),r(42420)),v=r(79746),y=r(88667),w=r(2423),N=r.n(w),k=r(38482),C=r.n(k),S=r(92379),O=r(75172),_=r(62984),P=r(68306),Z=r(67526),I=r(75853),T=r(15478),D=r(11550),F=r(39358),R=r(94273),L=r(75130),M=r(651);function E(e){let{children:t,sidebarOpen:r,onClose:n}=e;return(0,M.jsx)(R.u.Root,{show:r,as:S.Fragment,children:(0,M.jsxs)(L.V,{as:"div",className:"relative z-10",onClose:n,children:[(0,M.jsx)("div",{className:"fixed inset-0"}),(0,M.jsx)("div",{className:"fixed inset-0 overflow-hidden",children:(0,M.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:(0,M.jsx)("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:(0,M.jsx)(R.u.Child,{as:S.Fragment,enter:"transform transition ease-in-out duration-100 sm:duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-300 sm:duration-500",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,M.jsx)(L.V.Panel,{className:"pointer-events-auto w-screen max-w-md border-l border-gray-100 dark:border-gray-700",children:(0,M.jsx)("div",{className:"h-full overflow-y-auto bg-token-main-surface-primary shadow-xl",children:t})})})})})})]})})}var U=r(30853),z=r(30115),A=r(28146),V=r(24434),Q=r(73468),B=r(89678),J=r.n(B),G=r(13859),q=r.n(G),X=r(24740),Y=r(88815);function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach(function(t){(0,d.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function H(e){var t;let{clientThreadId:r}=e,{rebaseSystemMessageContent:n,showDebugConversationTurns:s}=(0,Y.N)(),{0:a,1:l}=(0,S.useState)(()=>n?JSON.stringify(n,null,2):void 0),{0:o,1:i}=(0,S.useState)(!!n),d=(0,p.u9)(r,p.tQ.getThreadCurrentLeafId(r)),m=q()(d,e=>e.content.content_type===c.PX.SystemContent),x=null!==(t=null==m?void 0:m.content)&&void 0!==t?t:null,f=(0,S.useMemo)(()=>J()(e=>{try{e?Y.N.setState({rebaseSystemMessageContent:W(W({},JSON.parse(e)),{},{content_type:c.PX.SystemContent})}):Y.N.setState({rebaseSystemMessageContent:null}),X.m.closeAll()}catch(e){X.m.danger("The System Message is not valid JSON")}},500),[]);return(0,S.useEffect)(()=>{o?f(a):(f.cancel(),Y.N.setState({rebaseSystemMessageContent:null}))},[f,o,a]),(0,M.jsxs)("div",{className:"flex flex-col gap-3 px-4",children:[(0,M.jsxs)("div",{children:[(0,M.jsxs)("div",{className:"flex justify-between",children:[(0,M.jsx)(U.u,{label:"Enable to apply this system message to the current conversation.",children:(0,M.jsx)(u.Z,{id:"enabled",label:"Enabled",checked:o,onChange:e=>i(e.currentTarget.checked)})}),(0,M.jsx)(u.Z,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:s,onChange:()=>{Y.N.setState({showDebugConversationTurns:!s})}})]}),(0,M.jsx)(D.z,{disabled:!x,className:"mt-2",onClick:()=>{l(x?JSON.stringify(x,null,2):"")},size:"small",children:"Load active system message"})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("label",{className:"text-sm",children:"System Message"}),(0,M.jsx)(K,{disabled:!o,placeholder:x?"Press `Load active system message` to pre-populate this":"Start a conversation and then press `Load active system message` to pre-populate this",className:"min-h-[75vh] rounded-md border border-gray-400 p-1 font-mono",value:a,onChange:e=>l(e.target.value)})]})]})}let K=T.Z.textarea(n||(n=(0,i.Z)(["w-full rounded-lg border border-token-border-light bg-token-main-surface-primary text-sm text-token-text-primary focus:border-token-text-primary focus:shadow-none focus:outline-none focus:ring-token-text-primary disabled:bg-token-main-surface-tertiary"])));var ee=r(19841);function et(e){let{clientThreadId:t}=e,{0:r,1:n}=(0,S.useState)([]),s=p.tQ.getThreadCurrentLeafId(t),a=p.tQ.getThreadConversationTurns(t,s),l=e=>{let r=p.tQ.getTree(t).getLeafFromNode(e);p.tQ.setThreadCurrentLeafId(t,r.id)},o=e=>{n(e=>[...e,s]),l(e)};return(0,M.jsxs)(M.Fragment,{children:[r.length>0&&(0,M.jsxs)(D.z,{className:"absolute left-2 top-2",color:"secondary",onClick:()=>{l(r[r.length-1]),n(e=>e.slice(0,-1))},children:[(0,M.jsx)(A.eF8,{className:"icon-sm"}),"Go back to ",r[r.length-1]]}),(0,M.jsx)("div",{className:"flex flex-col items-center gap-4 overflow-auto p-4 text-xs",children:a.map((e,r)=>{let n;let s=e.messages[0].nodeId,a=p.tQ.getTree(t),l=0!==r?a.getParent(s):null,i=null!=l?l.children.findIndex(e=>s===e):0,d=null!=l?l.children:[],u=d.slice(0,i),m=d.slice(i+1);switch(e.role){case c.uU.User:n="bg-blue-500";break;case c.uU.Assistant:n="bg-gray-600";break;default:n="bg-gray-400"}return(0,M.jsxs)("div",{className:(0,ee.default)("relative p-2",n),children:[(0,M.jsx)("div",{className:"absolute bottom-0 left-0 -ml-2 flex -translate-x-full gap-2 pl-2",children:u.map(e=>(0,M.jsx)(er,{variantId:e,onChangeItemInView:o},e))}),(0,M.jsx)("div",{className:"absolute left-full top-0 ml-2 flex gap-2 pr-2",children:m.map(e=>(0,M.jsx)(er,{variantId:e,onChangeItemInView:o},e))}),(0,M.jsx)("div",{className:"flex flex-col gap-2",children:e.messages.map(e=>(0,M.jsxs)("div",{className:"h-14 w-32 truncate bg-gray-200 p-1 text-black",children:[(0,M.jsx)("div",{className:"font-semibold",children:e.nodeId}),(0,M.jsx)("div",{className:"italic text-token-text-tertiary",children:e.message.author.role}),(0,M.jsx)("div",{children:(0,f.RR)(e.message)})]},e.nodeId))})]},r)})})]})}function er(e){let{variantId:t,onChangeItemInView:r}=e;return(0,M.jsx)("button",{className:"w-32 truncate bg-gray-400 p-2 text-black opacity-50 hover:opacity-100",onClick:()=>{r(t)},children:(0,M.jsx)("span",{className:"bg-gray-200 p-2",children:t})},t)}function en(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function es(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?en(Object(r),!0).forEach(function(t){(0,d.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):en(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ea=C()(()=>Promise.all([r.e(6923),r.e(1981),r.e(6925),r.e(1502)]).then(r.bind(r,19042)).then(e=>e.DebugModalContents),{ssr:!1,loadableGenerated:{webpack:()=>[19042]}}),el=C()(()=>r.e(1583).then(r.bind(r,51583)).then(e=>e.FramesViewer),{ssr:!1,loadableGenerated:{webpack:()=>[51583]}});function eo(e){let{children:t,title:r,icon:n,isOpen:s,slideOver:a,onClose:l}=e,o=(0,M.jsxs)(eg,{children:[(0,M.jsxs)("div",{className:"flex items-start justify-between",children:[(0,M.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 text-lg font-semibold text-gray-900 dark:text-white",children:[(0,M.jsx)(n,{className:"icon-sm"}),r]}),(0,M.jsx)("div",{className:"mr-2 mt-2 flex h-7 items-center",children:(0,M.jsx)(z.P,{onClick:l})})]}),t]});return a?(0,M.jsx)(E,{sidebarOpen:s,onClose:l,children:o}):s?o:null}function ei(e){let{nodes:t,setDebugNodeIndex:r,setFrameSrc:n}=e,s=t.map((e,t)=>{var s;let a=e.message,{role:l,name:o}=a.author,i=N()(a,"metadata.__internal.model_id"),d=N()(a,"metadata.__internal.agent.settings.completion_api.engine"),u=N()(a,"metadata.__internal.model_experiment_name"),m=N()(a,"metadata.__internal.model_experiment_treatment"),x=N()(a,"metadata.__internal.normalized_model_side"),p=N()(a,"metadata.__internal.model_experiment_group_name"),b=N()(a,"metadata.__internal.model_experiment_group_params"),g=N()(a,"metadata.__internal.model_experiment_override"),j=N()(a,"metadata.__internal.model_experiment_eval_seq"),v=null===(s=N()(a,"metadata.__internal.raw_tokens"))||void 0===s?void 0:s.length,y=N()(a,"metadata.request_id"),w=h.U.getAudio(a),k=h.U.getAudioAssetPointers(a),C=h.U.getFrameAssetPointers(a);return(0,M.jsxs)(ev,{role:"button",onClick:()=>r(t),children:[(0,M.jsxs)("div",{className:"text-xs font-semibold uppercase text-token-text-tertiary",children:[l,o&&o!==l&&" (".concat(o,")"),a.recipient&&" -> ",(0,f.Ej)(a)]}),(a.author.role!==c.uU.System||y)&&(0,M.jsxs)("div",{className:"text-xs text-token-text-tertiary",children:[(0,M.jsxs)("div",{children:["ID: ",a.id]}),e.id!==a.id&&(0,M.jsxs)("div",{children:["UI Node ID: ",e.id]}),(0,M.jsxs)("div",{children:["Req ID: ",y||"Reload page to see ID"]})]}),(0,M.jsx)("div",{className:"line-clamp-6",children:(0,f.RR)(a)}),(v||i||d||u||m||x||p||b||g||j)&&(0,M.jsxs)("div",{className:"mt-4 w-full self-start rounded-xl bg-blue-200 px-3 py-0.5 text-xs text-black",children:[void 0!==v&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Tokens Count:"})," ",v]}),i&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Model ID:"})," ",i]}),d&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Engine:"})," ",d]}),u&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Experiment:"})," ",u]}),m&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Treatment:"})," ",m]}),x&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Normalized Side:"})," ",x]}),p&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Group Name:"})," ",p]}),b&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Group Params:"}),(0,M.jsx)("div",{children:JSON.stringify(b,null,2)})]}),g&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Above Params are Overridden By:"})," ",g]}),j&&(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{children:"Experiment Eval Seq:"})," click to see"]})]}),w.length||k.length?(0,M.jsxs)("div",{className:"mt-4 flex flex-col flex-nowrap gap-2",children:[(0,M.jsx)(eb,{frameAssets:C,setFrameSrc:n},t),w.map((e,t)=>(0,M.jsx)(eh,{audio:e},t)),k.map((e,t)=>(0,M.jsx)(eh,{assetPointer:e},t))]}):null]},a.id)});return(0,M.jsx)(ej,{children:s})}let ed=e=>(0,M.jsx)(Z.c.Input,es(es({},e),{},{inputClassName:"focus:ring-0"}));function ec(){let e=(0,Y.N)(),t=(0,Q.ZP)().map(e=>({label:e.name,options:e.options.map(e=>({label:"".concat(e.value," (").concat(e.name,")"),value:e.value}))}));return(0,M.jsxs)("div",{className:"mt-2 flex flex-col justify-around gap-3 px-4 py-1 text-xs font-semibold",children:[(0,M.jsx)(u.Z,{id:"force-paragen",label:"Force Parallel Gen",checked:e.forceParagen,onChange:()=>{Y.N.setState({forceParagen:!e.forceParagen})}}),(0,M.jsx)(I.Z,{options:t,name:"force-paragen-model",className:"shadow-none dark:text-gray-800",isDisabled:!e.forceParagen,isLoading:0===t.length,value:e.forceParagenModel,isClearable:!0,isMulti:!1,components:{Input:ed},onChange:e=>{Y.N.setState({forceParagenModel:null!=e?e:Y.J})}}),(0,M.jsx)(u.Z,{id:"force-paragen",label:"Force Nulligen",checked:e.forceNulligen,onChange:()=>{Y.N.setState({forceNulligen:!e.forceNulligen})}}),(0,M.jsx)(u.Z,{id:"force-indepth-feedback",label:"Force Indepth Feedback with prompt:",checked:e.forceIndepthFeedback,onChange:()=>{Y.N.setState({forceIndepthFeedback:!e.forceIndepthFeedback})}}),(0,M.jsx)(m.B1,{id:"force-indepth-feedback-prompt",value:e.forceIndepthFeedbackPrompt,disabled:!e.forceIndepthFeedback,className:"font-weight-normal font-mono text-xs",onChange:e=>{Y.N.setState({forceIndepthFeedbackPrompt:e.target.value})}}),(0,M.jsx)(u.Z,{id:"force-rate-limit",label:"Force Rate Limit",checked:e.forceRateLimit,onChange:()=>{Y.N.setState({forceRateLimit:!e.forceRateLimit})}}),(0,M.jsx)(u.Z,{id:"reset-rate-limit",label:"Reset Rate Limits",checked:e.resetRateLimits,onChange:()=>{Y.N.setState({resetRateLimits:!e.resetRateLimits})}}),(0,M.jsx)(U.u,{label:"Enabling this will show debug conversation messages in the chat",children:(0,M.jsx)(u.Z,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:e.showDebugConversationTurns,onChange:()=>{Y.N.setState({showDebugConversationTurns:!e.showDebugConversationTurns})}})})]})}let eu=T.Z.div(s||(s=(0,i.Z)(["px-3 pb-2 text-xs font-semibold uppercase border-b-2 ",""])),e=>{let{$isSelected:t}=e;return t?"border-black dark:border-white":"border-transparent"});function em(e){let{clientThreadId:t,isOpen:r,slideOver:n,onClose:s}=e,a=(0,O.Z)(),l=(0,x.hz)(),{0:o,1:i}=(0,S.useState)("conversation");return null!=l&&l.includes("debug")?(0,M.jsx)(eo,{icon:A.reV,title:a.formatMessage(ey.debugTitle),isOpen:r,slideOver:n,onClose:s,children:(0,M.jsxs)(g.fC,{orientation:"vertical",defaultValue:o,onValueChange:e=>i(e),children:[(0,M.jsxs)(g.aV,{className:"flex items-center justify-center gap-2 px-4 py-1 text-xs font-semibold",children:[(0,M.jsx)(g.xz,{value:"conversation",children:(0,M.jsx)(eu,{$isSelected:"conversation"===o,children:"Conversation"})}),(0,M.jsx)(g.xz,{value:"system-message-editor",className:"p-4",children:(0,M.jsx)(eu,{$isSelected:"system-message-editor"===o,children:"System Message Editor"})})]}),(0,M.jsx)(g.VY,{value:"conversation",children:(0,M.jsx)(ex,{clientThreadId:t})}),(0,M.jsx)(g.VY,{value:"system-message-editor",children:(0,M.jsx)(H,{clientThreadId:t})})]})}):null}function ex(e){var t,r;let{clientThreadId:n}=e,s=(0,O.Z)(),a=p.tQ.getThreadCurrentLeafId(n),l=(0,p.Fe)(n,a),{0:o,1:i}=(0,S.useState)(),d=(0,x.hz)(),c=(0,S.useCallback)(()=>{i(void 0)},[]),u=(0,S.useCallback)(()=>{let e=p.tQ.getTree(n);(0,v.v)(e.getTextFromThread(a))},[a,n]),{0:m,1:f}=(0,S.useState)(!1),{0:b,1:h}=(0,S.useState)(void 0);return null!=d&&d.includes("debug")?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{className:"mb-2 flex items-center justify-around px-4 py-1 text-xs font-semibold uppercase",children:(0,M.jsx)(ef,{clientThreadId:n,messages:l.map(e=>e.message)})}),!1,(0,M.jsxs)("div",{className:"flex items-center justify-around gap-2 px-4 py-1 text-xs font-semibold uppercase",children:[(0,M.jsx)("div",{children:(0,M.jsx)(F.Z,{onCopy:u,buttonText:s.formatMessage(ey.copyText)})}),(0,M.jsxs)("button",{className:"flex items-center justify-center gap-2",onClick:()=>f(!0),children:[(0,M.jsx)(A.aAc,{className:"icon-sm rotate-90"}),"View tree"]})]}),(0,M.jsx)(ec,{}),(0,M.jsx)(ei,{nodes:l,setDebugNodeIndex:i,setFrameSrc:h}),void 0!==o&&(0,M.jsx)(V.Z,{type:"success",size:"fullscreen",noPadding:!0,isOpen:!0,onClose:c,children:(0,M.jsx)(ea,{threadId:null===(t=l[o].message.metadata)||void 0===t||null===(t=t.__internal)||void 0===t?void 0:t.sonic_thread_id,threadUserId:null===(r=l[o].message.metadata)||void 0===r||null===(r=r.__internal)||void 0===r?void 0:r.sonic_user_id,onClose:c,message:l[o].message})},"DebugMessageModal-".concat(o)),m&&(0,M.jsx)(V.Z,{isOpen:!0,onClose:()=>f(!1),type:"success",size:"custom",noPadding:!0,children:(0,M.jsx)(et,{clientThreadId:n})},"DebugTreeViewer"),b&&(0,M.jsx)(V.Z,{size:"normal",isOpen:!0,onClose:()=>h(void 0),type:"success",children:(0,M.jsx)("img",{src:b,alt:"debug image"})},"DebugFrameViewer")]}):null}function ep(e,t){let r=new Blob([JSON.stringify({conversation_id:p.tQ.getServerThreadId(e),messages:t},null,2)],{type:"application/json"}),n=URL.createObjectURL(r),s=document.createElement("a");s.href=n,s.download="messages-".concat(p.tQ.getServerThreadId(e),".json"),s.click(),URL.revokeObjectURL(n)}function ef(e){let{clientThreadId:t,messages:r}=e,n=(0,S.useCallback)(()=>{ep(t,r)},[t,r]);return(0,M.jsx)(D.z,{onClick:n,color:"primary",size:"small",icon:A._8t,children:(0,M.jsx)(_.Z,es({},ey.downloadRawConversation))})}function eb(e){let{0:t,1:r}=(0,S.useState)([]),n=(0,j.NL)(),{frameAssets:s}=e;return(0,S.useEffect)(()=>{async function e(){return Promise.all(s.map(async e=>{let{image_asset_pointer:t,timestamp:r}=e;return{src:(await b.j.fetch(n,{asset:t})).url,timestamp:r}}))}s.length>0&&e().then(r)},[s,n]),(0,M.jsx)(el,{frames:t,setFrameSrc:e.setFrameSrc})}function eh(e){let t=eh.useAssetPointerSource(e.assetPointer),r=eh.useAudioSource(e.audio),n=null!=t?t:r,s=(0,y.xb)("3230069703").config.value.expirySeconds,{0:a,1:l}=(0,S.useState)(Date.now()),o=(0,S.useRef)(null);return((0,S.useEffect)(()=>{let e=setInterval(()=>{o.current&&o.current.currentTime>0&&!o.current.paused&&!o.current.ended&&o.current.readyState>2||l(Date.now())},1e3*s);return()=>clearInterval(e)},[s]),n)?(0,M.jsx)("audio",{ref:o,controls:!0,src:n,className:"w-full"},a):null}eh.useAssetPointerSource=e=>{let{0:t,1:r}=(0,S.useState)(null),n=(0,j.NL)();return(0,S.useEffect)(()=>{e&&b.j.fetch(n,{asset:e}).then(e=>{r(e.url)})},[n,e]),t},eh.useAudioSource=e=>{let{0:t,1:r}=(0,S.useState)(null);return(0,S.useEffect)(()=>{if(e){let t=atob(e.payload),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);let s=new Blob([n],{type:"audio/".concat(e.format)}),a=URL.createObjectURL(s);return r(a),()=>{URL.revokeObjectURL(a)}}},[e]),t};let eg=T.Z.div(a||(a=(0,i.Z)(["overflow-y-auto h-full md:w-[250px] lg:w-[300px] xl:w-[350px] 2xl:w-[400px] md:border-l md:border-gray-100 md:dark:border-gray-700 popover bg-token-main-surface-primary"]))),ej=T.Z.pre(l||(l=(0,i.Z)(["whitespace-pre-wrap text-sm"]))),ev=T.Z.div(o||(o=(0,i.Z)(["px-6 py-4 flex flex-col gap-1 hover:bg-gray-50 dark:hover:bg-gray-500/10 cursor-pointer border-b dark:border-white/10 border-gray-200"]))),ey=(0,P.vU)({debugTitle:{id:"DebugSidebar.debugTitle",defaultMessage:"Debug"},copyText:{id:"DebugSidebar.copyText",defaultMessage:"Copy text"},downloadRawConversation:{id:"DebugSidebar.downloadRawConversation",defaultMessage:"Download raw conversation"},uploadRawConversation:{id:"DebugSidebar.uploadRawConversation",defaultMessage:"Upload conversation dump"},closeSidebar:{id:"DebugSidebar.closeSidebar",defaultMessage:"Close sidebar"}})}}]);
//# sourceMappingURL=5418.45471355e5b3f29c.js.map