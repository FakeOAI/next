(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8299,6054,159],{51516:function(e,t,n){"use strict";function r(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return r}})},17224:function(e,t,n){"use strict";function r(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,{Z:function(){return r}})},98987:function(e,t,n){var r=n(3284);e.exports=function(e,t){for(var n=-1,a=e.length,s=0,l=[];++n<a;){var i=e[n],o=t?t(i):i;if(!n||!r(o,c)){var c=o;l[s++]=0===i?0:i}}return l}},52538:function(e,t,n){var r=n(61757),a=n(98987);e.exports=function(e,t){return e&&e.length?a(e,r(t,2)):[]}},19042:function(e,t,n){"use strict";n.r(t),n.d(t,{DebugModal:function(){return _},DebugModalContents:function(){return D}});var r=n(11550),a=n(39358),s=n(30115),l=n(28146),i=n(24434),o=n(67330),c=n(91111),u=n(97193),d=n(27313),f=n(5132),h=n(30757),x=n(79746),m=n(19841),p=n(38482),g=n.n(p),b=n(92379),j=n(15478),v=n(19229),w=n(651);let y=g()(()=>Promise.all([n.e(3904),n.e(6476)]).then(n.bind(n,16476)).then(e=>e.default),{ssr:!1,loadableGenerated:{webpack:()=>[16476]}});function _(e){let{threadId:t,threadUserId:n}=e;return(0,u.W6)(u.bM.isDebugModalOpen)&&(0,w.jsx)(i.Z,{isOpen:!0,onClose:()=>u.vm.toggleDebugModalOpen(),type:"success",size:"fullscreen",noPadding:!0,rootClassName:"z-50",children:(0,w.jsx)(D,{threadId:t,threadUserId:n,onClose:()=>u.vm.toggleDebugModalOpen()})})}let N=(e,t)=>{let n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=window.URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download=e,a.click(),window.URL.revokeObjectURL(r)},k="<|im_start|>",C="<|im_sep|>",M="<|im_end|>";function E(e){let{prompt:t}=e,n=[],r=0;for(;;){let e=t.indexOf(k,r);if(-1===e)break;let a=t.indexOf(C,e);if(-1===a)break;let s=t.indexOf(M,a),l=t.indexOf("<|fim_suffix|>",a);if(-1!==l&&(-1===s||l<s)&&(s=l),-1===s)break;let i=t.substring(e+k.length,a),o=t.substring(a+C.length,s);n.push((0,w.jsxs)("div",{children:[(0,w.jsxs)("span",{className:"font-semibold",children:["[",i,"]"]})," ",o]},e)),r=s+M.length}return n}let V=j.Z.div`mb-[-5px] px-2 pb-1 font-semibold uppercase border-b-2 ${e=>{let{$isSelected:t}=e;return t?"border-black dark:border-white":"border-transparent"}}`;function D(e){let{threadId:t,threadUserId:n,message:a,onClose:i}=e,{sessionUser:u}=(0,c.A)(),{0:x,1:p}=(0,b.useState)(a?"message":"json"),{data:g,isLoading:j,refetch:v}=(0,d.Y)({threadId:t,threadUserId:n,refetchOnMount:"always"}),y=g?.thread;if((0,b.useEffect)(()=>{p(a?"message":y?.turns.length?`turn${y?.turns.length-1}`:"thread")},[y?.turns.length,a]),!j&&!y&&!a)return(0,w.jsxs)(o.bW,{onClickRetry:()=>v(),children:["Failed to load."," "]});if(j)return(0,w.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:"Loading..."});let _=y?.turns,k=y?.turns[y.turns.length-1]?.artifacts__?.model_snapshots?.default_id,C=n&&t?(0,f.t5)(n,t):null;return(0,w.jsx)("div",{className:"flex flex-col gap-2 break-words font-mono text-xs",children:(0,w.jsxs)(h.fC,{orientation:"vertical",value:x,onValueChange:e=>p(e),children:[(0,w.jsxs)(h.aV,{className:"flex items-center justify-center gap-2 px-4 py-1",children:[a&&(0,w.jsx)(h.xz,{value:"message",children:(0,w.jsx)(V,{$isSelected:"message"===x,children:"Message"})},"message"),y&&(0,w.jsx)(h.xz,{value:"thread",children:(0,w.jsx)(V,{$isSelected:"thread"===x,children:"Thread"})},"thread"),_?.map((e,t)=>w.jsxs(b.Fragment,{children:[w.jsx(h.xz,{value:`turn${t}`,children:w.jsxs(V,{$isSelected:x===`turn${t}`,children:["Turn[",t,"]"]})},t),e.artifacts__?.debug_ddtrace_urls?.map(e=>w.jsx(V,{$isSelected:!1,children:w.jsxs("a",{target:"_blank",href:e,className:"text-nowrap",children:["Trace[",t,"] â†—"]})},e))]},t)),(0,w.jsx)("div",{className:"flex-grow"}),k&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(I,{name:"Model",id:k})," ",(0,w.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),u&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(I,{name:"User ID",id:u.id})," ",(0,w.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),C&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(I,{name:"Permalink",id:C}),(0,w.jsx)("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),y&&(0,w.jsxs)(r.z,{size:"small",color:"secondary",onClick:()=>N("thread.json",y),children:[(0,w.jsx)(l._8t,{className:"icon-sm"})," thread.json"]}),(0,w.jsx)(s.P,{onClick:i})]}),_?.map((e,t)=>w.jsxs(h.VY,{value:`turn${t}`,className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth",children:[w.jsxs("div",{className:m.default("flex flex-col gap-1 p-6",e.index%2==0&&"bg-token-main-surface-tertiary"),children:[w.jsx(E,{prompt:e.artifacts__?.debug_info?.main_model_response?.prompt_string??""}),w.jsxs("div",{children:[w.jsx("span",{className:"font-semibold",children:"[assistant]"})," ",e.model_response?.text]})]})," "]},t)),y&&(0,w.jsx)(h.VY,{value:"thread",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-6",children:(0,w.jsx)(T,{data:y,collapsed:4})}),a&&(0,w.jsx)(h.VY,{value:"message",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-6",children:(0,w.jsx)(T,{data:a,collapsed:4})})]},y?.turns.length??"message")})}function T(e){let{data:t,collapsed:n}=e,{0:r,1:a}=(0,b.useState)(n??!0);return(0,w.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,w.jsx)("button",{onClick:()=>a(!r),className:"flex items-center gap-1",children:r?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(v.rIY,{size:14})," Expand all"]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(v.NsE,{size:14})," Collapse all"]})}),(0,w.jsx)("div",{className:"w-full",children:(0,w.jsx)(y,{json:t,jsonViewProps:{collapsed:r,shortenTextAfterLength:0}},String(r))})]})}function I(e){let{name:t,id:n}=e,r=(0,b.useCallback)(()=>{(0,x.v)(n)},[n]);return(0,w.jsxs)("div",{className:"flex items-center gap-2 truncate",children:[(0,w.jsxs)("span",{className:"text-nowrap font-semibold",children:[t,":"]}),(0,w.jsx)("span",{title:n,className:"truncate text-gray-500 dark:text-white",children:n}),(0,w.jsx)(a.Z,{onCopy:r})]})}},21214:function(e,t,n){"use strict";n.r(t),n.d(t,{PermalinkPage:function(){return m}});var r=n(41567),a=n(26925),s=n(27313),l=n(97537),i=n(2428),o=n.n(i),c=n(34977),u=n(92379),d=n(19042),f=n(51837),h=n(651);function x(){return(0,h.jsx)("div",{className:"mt-3 flex justify-center",children:(0,h.jsx)(l.Z,{})})}function m(){return(0,h.jsx)(a.HC,{children:(0,h.jsx)(p,{})})}function p(){let{permalink:e}=(0,c.useRouter)().query;if(!o()(e)||2!==e.length)throw Error("Invalid permalink");let[t,n]=e,{query:l,isLoading:i}=(0,s.v)({threadId:n,threadUserId:t}),m=a.ne.useStore();(0,u.useEffect)(()=>{i||m.setQueryInput(l)},[m,i]);let p=(0,f.L)();return i?(0,h.jsx)(x,{}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.u,{}),p&&(0,h.jsx)(d.DebugModal,{threadId:n,threadUserId:t})]})}},27313:function(e,t,n){"use strict";n.d(t,{Y:function(){return i},v:function(){return o}});var r=n(84760),a=n(92379),s=n(81014),l=n(12381);function i(e){let{threadId:t,threadUserId:n,refetchOnMount:a}=e;return(0,r.a)({queryKey:["thread",t,n],queryFn:async()=>{if(!t)return{thread:null,turns:null};let e=await (0,s.K8)({threadId:t,threadUserId:n}),r=e.turns;return{thread:e,turns:r}},enabled:!!t,refetchOnMount:a})}function o(e){let{threadId:t,threadUserId:n}=e,r=i({threadId:t,threadUserId:n}),s=r.data;return(0,a.useEffect)(()=>{t&&l.P3.setThread(t,s?.turns??[])},[t,s]),{query:r.data?.turns[0]?.user_query,refetch:r.refetch,isLoading:r.isLoading,isError:r.isError}}},78571:function(e,t,n){"use strict";n.d(t,{_:function(){return l}});var r=n(37088),a=n(92379),s=n(52125);let l=(0,a.forwardRef)((e,t)=>(0,a.createElement)(s.WV.label,(0,r.Z)({},e,{ref:t,onMouseDown:t=>{var n;null===(n=e.onMouseDown)||void 0===n||n.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault()}})))},30757:function(e,t,n){"use strict";n.d(t,{VY:function(){return E},aV:function(){return C},fC:function(){return k},xz:function(){return M}});var r=n(37088),a=n(92379),s=n(10132),l=n(31541),i=n(65954),o=n(79813),c=n(52125),u=n(76228),d=n(48758),f=n(28531);let h="Tabs",[x,m]=(0,l.b)(h,[i.Pc]),p=(0,i.Pc)(),[g,b]=x(h),j=(0,a.forwardRef)((e,t)=>{let{__scopeTabs:n,value:s,onValueChange:l,defaultValue:i,orientation:o="horizontal",dir:h,activationMode:x="automatic",...m}=e,p=(0,u.gm)(h),[b,j]=(0,d.T)({prop:s,onChange:l,defaultProp:i});return(0,a.createElement)(g,{scope:n,baseId:(0,f.M)(),value:b,onValueChange:j,orientation:o,dir:p,activationMode:x},(0,a.createElement)(c.WV.div,(0,r.Z)({dir:p,"data-orientation":o},m,{ref:t})))}),v=(0,a.forwardRef)((e,t)=>{let{__scopeTabs:n,loop:s=!0,...l}=e,o=b("TabsList",n),u=p(n);return(0,a.createElement)(i.fC,(0,r.Z)({asChild:!0},u,{orientation:o.orientation,dir:o.dir,loop:s}),(0,a.createElement)(c.WV.div,(0,r.Z)({role:"tablist","aria-orientation":o.orientation},l,{ref:t})))}),w=(0,a.forwardRef)((e,t)=>{let{__scopeTabs:n,value:l,disabled:o=!1,...u}=e,d=b("TabsTrigger",n),f=p(n),h=_(d.baseId,l),x=N(d.baseId,l),m=l===d.value;return(0,a.createElement)(i.ck,(0,r.Z)({asChild:!0},f,{focusable:!o,active:m}),(0,a.createElement)(c.WV.button,(0,r.Z)({type:"button",role:"tab","aria-selected":m,"aria-controls":x,"data-state":m?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:h},u,{ref:t,onMouseDown:(0,s.M)(e.onMouseDown,e=>{o||0!==e.button||!1!==e.ctrlKey?e.preventDefault():d.onValueChange(l)}),onKeyDown:(0,s.M)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&d.onValueChange(l)}),onFocus:(0,s.M)(e.onFocus,()=>{let e="manual"!==d.activationMode;m||o||!e||d.onValueChange(l)})})))}),y=(0,a.forwardRef)((e,t)=>{let{__scopeTabs:n,value:s,forceMount:l,children:i,...u}=e,d=b("TabsContent",n),f=_(d.baseId,s),h=N(d.baseId,s),x=s===d.value,m=(0,a.useRef)(x);return(0,a.useEffect)(()=>{let e=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,a.createElement)(o.z,{present:l||x},({present:n})=>(0,a.createElement)(c.WV.div,(0,r.Z)({"data-state":x?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":f,hidden:!n,id:h,tabIndex:0},u,{ref:t,style:{...e.style,animationDuration:m.current?"0s":void 0}}),n&&i))});function _(e,t){return`${e}-trigger-${t}`}function N(e,t){return`${e}-content-${t}`}let k=j,C=v,M=w,E=y}}]);
//# sourceMappingURL=8299.a33fc2b5af99db0f.js.map