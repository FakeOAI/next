"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[172,5418,6638,8442],{39358:function(e,t,r){r.d(t,{Z:function(){return x}});var s,i=r(2346),n=r(98601),a=r(92379),o=r(68306),l=r(62984),c=r(15478),d=r(15174),u=r(30853),p=r(77748),m=r(651);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let h=(0,o.vU)({copy:{id:"CopyButton.copy",defaultMessage:"Copy"},copied:{id:"CopyButton.copied",defaultMessage:"Copied!"}});function x(e){let{buttonText:t,shouldChangeText:r=!0,iconClassName:s="icon-sm",onCopy:i,className:n}=e,{0:o,1:c}=(0,a.useState)(!1),g=(0,d.Z)(),x=(0,a.useCallback)(e=>{e.stopPropagation(),i(),c(!0),setTimeout(()=>{g()&&c(!1)},2e3)},[g,i]),v=t;return r&&o?v=(0,m.jsx)(l.Z,f({},h.copied)):!0===t&&(v=(0,m.jsx)(l.Z,f({},h.copy))),(0,m.jsxs)(m.Fragment,{children:[!o&&(0,m.jsx)(u.u,{label:(0,m.jsx)(l.Z,{id:"CopyButton.copyTooltip",defaultMessage:"Copy"}),sideOffset:0,children:(0,m.jsxs)(b,{onClick:x,className:n,children:[(0,m.jsx)(p.TIy,{className:s}),v]})}),o&&(0,m.jsxs)(b,{className:n,children:[(0,m.jsx)(p.$As,{className:s}),v]})]})}let b=c.Z.button(s||(s=(0,i.Z)(["flex gap-1 items-center"])))},6440:function(e,t,r){var s,i=r(2346),n=r(98601),a=r(19841),o=r(92379),l=r(15478),c=r(651);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}t.Z=o.forwardRef(function(e,t){let{name:r,placeholder:s,type:i,list:n,displayName:l,onChange:d,onFocus:m,onBlur:g,value:f,saveOnBlur:h,icon:x,onInputIconClick:b,className:v,autoComplete:j,autoFocus:y,onPressEnter:w,disabled:k,maxLength:P,color:O="tertiary"}=e,{0:N,1:z}=(0,o.useState)(f),C=(0,o.useCallback)(e=>{null==g||g(e),h&&z(e.target.value)},[g,h]),M=(0,o.useCallback)(e=>{null==d||d(e),h&&z(e.target.value)},[d,h]),Z=(0,o.useCallback)(e=>{"Enter"===e.key&&w&&(e.preventDefault(),w(N))},[w,N]);(0,o.useEffect)(()=>{z(f)},[f]);let T=u(u({},h?{}:{value:f}),h?{value:N}:{});return(0,c.jsxs)("div",{className:(0,a.default)("rounded-md border shadow-none","neutral"===O&&"border-transparent px-3 py-2 focus-within:border-green-500 focus-within:bg-token-main-surface-tertiary focus-within:ring-1 focus-within:ring-transparent hover:bg-token-main-surface-tertiary","tertiary"===O&&"border-token-border-medium px-3 py-2 focus-within:border-token-border-xheavy focus-within:ring-1 focus-within:ring-token-text-secondary","search"===O&&"rounded-xl border-token-border-medium bg-token-main-surface-primary p-4 focus-within:border-token-border-xheavy focus-within:ring-0 dark:border-token-border-medium dark:focus-within:border-token-border-xheavy dark:focus-within:ring-0",v),children:[(0,c.jsx)("label",{htmlFor:r,className:"block text-xs font-semibold text-token-text-primary",children:l}),(0,c.jsxs)("div",{className:(0,a.default)(l&&"mt-1","relative"),children:[(0,c.jsx)("input",u({ref:t,type:i,name:r,id:r,list:n,className:(0,a.default)("block w-full border-0 p-0 placeholder-gray-500 shadow-none outline-none focus-within:shadow-none focus-within:outline-none focus-within:ring-0 focus:border-none focus:ring-0 sm:text-sm",null!=x&&"pr-6","neutral"===O||"search"===O?"bg-transparent":"bg-token-main-surface-primary text-token-text-primary"),placeholder:s,onBlur:C,onFocus:m,onChange:M,onKeyDown:Z,autoComplete:j,autoFocus:y,disabled:k,maxLength:P},T)),null!=x&&(0,c.jsx)(p,{onClick:b,children:(0,c.jsx)(x,{className:"icon-sm"})})]})]})});let p=l.Z.button(s||(s=(0,i.Z)(["absolute right-0 top-1/2 -translate-y-1/2"])))},76638:function(e,t,r){r.r(t),r.d(t,{DirectorySyncResourceManagedIndication:function(){return l}});var s=r(98601),i=r(62984),n=r(68306),a=r(651);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function l(){return(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("div",{className:"flex rounded-md bg-orange-300 px-1 text-center text-white dark:bg-orange-800",children:(0,a.jsx)("span",{className:"text-[0.5em] font-bold leading-4",children:(0,a.jsx)(i.Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},c.scimIndicatorText))})})})}let c=(0,n.vU)({scimIndicatorText:{id:"workspaceIdentity.directorySyncResourceTagTitle",defaultMessage:"SCIM"}})},94668:function(e,t,r){r.d(t,{Z:function(){return d}});var s,i=r(2346),n=r(19841),a=r(92379),o=r(15478),l=r(77748),c=r(651);function d(e){let t,{type:r="info",children:s,isDismissible:i=!1,onDismiss:o,className:d,isElevated:p=!1}=e,{0:m,1:g}=(0,a.useState)(!1);return m?null:("none"!==r&&(t=l.szr),(0,c.jsxs)(u,{$type:r,className:(0,n.default)("flex w-full items-start gap-3 rounded-2xl border text-sm","warning"===r||"danger"===r?"bg-opacity-5":"bg-opacity-10",i?"py-2.5 pl-3 pr-2 md:py-3 md:pl-4 md:pr-3":"px-3 py-2.5 md:p-4",p&&"shadow-xxs",d),children:[t&&(0,c.jsx)(t,{className:(0,n.default)("icon-lg shrink-0",i&&"mt-[2px] md:mt-px",("info"===r||"none"===r)&&"text-token-text-secondary")}),(0,c.jsx)("div",{className:(0,n.default)("grow",i?"pt-[4px] md:pt-[3px]":"pt-[2px]",!t&&"pl-1"),children:s}),i&&(0,c.jsx)("button",{onClick:()=>{g(!0),null==o||o()},className:(0,n.default)("flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-transparent text-token-text-primary",("info"===r||"none"===r)&&"hover:bg-token-main-surface-secondary","danger"===r&&"hover:bg-token-surface-error/10","warning"===r&&"hover:bg-orange-400/10"),children:(0,c.jsx)(l.tPq,{className:"icon-md"})})]}))}let u=o.Z.div(s||(s=(0,i.Z)(["\n",""])),e=>{let{$type:t}=e;switch(t){case"danger":return"text-token-text-error border-token-surface-error/15 bg-token-surface-error bg-opacity-0";case"warning":return"text-orange-600 bg-orange-400 bg-opacity-0 border-orange-400/15";case"success":return"text-green-500 border-green-500 bg-green-500 bg-opacity-0";default:return"text-token-text-primary border-token-border-light bg-token-main-surface-primary bg-opacity-0"}})},73062:function(e,t,r){r.d(t,{g:function(){return f}});var s=r(98601),i=r(52088),n=r(54198),a=r(19841),o=r(92379),l=r(77748),c=r(50863),d=r(651);let u=["children"],p=["children","className"];function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function f(e){let{options:t,value:r,onValueChange:s,disabled:i,defaultValue:n,placeholder:a}=e;return(0,d.jsxs)(h.Root,{value:r,onValueChange:s,disabled:i,defaultValue:n,children:[(0,d.jsxs)(h.Trigger,{children:[(0,d.jsx)(h.Value,{placeholder:a}),(0,d.jsx)(h.Icon,{})]}),(0,d.jsx)(h.Portal,{children:(0,d.jsx)(h.Content,{children:t.map(e=>(0,d.jsx)(h.Item,{value:e.value,children:e.label},e.value))})})]})}let h={Root:n.fC,Trigger:function(e){return(0,d.jsx)(c.J7,g({$as:n.xz},e))},Value:n.B4,Icon:function(){return(0,d.jsx)(n.JO,{children:(0,d.jsx)(l.Tg4,{className:"icon-sm"})})},Portal:n.h_,Content:function(e){let{children:t,className:r}=e,s=(0,i.Z)(e,p);return(0,d.jsxs)(c.w5,g(g({$as:n.VY,side:"bottom",sideOffset:4,position:"popper",className:(0,a.default)("min-w-[220px] overflow-auto",r)},s),{},{children:[(0,d.jsx)(n.u_,{className:"flex h-8 cursor-default items-center justify-center text-token-text-primary",children:(0,d.jsx)(l.r0F,{className:"icon-sm"})}),(0,d.jsx)(n.l_,{children:t}),(0,d.jsx)(n.$G,{className:"flex h-8 cursor-default items-center justify-center text-token-text-primary",children:(0,d.jsx)(l.Tg4,{className:"icon-sm"})})]}))},Item:o.forwardRef(function(e,t){let{children:r}=e,s=(0,i.Z)(e,u);return(0,d.jsxs)(c.gG,g(g({$as:n.ck,ref:t,className:"flex justify-between"},s),{},{children:[(0,d.jsx)(n.eT,{children:r}),(0,d.jsx)(n.wU,{className:"",children:(0,d.jsx)(l.kvR,{className:"icon-sm"})})]}))}),ItemText:n.eT,ItemIndicator:n.wU,Separator:function(){return(0,d.jsx)(n.Z0,{className:"mx-5 my-1 h-px bg-token-border-light"})},Label:function(e){let{children:t}=e;return(0,d.jsx)(n.__,{className:"mx-2 my-0 px-2 text-xs font-semibold text-token-text-secondary",children:t})},Group:n.ZA};t.Z=h},36792:function(e,t,r){var s=r(98601),i=r(52088),n=r(19841),a=r(92379),o=r(651);let l=["children"];function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let u=(0,a.createContext)({rootBordered:!1}),p=(0,a.forwardRef)(function(e,t){let{children:r,disabled:s=!1,onClick:i,className:a}=e;return(0,o.jsx)("tr",d(d({ref:t},s?{"data-disabled":!0}:{}),{},{className:(0,n.default)(s?"pointer-events-none":"",a),onClick:i,children:r}))});t.Z={Root:function(e){let{children:t,fixed:r=!1,className:s,size:i="normal",bordered:l=!1}=e,c=(0,a.useRef)(null),d=(0,a.useRef)(null),{0:p,1:m}=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=c.current,t=d.current;if(e&&t){let r=new ResizeObserver(()=>{m(t.scrollHeight>e.clientHeight)});return r.observe(e),()=>r.disconnect()}},[]),(0,o.jsx)(u.Provider,{value:{rootBordered:l},children:(0,o.jsx)("div",{className:(0,n.default)("overflow-y-auto text-token-text-primary",l&&"rounded-lg border border-token-border-light","normal"===i?"text-base":"text-sm",p&&"pr-1",s),ref:c,children:(0,o.jsx)("table",{className:(0,n.default)("w-full border-separate border-spacing-0",r&&"table-fixed"),ref:d,children:t})})})},Header:function(e){let{children:t}=e;return(0,o.jsx)("thead",{children:(0,o.jsx)("tr",{children:t})})},HeaderCell:function(e){let{textAlign:t="left",children:r,className:s=""}=e,{rootBordered:i}=(0,a.useContext)(u);return(0,o.jsx)("th",{className:(0,n.default)("text-token sticky top-0 z-10 border-b-[0.5px] border-token-border-medium bg-token-main-surface-primary py-2 font-semibold",i?"px-3":"pr-4 last:pr-0","left"===t?"text-left":"right"===t?"text-right":"text-center",s),children:r})},Body:function(e){let{children:t}=e,r=(0,i.Z)(e,l);return(0,o.jsx)("tbody",d(d({},r),{},{children:t}))},Row:p,Cell:function(e){let{textAlign:t="left",children:r,className:s,colSpan:i}=e,{rootBordered:l}=(0,a.useContext)(u);return(0,o.jsx)("td",{className:(0,n.default)("border-b-[0.5px] border-token-border-medium align-top",l?"px-3":"pr-4 last:pr-0 [tr:last-child_&]:border-b-0",t&&"text-"+t,s),colSpan:i,children:(0,o.jsx)("div",{className:(0,n.default)("flex min-h-[40px] items-center [tr[data-disabled=true]_&]:opacity-50","right"===t&&"justify-end","center"===t&&"justify-center"),children:r})})},Actions:function(e){let{children:t}=e;return(0,o.jsx)("div",{className:"text-md flex items-center justify-end gap-2",children:t})}}},50863:function(e,t,r){r.d(t,{J7:function(){return d},M4:function(){return g},aF:function(){return u},gG:function(){return p},w5:function(){return m}});var s,i,n,a,o,l=r(2346),c=r(15478);let d=c.Z.button(s||(s=(0,l.Z)(["\ntext-token-text-primary border border-transparent inline-flex h-9 items-center justify-center gap-1 rounded-lg bg-white px-3 text-sm dark:transparent dark:bg-transparent\nleading-none outline-none cursor-pointer\nhover:bg-token-main-surface-secondary dark:hover:bg-token-main-surface-secondary\nfocus-visible:bg-token-main-surface-secondary\nradix-state-active:text-token-text-secondary\nradix-disabled:cursor-auto radix-disabled:bg-transparent radix-disabled:text-token-text-tertiary dark:radix-disabled:bg-transparent\n"]))),u=c.Z.div(i||(i=(0,l.Z)(["flex gap-2 items-center m-1.5 rounded p-2.5 text-sm cursor-pointer focus-visible:outline-0 hover:bg-token-main-surface-secondary focus-visible:bg-token-main-surface-secondary radix-disabled:pointer-events-none radix-disabled:opacity-50 group relative"]))),p=(0,c.Z)(u)(n||(n=(0,l.Z)(["","\nhover:bg-[#f5f5f5] focus-visible:bg-[#f5f5f5]\nradix-state-open:bg-[#f5f5f5]\ndark:hover:bg-token-main-surface-secondary\ndark:focus-visible:bg-token-main-surface-secondary\nrounded-md my-0 px-3 mx-2\ndark:radix-state-open:bg-token-main-surface-secondary gap-2.5 py-3"])),e=>e.spoofHovered?"bg-[#f5f5f5]":""),m=c.Z.div(a||(a=(0,l.Z)(["max-w-xs rounded-2xl popover bg-token-main-surface-primary shadow-lg will-change-[opacity,transform] radix-side-bottom:animate-slideUpAndFade radix-side-left:animate-slideRightAndFade radix-side-right:animate-slideLeftAndFade radix-side-top:animate-slideDownAndFade border border-token-border-light py-2"]))),g=c.Z.div(o||(o=(0,l.Z)(["popover overflow-auto rounded-xl border border-token-border-light bg-token-main-surface-primary p-2 shadow-xl"])))},21025:function(e,t,r){r.d(t,{YK:function(){return n},ai:function(){return a},nJ:function(){return o}});var s=r(10080);function i(e){return e==s.Zz.User||e==s.Zz.Group?s.Zz.Private:e==s.Zz.WorkspaceLink?s.Zz.Workspace:e}function n(e,t){return e=i(e),void 0!==t&&t.some(t=>t.recipient===e&&t.allowed)}function a(e,t){if(void 0===t)return[];e=i(e);let r=t.find(t=>t.recipient===e);return null==r?void 0:r.moderated_fields}function o(e,t){let r=a(e,t);return r&&r.length>0}r(651)},51307:function(e,t,r){r.d(t,{JE:function(){return D},MU:function(){return B},Te:function(){return _},UJ:function(){return S},z$:function(){return I}});var s,i,n,a,o,l=r(98601),c=r(2346),d=r(59144),u=r(24434),p=r(39004),m=r(99555),g=r(10080),f=r(93951),h=r(42420),x=r(88667),b=r(82920),v=r(91530),j=r.n(v),y=r(92379),w=r(68306),k=r(62984),P=r(75172),O=r(15478),N=r(21025),z=r(651);function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach(function(t){(0,l.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let Z=O.Z.a(a||(a=(0,c.Z)(["bold underline"]))),T=O.Z.textarea(o||(o=(0,c.Z)(["w-full text-sm overflow-y-auto rounded-lg border px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium bg-token-main-surface-primary h-32"]))),S=((s={})[s.None=0]="None",s[s.AppealAvailable=1]="AppealAvailable",s[s.AppealSent=2]="AppealSent",s),_=((i={})[i.None=0]="None",i[i.PublishBlocked=1]="PublishBlocked",i[i.RemovedFromMarketplace=2]="RemovedFromMarketplace",i[i.RemovedFromPublic=3]="RemovedFromPublic",i[i.RemovedFromPrivate=4]="RemovedFromPrivate",i[i.Recategorized=5]="Recategorized",i);function I(e){var t;if(!e)return;let r=(null===(t=e.gizmo.appeal_info)||void 0===t?void 0:t.state.kind)==="appeal_sent",s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=new Set(t.filter(e=>e.allowed).map(e=>e.recipient));if(!e||(e in E&&(e=E[e]),r.has(e)))return _.None;let s=r.has(g.Zz.Private)||r.has(g.Zz.Workspace),i=r.has(g.Zz.Link)||r.has(g.Zz.Marketplace);return e===g.Zz.Marketplace&&i?_.RemovedFromMarketplace:!i&&s?_.RemovedFromPublic:_.RemovedFromPrivate}(e.gizmo.share_recipient,e.gizmo.sharing_targets);return{sharingRecipient:e.gizmo.share_recipient,categories:e.gizmo.categories,gizmoId:e.gizmo.id,moderationType:s,sharingTargets:e.gizmo.sharing_targets,showModal:r?S.AppealSent:s!==_.None?S.AppealAvailable:S.None}}let E={[g.Zz.User]:g.Zz.Private,[g.Zz.Group]:g.Zz.Private,[g.Zz.WorkspaceLink]:g.Zz.Workspace};function L(e){switch(e){case _.None:case _.PublishBlocked:return(0,w.Em)({id:"gizmo.appeals.publishBlockedTitle",defaultMessage:"Your changes couldn’t be published"});case _.RemovedFromMarketplace:return(0,w.Em)({id:"gizmo.appeals.removedFromMarketplaceTitle",defaultMessage:"Your GPT has been removed from the marketplace"});case _.RemovedFromPublic:return(0,w.Em)({id:"gizmo.appeals.removedFromPublicTitle",defaultMessage:"Your GPT has been removed from public view"});case _.Recategorized:return(0,w.Em)({id:"gizmo.appeals.recategorizedTitle",defaultMessage:"Your GPT has been recategorized"});default:(0,b.ZP)(e)}}function D(e){let{sharingRecipient:t,moderatedFields:r,appealAvailable:s}=e,i=r.length;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("p",{children:[(0,z.jsx)(k.Z,M(M({},function(e){switch(e){case g.Zz.Private:case g.Zz.Workspace:return(0,w.Em)({id:"gizmo.appeals.privateRecipientModerationText",defaultMessage:"Your GPT can’t be updated because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case g.Zz.Link:return(0,w.Em)({id:"gizmo.appeals.linkRecipientModerationText",defaultMessage:"Your GPT can’t be shared publicly because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case g.Zz.Marketplace:return(0,w.Em)({id:"gizmo.appeals.marketplaceRecipientModerationText",defaultMessage:"Your GPT can’t appear in the Explore GPTs page because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});default:(0,b.ZP)(e)}}(t)),{},{values:{usagePolicyLink:e=>(0,z.jsx)(Z,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:e})}}))," ",i>0&&(0,z.jsx)(k.Z,{id:"gizmo.appeals.seeBelowForSpecificIssues",defaultMessage:"{numModeratedFields, plural, one {See below for the specific issue:} other {See below for the specific issues:} }",values:{numModeratedFields:i}})]}),i>0&&(null==r?void 0:r.map(e=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{className:"font-bold",children:(0,z.jsx)(k.Z,M({},function(e){switch(e){case"profile_picture":return(0,w.Em)({id:"gizmo.appeals.profilePictureFieldName",defaultMessage:"Profile Picture"});case"gizmo_name":return(0,w.Em)({id:"gizmo.appeals.gizmoNameFieldName",defaultMessage:"Name"});case"gizmo_description":return(0,w.Em)({id:"gizmo.appeals.gizmoDescriptionFieldName",defaultMessage:"Description"});case"gizmo_instructions":return(0,w.Em)({id:"gizmo.appeals.gizmoInstructionsFieldName",defaultMessage:"Instructions"});case"gizmo_welcome_message":return(0,w.Em)({id:"gizmo.appeals.gizmoWelcomeMessageFieldName",defaultMessage:"Welcome Message"});case"custom_actions":return(0,w.Em)({id:"gizmo.appeals.customActionsFieldName",defaultMessage:"Custom Actions"});case"conversation_starter":return(0,w.Em)({id:"gizmo.appeals.conversationStarterFieldName",defaultMessage:"Conversation Starter"});case"file":return(0,w.Em)({id:"gizmo.appeals.fileFieldName",defaultMessage:"File"});case"gizmo_combined_content":return(0,w.Em)({id:"gizmo.appeals.gizmoCombinedContentFieldName",defaultMessage:"Overall GPT Config"})}}(e.name)))}),(0,z.jsx)("ul",{className:"list-disc pl-5",children:e.reasons.map(e=>(0,z.jsxs)("li",{children:[e.description," ",e.link?(0,z.jsx)(Z,{href:e.link,target:"_blank",rel:"noreferrer",children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.learnMore",defaultMessage:"Learn more"})}):""]},e.description))})]}))),s&&(0,z.jsx)("p",{children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.appealAvailableText",defaultMessage:"Alternatively you may appeal this decision and we will get back to you as soon as possible. Or you can publish to “Only me” and use this GPT privately."})})]})}var A=((n=A||{})[n.Initial=0]="Initial",n[n.AppealForm=1]="AppealForm",n[n.SubmittedConfirmation=2]="SubmittedConfirmation",n);function G(e){var t;let{gizmoId:r,sharingRecipient:s,categories:i,moderationType:n,sharingTargets:a,appealAvailable:o,onClose:l,onAppealSubmitted:c}=e,p=(0,P.Z)(),{0:g,1:x}=(0,y.useState)(""),{0:b,1:v}=(0,y.useState)(A.Initial),j=(0,h.NL)(),w=async()=>{await m.U.postGizmoAppeal(j,r,g,s,i),v(A.SubmittedConfirmation),null==c||c()},O=(0,N.ai)(s,a),C=null!==(t=null==O?void 0:O.length)&&void 0!==t?t:0,M=(0,f.t)();if(0==C&&(null==M?void 0:M.isEnterprisey()))return(0,z.jsx)(u.Z,{title:p.formatMessage(L(n)),isOpen:!0,onClose:l,showCloseButton:!0,type:"warning",primaryButton:(0,z.jsx)(d.Z.Button,{color:"primary",onClick:l,children:(0,z.jsx)(k.Z,{id:"wEsAOU",defaultMessage:"OK"})}),children:(0,z.jsx)("p",{className:"text-sm",children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.workspaceSettingsMessage",defaultMessage:"Access to your GPT has been reduced by your workspace's GPT sharing settings. An owner of the workspace can change these settings in the workspace settings page."})})});switch(b){case A.Initial:return(0,z.jsx)(u.Z,{title:p.formatMessage(L(n)),isOpen:!0,onClose:l,showCloseButton:!0,primaryButton:(0,z.jsx)(d.Z.Button,{color:"primary",onClick:l,children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.contunueButton",defaultMessage:"Continue"})}),secondaryButton:o?(0,z.jsx)(d.Z.Button,{onClick:()=>v(A.AppealForm),children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.appealButton",defaultMessage:"Appeal"})}):void 0,type:"warning",children:(0,z.jsx)("div",{className:"flex flex-col gap-2 text-sm",children:(0,z.jsx)(D,{sharingRecipient:s,moderatedFields:null!=O?O:[],appealAvailable:o})})});case A.AppealForm:return(0,z.jsx)(u.Z,{title:p.formatMessage({id:"gizmo.appeals.appealModalTitle",defaultMessage:"Appeal"}),isOpen:!0,onClose:l,showCloseButton:!0,shouldIgnoreClickOutside:!0,primaryButton:(0,z.jsx)(d.Z.Button,{color:"primary",onClick:w,disabled:0===g.trim().length,children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.submitAppealButton",defaultMessage:"Submit"})}),secondaryButton:(0,z.jsx)(d.Z.Button,{onClick:()=>v(A.Initial),children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.backButton",defaultMessage:"Back"})}),type:"warning",children:(0,z.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,z.jsx)("p",{children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.appealReasonText",defaultMessage:"Please provide a reason for why you believe this GPT doesn’t violate our policies and should be published"})}),(0,z.jsx)(T,{value:g,onChange:e=>x(e.target.value)})]})});case A.SubmittedConfirmation:return(0,z.jsx)(z.Fragment,{})}}function R(e){let{onClose:t}=e,r=(0,P.Z)();return(0,z.jsx)(u.Z,{title:r.formatMessage({id:"gizmo.appeals.appealSubmittedModalTitle",defaultMessage:"Appeal submitted"}),isOpen:!0,onClose:t,showCloseButton:!0,primaryButton:(0,z.jsx)(d.Z.Button,{color:"primary",onClick:t,children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.closeButton",defaultMessage:"Close"})}),type:"success",children:(0,z.jsx)("div",{className:"flex flex-col gap-2 text-sm",children:(0,z.jsx)("div",{children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.appealSubmittedText",defaultMessage:"Your appeal has been submitted. We will get back to you as soon as possible."})})})})}function U(e){let{gizmoId:t,onClose:r}=e,{data:s}=(0,p.b9)(t,!0),i=(0,h.NL)(),n=async()=>{await m.U.postGizmoCancelAppeal(i,t)};return(0,z.jsx)(u.Z,{isOpen:!0,onClose:j(),primaryButton:(0,z.jsx)(d.Z.Button,{color:"primary",onClick:()=>{n(),null==r||r()},children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.cancelAppealButton",defaultMessage:"Cancel appeal"})}),type:"warning",children:(0,z.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,z.jsx)("h2",{className:"text-lg font-semibold",children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.appealReviewingHeader",defaultMessage:"Reviewing your appeal"})}),(0,z.jsx)("p",{children:(0,z.jsx)(k.Z,{id:"gizmo.appeals.appealSentModalText",defaultMessage:"During the review you can continue using “{gizmoName}” as your private GPT, but won’t be able to update it or share it with others.",values:{gizmoName:null==s?void 0:s.gizmo.display.name}})})]})})}function B(e){let{appealState:t,onAppealClose:r,onAppealSubmitted:s}=e,{value:i}=(0,x.sB)("4226692983"),{0:n,1:a}=(0,y.useState)(!1);return n?(0,z.jsx)(R,{onClose:()=>{a(!1),null==s||s()}}):(0,z.jsxs)(z.Fragment,{children:[(null==t?void 0:t.showModal)==S.AppealSent&&(0,z.jsx)(U,{gizmoId:t.gizmoId,onClose:r}),(null==t?void 0:t.showModal)==S.AppealAvailable&&(0,z.jsx)(G,{gizmoId:t.gizmoId,sharingRecipient:t.sharingRecipient,categories:t.categories,moderationType:t.moderationType,sharingTargets:t.sharingTargets,appealAvailable:i,onClose:()=>null==r?void 0:r(),onAppealSubmitted:()=>a(!0)})]})}},22674:function(e,t,r){r.d(t,{V9:function(){return t2},yf:function(){return tH}});var s,i,n,a=r(98601),o=r(99333),l=r(16757),c=r(97537),d=r(98303),u=r(51307),p=r(11550),m=r(6440),g=r(66587),f=r(77748),h=r(71090),x=r(92379),b=r(62984),v=r(88301),j=r(651);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function k(e){var t,r,s;let{gizmoEditorData:i,onOpen:n}=e,a=null==i||null===(t=i.tools)||void 0===t?void 0:t.find(e=>e.type===o.qK.INTENT&&"prompt_config"in e.settings),{0:l}=(0,x.useState)(null!==(r=null==a?void 0:a.settings.prompt_config)&&void 0!==r?r:[]),{0:c}=(0,x.useState)(null!==(s=null==a?void 0:a.settings.state_keys)&&void 0!==s?s:[]);return(0,j.jsxs)(v.hj,{children:[(0,j.jsx)("div",{className:"text-sm",children:(0,j.jsx)(v.lX,{label:"Blocks + State",description:"Blocks and State for your GPT"})}),(0,j.jsxs)("div",{className:"mb space-y-1",children:[!(l||c)&&(0,j.jsx)("div",{className:"flex text-token-text-primary",children:"Add prompt blocks and state keys to your GPT"}),(0,j.jsx)(h.cY,{onClick:()=>n(),children:l||c?"Show Blocks & State":"Add Blocks & State"})]})]})}function P(e){var t,r,s;let{gizmoEditorData:i,updateGizmo:n,onClose:a}=e,l=null==i||null===(t=i.tools)||void 0===t?void 0:t.find(e=>e.type===o.qK.INTENT&&"prompt_config"in e.settings),{0:c,1:d}=(0,x.useState)(null!==(r=null==l?void 0:l.settings.prompt_config)&&void 0!==r?r:[]),{0:u,1:m}=(0,x.useState)(null!==(s=null==l?void 0:l.settings.state_keys)&&void 0!==s?s:[]),g={key_name:"",description:""},y={prompt_key:"",prompt:"",continuation:"",hidden:!1},k=()=>{n(e=>w(w({},e),{},{tools:l?e.tools.map(e=>e.type===o.qK.INTENT?w(w({},e),{},{settings:w(w({},e.settings),{},{prompt_config:c,state_keys:u})}):e):[...e.tools,{type:o.qK.INTENT,settings:{prompt_config:c,state_keys:u}}]}))};return(0,j.jsxs)("div",{className:"h-full overflow-auto px-4 pb-12 text-sm",children:[(0,j.jsxs)("div",{className:"relative flex flex-col items-center px-16 py-6 text-center",children:[(0,j.jsx)("div",{className:"absolute left-0 top-6",children:(0,j.jsx)(p.z,{color:"secondary",onClick:a,icon:f.DUf})}),(0,j.jsx)("div",{className:"text-xl font-semibold",children:(0,j.jsx)(b.Z,{id:"eIFoMg",defaultMessage:"Blocks & State"})}),(0,j.jsx)("div",{className:"text-sm text-token-text-tertiary",children:(0,j.jsx)(b.Z,{id:"rdK8Dl",defaultMessage:"Construct your GPT with instruction blocks and state."})}),(0,j.jsx)(v.lX,{label:(0,j.jsx)("div",{className:"text-sm font-semibold text-token-text-tertiary",children:"Learn more"}),description:(0,j.jsxs)("div",{className:"space-y-2 text-sm font-normal",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{children:"Blocks"})," allow you to break up your GPT's instructions into smaller sections, letting the GPT decide which to load up in what scenario."]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{children:"State"})," gives the GPT a per-user storage for data, that will be provided at the start of all new conversations."]})]})})]}),(0,j.jsx)(v.hj,{children:(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsxs)("div",{className:"mb-4 space-y-5 text-lg",children:[(0,j.jsx)(v.lX,{label:(0,j.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,j.jsx)("span",{children:"Instruction Blocks"}),(0,j.jsx)(f.szr,{className:"icon-sm"})]}),description:(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsx)("div",{children:"Instruction Blocks are added to the end of your GPT's instructions when the GPT decides to use them."}),(0,j.jsx)("div",{children:"The GPT only knows these blocks by their name. and your initial GPT instructions must describe how to use at least one of these blocks."})]})}),(0,j.jsxs)("div",{className:"space-y-5 text-sm",children:[c.map((e,t)=>(0,j.jsx)(O,{promptKey:e.prompt_key,prompt:e.prompt,continuation:e.continuation,hidden:e.hidden,visible:!1,isDuplicate:c.filter(t=>t.prompt_key===e.prompt_key).length>1,onChange:e=>{let{promptKey:r,prompt:s,continuation:i,hidden:n}=e;d(e=>{let a=[...e];return a[t]={prompt_key:r,prompt:s,continuation:i,hidden:n},a}),k()},onDelete:e=>{let{promptKey:t}=e;d(e=>e.filter(e=>e.prompt_key!==t)),k()}},t)),(0,j.jsx)(h.cY,{onClick:()=>{d(e=>[...e,y])},children:"Add Block"})]}),(0,j.jsx)(v.lX,{label:(0,j.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,j.jsx)("span",{children:"Saved State"}),(0,j.jsx)(f.szr,{className:"icon-sm"})]}),description:(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsx)("div",{children:"State the GPT can save per-user, that will be provided at the start of all new conversations"}),(0,j.jsx)("div",{children:"Your GPT has access to write to these state entries, and read from them."}),(0,j.jsx)("div",{children:"The user can see this data."})]})}),u.map((e,t)=>(0,j.jsx)(N,{keyName:e.key_name,description:e.description,isDuplicate:u.filter(t=>t.key_name===e.key_name).length>1,onChange:e=>{let{keyName:r,description:s}=e;m(e=>{let i=[...e];return i[t]={key_name:r,description:s},i}),k()},onDelete:e=>{let{keyName:t}=e;m(e=>e.filter(e=>e.key_name!==t)),k()}},t))]}),(0,j.jsx)(h.cY,{onClick:()=>{m(e=>[...e,g])},children:"Add State Data"})]})})]})}function O(e){let{promptKey:t,prompt:r,continuation:s,hidden:i,visible:n,isDuplicate:a,onChange:o,onDelete:l}=e,{0:c,1:d}=(0,x.useState)(i),{0:u,1:p}=(0,x.useState)(n),h=[];t.length>20&&h.push({msg:"Block names work best when they are short"}),a&&h.push({msg:"Block names must be unique"});let b=h.length>0?f.ETw:void 0;return(0,j.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,j.jsxs)("div",{className:"flex space-x-2 text-sm",children:[(0,j.jsx)(v.lX,{collapsed:!u,label:"Block",onClick:()=>{p(!u)}}),(0,j.jsx)(m.Z,{name:"promptKey",value:t,onChange:e=>o({promptKey:e.target.value,prompt:r,continuation:s}),icon:b,className:"max-w-xs grow-0",placeholder:"Block name"})]}),h.map(e=>(0,j.jsx)("div",{className:"text-xs text-token-text-secondary",children:e.msg},e.msg)),u&&(0,j.jsxs)("div",{className:"mb-4 space-y-1",children:[(0,j.jsx)(g.Z,{rows:5,name:"prompt",value:r,onChange:e=>o({promptKey:t,prompt:e.target.value,continuation:s}),className:"grow",placeholder:"Block Text"}),z&&(0,j.jsxs)("div",{className:"flex space-x-2 text-sm",children:[(0,j.jsx)("div",{role:"button",className:"flex items-center space-x-2",onClick:()=>{o({promptKey:t,prompt:r,continuation:s,hidden:!c}),d(!c)},children:c?(0,j.jsx)(f.Xl7,{className:"icon-sm"}):(0,j.jsx)(f.tEF,{className:"icon-sm"})}),(0,j.jsx)(v.lX,{label:"Continue on to:",description:"When set, the GPT will automatically go to the that block after this one."}),(0,j.jsx)(m.Z,{name:"continuation",value:s,onChange:e=>o({promptKey:t,prompt:r,continuation:e.target.value}),className:"max-w-xs grow-0",placeholder:"Continuation"})]}),(0,j.jsx)("div",{role:"button",className:"flex items-center space-x-2",onClick:()=>{l({promptKey:t})},children:(0,j.jsx)(f.XHJ,{className:"icon-sm"})})]})]})}function N(e){let{keyName:t,description:r,isDuplicate:s,onChange:i,onDelete:n}=e,a=[];t.length>20&&a.push({msg:"State names work best when they are short"}),s&&a.push({msg:"State names must be unique"});let o=a.length>0?f.ETw:void 0;return(0,j.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,j.jsxs)("div",{className:"flex space-x-2 text-sm",children:[(0,j.jsx)(m.Z,{name:"key",value:t,onChange:e=>i({keyName:e.target.value,description:r}),icon:o,className:"max-w-xs grow-0",placeholder:"State Name"}),(0,j.jsx)(m.Z,{name:"description",value:r,onChange:e=>i({keyName:t,description:e.target.value}),className:"max-w-s flex-grow",placeholder:"Description"}),(0,j.jsx)("div",{role:"button",className:"flex items-center space-x-2",onClick:()=>{n({keyName:t})},children:(0,j.jsx)(f.XHJ,{className:"icon-sm"})})]}),a.map(e=>(0,j.jsx)("div",{className:"text-xs text-token-text-secondary",children:e.msg},e.msg))]})}let z=!1;var C=r(39004),M=r(10080),Z=r(24740),T=r(67437),S=r(93951),_=r(41987),I=r(92745),E=r(31498),L=r(92319),D=r(13391),A=r(3551),G=r(38724),R=r(43991),U=r(42420),B=r(99976),F=r(61619),K=r(82363),W=r(13249),q=r(19841),X=r(17806),Y=r.n(X),Q=r(89678),V=r.n(Q),J=r(65925),H=r.n(J),$=r(38482),ee=r.n($),et=r(34977),er=r(75172),es=r(68306),ei=r(2346),en=r(12128),ea=r(46702),eo=r(31438),el=r(66290),ec=r(88667),ed=r(15478),eu=r(38838),ep=r(98095),em=r(76665),eg=r(99555),ef=r(41177),eh=r(23763),ex=r.n(eh),eb=r(24434),ev=r(30853),ej=r(21025),ey=r(81107);function ew(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function ek(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ew(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ew(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function eP(e){let{gizmo:t,updateGizmo:r,publishedGizmo:s,promoteGizmo:i,appealGizmo:n,setAppealState:a,showActionsModal:o,shareOnly:l,onClose:c}=e,{0:d,1:u}=(0,x.useState)({type:"privacy"});return"privacy"===d.type?(0,j.jsx)(eO,{gizmo:t,updateGizmo:r,publishedGizmo:s,promoteGizmo:i,appealGizmo:n,setAppealState:a,setStep:u,showActionsModal:o,shareOnly:l,onClose:c}):(0,j.jsx)(eN,{publishedGizmo:d.publishedGizmo,onClose:c})}function eO(e){var t,r,s,i;let{gizmo:n,publishedGizmo:a,updateGizmo:l,promoteGizmo:c,appealGizmo:d,setAppealState:m,setStep:g,showActionsModal:f,shareOnly:h,onClose:v}=e,{0:y,1:w}=(0,x.useState)(!1),k=(0,E.ec)(E.F_.isBusinessWorkspace),P=(0,er.Z)(),{0:O,1:N}=(0,x.useState)((0,C.Sg)(n)?k?M.Zz.Workspace:M.Zz.Link:n.sharingRecipient),z=(0,U.NL)(),T=(0,ej.YK)(O,n.sharingTargets),{data:_,isLoading:I}=(0,C.WL)(),L=(0,C.Z1)(),{0:D,1:A}=(0,x.useState)(null!=a&&a.gizmo.display.categories.length>0?null===(t=L.data)||void 0===t||null===(t=t.categories.find(e=>e.id===a.gizmo.display.categories[0]))||void 0===t?void 0:t.id:void 0);(0,x.useEffect)(()=>{A(null==a?void 0:a.gizmo.display.categories[0])},[null==a?void 0:a.gizmo.display.categories]);let{0:G,1:B}=(0,x.useState)(void 0),F=(0,x.useRef)(ex()((e,t)=>eg.U.generateCategory(e,t),1e3)),K=null!=_&&_.is_verified?void 0:P.formatMessage({id:"qEQtmt",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile."});O!==M.Zz.Marketplace||null==K||I||N(M.Zz.Link);let W=k&&!(null!==(r=n.sharingTargets)&&void 0!==r&&r.some(e=>e.recipient===M.Zz.Link)),q=(0,em.bw)(n,O,D),X=q.includes(em.hs.MissingPublicActionPrivacyPolicyURL),Y=n.tools.find(e=>e.type===o.qK.JIT_PLUGIN&&!e.metadata.privacy_policy_url),Q=(0,E.ec)(e=>e.currentWorkspace),V=(0,S.hz)();(0,x.useEffect)(()=>{let e=!0;return(async()=>{try{if(null!=D)return;let t=await F.current(n.name,n.instructions);e&&null==D&&(t?A(t.id):B(!0))}catch(t){e&&null==D&&B(!0)}})(),()=>{e=!1}},[n.instructions,n.name,V,D]);let{value:J}=(0,ec.sB)("4226692983");return(0,j.jsx)(eb.Z,{type:"success",isOpen:!0,onClose:v,title:(0,j.jsx)(b.Z,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:T?(0,j.jsx)(p.z,{color:"primary",disabled:q.length>0,loading:y,onClick:async()=>{try{if(w(!0),h){if(!(null!=a&&a.gizmo.id)){Z.m.danger(P.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}));return}let e=await eg.U.shareGizmo(a.gizmo.id,D?{sharing:(0,M.Mj)(O,[],M.EL),categories:[D]}:{sharing:(0,M.Mj)(O,[],M.EL)});e.error?(Z.m.warning(P.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),l({sharingTargets:e.sharing_targets}),m({gizmoId:a.gizmo.id,sharingRecipient:O,categories:a.gizmo.display.categories,moderationType:u.Te.PublishBlocked,sharingTargets:e.sharing_targets,showModal:u.UJ.AppealAvailable})):(z.setQueryData(["gizmo",{gizmoId:a.gizmo.id},{draft:!1}],t=>e.resource),l(e=>ek(ek({},e),{},{sharingRecipient:O})),Z.m.success(P.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),v())}else{let e=await c({recipient:O,subjects:(0,M.Mj)(O,[],M.EL)},D);e?(g({type:"published",publishedGizmo:e}),l(t=>ek(ek({},t),{},{id:e.gizmo.id,sharingRecipient:O})),null!=e.gizmo.live_version&&l({liveVersion:e.gizmo.live_version}),Z.m.success(P.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}))):(Z.m.warning(P.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),v())}}finally{w(!1)}},children:(0,j.jsx)(b.Z,{id:"SW4DG4",defaultMessage:"Save"})}):J?(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(p.z,{color:"primary",onClick:async()=>{await d(O,D)},children:(0,j.jsx)(b.Z,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:a?(0,j.jsx)(p.z,{color:"secondary",onClick:()=>(0,ey.A4)(a,P.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:(0,j.jsx)(b.Z,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:(0,j.jsxs)("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[(0,j.jsx)("div",{className:"space-y-1.5",children:(0,j.jsxs)(R.fC,{value:O,onValueChange:e=>N(e),children:[n.sharingTargets&&n.sharingTargets.map((e,t)=>(0,j.jsx)(eC,{value:e.recipient,disabled:e.recipient===M.Zz.Marketplace&&null!=K,tooltipText:e.recipient===M.Zz.Marketplace?null!=K?K:P.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:e.recipient},t)),W&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(eC,{value:M.Zz.Link,disabled:!0,tooltipText:P.formatMessage(ez.workspaceDisabledHint),shareLevel:M.Zz.Link,workspaceName:null==Q?void 0:Q.name}),(0,j.jsx)(eC,{value:M.Zz.Link,disabled:!0,tooltipText:P.formatMessage(ez.workspaceDisabledHint),shareLevel:M.Zz.Marketplace,workspaceName:null==Q?void 0:Q.name})]})]})}),X&&(0,j.jsx)("div",{className:"text-xs text-red-500",children:(0,j.jsx)(b.Z,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:e=>(0,j.jsx)("button",{onClick:()=>{f(null==Y?void 0:Y.metadata.action_id)},className:"underline",children:e})}})}),O!==M.Zz.Private&&(0,j.jsx)(ef.O2,{gizmo:n,category:D,categories:O===M.Zz.Marketplace?null!==(s=null===(i=L.data)||void 0===i?void 0:i.categories)&&void 0!==s?s:[]:void 0,onCategoryChange:O===M.Zz.Marketplace?e=>A(e.id):void 0}),O===M.Zz.Marketplace&&(G?(0,j.jsx)("div",{className:"text-xs text-red-500",children:(0,j.jsx)(b.Z,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!T&&J&&(0,j.jsx)("div",{className:"flex items-center justify-between text-sm text-token-text-secondary",children:(0,j.jsx)(b.Z,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function eN(e){let{publishedGizmo:t,onClose:r}=e,s=(0,ey.Rb)(t),i=(0,er.Z)();return(0,j.jsx)(eb.Z,{type:"success",isOpen:!0,onClose:r,title:(0,j.jsx)(b.Z,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:(0,j.jsx)(p.z,{color:"primary",as:"link",to:s,children:(0,j.jsx)(b.Z,{id:"lyZz44",defaultMessage:"View GPT"})}),children:(0,j.jsx)("div",{className:"flex flex-col gap-2",children:(0,j.jsxs)("div",{className:"flex gap-1 rounded bg-token-main-surface-secondary px-2 py-1",children:[(0,j.jsx)("div",{className:"line-clamp-1 text-ellipsis break-all",children:s}),(0,j.jsx)("button",{onClick:()=>{(0,ey.A4)(t,i.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary transition hover:text-token-text-primary",children:(0,j.jsx)(f.TIy,{className:"icon-sm"})})]})})})}let ez=(0,es.vU)({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function eC(e){let{shareLevel:t,workspaceName:r,value:s,disabled:i=!1,tooltipText:n}=e,a=(0,x.useId)();return(0,j.jsx)(ev.E,{disabled:null==n,label:n,side:"top",children:(0,j.jsxs)(R.ck,{id:a,value:s,disabled:i,className:"flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold hover:bg-token-main-surface-secondary",children:[(0,j.jsx)("label",{htmlFor:a,className:"flex cursor-pointer items-center gap-1",children:(0,j.jsx)(ef.C6,{shareLevel:t,workspaceName:null!=r?r:"",hasInviteSharing:!1})}),(0,j.jsx)(R.z$,{children:(0,j.jsx)(f.kvR,{className:"icon-lg mr-1"})})]})})}function eM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function eZ(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eM(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eM(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function eT(e){e(window.history.length>1?-1:(0,A.L7)())}function eS(e){var t;let{gizmo:r,publishedGizmo:s,isLoading:i,isUploadingProfilePic:n,isGeneratingProfilePic:a,updateGizmo:o,promoteGizmo:l,appealGizmo:c,setAppealState:d,showActionsModal:u}=e,p=(0,S.t)(),m=null!=r?(0,em.bw)(r):[];(null==r||i)&&m.push(em.hs.Loading),n&&m.push(em.hs.UploadingProfilePic),a&&m.push(em.hs.GeneratingProfilePic);let g=(0,C.Sg)(r),{0:f,1:v}=(0,x.useState)(!1),{0:y,1:w}=(0,x.useState)(!1),k=r.sharingRecipient?ef.P6[r.sharingRecipient]:ef.P6.private;return(0,j.jsxs)(j.Fragment,{children:[g?(0,j.jsx)(h.cY,{color:"primary",onClick:()=>v("promote"),loading:i,disabled:void 0===r.id||m.length>0,tooltip:m.length>0?m.map(em.sw).join("\n"):void 0,children:(0,j.jsx)(b.Z,{id:"svUGIb",defaultMessage:"Create"})}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(h.cY,{color:"secondary",loading:i||!s,onClick:()=>v("share"),children:[(0,j.jsx)(k,{className:"icon-sm shrink-0"}),(0,j.jsx)(b.Z,{id:"aXKW4G",defaultMessage:"Share"})]}),(0,j.jsx)(h.cY,{color:"primary",onClick:async()=>{var e;let t=r.sharing.subjects.map(ef.xH),i=(0,M.H$)(r.sharing.subjects);t=(0,M.Mj)(r.sharing.recipient,t,null!==(e=null==i?void 0:i.capabilities)&&void 0!==e?e:M.EL),await l({recipient:r.sharing.recipient,subjects:t},null==s?void 0:s.gizmo.display.categories[0])&&w(!0)},loading:i||!s,disabled:m.length>0,tooltip:m.length>0?m.map(em.sw).join("\n"):void 0,children:(0,j.jsx)(b.Z,{id:"84QVoj",defaultMessage:"Update"})})]}),f&&((null==p?void 0:p.getWorkspaceId())==void 0?(0,j.jsx)(eP,{gizmo:r,publishedGizmo:s,promoteGizmo:l,appealGizmo:c,setAppealState:d,showActionsModal:u,updateGizmo:o,shareOnly:"share"===f,onClose:()=>v(!1)}):(0,j.jsx)(ef.hD,{gizmo:r,publishedGizmo:s,promoteGizmo:l,appealGizmo:c,setAppealState:d,showActionsModal:u,updateGizmo:o,onClose:()=>v(!1),shareOnly:"share"===f})),y&&(0,j.jsx)(ef.uj,{publishedGizmo:s,sharing:s.gizmo.sharing,onClose:()=>w(!1),workspaceName:null!==(t=null==p?void 0:p.data.name)&&void 0!==t?t:""})]})}function e_(e){let{gizmoEditorData:t,publishedGizmo:r,revertDraft:s}=e,i=(0,er.Z)(),n=(0,el.Z)(),{0:a,1:o}=(0,x.useState)(!1),l=(0,S.hz)(),{value:c}=(0,ec.sB)("3645668434");return null!=l&&l.includes("debug")||(null==t?void 0:t.id)!=null?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(ep.d,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:(0,j.jsx)(h.cY,{color:"ghost",icon:f.nWS}),children:[null!=r&&(0,j.jsxs)(ep.Z.Item,{onClick:()=>{(0,ey.A4)(r)},children:[(0,j.jsx)(f.xPt,{className:"icon-sm"}),(0,j.jsx)(b.Z,eZ({},eA.copyLink))]}),null!=s&&(0,j.jsxs)(ep.Z.Item,{onClick:()=>{window.confirm(i.formatMessage(eA.revertConfirm))&&s()},children:[(0,j.jsx)(f.Ezi,{className:"icon-sm"}),(0,j.jsx)(b.Z,{id:"W2blnV",defaultMessage:"Revert..."})]}),(null==t?void 0:t.id)!=null&&c&&t.liveVersion>0&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(ep.Z.Item,{onClick:()=>{n("/g/".concat(t.id,"/view"))},children:[(0,j.jsx)(f.JJ3,{className:"icon-sm"}),(0,j.jsx)(b.Z,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),(0,j.jsxs)(ep.Z.Item,{onClick:async()=>{let e=await eg.U.copyGizmo({gizmoId:t.id});e.gizmo.id&&n("/gpts/editor/".concat(e.gizmo.id))},children:[(0,j.jsx)(f.TIy,{className:"icon-sm"}),(0,j.jsx)(b.Z,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),(null==t?void 0:t.id)!=null&&(0,j.jsxs)(ep.Z.Item,{color:"danger",onClick:()=>{o(!0)},children:[(0,j.jsx)(f.XHJ,{className:"icon-sm"}),(0,j.jsx)(b.Z,{id:"tNrOLG",defaultMessage:"Delete GPT"})]}),(null==l?void 0:l.includes("debug"))&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ep.Z.Separator,{}),(0,j.jsxs)(ep.Z.Item,{onClick:()=>{eo.vm.toggleActiveSidebar("debug")},children:[(0,j.jsx)(f.reV,{className:"icon-sm"}),"Debug (Internal only)"]})]})]}),a&&(0,j.jsx)(ea.b,{gizmoId:t.id,onSuccess:()=>eT(n),onClose:()=>{o(!1)}})]}):null}let eI=ed.Z.div(i||(i=(0,ei.Z)(["flex items-center gap-1"])));function eE(e){let{gizmoEditorData:t}=e,r=(0,E.ec)(e=>{var t;return null===(t=e.currentWorkspace)||void 0===t?void 0:t.name});switch(t.sharingRecipient){case M.Zz.Private:return(0,j.jsxs)(eI,{children:[(0,j.jsx)(f.oVl,{className:"icon-xs"}),(0,j.jsx)(b.Z,eZ({},eA.onlyMe))]});case M.Zz.Link:return(0,j.jsxs)(eI,{children:[(0,j.jsx)(f.xPt,{className:"icon-xs"}),(0,j.jsx)(b.Z,eZ({},eA.anyoneWithLink))]});case M.Zz.Workspace:return(0,j.jsxs)(eI,{children:[(0,j.jsx)(f.ZyV,{className:"icon-xs"}),r]});case M.Zz.Marketplace:return(0,j.jsxs)(eI,{children:[(0,j.jsx)(f.frp,{className:"icon-xs"}),(0,j.jsx)(b.Z,eZ({},eA.public))]});default:return(0,j.jsx)("div",{})}}function eL(e){let{gizmoEditorData:t}=e;return(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[null!=t.profilePictureUrl?(0,j.jsx)(en.Z,{isFirstParty:!1,src:t.profilePictureUrl,className:"h-8 w-8"}):(0,j.jsx)("div",{className:"h-8 w-8 rounded-full border-2 border-dashed border-token-border-medium"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{className:"text-sm font-semibold",children:t.name||(0,j.jsx)(b.Z,eZ({},eA.newGPT))}),(0,j.jsx)("div",{className:"text-xs text-token-text-secondary",children:(0,C.Sg)(t)?(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-token-text-tertiary"}),(0,j.jsx)(b.Z,eZ({},eA.draft))]}):(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-brand-green"}),t.sharingRecipient===M.Zz.Marketplace?(0,j.jsx)(b.Z,eZ({},eA.published)):(0,j.jsx)(b.Z,{id:"gizmoEditorHeader.live",defaultMessage:"Live"})," \xb7 ",(0,j.jsx)(eE,{gizmoEditorData:t})]})})]})]})}function eD(e){let{gizmoEditorData:t,isLoading:r,isUploadingProfilePic:s,isGeneratingProfilePic:i,publishedGizmo:n,updateGizmo:a,promoteGizmo:o,appealGizmo:l,setAppealState:c,revertDraft:d,draftMessage:u,className:p,hasUnpublishedChanges:m,showActionsModal:g}=e,f=(0,el.Z)();return(0,j.jsxs)("div",{className:(0,q.default)("relative flex h-14 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",p),children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("a",{className:"cursor-pointer text-token-text-primary",onClick:()=>eT(f),children:(0,j.jsx)(eu.Dz,{className:"icon-lg"})}),(0,j.jsx)(eL,{gizmoEditorData:t})]}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[u,(0,j.jsx)(e_,{gizmoEditorData:t,publishedGizmo:n,revertDraft:d}),(0,j.jsx)(eS,{gizmo:t,publishedGizmo:n,isLoading:r,isUploadingProfilePic:s,isGeneratingProfilePic:i,updateGizmo:a,promoteGizmo:o,appealGizmo:l,setAppealState:c,hasUnpublishedChanges:m,showActionsModal:g})]})]})}let eA=(0,es.vU)({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"}});var eG=r(18939),eR=r.n(eG),eU=r(64216),eB=r(25899),eF=r(72349),eK=r(44395),eW=r(20772),eq=r(45027),eX=r(84082),eY=r(93866),eQ=r(98628),eV=r(66114);function eJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function eH(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eJ(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eJ(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function e$(){return(0,j.jsx)("div",{className:"relative flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-token-border-medium",children:(0,j.jsx)(c.Z,{className:"h-1/4 w-1/4"})})}function e0(e){let{gizmoEditorData:t,onFileChange:r,generateProfilePic:s,isGeneratingProfilePic:i,setIsGeneratingProfilePic:n}=e,a=(0,er.Z)(),{0:l,1:c}=(0,x.useState)(void 0),d=(0,x.useRef)(r);async function u(e){if(e.length>0){n(!1);let t=await (0,eV.WI)(e[0],512),r=(0,eQ.W7)(t);c({tempId:r,file:t,status:eY.XX.Uploading,progress:1,fileId:null,cdnUrl:null}),d.current("uploading"),(0,eQ.lU)(r,t,a,o.Ei.ProfilePicture,{onFileCreated(e,t,r){c(s=>"initial"!==s&&(null==s?void 0:s.tempId)===e&&s.status===eY.XX.Uploading?eH(eH({},s),{},{progress:10,fileId:t,cdnUrl:r}):s)},onFileUploadProgress(e,t){c(r=>"initial"!==r&&(null==r?void 0:r.tempId)===e&&r.status===eY.XX.Uploading?eH(eH({},r),{},{progress:t}):r)},onFileUploaded(e,t,r){c(t=>"initial"!==t&&(null==t?void 0:t.tempId)===e?(d.current(t),eH(eH({},t),{},{status:eY.XX.Ready,progress:100,fileSpec:eH({name:t.file.name,id:t.fileId,size:t.file.size},null!=r?r:{})})):t)},onError(e){c(t=>{if("initial"!==t&&(null==t?void 0:t.tempId)===e){d.current(void 0);return}return t})}})}}(0,x.useEffect)(()=>{d.current=r});let{open:p,getInputProps:m}=(0,eF.uI)(eH({disabled:!1,noClick:!0,onDropAccepted:u,onDropRejected:e=>(0,eW.UJ)(e,a,eY.AJ.ProfilePicture),multiple:!0,maxSize:eX.xC},(0,eV.Z8)(eV.KL)));return(0,j.jsxs)("div",{className:"flex w-full items-center justify-center gap-4",children:[(0,j.jsxs)(ep.d,{sideOffset:8,triggerButton:(0,j.jsx)("button",{className:"h-20 w-20",children:i?(0,j.jsx)(e$,{}):null!=l&&"initial"!=l&&l.status!=eY.XX.Ready?(0,j.jsxs)("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[(0,j.jsx)(eq.l,{file:l.file}),l.status===eY.XX.Uploading&&l.progress<90?(0,j.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:(0,j.jsx)(eK.Z,{percentage:l.progress,className:"h-6 w-6"})}):null]}):(null==t?void 0:t.profilePictureUrl)!=null&&(null==t?void 0:t.profilePictureUrl)!==""?(0,j.jsx)(en.Z,{isFirstParty:!1,src:t.profilePictureUrl}):(0,j.jsx)("div",{className:"flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-token-border-medium",children:(0,j.jsx)(f.Vz5,{className:"text-4xl"})})}),children:[(0,j.jsx)(ep.Z.Item,{onClick:p,children:(0,j.jsx)(b.Z,{id:"ERQwXg",defaultMessage:"Upload Photo"})}),(0,j.jsx)(ep.Z.Item,{onClick:s,children:(0,j.jsx)(b.Z,{id:"NXAog/",defaultMessage:"Use DALL\xb7E"})})]}),(0,j.jsx)("input",eH({},m()))]})}function e1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function e2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?e1(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e1(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function e4(e){var t,r,s;let{gizmoEditorData:i,updateGizmo:n}=e,a=null==i||null===(t=i.tools)||void 0===t?void 0:t.find(e=>e.type===o.qK.INTENT&&"intents"in e.settings),{0:l,1:c}=(0,x.useState)(null!==(r=null==a?void 0:a.settings.intents)&&void 0!==r?r:""),{0:d,1:u}=(0,x.useState)(null!==(s=null==a?void 0:a.settings.intent_hook)&&void 0!==s?s:""),{0:m,1:g}=(0,x.useState)(!1),f=(0,er.Z)(),b=()=>{n(e=>e2(e2({},e),{},{tools:a?e.tools.map(e=>e.type===o.qK.INTENT?e2(e2({},e),{},{settings:e2(e2({},e.settings),{},{intents:l,intent_hook:d})}):e):[...e.tools,{type:o.qK.INTENT,settings:{intents:l,intent_hook:d}}]})),g(!1)};return(0,j.jsxs)(v.hj,{children:[(0,j.jsx)(v.lX,{label:"GPT Script",description:f.formatMessage({id:"gizmo.gptScriptExplanation",defaultMessage:"Code and Intents to save GPT state"})}),m&&(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsx)(v.lX,{label:"Intent Hook"}),(0,j.jsx)(v.B1,{value:d,rows:20,onChange:e=>u(e.target.value),placeholder:'def f(input):\nreturn {\n  "instructions": str(input.intent),\n  "conversation_state": input.conversation_state,\n  "user_state": input.user_state,\n  "pinned": {},\n}',className:"h-50 mb-4 block w-full resize-none rounded-md border border-gray-300 p-2 font-mono text-xs shadow-sm focus:border-blue-500 focus:ring-blue-500",spellCheck:"false"}),(0,j.jsx)(v.lX,{label:"Intents"}),(0,j.jsx)(v.B1,{value:l,rows:20,onChange:e=>c(e.target.value),placeholder:"Enter Intent",className:"h-50 mb-4"}),(0,j.jsx)(p.z,{color:"primary",onClick:()=>{b()},children:"Update"})]}),!m&&(0,j.jsx)(h.cY,{onClick:()=>g(!0),children:d?"Update Script":"Add Script"})]})}var e3=r(2721),e5=r(21389),e8=r(88600),e9=r(51857),e7=r.n(e9);function e6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?e6(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e6(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function tt(e){var t;let{gizmoEditorData:r,requireGizmoId:s,currentModelConfig:i,updateGizmo:n}=e,a=(0,er.Z)(),{0:l,1:c}=(0,x.useState)(0),d=(0,x.useRef)(new Map),u=(0,eV.Zp)(i,void 0),p=async e=>{B.A.logEvent(F.M.uploadFile,{client:"web",eventSource:"mouse",intent:"gizmo"});let t=await s();e.length>0&&await Promise.all(e.map(e=>{let r=(0,eQ.W7)(e);d.current.set(r,{tempId:r,gizmoId:t,file:e,status:eY.XX.Uploading,progress:1,fileId:null,cdnUrl:null}),(0,eQ.cT)((0,eQ.W7)(e),e,a,{kind:o.Ei.Gizmo,gizmoId:t},{onFileUploaded:(e,t,r,s)=>{let i=d.current.get(e);null!=i&&null!=i.fileId&&(n(e=>{var t;return te(te({},e),{},{files:[...null!==(t=e.files)&&void 0!==t?t:[],{file_id:i.fileId,name:i.file.name,size:i.file.size,type:i.file.type,last_modified:i.file.lastModified,file_size_tokens:null==s?void 0:s.fileTokenSize}]})}),d.current.delete(e),c(e=>e+1))},onFileCreated:(r,s,i)=>{d.current.set(r,te(te({tempId:r,gizmoId:t,file:e,status:eY.XX.Uploading,progress:1},d.current.get(r)),{},{fileId:s,cdnUrl:i})),c(e=>e+1)},onFileUploadProgress:(e,t)=>{let r=d.current.get(e);(null==r?void 0:r.status)===eY.XX.Uploading&&d.current.set(e,te(te({},r),{},{progress:t})),c(e=>e+1)},onError:e=>{d.current.delete(e)}},{usesRetrievalIndex:null!=i&&(0,eV._0)(i,e.type,e.name)===o.Cd.Retrieval})}))},{getInputProps:m,open:g}=(0,eF.uI)(te({disabled:!1,noClick:!0,onDropAccepted:p,multiple:!0,maxSize:eX.xC,maxFiles:10},(0,eV.Z8)(u))),f=null!==(t=null==r?void 0:r.files)&&void 0!==t?t:[];function v(e){return(0,j.jsx)(eq.Z,{onRemoveFileClick:()=>{d.current.delete(e.tempId),c(e=>e+1)},file:e.file,loadingPercentage:e.status===eY.XX.Uploading?e.progress:void 0},e.tempId)}function y(e){return(0,j.jsx)(eq.Z,{file:e.name,fileId:e.file_id,onRemoveFileClick:()=>n(t=>{var r;return te(te({},t),{},{files:null==t||null===(r=t.files)||void 0===r?void 0:r.filter(t=>t.file_id!==e.file_id)})}),gizmoId:null==r?void 0:r.id},e.file_id)}let w=Array.from(d.current.values()).filter(e=>f.every(t=>t.file_id!==e.fileId)),[k,P]=e7()(w,e=>null!=i&&(0,eV._0)(i,e.file.type,e.file.name)===o.Cd.CodeInterpreter),[O,N]=e7()(f,e=>null!=i&&null!=e.type&&(0,eV._0)(i,e.type,e.name)===o.Cd.CodeInterpreter),z=(0,x.useRef)(O.length);return(0,x.useEffect)(()=>{O.length>z.current&&n(e=>{var t,r;return null!==(t=e.tools)&&void 0!==t&&t.some(e=>e.type===o.qK.PYTHON)?e:te(te({},e),{},{tools:[...null!==(r=e.tools)&&void 0!==r?r:[],{type:o.qK.PYTHON}]})}),z.current=O.length},[O.length]),(0,j.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,j.jsx)("div",{className:"rounded-lg text-token-text-tertiary",children:(0,j.jsx)(b.Z,te({},tr.knowledgeWarning))}),P.length>0||N.length>0?(0,j.jsxs)("div",{className:"flex flex-wrap gap-2",children:[P.map(v),N.map(y)]}):null,k.length>0||O.length>0?(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{className:"mb-2 text-xs text-token-text-tertiary",children:(0,j.jsx)(b.Z,{id:"i/QurZ",defaultMessage:"The following files are only available for Code Interpreter:"})}),(0,j.jsxs)("div",{className:"flex flex-wrap gap-2",children:[k.map(v),O.map(y)]})]}):null,(0,j.jsx)("div",{children:(0,j.jsxs)(h.cY,{onClick:g,children:[(0,j.jsx)("input",te({},m())),(0,j.jsx)(b.Z,{id:"sr8Qp/",defaultMessage:"Upload files"})]})})]})}let tr=(0,es.vU)({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"If you upload files under Knowledge, conversations with your GPT may include file contents. Files can be downloaded when Code Interpreter is enabled"}});function ts(e){let{placeholder:t,text:r,onChange:s,onClose:i}=e;return(0,j.jsx)(eb.Z,{className:"!max-h-[100vh] !max-w-[80vw]",type:"success",isOpen:!0,onClose:i,primaryButton:(0,j.jsx)(h.cY,{onClick:i,children:(0,j.jsx)(b.Z,{id:"FeFVdS",defaultMessage:"Close"})}),children:(0,j.jsx)("textarea",{className:"h-[70vh] w-full resize-none rounded-lg bg-token-main-surface-primary dark:border-gray-700",value:r,onChange:e=>{s(e.target.value)},placeholder:t})})}var ti=r(17711);function tn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function ta(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tn(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let to=ed.Z.div(n||(n=(0,ei.Z)(["text-sm text-red-500"])));function tl(e){let{children:t,collapsed:r,initial:s}=e;return(0,j.jsx)(e5.M,{initial:s,children:!r&&(0,j.jsx)(e8.E.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:t})})}function tc(e){var t,r,s;let{gizmo:i,onShowActionsEditor:n,isDisabled:a}=e,l=(0,er.Z)(),c=(0,j.jsxs)("div",{className:"space-y-1",children:[null==i||null===(t=i.tools)||void 0===t?void 0:t.map((e,t)=>{var r;return e.type!==o.qK.JIT_PLUGIN?null:(0,j.jsxs)("div",{children:[(0,j.jsx)(v.r,{isDisabled:a,actionTool:e,onShowActionsEditor:()=>n(e.metadata.domain)}),(null===(r=e.metadata.auth)||void 0===r?void 0:r.type)==="oauth"&&(0,j.jsx)(eU.Z,{label:l.formatMessage(tp.callbackUrlLabel),value:"".concat("https://chat.openai.com","/aip/").concat(e.metadata.action_id,"/oauth/callback"),onCopied:()=>{Z.m.success("Copied to clipboard",{duration:3})}})]},t)}),(null!==(r=null==i||null===(s=i.tools)||void 0===s?void 0:s.filter(e=>e.type===o.qK.JIT_PLUGIN))&&void 0!==r?r:[]).length>=eB.L5?(0,j.jsx)("div",{children:l.formatMessage(tp.maxActionsReached,{number:eB.L5})}):(0,j.jsx)(h.cY,{disabled:a,onClick:()=>{n("Unknown domain")},className:"mt-2",children:(0,j.jsx)(b.Z,ta({},tp.createActionLabel))})]});return a?(0,j.jsx)(ev.u,{side:"top",label:l.formatMessage(tp.disabledCustomActionsTooltip),children:c}):c}function td(e){var t,r,s,i,n,a,l,c;let{gizmoEditorData:u,updateGizmo:p,currentModelConfig:m,generateProfilePic:g,setIsUploadingProfilePic:y,isGeneratingProfilePic:w,setIsGeneratingProfilePic:P,requireGizmoId:O,onShowActionsEditor:N,onShowBlocksEditor:z}=e,C=null!==(t=null==u?void 0:u.tools)&&void 0!==t?t:[],{0:M,1:Z}=(0,x.useState)(!1),{0:T,1:I}=(0,x.useState)(!0),E=null!==(r=null==u?void 0:u.promptStarters)&&void 0!==r?r:[],L=[...E,...E.length<12?[""]:[]],D=(0,em.bw)(u),A=(0,S.t)(),G=null==A?void 0:A.isWorkspaceAccount(),R=(0,d.C)(_.L0.WorkspaceGPTCustomActions),U=(0,er.Z)(),{value:B}=(0,ec.sB)("804300613"),{value:F}=(0,ec.sB)("736089948"),{value:K}=(0,ec.sB)("3047641741");return(0,j.jsxs)("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[(0,j.jsxs)("div",{className:"grow",children:[(0,j.jsxs)(v.hj,{children:[(0,j.jsx)(e0,{gizmoEditorData:u,generateProfilePic:g,isGeneratingProfilePic:w,setIsGeneratingProfilePic:P,onFileChange:async e=>{if(null!=e&&"uploading"!==e&&null!=e.fileId){let t=await e3.Z.getFileDownloadLink(e.fileId);t.status===o.KF.Success&&p({profilePictureId:null!=e.fileId?e.fileId:void 0,profilePictureUrl:t.download_url})}else p({profilePictureId:void 0,profilePictureUrl:void 0});y("uploading"===e)}}),(0,j.jsx)(v.lX,{label:(0,j.jsx)(b.Z,{id:"M4dZms",defaultMessage:"Name"}),description:(0,j.jsx)(b.Z,{id:"+Gkni2",defaultMessage:"The name of your GPT"})}),(0,j.jsx)(v.yt,{type:"text",placeholder:U.formatMessage(tp.gptNamePlaceholder),value:null!==(s=null==u?void 0:u.name)&&void 0!==s?s:"",onChange:e=>{p({name:e.target.value})},onBlurCapture:()=>p(e=>ta(ta({},e),{},{name:e.name.trim()}))}),D.includes(em.hs.GizmoNameTooLong)?(0,j.jsx)(to,{className:"mt-1",children:(0,j.jsx)(b.Z,ta(ta({},tp.nameTooLong),{},{values:{length:eB.aI}}))}):null]}),(0,j.jsxs)(v.hj,{className:"mt-4",children:[(0,j.jsx)(v.lX,{label:(0,j.jsx)(b.Z,{id:"YDzNvf",defaultMessage:"Description"}),description:(0,j.jsx)(b.Z,{id:"dpxCw8",defaultMessage:"Short description of what this GPT does"})}),(0,j.jsx)(v.yt,{type:"text",placeholder:U.formatMessage(tp.descriptionPlaceholder),value:null!==(i=null==u?void 0:u.description)&&void 0!==i?i:"",onChange:e=>p({description:e.target.value}),onBlurCapture:()=>p(e=>{var t,r;return ta(ta({},e),{},{description:null!==(t=null===(r=e.description)||void 0===r?void 0:r.trim())&&void 0!==t?t:""})})}),D.includes(em.hs.GizmoDescriptionTooLong)?(0,j.jsx)(to,{className:"mt-1",children:(0,j.jsx)(b.Z,ta(ta({},tp.descriptionTooLong),{},{values:{length:eB.P_}}))}):null]}),(0,j.jsxs)(v.hj,{children:[(0,j.jsx)(v.lX,{label:(0,j.jsx)(b.Z,{id:"2SO0RJ",defaultMessage:"Instructions"}),description:U.formatMessage(tp.instructionsSubtitle)}),(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)(v.B1,{className:"resize-none",rows:8,value:null==u?void 0:u.instructions,onChange:e=>p({instructions:e.target.value}),onBlurCapture:()=>p(e=>ta(ta({},e),{},{instructions:e.instructions.trim()})),placeholder:U.formatMessage(tp.instructionsSubtitle)}),(0,j.jsx)("button",{className:"absolute bottom-3 right-2 text-token-text-tertiary",onClick:()=>Z(!0),children:(0,j.jsx)(f.Qq,{className:"icon-sm"})})]}),D.includes(em.hs.GizmoInstructionsTooLong)?(0,j.jsx)(to,{className:"mt-1",children:(0,j.jsx)(b.Z,ta(ta({},tp.instructionsTooLong),{},{values:{length:eB.vi}}))}):null]}),(0,j.jsxs)(v.hj,{children:[(0,j.jsx)(v.lX,{label:(0,j.jsx)(b.Z,{id:"6rfYOX",defaultMessage:"Conversation starters"}),description:(0,j.jsx)(b.Z,{id:"OSOIpd",defaultMessage:"Examples for the user to start the conversation"})}),(0,j.jsx)("div",{className:"flex flex-col gap-1",children:L.map((e,t)=>(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsx)(v.yt,{className:"rounded-r-none",value:e,type:"text",onChange:e=>{let r=e.target.value;p(e=>{var s;return ta(ta({},e),{},{promptStarters:eR()(t>=(null!==(s=E.length)&&void 0!==s?s:0)?[...null!=E?E:[],r]:E.map((e,s)=>{if(s===t){if(""===r)return;return r}return e}))})})}}),(0,j.jsx)("button",{className:"flex h-9 w-9 items-center justify-center rounded-lg rounded-l-none border border-l-0 border-token-border-medium",onClick:()=>p(e=>ta(ta({},e),{},{promptStarters:E.filter((e,r)=>r!==t)})),children:(0,j.jsx)(f.tPq,{className:"icon-sm"})})]},t))})]}),(0,j.jsxs)(v.hj,{children:[(0,j.jsx)(v.lX,{label:(0,j.jsx)(b.Z,{id:"bwXSkU",defaultMessage:"Knowledge"}),description:U.formatMessage(tp.knowledgeExplanation)}),(0,j.jsx)(tt,{gizmoEditorData:u,requireGizmoId:O,currentModelConfig:m,updateGizmo:p})]}),(0,j.jsxs)(v.hj,{children:[(0,j.jsx)(v.lX,{label:(0,j.jsx)(b.Z,{id:"mcAwDU",defaultMessage:"Capabilities"}),description:(0,j.jsx)(b.Z,{id:"2exQT6",defaultMessage:"Functionality this GPT can use"})}),(0,j.jsx)(ti.W,{enabledTools:C,onEnabledToolsChange:e=>p({tools:e})})]}),(0,j.jsxs)(v.hj,{children:[(0,j.jsx)(v.lX,{label:(0,j.jsx)(b.Z,{id:"7r7v+u",defaultMessage:"Actions"}),description:(0,j.jsx)(b.Z,{id:"fBln7I",defaultMessage:"APIs this GPT can use"})}),(0,j.jsx)(tc,{isDisabled:!!(G&&!R),gizmo:u,onShowActionsEditor:N})]}),!G&&((null!==(a=null===(l=u.files)||void 0===l?void 0:l.length)&&void 0!==a?a:0)>0||(null==u||null===(c=u.tools)||void 0===c?void 0:c.some(e=>e.type===o.qK.JIT_PLUGIN)))&&(0,j.jsxs)(v.hj,{children:[(0,j.jsx)(v.lX,{label:(0,j.jsx)(b.Z,{id:"R3KeU7",defaultMessage:"Additional Settings"}),collapsed:!!T,onClick:()=>{I(e=>!e)}}),(0,j.jsx)(tl,{collapsed:T,initial:!1,children:(0,j.jsx)(h.f8,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:(0,j.jsx)(b.Z,{id:"tZgwFW",defaultMessage:"Use conversation data in your GPT to improve our models"}),id:"improve-chatgpt",checked:!u.trainingDisabled,onChange:()=>{p({trainingDisabled:!u.trainingDisabled})}})})]}),B&&(0,j.jsx)(tu,{gizmoEditorData:u,updateGizmo:p}),F&&!K&&(0,j.jsx)(e4,{gizmoEditorData:u,updateGizmo:p}),K&&(0,j.jsx)(k,{gizmoEditorData:u,onOpen:z})]}),M&&(0,j.jsx)(ts,{text:null!==(n=u.instructions)&&void 0!==n?n:"",onChange:e=>{p({instructions:e})},onClose:()=>Z(!1),placeholder:U.formatMessage(tp.instructionsSubtitle)})]})}let tu=ee()(()=>r.e(8682).then(r.bind(r,98365)).then(e=>e.GizmoContactsEditor),{loadableGenerated:{webpack:()=>[98365]}}),tp=(0,es.vU)({nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters."},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters."},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters."},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them."},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions"},descriptionPlaceholder:{id:"gizmo.descriptionPlaceholder",defaultMessage:"Add a short description about what this GPT does"},instructionsSubtitle:{id:"gizmo.instructionsSubtitle",defaultMessage:"What does this GPT do? How does it behave? What should it avoid doing?"},gptNamePlaceholder:{id:"gizmo.gptNamePlaceholder",defaultMessage:"Name your GPT"},callbackUrlLabel:{id:"gizmo.callbackUrlLabel",defaultMessage:"Callback URL"}});function tm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function tg(e){let{upsertDraftError:t}=e,r=function(e,t){let r=e.response,s=(0,L.Ot)(e);if(!Array.isArray(r))return s;let i=eR()(r.map(e=>{if("value_error.any_str.max_length"===e.type)switch(e.loc[1]){case"display":switch(e.loc[2]){case"name":return t.formatMessage(tp.nameTooLong,{length:e.ctx.limit_value});case"description":return t.formatMessage(tp.descriptionTooLong,{length:e.ctx.limit_value})}break;case"instructions":return t.formatMessage(tp.instructionsTooLong,{length:e.ctx.limit_value})}if("string"==typeof e.msg)return e.msg}));return i.length>0?i.join("\n"):s}(t,(0,er.Z)());return(0,j.jsxs)("div",{className:"flex items-center gap-2 text-red-500",children:[(0,j.jsx)("div",{children:(0,j.jsx)(b.Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tm(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tm(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},th.errorSavingDraft))}),null!=r&&(0,j.jsx)(ev.u,{label:r,children:(0,j.jsx)(f.szr,{className:"icon-sm"})})]})}function tf(e){let{isPublished:t,isSavingDraft:r,hasUnpublishedChanges:s,upsertDraftError:i,className:n}=e;return i instanceof L.Q0?(0,j.jsx)(tg,{upsertDraftError:i}):s?(0,j.jsxs)("div",{className:(0,q.default)("flex items-center gap-2",n),children:[(0,j.jsx)("span",{className:"text-token-text-secondary",children:t?(0,j.jsx)(b.Z,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):(0,j.jsx)(b.Z,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),(0,j.jsx)("div",{className:"w-4 text-token-text-tertiary",children:r&&(0,j.jsx)(c.Z,{})})]}):null}let th=(0,es.vU)({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}});var tx=r(90945),tb=r(60825),tv=r(62166),tj=r(65418),ty=r(34455),tw=r(92054),tk=r(2319),tP=r(74301),tO=r(46900),tN=r(98541),tz=r(79857),tC=r(38924),tM=r(97834),tZ=r(52978),tT=r(68039),tS=r.n(tT),t_=r(46667),tI=r.n(t_);function tE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function tL(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tE(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tE(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tD(e){let t;for(let r of e)if("gizmo_editor.generate_profile_pic"===r.author.name){let e=tO.U.getImageAssetPointers(r);e.length>0&&(t=e.at(-1))}if(null!=t){let e=(0,eV.Iy)(t.asset_pointer),r=await e3.Z.getFileDownloadLink(e);if(r.status===o.KF.Success)return{id:e,permalink:r.download_url}}}async function tA(e,t,r){var s,i;let n=function(e,t){let r=I.tQ.getThreadCurrentLeafId(e),s=I.tQ.getTree(e),i=[],n=s.getNodeByIdOrMessageId(r);for(;null!=n&&(null==t||n.id!==t);)i.unshift(n.message),n=""!==n.parentId?s.getNodeByIdOrMessageId(n.parentId):void 0;return i}(t,r),a=n.filter(e=>"gizmo_editor.update_behavior"===e.recipient).flatMap(e=>"text"===e.content.content_type?e.content.parts:"code"===e.content.content_type?[e.content.text]:[]).map(e=>JSON.parse(e)).reduce((e,t)=>tL(tL({},e),t),{}),l=await tD(n);if(tS()(a)&&null==l)return;let{name:c,context:d,description:u,profile_pic_file_id:p,prompt_starters:m}=a;if(null!=p)try{let t=await e3.Z.getFileDownloadLink(p,e.id);t.status===o.KF.Success&&(l={id:p,permalink:t.download_url})}catch(e){K.U.addError(Error("Error while retrieving profile pic in update",{cause:e})),Z.m.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}let g={name:"string"==typeof c?c:void 0,description:"string"==typeof u?u:void 0,instructions:"string"==typeof d?d:void 0,promptStarters:Array.isArray(m)?m:void 0,profilePictureId:null===(s=l)||void 0===s?void 0:s.id,profilePictureUrl:null===(i=l)||void 0===i?void 0:i.permalink};return tI()(g,e=>null!=e)}function tG(e,t,r,s){var i,n,a,o,c,d,u,p,m,g,f;let h=r.current,x=s.current;if(H()(h,x))return;let b={};h.name!==(null==x?void 0:x.name)&&(b.name=h.name),(null!==(i=h.description)&&void 0!==i?i:"")!==(null!==(n=null==x?void 0:x.description)&&void 0!==n?n:"")&&(b.description=null!==(g=h.description)&&void 0!==g?g:""),h.instructions!==(null!==(a=null==x?void 0:x.instructions)&&void 0!==a?a:"")&&(b.context=null!==(f=h.instructions)&&void 0!==f?f:"");let v=new Set(null!==(o=null==x||null===(c=x.files)||void 0===c?void 0:c.map(e=>e.file_id))&&void 0!==o?o:[]),j=new Set(null!==(d=null===(u=h.files)||void 0===u?void 0:u.map(e=>e.file_id))&&void 0!==d?d:[]),y=(null!==(p=h.files)&&void 0!==p?p:[]).filter(e=>!v.has(e.file_id)),w=(null!==(m=null==x?void 0:x.files)&&void 0!==m?m:[]).filter(e=>!j.has(e.file_id));if(tS()(b)&&0===y.length&&0===w.length)return;let k=[];if(!tS()(b)){let e="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(b,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');k.push(tN.Cv.getTextAsMessage(e,l.uU.System))}w.length>0&&k.push(tN.Cv.getTextAsMessage("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(w.map(e=>e.file_id).join(", ")),l.uU.System)),y.length>0&&k.push(tN.Cv.getTextAsMessage("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(y.map(e=>e.file_id).join(", ")),l.uU.System,{attachments:y.map(e=>({id:e.file_id,name:e.name,size:e.size}))})),k.length>0&&I.tQ.updateTree(e,e=>{let r=e.getNodeByIdOrMessageId(t).parentId;for(let s of k){let i=(0,tw.Z)();e.insertNodeBefore(t,{id:i,children:[],parentId:r,message:s,metadata:{isClientCreatedSystemMessage:!0}}),r=i}})}function tR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function tU(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tR(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tR(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let tB=x.memo(function(e){let{gizmoEditorData:t,updateGizmo:r,clientThreadId:s,completionCallbackResponse:i,gizmoEditorDataRef:n,magicMakerBehaviorOverrides:a,magicMakerConversationGizmoEditorDataRef:o,requireGizmoId:c}=e,d=(0,x.useMemo)(()=>({gizmoEditorData:t,gizmoId:t.id,mode:"magic",behaviorOverrides:a,getGizmoId:c}),[c,t,a]),u=(0,tv.gF)(e=>e.files.filter(e=>e.status===eY.XX.Ready&&null!=e.gizmoId)),p=(0,x.useCallback)((e,t)=>{!function(e,t,r){if(0===r.length)return;let s=(0,tw.Z)(),i="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(r.map(e=>'"'.concat(e.fileId,'"')).join(", "));I.tQ.updateTree(e,e=>{let r=e.getNodeByIdOrMessageId(t).parentId;e.insertNodeBefore(t,{id:s,children:[],parentId:r,message:tN.Cv.getTextAsMessage(i,l.uU.System),metadata:{isClientCreatedSystemMessage:!0}})})}(e,t,u),tG(e,t,n,o),function(e,t){let r="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.",s=I.tQ.getThreadCurrentLeafId(e),i=I.tQ.getTree(e),n=i.getNodeByIdOrMessageId(s);for(;null!=n&&n.message.author.role!==l.uU.User;){if("text"===n.message.content.content_type&&n.message.content.parts[0]===r)return;n=""!==n.parentId?i.getNodeByIdOrMessageId(n.parentId):void 0}I.tQ.updateTree(e,e=>{let s=e.getNodeByIdOrMessageId(t).parentId;e.insertNodeBefore(t,{id:(0,tw.Z)(),children:[],parentId:s,message:tN.Cv.getTextAsMessage(r,l.uU.System,{exclude_after_next_user_message:!0}),metadata:{isClientCreatedSystemMessage:!0}})})}(e,t),r(e=>{var t;return tU(tU({},e),{},{files:[...null!==(t=e.files)&&void 0!==t?t:[],...eR()(u.map(e=>{var t;return null!=e.fileId&&{file_id:e.fileId,name:e.file.name,size:e.file.size,type:e.file.type,last_modified:e.file.lastModified,file_size_tokens:null===(t=e.fileSpec)||void 0===t?void 0:t.fileTokenSize}}))]})}),o.current=Y()(n.current)},[n,o,u,r]),m=(0,eo.tN)(e=>e.activeSidebar);return(0,j.jsx)(tk.D.Provider,{value:d,children:(0,j.jsxs)("div",{className:"relative flex h-full grow overflow-auto",children:[(0,j.jsx)("div",{className:"grow",children:(0,j.jsx)(tb.Z,{clientThreadId:s,onCompletionFinished:i,preRequestCompletion:p,hideHeader:!0,prependThreadChildren:(0,j.jsx)("div",{className:"h-8"})})}),"debug"===m&&(0,j.jsx)(tj.DebugConversationSidebar,{clientThreadId:s,slideOver:!1,onClose:()=>eo.vm.toggleActiveSidebar("debug"),isOpen:!0})]})})});var tF=r(45334);function tK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function tW(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tK(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tK(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let tq=ee()(()=>Promise.all([r.e(1703),r.e(7147)]).then(r.bind(r,37147)).then(e=>e.GizmoActionsEditor),{loadableGenerated:{webpack:()=>[37147]}});var tX=((s=tX||{}).MAGIC_MAKER="magic",s.ADVANCED="advanced",s.PREVIEW="preview",s);function tY(e){let{value:t,label:r}=e;return(0,j.jsx)(R.ck,{value:t,className:"text-md w-1/3 flex-grow rounded-lg border-token-border-light p-1.5 font-semibold text-token-text-tertiary transition hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] md:w-1/2",children:r})}function tQ(e){let{className:t,editorTab:r,setEditorTab:s}=e,i=(0,er.Z)();return(0,j.jsxs)(R.fC,{className:(0,q.default)("flex w-full overflow-hidden rounded-xl bg-token-main-surface-secondary p-1.5 md:w-1/2",t),value:r,onValueChange:e=>{s(e)},children:[(0,j.jsx)(tY,{value:tX.MAGIC_MAKER,label:i.formatMessage(t4.magicMakerLabel)}),(0,j.jsx)(tY,{value:tX.ADVANCED,label:i.formatMessage(t4.configureLabel)}),(0,j.jsx)("div",{className:"flex w-1/3 md:hidden",children:(0,j.jsx)(tY,{value:tX.PREVIEW,label:i.formatMessage(t4.previewLabel)})})]})}let tV={id:void 0,instructions:"",name:"",description:"",profilePictureId:void 0,profilePictureUrl:void 0,promptStarters:[],sharing:{recipient:M.Zz.Private,subjects:[]},tools:[{type:o.qK.DALLE}],files:[],trainingDisabled:!1,liveVersion:0},tJ=tW(tW({},tV),{},{tools:[...tV.tools,{type:o.qK.BROWSER}]});function tH(e){var t,r,s,i,n,a;return{id:e.gizmo.id,instructions:e.gizmo.instructions,name:e.gizmo.display.name,description:null!==(t=e.gizmo.display.description)&&void 0!==t?t:"",profilePictureId:null!==(r=e.gizmo.display.profile_pic_id)&&void 0!==r?r:void 0,profilePictureUrl:null!==(s=e.gizmo.display.profile_picture_url)&&void 0!==s?s:void 0,promptStarters:null!==(i=e.gizmo.display.prompt_starters)&&void 0!==i?i:[],tools:Y()(e.tools),files:Y()(e.files),sharing:e.gizmo.sharing?Y()(e.gizmo.sharing):{subjects:[],recipient:e.gizmo.share_recipient},trainingDisabled:null!==(n=e.gizmo.training_disabled)&&void 0!==n&&n,sharingRecipient:e.gizmo.share_recipient,sharingTargets:Y()(e.gizmo.sharing_targets),liveVersion:null!==(a=e.gizmo.live_version)&&void 0!==a?a:0}}let t$=e=>{var t;let{gizmo:r,onNewGizmoId:s}=e,i=(0,U.NL)(),n=(0,d.C)(_.L0.BrowsingAvailable),a=(0,er.Z)(),c=(0,x.useRef)(null!=r?tH(r):n?tJ:tV),p=(0,x.useRef)(r),m=(0,x.useRef)(c.current),{0:g,1:f}=(0,x.useState)(()=>c.current),{0:h,1:b}=(0,x.useState)(()=>(0,I.OX)()),{0:v}=(0,x.useState)(()=>({context_message:function(e){var t,r,s;let i=new Set;for(let t of e.tools)i.add(t.type);let n=null!==(t=e.name)&&void 0!==t?t:"",a=null!==(r=e.description)&&void 0!==r?r:"",o=null!==(s=e.instructions)&&void 0!==s?s:"",l=Array.from(i).join(","),c=""===n&&""===a&&""===o,d=null!=e.profilePictureUrl;return c?"The GPT you are about to has the following abilities: ".concat(l,"."):"This is the GPT's current set of fields:\n\nname: ".concat(n,"\n\ndescription: ").concat(a,"\n\ncontext: ").concat(o,"\n\nabilities: ").concat(l,"\n\n").concat(d?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}(c.current),model_slug:"unused",enabled_tools:[{tool_id:null!=r?"gizmo_editor":"gizmo_creator"}]}));!function(e,t,r){(0,ty.a)(e,{kind:l.OL.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:r}),(0,x.useEffect)(()=>{I.tQ.updateConversationMode(e,{kind:l.OL.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:r})},[e,t.id,r]);let{0:s}=(0,x.useState)(()=>{let e=null==t.id,r=null!=t.id&&""!==t.name&&null!=t.description&&""!==t.instructions&&null!=t.profilePictureUrl;return e?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':r?"Welcome back! Is there anything ".concat(t.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."});(0,x.useEffect)(()=>{let t=I.tQ.getTree(e);if(t.findNode(e=>{var t;return e.message.author.role===l.uU.User||(null===(t=e.metadata)||void 0===t?void 0:t.isClientCreatedSystemMessage)===!0})||(I.tQ.deleteNodesByFilter(e,e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.isPlaceholderTemplateAssistantWelcomeMessage)===!0}),null==s||0===s.length))return;let r=I.tQ.getThreadCurrentLeafId(e);if(!t.hasNodeOrMessageId(r))return;let i=(0,tw.Z)();I.tQ.updateTree(e,e=>{e.addNode(i,s,r,l.uU.Assistant,{isPlaceholderTemplateAssistantWelcomeMessage:!0})}),I.tQ.setThreadCurrentLeafId(e,i)},[e,s])}(h,m.current,v);let{data:y}=(0,T.Y7)(),w=null!==(t=null==y?void 0:y.modelsList.find(e=>e.tags.includes(l.S.GPT_4)))&&void 0!==t?t:null==y?void 0:y.modelsList.find(e=>e.id===T.mx),{data:k}=(0,C.b9)(c.current.id),O=(0,C.N_)(),{isPending:N,error:z}=O,S=(0,C.ZJ)(),E=(0,x.useMemo)(()=>{var e,t,r,s,i,n;return null!=k&&(!(g.name===k.gizmo.display.name&&g.description===k.gizmo.display.description&&g.instructions===k.gizmo.instructions&&(i=g.tools,n=k.tools,i.length===n.length&&i.every(e=>n.some(t=>t.type===e.type)))&&H()(null!==(e=null===(t=g.files)||void 0===t?void 0:t.map(e=>e.file_id))&&void 0!==e?e:[],null!==(r=null===(s=k.files)||void 0===s?void 0:s.map(e=>e.file_id))&&void 0!==r?r:[]))||g.profilePictureUrl!=k.gizmo.display.profile_picture_url||g.profilePictureId!=k.gizmo.display.profile_pic_id)},[g,k]),D=async()=>{let e=c.current;try{let t=await O.mutateAsync({editorData:e,gizmoId:e.id});if(p.current=t,null==c.current.id){let e=t.gizmo.id;c.current=tW(tW({},c.current),{},{id:e,sharingTargets:t.gizmo.sharing_targets}),f(c.current),null==s||s(e)}for(let e of t.tools.filter(e=>e.type===o.qK.JIT_PLUGIN)){let t=c.current.tools.find(t=>t.type===o.qK.JIT_PLUGIN&&t.metadata.domain===e.metadata.domain);t&&t.metadata.action_id!==e.metadata.action_id&&(t.metadata=tW(tW({},t.metadata),{},{action_id:e.metadata.action_id}),f(c.current))}return t}catch(r){var t;let e=null!==(t=(0,L.Ot)(r))&&void 0!==t?t:a.formatMessage(th.errorSavingDraft);throw Z.m.warning(e,{duration:2}),r}},A=(0,x.useRef)(),R=async()=>null!=c.current.id?c.current.id:(null==A.current&&(A.current=D().then(e=>e.gizmo.id).catch(e=>{throw A.current=void 0,e})),A.current),{0:X}=(0,x.useState)(()=>V()(()=>D(),2e3,{trailing:!0}));function Q(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r="function"==typeof e?e(c.current):(0,em.x$)(c.current,e);!H()(r,c.current)&&(c.current=r,f(c.current),t&&X())}let J=(0,x.useRef)(),$=async e=>{if(null==e){ep(!1);return}try{let t=await tA(c.current,e,J.current);null!=t&&(Q(t),m.current=Y()(c.current))}catch(e){K.U.addError(e),Z.m.warning("Something went wrong generating your GPT",{duration:3})}finally{J.current=I.tQ.getThreadCurrentLeafId(e),ep(!1)}},ee=function(e,t,r){var s;I.tQ.initThread(e,{kind:l.OL.GizmoMagicCreate,gizmo_id:void 0,behavior_overrides:r});let i=(0,T.j8)().id,n=null!==(s=(0,T.Bv)(e))&&void 0!==s?s:i,a=(0,tP.Z)(e,void 0,t);return async(t,s,i)=>{if(0===i.length)return;let o=I.tQ.getThreadCurrentLeafId(e);for(let t of i){let r=(0,tw.Z)();I.tQ.updateTree(e,e=>{e.addNodeToEnd(o,{id:r,children:[],parentId:o,message:tN.Cv.getTextAsMessage(t,l.uU.System),metadata:{isClientCreatedSystemMessage:!0}})}),I.tQ.setThreadCurrentLeafId(e,r),o=r}let c=o;tG(e,c,t,s);let d={conversationMode:{kind:l.OL.GizmoMagicCreate,gizmo_id:t.current.id,behavior_overrides:r}},u=await (0,tM.rS)(),[p,m,g]=await Promise.all([tz.ZP.getEnforcementToken(u),tZ.Z.getEnforcementToken(u),tC.Z.getEnforcementToken(u)]);a({model:n,completionType:l.Os.Next,parentNodeId:c,metadata:{},focusOnNewCompletion:!0,chatReq:u,arkoseToken:p,turnstileToken:m,proofToken:g,preflightTime:0,completionMetadata:d})}}(h,$,v),{0:et,1:es}=(0,x.useState)(void 0);(0,x.useEffect)(()=>{es((0,u.z$)(r))},[null==r?void 0:r.gizmo.id]);let ei=async(e,t)=>{let r=(0,em.bw)(c.current,e.recipient,t);if(r.length>0){Z.m.warning("Could not save GPT:\n\n".concat(r.map(e=>"- ".concat((0,em.sw)(e))).join("\n")),{duration:3});return}let s=await D(),n=s.gizmo.id;try{return B.A.logEvent(F.M.promoteGizmo,{gizmo_id:s.gizmo.id,sharing_recipient:e.recipient,editor_tab:ea}),await S.mutateAsync({gizmoId:s.gizmo.id,data:{sharingSubjects:e.subjects,sharingRecipient:e.recipient,categories:null==t?void 0:[t]}},{onSuccess(e){i.setQueryData((0,C.Vw)(i,n).queryKey,e),i.invalidateQueries({queryKey:["gizmos"]}),i.invalidateQueries({queryKey:["gizmo",{gizmoId:n}]}),i.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:n}]})}})}catch(t){t instanceof M.DC?es({gizmoId:n,sharingRecipient:e.recipient,moderationType:u.Te.PublishBlocked,sharingTargets:t.response.sharing_targets,showModal:u.UJ.AppealAvailable}):(K.U.addError(t),Z.m.warning("Error saving GPT",{duration:2}))}},en=O.isPending||S.isPending,{0:ea,1:eo}=(0,x.useState)(()=>{let e=W.m.getItem(W.F.GizmoEditorTab);return Object.values(tX).includes(e)?e:tX.MAGIC_MAKER}),el=G.fY.useState(e=>{let{windowWidth:t}=e;return t});(0,x.useEffect)(()=>{null!=el&&el>=768&&ea===tX.PREVIEW&&eo(tX.MAGIC_MAKER)},[el,ea]);let{0:ec,1:ed}=(0,x.useState)(!1),{0:eu,1:ep}=(0,x.useState)(!1),{0:eg,1:ef}=(0,x.useState)(void 0),{0:eh,1:ex}=(0,x.useState)(!1);return(0,j.jsxs)("div",{className:"flex h-screen w-full flex-col items-center",children:[(0,j.jsx)(eD,{gizmoEditorData:g,isLoading:en,hasUnpublishedChanges:E,isUploadingProfilePic:ec,isGeneratingProfilePic:eu,publishedGizmo:k,updateGizmo:Q,promoteGizmo:async(e,t)=>{let r=await ei(e,t);return c.current=tW(tW({},c.current),{},{sharingRecipient:e.recipient}),f(c.current),W.m.setItem(W.F.GizmoEditorTab,ea),r},appealGizmo:async(e,t)=>{null!=et&&es(tW(tW({},et),{},{sharingRecipient:e,categories:null==t?void 0:[t],showModal:u.UJ.AppealAvailable}))},setAppealState:es,revertDraft:null!=k&&E?()=>{let e=i.getQueryData((0,C.Vw)(i,c.current.id).queryKey);if(null!=e){let t=tH(e);c.current=t,f(t),D()}}:void 0,draftMessage:(0,j.jsx)(tf,{isPublished:null!=k&&("marketplace"===k.gizmo.share_recipient||"workspace"===k.gizmo.share_recipient),hasUnpublishedChanges:E,isSavingDraft:N,upsertDraftError:z,className:"text-sm"}),showActionsModal:e=>{ef(e)},className:"flex-shrink-0"}),et&&(0,j.jsx)(u.MU,{appealState:et,onAppealClose:()=>es(tW(tW({},et),{},{showModal:u.UJ.None})),onAppealSubmitted:()=>es(tW(tW({},et),{},{showModal:u.UJ.AppealSent}))}),(0,j.jsxs)("div",{className:"relative flex w-full grow overflow-hidden",children:[(0,j.jsx)("div",{className:"flex w-full justify-center md:w-1/2",children:(0,j.jsx)("div",{className:"h-full grow overflow-hidden",children:void 0!==eg?(0,j.jsx)(tq,{currentlyEditingActionDomain:eg,gizmoEditorData:g,updateGizmo:Q,onClose:()=>{ef(void 0)}}):eh?(0,j.jsx)(P,{gizmoEditorData:g,updateGizmo:Q,onClose:()=>{ex(!1)}}):(0,j.jsxs)("div",{className:"flex h-full flex-col px-2 pt-2",children:[(0,j.jsx)("div",{className:"flex w-full flex-row justify-center",children:(0,j.jsx)(tQ,{editorTab:ea,setEditorTab:eo,className:"mb-2 flex-shrink-0 self-center"})}),(0,j.jsx)("div",{className:"grow overflow-hidden",children:ea===tX.MAGIC_MAKER?(0,j.jsx)("div",{className:"h-full w-full pb-5",children:(0,j.jsx)(tB,{gizmoEditorData:g,updateGizmo:Q,completionCallbackResponse:$,clientThreadId:h,gizmoEditorDataRef:c,magicMakerBehaviorOverrides:v,magicMakerConversationGizmoEditorDataRef:m,requireGizmoId:R},h)}):ea===tX.ADVANCED?(0,j.jsx)(td,{gizmoEditorData:g,updateGizmo:Q,currentModelConfig:w,generateProfilePic:()=>{ep(!0),ee(c,m,["Generate a new profile picture for this GPT using gizmo_editor generate_profile_pic. Do not prompt the user for any clarification. Do not send extra text outside of the tool function call. DO NOT CALL update_behavior or otherwise update GPT behavior in your response."])},setIsUploadingProfilePic:ed,isGeneratingProfilePic:eu,setIsGeneratingProfilePic:ep,requireGizmoId:R,onShowActionsEditor:e=>{ef(e)},onShowBlocksEditor:()=>{ex(!0)}}):(0,j.jsx)(tx.P,{gizmoEditorData:g,currentModelConfig:w,isSavingDraft:N,showTitle:!1})})]})})}),(0,j.jsx)("div",{className:(0,q.default)("hidden w-1/2 justify-center border-l border-token-border-medium bg-token-main-surface-secondary pt-4",ea!==tX.PREVIEW&&"md:flex"),children:(0,j.jsx)("div",{className:"flex-grow pb-5",children:(0,j.jsx)("div",{className:"h-full",children:(0,j.jsx)(tx.P,{gizmoEditorData:g,currentModelConfig:w,isSavingDraft:N})})})})]})]})};function t0(e){let{gizmoId:t,version:r}=e,{data:s}=(0,C.DC)({gizmoId:t,draft:!0,version:r}),i=(0,E.ec)(E.F_.accountUserId),n=(0,E.aF)(),a=null==n?void 0:n.id,o=null!=s&&null!=i&&null!=a&&(0,tF.k1)(s);return null!=s&&o?(0,j.jsx)(t$,{gizmo:s}):null}function t1(e){let{onNewGizmoId:t}=e;return(0,j.jsx)(t$,{gizmo:void 0,onNewGizmoId:t})}function t2(e){let{gizmoId:t,remixSourceId:r,version:s}=e,i=(0,et.useRouter)(),n=(0,S.t)(),a=(0,x.useRef)(void 0),o=t;return null!=t&&a.current===t&&(o=void 0),(0,D.yx)({resetThreadAction:()=>{i.push("/")}}),(0,j.jsx)("div",{children:null!=n&&n.data?(0,j.jsx)("div",{children:void 0!=o?(0,j.jsx)(t0,{gizmoId:o,version:s},o):(0,j.jsx)(t1,{remixSourceId:r,onNewGizmoId:e=>{a.current=e,window.history.replaceState(window.history.state,"",(0,A.AA)(e))}})}):(0,j.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,j.jsx)(c.Z,{})})})}let t4=(0,es.vU)({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}})},46702:function(e,t,r){r.d(t,{b:function(){return d}});var s=r(59144),i=r(24434),n=r(39004),a=r(24740),o=r(75172),l=r(62984),c=r(651);function d(e){let{gizmoId:t,onSuccess:r,onClose:d}=e,u=(0,o.Z)(),p=(0,n.kb)(),m=async()=>{try{await p.mutateAsync({gizmoId:t}),r()}catch{a.m.danger("Failed to delete gizmo. Please try again.")}};return(0,c.jsx)(i.Z,{isOpen:!0,onClose:d,type:"danger",title:(0,c.jsx)(l.Z,{id:"shLmv5",defaultMessage:"Delete GPT"}),primaryButton:(0,c.jsx)(s.Z.Button,{title:u.formatMessage({id:"nlWRPu",defaultMessage:"Delete GPT"}),color:"danger",loading:p.isPending,onClick:()=>{m()}}),secondaryButton:(0,c.jsx)(s.Z.Button,{title:u.formatMessage({id:"D4IuIb",defaultMessage:"Cancel"}),color:"secondary",onClick:d}),children:(0,c.jsx)("div",{className:"text-sm",children:(0,c.jsx)(l.Z,{id:"zIR+cK",defaultMessage:"Are you sure you want to delete this GPT? This cannot be undone."})})})}},88301:function(e,t,r){r.d(t,{B1:function(){return m},hj:function(){return g},lX:function(){return h},r:function(){return x},yt:function(){return f}});var s,i,n,a=r(2346),o=r(77748),l=r(30853),c=r(19841),d=r(62984),u=r(15478),p=r(651);let m=u.Z.textarea(s||(s=(0,a.Z)(["w-full text-sm overflow-y-auto rounded-lg border px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium bg-token-main-surface-primary h-32"]))),g=u.Z.div(i||(i=(0,a.Z)(["mb-6"]))),f=u.Z.input(n||(n=(0,a.Z)(["w-full resize-none overflow-y-auto rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 border focus:ring-blue-400 border-token-border-medium h-9 bg-token-main-surface-primary"])));function h(e){let{label:t,description:r,collapsed:s,onClick:i}=e,n=(0,p.jsx)("label",{className:"block font-semibold text-token-text-primary",children:t});return(0,p.jsxs)("div",{className:"mb-1.5 flex items-center",onClick:i,children:[void 0!==s&&(s?(0,p.jsx)(o.r0F,{className:"icon-sm"}):(0,p.jsx)(o.Tg4,{className:"icon-sm"})),r?(0,p.jsx)(l.u,{label:r,sideOffset:4,side:"top",delayDuration:0,children:n}):(0,p.jsx)(p.Fragment,{children:n})]})}function x(e){var t;let{actionTool:r,onShowActionsEditor:s,isDisabled:i}=e,n="metadata"in r?null===(t=r.metadata)||void 0===t?void 0:t.domain:void 0;return(0,p.jsxs)("div",{className:(0,c.default)("flex rounded-lg border border-token-border-medium text-sm hover:cursor-pointer",i?"bg-token-main-surface-secondary":""),onClick:s,children:[(0,p.jsx)("div",{className:"h-9 grow px-3 py-2",children:null!=n?n:(0,p.jsx)("span",{className:"text-red-500",children:(0,p.jsx)(d.Z,{id:"TJYXrY",defaultMessage:"Invalid action"})})}),(0,p.jsx)("div",{className:"w-px bg-token-border-medium"}),(0,p.jsx)("button",{disabled:i,className:"flex h-9 w-9 items-center justify-center rounded-lg rounded-l-none",children:(0,p.jsx)(o.SWE,{className:"icon-sm"})})]})}},17711:function(e,t,r){r.d(t,{W:function(){return x}});var s=r(98601),i=r(99333),n=r(98303),a=r(30853),o=r(71090),l=r(41987);r(92379);var c=r(75172),d=r(62984),u=r(68306),p=r(651);function m(){return(0,p.jsx)("div",{className:"ml-2 flex h-3.5 w-3.5 cursor-default items-center justify-center rounded-full border border-token-border-medium text-[0.5rem] font-semibold leading-none text-token-text-tertiary",children:"?"})}function g(e){let{description:t}=e;return(0,p.jsx)(a.u,{wide:!0,label:t,delayDuration:0,children:(0,p.jsx)(m,{})})}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function h(e){let{label:t,toolType:r,enabledTools:s,onEnabledToolsChange:i,disabled:n,disabledTooltip:l}=e,c=e=>s.some(t=>t.type===e),d=(0,p.jsx)(o.f8,{labelClassName:"w-full cursor-pointer",id:r,label:t,checked:!n&&c(r),disabled:n,onChange:()=>{c(r)?i(s.filter(e=>e.type!==r)):i([...s,{type:r}])}});return null!=l?(0,p.jsx)("div",{className:"opacity-70",children:(0,p.jsx)(a.u,{side:"top",label:l,children:d})}):d}function x(e){let{enabledTools:t,onEnabledToolsChange:r}=e,a=(0,n.C)(l.L0.BrowsingAvailable),o=(0,c.Z)();return(0,p.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,p.jsx)(h,{label:(0,p.jsx)(d.Z,{id:"tNlef1",defaultMessage:"Web Browsing"}),toolType:i.qK.BROWSER,enabledTools:t,onEnabledToolsChange:r,disabled:!a,disabledTooltip:a?void 0:(0,p.jsx)(d.Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},b.disabledBrowsingToolTip))}),(0,p.jsx)(h,{label:(0,p.jsx)(d.Z,{id:"uSmS/p",defaultMessage:"DALL\xb7E Image Generation"}),toolType:i.qK.DALLE,enabledTools:t,onEnabledToolsChange:r}),(0,p.jsx)(h,{label:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(d.Z,{id:"8Lv1lK",defaultMessage:"Code Interpreter & Data Analysis"}),(0,p.jsx)(g,{description:o.formatMessage(b.codeInterpreterTooltip)})]}),toolType:i.qK.PYTHON,enabledTools:t,onEnabledToolsChange:r})]})}let b=(0,u.vU)({disabledBrowsingToolTip:{defaultMessage:"Web browsing is disabled for your workspace. Contact your admin to enable it.",id:"GizmoEditorModelPicker.disabledBrowsingToolTip"},codeInterpreterTooltip:{id:"GizmoEditorModelPicker.codeInterpreterTooltip",defaultMessage:"Allow this GPT to run code. When enabled, this GPT can analyze data, work with files you’ve uploaded, do math, and more."},memoryTooltip:{id:"GizmoEditorModelPicker.memoryTooltip",defaultMessage:"Allow this GPT to pick up on users details and preferences to tailor its responses to them. When enabled, users will need to have memory on to use this GPT."}})},90945:function(e,t,r){r.d(t,{P:function(){return A},gP:function(){return D},f7:function(){return L}});var s,i=r(16757),n=r(92745),a=r(58015),o=r(91530),l=r.n(o),c=r(29329),d=r(67437),u=r(651);function p(e){let{clientThreadId:t}=e,r=(0,n.oq)(t),s=(0,d.Bv)(t),i=(0,n.U0)(t,r),o=[...Array(i).keys()].map(e=>(0,u.jsx)(c.h,{isFinalTurn:e===i-1,turnIndex:e,clientThreadId:t,conversationLeafId:r,onChangeItemInView:l(),onChangeRating:l(),onRequestMoreCompletions:l(),onRequestCompletion:a.C,currentModelId:null!=s?s:""},e));return(0,u.jsx)(u.Fragment,{children:o})}function m(e){let{clientThreadIds:t}=e;return(0,u.jsx)(u.Fragment,{children:t.map(e=>(0,u.jsx)(p,{clientThreadId:e},e))})}var g=r(60825),f=r(44039),h=r(45334),x=r(65418),b=r(34455),v=r(31438),j=r(43703),y=r(49763),w=r(79857),k=r(38924),P=r(97834),O=r(52978),N=r(19841),z=r(88600),C=r(92379),M=r(62984),Z=r(92054),T=r(77748),S=r(74301),_=r(2319),I=r(10083);function E(){return(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)("div",{className:"border-token-border-secondary flex-grow border-b"}),(0,u.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-2 px-2 py-6 text-sm text-token-text-tertiary",children:[(0,u.jsx)(T.vHI,{className:"icon-sm"}),(0,u.jsx)(M.Z,{id:"qtaMEG",defaultMessage:"GPT updated"})]}),(0,u.jsx)("div",{className:"border-token-border-secondary flex-grow border-b"})]})}let L=((s={}).TestGizmoAction="test_gizmo_action",s),D=new y.V,A=C.memo(function(e){var t;let{gizmoEditorData:r,isSavingDraft:s,currentModelConfig:a,showTitle:o=!0}=e,{0:c,1:d}=(0,C.useState)(()=>(0,n.OX)()),{0:p,1:y}=(0,C.useState)([]);(0,C.useEffect)(()=>{y(e=>e[e.length-1]===c?e:[...e,c])},[c]);let L=p.slice(0,-1);(0,b.a)(c,{kind:i.OL.GizmoTest,gizmo_id:r.id}),(0,C.useEffect)(()=>{n.tQ.updateConversationMode(c,{kind:i.OL.GizmoTest,gizmo_id:r.id})},[c,r.id]);let A=null===(t=r.files)||void 0===t?void 0:t.map(e=>e.file_id).join();(0,C.useEffect)(()=>{null!=n.tQ.getServerThreadId(c)&&d((0,n.OX)())},[r.id,r.instructions,r.tools,A,c]);let G=(0,v.tN)(e=>e.activeSidebar),R=(0,C.useMemo)(()=>({gizmoEditorData:r,mode:"test"}),[r]),{0:U,1:B}=(0,C.useState)(0),F=()=>{B(e=>e-360)},K=r.id,W=function(e,t){let r=(0,S.Z)(e,void 0,l());return(0,C.useCallback)(async(s,a,o)=>{if(!t)return;let l=n.tQ.getThreadCurrentLeafId(e),c=(0,Z.Z)(),d=(0,h.VN)(a);n.tQ.updateTree(e,e=>{e.addNodeToEnd(l,{id:c,children:[],parentId:l,message:{id:c,author:{role:i.uU.User},content:{content_type:i.PX.Text,parts:["Call the ".concat(a," API with the ").concat(o," operation")]},recipient:"all",metadata:{jit_plugin_data:{from_client:{type:"test",operation:o,tool_name:d}}}}})});let u={conversationMode:{kind:i.OL.GizmoTest,gizmo_id:s}},p=await (0,P.rS)(),[m,g,f]=await Promise.all([w.ZP.getEnforcementToken(p),O.Z.getEnforcementToken(p),k.Z.getEnforcementToken(p)]);r({model:t.id,completionType:i.Os.Next,parentNodeId:c,metadata:{},focusOnNewCompletion:!0,chatReq:p,arkoseToken:m,turnstileToken:g,proofToken:f,preflightTime:0,completionMetadata:u})},[e,r,t])}(c,a);return(0,C.useEffect)(()=>(0,j.LW)(D,{test_gizmo_action:e=>{let{rootDomain:t,operationName:r}=e;K&&W(K,t,r)}}),[W,K]),(0,u.jsx)(_.D.Provider,{value:R,children:(0,u.jsxs)("div",{className:(0,N.default)("flex h-full w-full",s&&"cursor-wait opacity-80 transition"),children:[(0,u.jsxs)("div",{className:"flex grow flex-col",children:[(0,u.jsx)("div",{className:"relative mb-2 flex-shrink-0",children:(0,u.jsx)("div",{className:"flex justify-center py-1",children:o&&(0,u.jsxs)("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[(0,u.jsx)("div",{className:"icon-md"}),(0,u.jsxs)("button",{onClick:()=>{F(),y([]),d((0,n.OX)())},className:"flex items-center gap-2",children:[(0,u.jsx)(M.Z,{id:"2u/6Ja",defaultMessage:"Preview"}),(0,u.jsx)(z.E.div,{className:"text-token-text-primary",animate:{rotate:U},transition:{duration:.3},children:(0,u.jsx)(T.eF8,{className:"icon-md invisible group-hover:visible"})})]})]})})}),(0,u.jsx)("div",{className:(0,N.default)("relative grow overflow-auto px-2",s&&"pointer-events-none"),children:(0,u.jsx)(g.Z,{clientThreadId:c,hideHeader:!0,renderEmptyState:(0,u.jsxs)("div",{className:"relative h-full w-full",children:[null!=L&&L.length>0&&(0,u.jsx)("div",{className:"h-full w-full opacity-20",children:(0,u.jsxs)(f.I,{children:[(0,u.jsx)(m,{clientThreadIds:L}),(0,u.jsx)(E,{})]})}),(0,u.jsx)("div",{className:"absolute left-0 top-0 h-full w-full",children:(0,u.jsx)(I.r,{gizmo:r,hideOwner:!0,showStarterPrompts:!0})})]}),prependThreadChildren:L.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"opacity-50",children:(0,u.jsx)(m,{clientThreadIds:L})}),(0,u.jsx)(E,{})]})})})]}),"debug"===G&&(0,u.jsx)(x.DebugConversationSidebar,{clientThreadId:c,slideOver:!1,onClose:()=>v.vm.toggleActiveSidebar("debug"),isOpen:!0})]})})})},76665:function(e,t,r){r.d(t,{bw:function(){return m},hs:function(){return u},sw:function(){return p},x$:function(){return d}});var s,i=r(98601),n=r(99333),a=r(10080),o=r(25899);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t){return null==t?e:(t=function e(t){return"object"==typeof t&&null!=t?Array.isArray(t)?t.map(e):Object.fromEntries(Object.entries(t).map(t=>{let[r,s]=t;return[r,e(s)]})):null===t?void 0:t}(t),c(c({},e),t))}let u=((s={})[s.Loading=0]="Loading",s[s.UploadingProfilePic=1]="UploadingProfilePic",s[s.GeneratingProfilePic=2]="GeneratingProfilePic",s[s.GizmoNameTooLong=3]="GizmoNameTooLong",s[s.GizmoDescriptionTooLong=4]="GizmoDescriptionTooLong",s[s.GizmoInstructionsTooLong=5]="GizmoInstructionsTooLong",s[s.NameEmpty=6]="NameEmpty",s[s.MissingPublicActionPrivacyPolicyURL=7]="MissingPublicActionPrivacyPolicyURL",s[s.MissingCategory=8]="MissingCategory",s);function p(e){switch(e){case u.Loading:return"Loading";case u.UploadingProfilePic:return"Uploading profile picture";case u.GeneratingProfilePic:return"Generating profile picture";case u.GizmoNameTooLong:return"GPT name too long";case u.GizmoDescriptionTooLong:return"GPT description too long";case u.GizmoInstructionsTooLong:return"GPT instructions too long";case u.NameEmpty:return"GPT name cannot be empty";case u.MissingPublicActionPrivacyPolicyURL:return"Public actions require valid privacy policy URLs";case u.MissingCategory:return"Public GPTs must have a category"}}function m(e,t,r){var s,i,l,c,d,p;let m=e.name.length>o.aI,g=(null!==(s=null===(i=e.description)||void 0===i?void 0:i.length)&&void 0!==s?s:0)>o.P_,f=(null!==(l=null===(c=e.instructions)||void 0===c?void 0:c.length)&&void 0!==l?l:0)>o.vi,h=[];if((null==e?void 0:e.name)===""&&h.push(u.NameEmpty),m&&h.push(u.GizmoNameTooLong),g&&h.push(u.GizmoDescriptionTooLong),f&&h.push(u.GizmoInstructionsTooLong),null!=t&&("link"===t||"marketplace"===t))for(let t of null===(d=e.tools)||void 0===d?void 0:d.filter(e=>e.type===n.qK.JIT_PLUGIN)){let e=null===(p=t.metadata)||void 0===p?void 0:p.privacy_policy_url;if(null==e||!function(e){try{return new URL(e),!0}catch(e){return!1}}(e)){h.push(u.MissingPublicActionPrivacyPolicyURL);break}}return t===a.Zz.Marketplace&&null==r&&h.push(u.MissingCategory),h}},41177:function(e,t,r){r.d(t,{C6:function(){return es},O2:function(){return en},P6:function(){return er},hD:function(){return J},uj:function(){return ei},xH:function(){return V}});var s,i=r(2346),n=r(98601),a=r(99333),o=r(2721),l=r(93951),c=r(31498),d=r(75172),u=r(62984),p=r(68306),m=r(11550),g=r(98095),f=r(24434),h=r(76638),x=r(89039),b=r(42420),v=r(84760),j=r(19841),y=r(65925),w=r.n(y),k=r(92379),P=r(15478),O=r(59725),N=r(18898),z=r(77748),C=r(27160),M=r(57849),Z=r(98682),T=r(73062),S=r(30853),_=r(6440),I=r(15122),E=r(24740),L=r(21025),D=r(51307),A=r(83036),G=r(12128),R=r(39004),U=r(76665),B=r(99555),F=r(10080),K=r(81107),W=r(651);function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let Y=[F.EL,F.fV],Q={[F.LA.USER]:F.Zz.User,[F.LA.GROUP]:F.Zz.Group,[F.LA.WORKSPACE]:F.Zz.Workspace,[F.LA.ALL]:F.Zz.Marketplace};function V(e){let t=Q[e.type];if(!t)throw Error("Unknown sharing subject type: "+e.type);return X(X({},e),{},{type:t})}function J(e){var t,r,s,i,n,p,x,v,y,P;let{gizmo:N,publishedGizmo:C,updateGizmo:M,promoteGizmo:Z,appealGizmo:_,setAppealState:I,showActionsModal:A,shareOnly:G,onClose:q,workspaceOwner:Q=!1}=e,J=(0,d.Z)(),H=(0,l.t)(),$=null!==(t=null==H||null===(r=H.data)||void 0===r?void 0:r.name)&&void 0!==t?t:"your workspace",er=(0,c.aF)(),ea=(0,R.Z1)(),{0:el,1:ec}=(0,k.useState)(void 0);(0,k.useEffect)(()=>{if(void 0==el){if(null!=C&&C.gizmo.display.categories&&(null==C?void 0:C.gizmo.display.categories.length)>0){var e;let t=null===(e=ea.data)||void 0===e?void 0:e.categories.find(e=>e.id===(null==C?void 0:C.gizmo.display.categories[0]));t&&ec(t)}else void 0!=ea.data&&ec(ea.data.categories[ea.data.categories.length-1])}},[ea.data,el,C]);let{0:ed,1:eu}=(0,k.useState)(null!==(s=N.sharingRecipient)&&void 0!==s?s:F.Zz.Private),{0:ep,1:em}=(0,k.useState)(null!==(i=null===(n=N.sharing)||void 0===n?void 0:n.subjects)&&void 0!==i?i:[]),{0:eg,1:ef}=(0,k.useState)(null),{0:eh,1:ex}=(0,k.useState)(!1),eb=(0,k.useCallback)(()=>{var e;return!w()(null===(e=N.sharing)||void 0===e?void 0:e.subjects,ep)||N.sharingRecipient!==ed},[N.sharing,N.sharingRecipient,ed,ep]),ev=(0,b.NL)(),ej=(0,U.bw)(N,ed,null!==(p=null==el?void 0:el.id)&&void 0!==p?p:void 0),ey=ej.includes(U.hs.MissingPublicActionPrivacyPolicyURL),ew=N.tools.find(e=>e.type===a.qK.JIT_PLUGIN&&!e.metadata.privacy_policy_url);if(eg)return(0,W.jsx)(ei,{publishedGizmo:eg,sharing:{recipient:ed,subjects:ep},workspaceName:$,onClose:q});let ek=(0,F.H$)(ep);function eP(e){let t=ep.filter(e=>-1===[F.LA.WORKSPACE,F.LA.ALL].indexOf(e.type));null!=e&&t.push(e),em(t)}function eO(e){null!=ek&&em(ep.map(t=>t===ek?X(X({},t),{},{capabilities:e}):t))}function eN(e,t,r){return e.type===F.LA.USER&&-1===e.user_id.indexOf("__")?X(X({},e),{},{user_id:e.user_id+"__"+(null==H?void 0:H.getWorkspaceId())}):e}async function ez(e,t){var r,s;if(eh)return;if(e&&!t)throw Error("Cannot share a gizmo that hasn't been promoted before");if(!el)return;ex(!0);let i=ep.map(eN).map(V);if(i=(0,F.Mj)(ed,i,null!==(r=null==ek?void 0:ek.capabilities)&&void 0!==r?r:F.EL),Q)return H&&t?(await o.Z.updateWorkspaceGPTSharing(H.id,t,i),E.m.success(J.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),ev.invalidateQueries({queryKey:["workspace"]})):E.m.warning("Unable to change sharing settings"),q();if(e){if(!t||!C)throw Error("No gizmo ID to share");try{let e={sharing:i};el&&(e.categories=[el.id]);let r=await B.U.shareGizmo(t,e);r.error?(0,L.nJ)(ed,r.sharing_targets)?(I({gizmoId:C.gizmo.id,sharingRecipient:ed,categories:C.gizmo.display.categories,moderationType:D.Te.PublishBlocked,sharingTargets:r.sharing_targets,showModal:D.UJ.AppealAvailable}),q()):E.m.warning(J.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})):(ev.setQueryData(["gizmo",{gizmoId:C.gizmo.id},{draft:!1}],e=>r.resource),M(e=>X(X({},e),{},{sharingRecipient:ed})),E.m.success(J.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),q())}catch(e){return E.m.warning(J.formatMessage({id:"dKC65l",defaultMessage:"Failed to update sharing settings"})),q()}}else{let e=await Z({subjects:i,recipient:ed},el.id);t||(t=null==e?void 0:e.gizmo.id),ef(null!=e?e:null),M({liveVersion:null!==(s=null==e?void 0:e.gizmo.live_version)&&void 0!==s?s:void 0}),ev.invalidateQueries({queryKey:["gizmo",{gizmoId:t}]})}ex(!1),ev.invalidateQueries({queryKey:["gizmos"]}),ev.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:t}]}),ev.invalidateQueries({queryKey:["workspace"]}),M({sharing:{recipient:ed,subjects:ep},sharingRecipient:ed},!1)}return(0,W.jsx)(f.Z,{type:"success",className:"max-w-[555px]",size:"custom",isOpen:!0,onClose:q,primaryButton:(0,L.nJ)(ed,N.sharingTargets)?(0,W.jsx)(m.z,{onClick:()=>_(ed,null==el?void 0:el.id),children:(0,W.jsx)(u.Z,{id:"HRzqKK",defaultMessage:"Appeal"})}):(0,W.jsx)(m.z,{onClick:()=>ez(G,null==C?void 0:C.gizmo.id),loading:eh,disabled:ej.length>0||!(0,L.YK)(ed,N.sharingTargets),children:G?(0,W.jsx)(u.Z,{id:"BEKjVh",defaultMessage:"Save"}):(0,W.jsx)(u.Z,{id:"24j5ts",defaultMessage:"Update"})}),secondaryButton:(0,W.jsxs)(W.Fragment,{children:[eb()&&(0,W.jsx)("div",{className:"absolute bottom-8 left-6 text-sm text-token-text-secondary",children:(0,W.jsx)(u.Z,{id:"9CkgC4",defaultMessage:"Unsaved changes"})}),C&&(0,W.jsx)(m.z,{color:"secondary",onClick:()=>(0,K.A4)(C,J.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:(0,W.jsx)(u.Z,{id:"wvL15a",defaultMessage:"Copy link"})})]}),title:J.formatMessage({id:"7JggXH",defaultMessage:"Share GPT"}),showCloseButton:!0,children:(0,W.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,W.jsx)(eo,{onAdd:e=>{ep.find(t=>t.type===F.LA.USER?t.user_id===e.user_id:t.type===F.LA.GROUP?t.group_id===e.group_id:t.type===e.type)||em([...ep,e])},publishedGizmo:C}),(0,W.jsx)("h3",{className:"text-base font-semibold",children:(0,W.jsx)(u.Z,{id:"bNQXcV",defaultMessage:"Share with..."})}),(0,W.jsxs)("div",{className:"max-h-[200px] space-y-2 overflow-y-auto",children:[(0,W.jsxs)("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[(0,W.jsx)("div",{className:"shrink-0 grow-0 self-start",children:(0,W.jsx)(O.Yt,{user:er,size:"gizmoConversation",roundedStyle:"rounded-full"})}),(0,W.jsx)("div",{className:"grow",children:C&&(y=null==C?void 0:C.gizmo.author.user_id.split("__")[0],P=null==er?void 0:er.id,void 0===y||void 0===P||y.split("__")[0]!==P.split("__")[0])?(0,W.jsx)("span",{className:"text-base font-semibold",children:(0,W.jsx)(u.Z,{id:"scRZqV",defaultMessage:"{userName} (builder)",values:{userName:null==C?void 0:C.gizmo.author.display_name}})}):(0,W.jsxs)("div",{className:"flex flex-col",children:[(0,W.jsx)("span",{className:"text-base font-semibold",children:(0,W.jsx)(u.Z,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:null==er?void 0:er.name}})}),(0,W.jsx)("span",{className:"-mt-1 text-sm text-token-text-secondary",children:null==er?void 0:er.email})]})})]}),ep.map((e,t)=>(0,F.h)(e)&&(0,W.jsxs)("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[(0,W.jsx)(O.m0,{name:e.type===F.LA.GROUP?e.group_name:"".concat(e.user_name," ").concat(e.user_email),initialsCount:e.type===F.LA.USER?2:1,size:"gizmoConversation",className:(0,j.default)("shrink-0 grow-0",e.type===F.LA.USER&&"self-start")}),(0,W.jsxs)("div",{className:"flex grow flex-col",children:[(0,W.jsxs)("span",{className:"flex flex-row",children:[(0,W.jsx)("span",{className:"mr-2 text-base font-semibold",children:e.type===F.LA.GROUP?e.group_name:e.user_name}),e.type===F.LA.GROUP&&e.is_scim_managed&&(0,W.jsx)(h.DirectorySyncResourceManagedIndication,{})]}),e.type===F.LA.USER&&(0,W.jsx)("span",{className:"-mt-1 text-sm text-token-text-secondary",children:e.user_email})]}),(0,W.jsxs)(g.Z.Root,{children:[(0,W.jsxs)(g.Z.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[(0,W.jsx)(u.Z,X({},ee(e.capabilities))),(0,W.jsx)(z.T2M,{className:"icon-md"})]}),(0,W.jsx)(g.Z.Portal,{children:(0,W.jsxs)(g.Z.Content,{className:"max-w-[280px]",children:[Y.map((t,r)=>(0,W.jsx)(et,{caps:t,selected:w()(t,e.capabilities),onClick:()=>{em(ep.map(r=>r===e?X(X({},r),{},{capabilities:t}):r))}},r)),(0,W.jsx)(g.Z.Separator,{}),(0,W.jsx)(g.Z.Item,{onClick:()=>em(ep.filter(t=>t!==e)),color:"danger",icon:z.XHJ,children:(0,W.jsx)(u.Z,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},t))]}),(0,W.jsx)("hr",{className:"border-token-border-medium"}),(0,W.jsx)("h3",{className:"text-base font-semibold",children:(0,W.jsx)(u.Z,{id:"uqD7Y8",defaultMessage:"Access"})}),(0,W.jsxs)("div",{className:"-ms-3.5 flex flex-row items-center justify-between space-x-3",children:[(0,W.jsxs)(T.Z.Root,{value:ed,onValueChange:e=>(function(e){switch(eu(e),e){case F.Zz.Marketplace:case F.Zz.Link:eP({type:F.LA.ALL,capabilities:F.EL});break;case F.Zz.Workspace:case F.Zz.WorkspaceLink:eP({type:F.LA.WORKSPACE,capabilities:F.EL});break;default:eP(null)}})(e),children:[(0,W.jsxs)(T.Z.Trigger,{children:[(0,W.jsx)(T.Z.Value,{}),(0,W.jsx)(T.Z.Icon,{})]}),(0,W.jsx)(T.Z.Portal,{children:(0,W.jsxs)(T.Z.Content,{children:[(0,W.jsxs)(T.Z.Group,{children:[(0,W.jsx)(T.Z.Label,{children:(0,W.jsx)(u.Z,{id:"YIQwaP",defaultMessage:"Private"})}),(0,W.jsx)(T.Z.Item,{value:F.Zz.Private,children:(0,W.jsx)(es,{shareLevel:F.Zz.Private,workspaceName:$})})]}),(0,W.jsx)(T.Z.Separator,{}),(0,W.jsx)(S.E,{label:J.formatMessage({id:"n0m61x",defaultMessage:"Your workspace has disabled sharing with the workspace."}),side:"bottom",disabled:(0,L.YK)("workspace",N.sharingTargets),children:(0,W.jsxs)(T.Z.Group,{children:[(0,W.jsx)(T.Z.Label,{children:$}),(0,W.jsx)(T.Z.Item,{value:F.Zz.WorkspaceLink,disabled:!(0,L.YK)(F.Zz.WorkspaceLink,N.sharingTargets)&&!(0,L.YK)(F.Zz.Workspace,N.sharingTargets),children:(0,W.jsx)(es,{shareLevel:F.Zz.WorkspaceLink,workspaceName:$})}),(0,W.jsx)(T.Z.Item,{value:F.Zz.Workspace,disabled:!(0,L.YK)("workspace",N.sharingTargets),children:(0,W.jsx)(es,{shareLevel:F.Zz.Workspace,workspaceName:$})})]})}),(0,W.jsx)(T.Z.Separator,{}),(0,W.jsx)(S.E,{label:J.formatMessage({id:"IHnort",defaultMessage:"Your workspace has disabled public sharing."}),side:"bottom",disabled:(0,L.YK)("marketplace",N.sharingTargets),children:(0,W.jsxs)(T.Z.Group,{children:[(0,W.jsx)(T.Z.Label,{children:(0,W.jsx)(u.Z,{id:"PjY9bi",defaultMessage:"Public"})}),(0,W.jsx)(T.Z.Item,{value:F.Zz.Link,disabled:!(0,L.YK)("link",N.sharingTargets),children:(0,W.jsx)(es,{shareLevel:F.Zz.Link,workspaceName:$})}),(0,W.jsx)(T.Z.Item,{disabled:!(0,L.YK)("marketplace",N.sharingTargets),value:F.Zz.Marketplace,children:(0,W.jsx)(es,{shareLevel:F.Zz.Marketplace,workspaceName:$})})]})})]})})]}),ed!==F.Zz.Private&&ed!==F.Zz.User&&(0,W.jsxs)(g.Z.Root,{children:[(0,W.jsxs)(g.Z.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[null==ek?(0,W.jsx)(u.Z,X({},ee(F.EL))):(0,W.jsx)(u.Z,X({},ee(ek.capabilities))),(0,W.jsx)(z.T2M,{className:"icon-md"})]}),(0,W.jsx)(g.Z.Portal,{children:(0,W.jsxs)(g.Z.Content,{className:"max-w-[280px]",children:[(0,W.jsx)(et,{onClick:()=>eO(F.EL),caps:F.EL,selected:w()(null==ek?void 0:ek.capabilities,F.EL)}),ed!==F.Zz.Marketplace&&ed!==F.Zz.Link&&(0,W.jsx)(et,{onClick:()=>eO(F.fV),caps:F.fV,selected:w()(null==ek?void 0:ek.capabilities,F.fV)})]})})]})]}),ey&&(0,W.jsx)("div",{className:"text-xs text-red-500",children:(0,W.jsx)(u.Z,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:e=>(0,W.jsx)("button",{onClick:()=>{A(null==ew?void 0:ew.metadata.action_id),q()},className:"underline",children:e})}})}),(ed===F.Zz.Marketplace||ed===F.Zz.Workspace)&&((0,L.YK)(ed,N.sharingTargets)?(0,W.jsx)(en,{gizmo:N,category:null==el?void 0:el.id,categories:null===(x=ea.data)||void 0===x?void 0:x.categories,onCategoryChange:e=>ec(e)}):(0,L.nJ)(ed,N.sharingTargets)?(0,W.jsx)("div",{className:"pb-2 text-xs text-red-500",children:(0,W.jsx)(D.JE,{sharingRecipient:ed,moderatedFields:null!==(v=(0,L.ai)(ed,N.sharingTargets))&&void 0!==v?v:[],appealAvailable:!0})}):(0,W.jsx)("div",{className:"pb-2 text-xs text-red-500",children:(0,W.jsx)(u.Z,{id:"BzqqKH",defaultMessage:"Your workspace's settings don't allow this level of access. An owner of the workspace can change this setting in the workspace's GPTs settings."})}))]})})}let H=(0,p.vU)({private:{id:"pSXBWQ",defaultMessage:"Invite-only"},user:{id:"pSXBWQ",defaultMessage:"Invite-only"},group:{id:"pSXBWQ",defaultMessage:"Invite-only"},workspace_link:{id:"Giaxt1",defaultMessage:"Anyone at {workspaceName} with the link"},workspace:{id:"XLHaTU",defaultMessage:"{workspaceName}"},link:{id:"uP1+Ri",defaultMessage:"Anyone with the link"},marketplace:{id:"82Ilac",defaultMessage:"GPT Store"}}),$=(0,p.vU)({workspace:{id:"1kpopF",defaultMessage:"Published to {workspaceName}"},marketplace:{id:"hdTRpJ",defaultMessage:"Published to GPT Store"}});function ee(e){return e.can_write?(0,p.Em)({id:"SubCqD",defaultMessage:"Can edit"}):e.can_view_config?(0,p.Em)({id:"ud3lp4",defaultMessage:"Can view configuration"}):e.can_read?(0,p.Em)({id:"/0j34W",defaultMessage:"Can chat"}):(0,p.Em)({id:"x2E8ET",defaultMessage:"Unknown"})}function et(e){let{caps:t,selected:r,onClick:s}=e,i=z.vdY;return t.can_view_config?i=z.KAl:t.can_read&&(i=z.kBi),(0,W.jsx)(g.Z.Item,{className:"flex h-auto flex-row items-start space-x-3 px-3 py-3",onClick:s,icon:i,children:t.can_write?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("div",{className:"flex grow flex-col",children:(0,W.jsx)("span",{className:"text-base font-semibold leading-tight",children:(0,W.jsx)(u.Z,X({},ee(t)))})}),(0,W.jsx)(z.kvR,{className:(0,j.default)("icon-lg shrink-0",!r&&"invisible")})]}):t.can_view_config?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{className:"flex grow flex-col",children:[(0,W.jsx)("span",{className:"align-baseline text-base font-semibold leading-tight",children:(0,W.jsx)(u.Z,X({},ee(t)))}),(0,W.jsx)("span",{className:"text-xs text-token-text-secondary",children:(0,W.jsx)(u.Z,{id:"fL1rWw",defaultMessage:"View configuration settings, duplicate, and chat"})})]}),(0,W.jsx)(z.kvR,{className:(0,j.default)("icon-lg shrink-0",!r&&"invisible")})]}):t.can_read?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{className:"flex grow flex-col",children:[(0,W.jsx)("span",{className:"text-base font-semibold leading-tight",children:(0,W.jsx)(u.Z,X({},ee(t)))}),(0,W.jsx)("span",{className:"text-xs text-token-text-secondary",children:(0,W.jsx)(u.Z,{id:"tx5q1o",defaultMessage:"Users can only chat with this GPT"})})]}),(0,W.jsx)(z.kvR,{className:(0,j.default)("icon-lg shrink-0",!r&&"invisible")})]}):null})}let er={private:Z.Z,user:Z.Z,group:Z.Z,workspace_link:M.Z,workspace:C.Z,link:M.Z,marketplace:z.frp};function es(e){let{shareLevel:t,workspaceName:r,hasInviteSharing:s=!0}=e;(t===F.Zz.User||t===F.Zz.Group)&&(t=F.Zz.Private);let i=er[t];return(0,W.jsxs)("div",{className:"flex flex-row items-center gap-3 text-base",children:[(0,W.jsx)(i,{className:"icon-lg"}),(0,W.jsx)("div",{className:"line-clamp-1 pt-px text-start font-semibold",children:s||t!==F.Zz.Private?(0,W.jsx)(u.Z,X(X({},H[t]),{},{values:{workspaceName:r}})):(0,W.jsx)(u.Z,{id:"vVJhYB",defaultMessage:"Only me"})})]})}function ei(e){var t,r;let{publishedGizmo:s,sharing:i,workspaceName:n,onClose:a}=e,o=i.recipient,l=er[o],c=(0,d.Z)();return(0,W.jsxs)(f.Z,{isOpen:!0,onClose:a,showCloseButton:!0,className:"w-[304px]",title:(0,W.jsx)(u.Z,{id:"5CEceY",defaultMessage:"GPT Updated"}),primaryButton:(0,W.jsx)(m.z,{onClick:()=>{window.location.href="/g/".concat(s.gizmo.id)},children:(0,W.jsx)(u.Z,{id:"RF75o5",defaultMessage:"View GPT"})}),secondaryButton:(0,W.jsx)(m.z,{color:"secondary",onClick:()=>(0,K.A4)(s,c.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:(0,W.jsx)(u.Z,{id:"9hLOl9",defaultMessage:"Copy link"})}),type:"success",children:[(0,W.jsx)(en,{gizmo:{profilePictureUrl:null!==(t=s.gizmo.display.profile_picture_url)&&void 0!==t?t:void 0,name:s.gizmo.display.name}}),i.subjects.filter(e=>(0,F.h)(e)).length>0&&(0,W.jsxs)("div",{className:"my-4",children:[(0,W.jsx)("h4",{className:"text-xs font-semibold text-token-text-secondary",children:(0,W.jsx)(u.Z,{id:"/paYH9",defaultMessage:"Shared with"})}),i.subjects&&i.subjects.map((e,t)=>(0,F.h)(e)&&(0,W.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-3 py-2",children:[(0,W.jsxs)("div",{children:[(0,W.jsx)("span",{className:"text-base font-semibold",children:e.type===F.LA.GROUP?e.group_name:e.user_name}),e.type===F.LA.USER&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("br",{}),(0,W.jsx)("span",{className:"text-sm text-token-text-secondary",children:e.user_email})]})]}),(0,W.jsx)("span",{className:"text-token-text-secondary",children:(0,W.jsx)(u.Z,X({},ee(e.capabilities)))})]},t))]}),(0,W.jsxs)("div",{className:"my-4",children:[(0,W.jsx)("h4",{className:"text-xs font-semibold text-token-text-secondary",children:(0,W.jsx)(u.Z,{id:"q9XNZ7",defaultMessage:"Access"})}),(0,W.jsxs)("div",{className:"ml-[3px] flex flex-row items-center py-3 text-left text-base font-semibold",children:[(0,W.jsx)(l,{className:"md:icon-lg mr-3 h-6 w-6 shrink-0"}),(0,W.jsxs)("div",{className:"flex flex-col",children:[(0,W.jsx)("span",{className:"font-semibold",children:(0,W.jsx)(u.Z,X(X({},null!==(r=$[o])&&void 0!==r?r:H[o]),{},{values:{workspaceName:n}}))}),(o===F.Zz.Workspace||o===F.Zz.Marketplace)&&(0,W.jsx)("span",{className:"text-xs text-token-text-secondary"})]})]})]})]})}function en(e){let{gizmo:t,category:r,categories:s,onCategoryChange:i}=e,{data:n,isLoading:a}=(0,R.WL)(),o=null==s?void 0:s.find(e=>e.id===r);return(0,W.jsxs)("div",{children:[(0,W.jsxs)("div",{className:(0,j.default)("mb-[1px] flex flex-row items-center space-x-2 bg-token-main-surface-secondary p-4",a&&"invisible",s?"rounded-t-lg":"rounded-lg"),children:[(0,W.jsx)(G.Z,{isFirstParty:!1,className:"h-11 w-11",src:t.profilePictureUrl}),(0,W.jsxs)("div",{className:"flex grow flex-col space-y-0",children:[(0,W.jsx)("span",{className:"text-base font-semibold",children:t.name}),(0,W.jsx)(A.Z,{builderName:null==n?void 0:n.display_name,builderUrl:null==n?void 0:n.website_url,socials:[null==n?void 0:n.socials.linkedin,null==n?void 0:n.socials.github,null==n?void 0:n.socials.twitter].filter(e=>null!=e),className:"text-xs text-token-text-secondary"})]})]}),s&&(0,W.jsxs)("div",{className:"flex min-h-[56px] flex-row items-center justify-between space-x-2 rounded-b-lg bg-token-main-surface-secondary px-4 text-base",children:[(0,W.jsx)("span",{className:"font-semibold",children:(0,W.jsx)(u.Z,{id:"JcA4/t",defaultMessage:"Category"})}),(0,W.jsx)("div",{className:"text-token-text-secondary",children:i?(0,W.jsx)(g.d,{size:"small",triggerButton:(0,W.jsxs)("button",{className:"flex items-center gap-1",children:[null==o?void 0:o.title,(0,W.jsx)(z.T2M,{className:"icon-md"})]}),children:s.map((e,t)=>(0,W.jsx)(g.Z.Item,{onClick:()=>i(e),children:e.title},t))}):(0,W.jsx)("span",{className:"text-token-text-secondary",children:null==o?void 0:o.title})})]})]})}let ea=P.Z.li(s||(s=(0,i.Z)(["flex flex-col rounded-sm p-1 hover:bg-token-main-surface-secondary"])));function eo(e){var t,r,s;let{onAdd:i,publishedGizmo:n}=e,a=(0,d.Z)(),c=(0,l.t)(),{0:p,1:m}=(0,k.useState)(""),g=null===(t=(0,N.Z)(null==c?void 0:c.id,0,p,5).data)||void 0===t?void 0:t.items.filter(e=>e.id!==(null==n?void 0:n.gizmo.author.user_id.split("__")[0])),{data:f}=(0,v.a)({queryKey:[null==c?void 0:c.id,"groups","filtered",p],queryFn:()=>o.Z.getWorkspaceGroups(c.id,{query:p,orderby:"@score"}),enabled:""!==p.trim()&&null!=c&&!!c.getWorkspaceId()}),b=(null!==(r=null==g?void 0:g.length)&&void 0!==r?r:0)>0||(null!==(s=null==f?void 0:f.items.length)&&void 0!==s?s:0)>0,{0:j,1:y}=(0,k.useState)(!1);return(0,W.jsx)(W.Fragment,{children:(0,W.jsx)("div",{className:"flex w-full flex-row space-x-3",children:(0,W.jsxs)(x.J,{as:"div",className:"group relative z-10 grow",children:[(0,W.jsx)(_.Z,{list:"suggested-choices",name:"share-with-input",placeholder:null!=c&&c.isEnterprisey()?a.formatMessage({id:"xy/AMO",defaultMessage:"Add people and groups from your workspace"}):a.formatMessage({id:"Lh9njB",defaultMessage:"Add people from your workspace"}),value:p,onChange:e=>m(e.target.value),onFocus:()=>y(!0),onBlur:()=>y(!1)}),(0,W.jsx)(I.m,{show:""!==p.trim()&&b&&j,children:(0,W.jsx)(x.J.Panel,{static:!0,className:"absolute top-8 ml-0 w-full cursor-pointer overflow-y-auto rounded-lg rounded-t-none border border-t-0 border-token-border-light bg-token-main-surface-primary px-1 py-1 group-has-[:focus]:border-token-border-xheavy",children:""!==p.trim()&&(0,W.jsxs)("ul",{id:"suggested-choices",children:[g&&g.map(e=>(0,W.jsxs)(ea,{tabIndex:0,className:"rounded-sm p-1 text-sm hover:bg-token-main-surface-secondary",onClick:()=>{var t,r,s,n;return r=e.id,s=e.name,n=null!==(t=e.email)&&void 0!==t?t:"",void(c&&(i({type:F.LA.USER,user_id:r+"__"+c.getWorkspaceId(),user_name:s,user_email:n,capabilities:X({},F.EL)}),m("")))},children:[(0,W.jsx)("span",{className:"w-full font-semibold",children:e.name}),(0,W.jsx)("span",{className:"text-sm text-token-text-secondary",children:e.email})]},e.id)),(null==f?void 0:f.items)&&f.items.slice(0,5).map(e=>(0,W.jsx)(ea,{tabIndex:0,onClick:()=>{var t,r,s,n;return r=e.id,s=e.name,n=null!==(t=e.is_scim_managed)&&void 0!==t&&t,void(i({type:F.LA.GROUP,group_id:r,group_name:s,capabilities:X({},F.EL),is_scim_managed:n}),m(""))},children:(0,W.jsxs)("span",{className:"flex flex-col",children:[(0,W.jsxs)("span",{className:"flex flex-row",children:[(0,W.jsx)("span",{className:"mr-2 font-semibold",children:e.name}),e.is_scim_managed&&(0,W.jsx)(h.DirectorySyncResourceManagedIndication,{})]}),(0,W.jsx)("span",{className:"text-sm text-token-text-secondary",children:(0,W.jsx)(u.Z,{id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}",values:{numMembers:e.num_members}})})]})},e.id))]})})})]})})})}F.H$,F.EL,F.fV},65418:function(e,t,r){r.r(t),r.d(t,{DebugConversation:function(){return em},DebugConversationSidebar:function(){return ep},default:function(){return eo},downloadMessages:function(){return eg}});var s,i,n,a,o,l=r(2346),c=r(98601),d=r(16757),u=(r(34095),r(55963)),p=r(88301),m=(r(2721),r(93951)),g=r(92745),f=r(22433),h=r(93180),x=r(46900),b=(r(66290),r(30757)),v=(r(56032),r(42420)),j=r(79746),y=r(88667),w=r(2423),k=r.n(w),P=r(38482),O=r.n(P),N=r(92379),z=r(75172),C=r(62984),M=r(68306),Z=r(67526),T=r(75853),S=r(15478),_=r(11550),I=r(39358),E=r(94273),L=r(75130),D=r(651);function A(e){let{children:t,sidebarOpen:r,onClose:s}=e;return(0,D.jsx)(E.u.Root,{show:r,as:N.Fragment,children:(0,D.jsxs)(L.V,{as:"div",className:"relative z-10",onClose:s,children:[(0,D.jsx)("div",{className:"fixed inset-0"}),(0,D.jsx)("div",{className:"fixed inset-0 overflow-hidden",children:(0,D.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:(0,D.jsx)("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:(0,D.jsx)(E.u.Child,{as:N.Fragment,enter:"transform transition ease-in-out duration-100 sm:duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-300 sm:duration-500",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,D.jsx)(L.V.Panel,{className:"pointer-events-auto w-screen max-w-md border-l border-gray-100 dark:border-gray-700",children:(0,D.jsx)("div",{className:"h-full overflow-y-auto bg-token-main-surface-primary shadow-xl",children:t})})})})})})]})})}var G=r(30853),R=r(30115),U=r(77748),B=r(24434),F=r(73468),K=r(89678),W=r.n(K),q=r(13859),X=r.n(q),Y=r(24740),Q=r(88815);function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach(function(t){(0,c.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function H(e){var t;let{clientThreadId:r}=e,{rebaseSystemMessageContent:s,showDebugConversationTurns:i}=(0,Q.N)(),{0:n,1:a}=(0,N.useState)(()=>s?JSON.stringify(s,null,2):void 0),{0:o,1:l}=(0,N.useState)(!!s),c=(0,g.u9)(r,g.tQ.getThreadCurrentLeafId(r)),p=X()(c,e=>e.content.content_type===d.PX.SystemContent),m=null!==(t=null==p?void 0:p.content)&&void 0!==t?t:null,f=(0,N.useMemo)(()=>W()(e=>{try{e?Q.N.setState({rebaseSystemMessageContent:J(J({},JSON.parse(e)),{},{content_type:d.PX.SystemContent})}):Q.N.setState({rebaseSystemMessageContent:null}),Y.m.closeAll()}catch(e){Y.m.danger("The System Message is not valid JSON")}},500),[]);return(0,N.useEffect)(()=>{o?f(n):(f.cancel(),Q.N.setState({rebaseSystemMessageContent:null}))},[f,o,n]),(0,D.jsxs)("div",{className:"flex flex-col gap-3 px-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:"flex justify-between",children:[(0,D.jsx)(G.u,{label:"Enable to apply this system message to the current conversation.",children:(0,D.jsx)(u.Z,{id:"enabled",label:"Enabled",checked:o,onChange:e=>l(e.currentTarget.checked)})}),(0,D.jsx)(u.Z,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:i,onChange:()=>{Q.N.setState({showDebugConversationTurns:!i})}})]}),(0,D.jsx)(_.z,{disabled:!m,className:"mt-2",onClick:()=>{a(m?JSON.stringify(m,null,2):"")},size:"small",children:"Load active system message"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"text-sm",children:"System Message"}),(0,D.jsx)($,{disabled:!o,placeholder:m?"Press `Load active system message` to pre-populate this":"Start a conversation and then press `Load active system message` to pre-populate this",className:"min-h-[75vh] rounded-md border border-gray-400 p-1 font-mono",value:n,onChange:e=>a(e.target.value)})]})]})}let $=S.Z.textarea(s||(s=(0,l.Z)(["w-full rounded-lg border border-token-border-light bg-token-main-surface-primary text-sm text-token-text-primary focus:border-token-text-primary focus:shadow-none focus:outline-none focus:ring-token-text-primary disabled:bg-token-main-surface-tertiary"])));var ee=r(19841);function et(e){let{clientThreadId:t}=e,{0:r,1:s}=(0,N.useState)([]),i=g.tQ.getThreadCurrentLeafId(t),n=g.tQ.getThreadConversationTurns(t,i),a=e=>{let r=g.tQ.getTree(t).getLeafFromNode(e);g.tQ.setThreadCurrentLeafId(t,r.id)},o=e=>{s(e=>[...e,i]),a(e)};return(0,D.jsxs)(D.Fragment,{children:[r.length>0&&(0,D.jsxs)(_.z,{className:"absolute left-2 top-2",color:"secondary",onClick:()=>{a(r[r.length-1]),s(e=>e.slice(0,-1))},children:[(0,D.jsx)(U.eF8,{className:"icon-sm"}),"Go back to ",r[r.length-1]]}),(0,D.jsx)("div",{className:"flex flex-col items-center gap-4 overflow-auto p-4 text-xs",children:n.map((e,r)=>{let s;let i=e.messages[0].nodeId,n=g.tQ.getTree(t),a=0!==r?n.getParent(i):null,l=null!=a?a.children.findIndex(e=>i===e):0,c=null!=a?a.children:[],u=c.slice(0,l),p=c.slice(l+1);switch(e.role){case d.uU.User:s="bg-blue-500";break;case d.uU.Assistant:s="bg-gray-600";break;default:s="bg-gray-400"}return(0,D.jsxs)("div",{className:(0,ee.default)("relative p-2",s),children:[(0,D.jsx)("div",{className:"absolute bottom-0 left-0 -ml-2 flex -translate-x-full gap-2 pl-2",children:u.map(e=>(0,D.jsx)(er,{variantId:e,onChangeItemInView:o},e))}),(0,D.jsx)("div",{className:"absolute left-full top-0 ml-2 flex gap-2 pr-2",children:p.map(e=>(0,D.jsx)(er,{variantId:e,onChangeItemInView:o},e))}),(0,D.jsx)("div",{className:"flex flex-col gap-2",children:e.messages.map(e=>(0,D.jsxs)("div",{className:"h-14 w-32 truncate bg-gray-200 p-1 text-black",children:[(0,D.jsx)("div",{className:"font-semibold",children:e.nodeId}),(0,D.jsx)("div",{className:"italic text-token-text-tertiary",children:e.message.author.role}),(0,D.jsx)("div",{children:(0,f.RR)(e.message)})]},e.nodeId))})]},r)})})]})}function er(e){let{variantId:t,onChangeItemInView:r}=e;return(0,D.jsx)("button",{className:"w-32 truncate bg-gray-400 p-2 text-black opacity-50 hover:opacity-100",onClick:()=>{r(t)},children:(0,D.jsx)("span",{className:"bg-gray-200 p-2",children:t})},t)}function es(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function ei(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?es(Object(r),!0).forEach(function(t){(0,c.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):es(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let en=O()(()=>Promise.all([r.e(3904),r.e(3674)]).then(r.bind(r,16476)).then(e=>e.default),{ssr:!1,loadableGenerated:{webpack:()=>[16476]}}),ea=O()(()=>r.e(1583).then(r.bind(r,51583)).then(e=>e.FramesViewer),{ssr:!1,loadableGenerated:{webpack:()=>[51583]}});function eo(e){let{children:t,title:r,icon:s,isOpen:i,slideOver:n,onClose:a}=e,o=(0,D.jsxs)(eb,{children:[(0,D.jsxs)("div",{className:"flex items-start justify-between",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 text-lg font-semibold text-gray-900 dark:text-white",children:[(0,D.jsx)(s,{className:"icon-sm"}),r]}),(0,D.jsx)("div",{className:"mr-2 mt-2 flex h-7 items-center",children:(0,D.jsx)(R.P,{onClick:a})})]}),t]});return n?(0,D.jsx)(A,{sidebarOpen:i,onClose:a,children:o}):i?o:null}function el(e){let{nodes:t,setDebugNodeIndex:r,setFrameSrc:s}=e,i=t.map((e,t)=>{var i;let n=e.message,{role:a,name:o}=n.author,l=k()(n,"metadata.__internal.model_id"),c=k()(n,"metadata.__internal.agent.settings.completion_api.engine"),u=k()(n,"metadata.__internal.model_experiment_name"),p=k()(n,"metadata.__internal.model_experiment_treatment"),m=k()(n,"metadata.__internal.normalized_model_side"),g=k()(n,"metadata.__internal.model_experiment_group_name"),h=k()(n,"metadata.__internal.model_experiment_group_params"),b=k()(n,"metadata.__internal.model_experiment_override"),v=k()(n,"metadata.__internal.model_experiment_eval_seq"),j=null===(i=k()(n,"metadata.__internal.raw_tokens"))||void 0===i?void 0:i.length,y=k()(n,"metadata.request_id"),w=x.U.getAudio(n),P=x.U.getAudioAssetPointers(n),O=x.U.getFrameAssetPointers(n);return(0,D.jsxs)(ej,{role:"button",onClick:()=>r(t),children:[(0,D.jsxs)("div",{className:"text-xs font-semibold uppercase text-token-text-tertiary",children:[a,o&&o!==a&&" (".concat(o,")"),n.recipient&&" -> ",(0,f.Ej)(n)]}),(n.author.role!==d.uU.System||y)&&(0,D.jsxs)("div",{className:"text-xs text-token-text-tertiary",children:[(0,D.jsxs)("div",{children:["ID: ",n.id]}),e.id!==n.id&&(0,D.jsxs)("div",{children:["UI Node ID: ",e.id]}),(0,D.jsxs)("div",{children:["Req ID: ",y||"Reload page to see ID"]})]}),(0,D.jsx)("div",{className:"line-clamp-6",children:(0,f.RR)(n)}),(j||l||c||u||p||m||g||h||b||v)&&(0,D.jsxs)("div",{className:"mt-4 w-full self-start rounded-xl bg-blue-200 px-3 py-0.5 text-xs text-black",children:[void 0!==j&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Tokens Count:"})," ",j]}),l&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Model ID:"})," ",l]}),c&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Engine:"})," ",c]}),u&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Experiment:"})," ",u]}),p&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Treatment:"})," ",p]}),m&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Normalized Side:"})," ",m]}),g&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Group Name:"})," ",g]}),h&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Group Params:"}),(0,D.jsx)("div",{children:JSON.stringify(h,null,2)})]}),b&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Above Params are Overridden By:"})," ",b]}),v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("b",{children:"Experiment Eval Seq:"})," click to see"]})]}),w.length||P.length?(0,D.jsxs)("div",{className:"mt-4 flex flex-col flex-nowrap gap-2",children:[(0,D.jsx)(eh,{frameAssets:O,setFrameSrc:s},t),w.map((e,t)=>(0,D.jsx)(ex,{audio:e},t)),P.map((e,t)=>(0,D.jsx)(ex,{assetPointer:e},t))]}):null]},n.id)});return(0,D.jsx)(ev,{children:i})}let ec=e=>(0,D.jsx)(Z.c.Input,ei(ei({},e),{},{inputClassName:"focus:ring-0"}));function ed(){let e=(0,Q.N)(),t=(0,F.ZP)().map(e=>({label:e.name,options:e.options.map(e=>({label:"".concat(e.value," (").concat(e.name,")"),value:e.value}))}));return(0,D.jsxs)("div",{className:"mt-2 flex flex-col justify-around gap-3 px-4 py-1 text-xs font-semibold",children:[(0,D.jsx)(u.Z,{id:"force-paragen",label:"Force Parallel Gen",checked:e.forceParagen,onChange:()=>{Q.N.setState({forceParagen:!e.forceParagen})}}),(0,D.jsx)(T.Z,{options:t,name:"force-paragen-model",className:"shadow-none dark:text-gray-800",isDisabled:!e.forceParagen,isLoading:0===t.length,value:e.forceParagenModel,isClearable:!0,isMulti:!1,components:{Input:ec},onChange:e=>{Q.N.setState({forceParagenModel:null!=e?e:Q.J})}}),(0,D.jsx)(u.Z,{id:"force-paragen",label:"Force Nulligen",checked:e.forceNulligen,onChange:()=>{Q.N.setState({forceNulligen:!e.forceNulligen})}}),(0,D.jsx)(u.Z,{id:"force-indepth-feedback",label:"Force Indepth Feedback with prompt:",checked:e.forceIndepthFeedback,onChange:()=>{Q.N.setState({forceIndepthFeedback:!e.forceIndepthFeedback})}}),(0,D.jsx)(p.B1,{id:"force-indepth-feedback-prompt",value:e.forceIndepthFeedbackPrompt,disabled:!e.forceIndepthFeedback,className:"font-weight-normal font-mono text-xs",onChange:e=>{Q.N.setState({forceIndepthFeedbackPrompt:e.target.value})}}),(0,D.jsx)(u.Z,{id:"force-rate-limit",label:"Force Rate Limit",checked:e.forceRateLimit,onChange:()=>{Q.N.setState({forceRateLimit:!e.forceRateLimit})}}),(0,D.jsx)(u.Z,{id:"reset-rate-limit",label:"Reset Rate Limits",checked:e.resetRateLimits,onChange:()=>{Q.N.setState({resetRateLimits:!e.resetRateLimits})}}),(0,D.jsx)(G.u,{label:"Enabling this will show debug conversation messages in the chat",children:(0,D.jsx)(u.Z,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:e.showDebugConversationTurns,onChange:()=>{Q.N.setState({showDebugConversationTurns:!e.showDebugConversationTurns})}})})]})}let eu=S.Z.div(i||(i=(0,l.Z)(["px-3 pb-2 text-xs font-semibold uppercase border-b-2 ",""])),e=>{let{$isSelected:t}=e;return t?"border-black dark:border-white":"border-transparent"});function ep(e){let{clientThreadId:t,isOpen:r,slideOver:s,onClose:i}=e,n=(0,z.Z)(),a=(0,m.hz)(),{0:o,1:l}=(0,N.useState)("conversation");return null!=a&&a.includes("debug")?(0,D.jsx)(eo,{icon:U.reV,title:n.formatMessage(ey.debugTitle),isOpen:r,slideOver:s,onClose:i,children:(0,D.jsxs)(b.fC,{orientation:"vertical",defaultValue:o,onValueChange:e=>l(e),children:[(0,D.jsxs)(b.aV,{className:"flex items-center justify-center gap-2 px-4 py-1 text-xs font-semibold",children:[(0,D.jsx)(b.xz,{value:"conversation",children:(0,D.jsx)(eu,{$isSelected:"conversation"===o,children:"Conversation"})}),(0,D.jsx)(b.xz,{value:"system-message-editor",className:"p-4",children:(0,D.jsx)(eu,{$isSelected:"system-message-editor"===o,children:"System Message Editor"})})]}),(0,D.jsx)(b.VY,{value:"conversation",children:(0,D.jsx)(em,{clientThreadId:t})}),(0,D.jsx)(b.VY,{value:"system-message-editor",children:(0,D.jsx)(H,{clientThreadId:t})})]})}):null}function em(e){let{clientThreadId:t}=e,r=(0,z.Z)(),s=g.tQ.getThreadCurrentLeafId(t),i=(0,g.Fe)(t,s),{0:n,1:a}=(0,N.useState)(),o=(0,m.hz)(),l=(0,N.useCallback)(()=>{a(void 0)},[]),c=(0,N.useCallback)(()=>{let e=g.tQ.getTree(t);(0,j.v)(e.getTextFromThread(s))},[s,t]),{0:d,1:u}=(0,N.useState)(!1),{0:p,1:f}=(0,N.useState)(void 0);return null!=o&&o.includes("debug")?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"mb-2 flex items-center justify-around px-4 py-1 text-xs font-semibold uppercase",children:(0,D.jsx)(ef,{clientThreadId:t,messages:i.map(e=>e.message)})}),!1,(0,D.jsxs)("div",{className:"flex items-center justify-around gap-2 px-4 py-1 text-xs font-semibold uppercase",children:[(0,D.jsx)("div",{children:(0,D.jsx)(I.Z,{onCopy:c,buttonText:r.formatMessage(ey.copyText)})}),(0,D.jsxs)("button",{className:"flex items-center justify-center gap-2",onClick:()=>u(!0),children:[(0,D.jsx)(U.aAc,{className:"icon-sm rotate-90"}),"View tree"]})]}),(0,D.jsx)(ed,{}),(0,D.jsx)(el,{nodes:i,setDebugNodeIndex:a,setFrameSrc:f}),void 0!==n&&(0,D.jsx)(B.Z,{className:"min-w-[80vw]",isOpen:!0,onClose:l,type:"success",children:(0,D.jsx)("div",{className:"max-h-[80vh] overflow-auto",children:(0,D.jsx)(en,{json:i[n].message})})},"DebugMessageModal-".concat(n)),d&&(0,D.jsx)(B.Z,{isOpen:!0,onClose:()=>u(!1),type:"success",size:"custom",noPadding:!0,children:(0,D.jsx)(et,{clientThreadId:t})},"DebugTreeViewer"),p&&(0,D.jsx)(B.Z,{size:"normal",isOpen:!0,onClose:()=>f(void 0),type:"success",children:(0,D.jsx)("img",{src:p,alt:"debug image"})},"DebugFrameViewer")]}):null}function eg(e,t){let r=new Blob([JSON.stringify({conversation_id:g.tQ.getServerThreadId(e),messages:t},null,2)],{type:"application/json"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download="messages-".concat(g.tQ.getServerThreadId(e),".json"),i.click(),URL.revokeObjectURL(s)}function ef(e){let{clientThreadId:t,messages:r}=e,s=(0,N.useCallback)(()=>{eg(t,r)},[t,r]);return(0,D.jsx)(_.z,{onClick:s,color:"primary",size:"small",icon:U._8t,children:(0,D.jsx)(C.Z,ei({},ey.downloadRawConversation))})}function eh(e){let{0:t,1:r}=(0,N.useState)([]),s=(0,v.NL)(),{frameAssets:i}=e;return(0,N.useEffect)(()=>{async function e(){return Promise.all(i.map(async e=>{let{image_asset_pointer:t,timestamp:r}=e;return{src:(await h.j.fetch(s,{asset:t})).url,timestamp:r}}))}i.length>0&&e().then(r)},[i,s]),(0,D.jsx)(ea,{frames:t,setFrameSrc:e.setFrameSrc})}function ex(e){let t=ex.useAssetPointerSource(e.assetPointer),r=ex.useAudioSource(e.audio),s=null!=t?t:r,i=(0,y.xb)("3230069703").config.value.expirySeconds,{0:n,1:a}=(0,N.useState)(Date.now()),o=(0,N.useRef)(null);return((0,N.useEffect)(()=>{let e=setInterval(()=>{o.current&&o.current.currentTime>0&&!o.current.paused&&!o.current.ended&&o.current.readyState>2||a(Date.now())},1e3*i);return()=>clearInterval(e)},[i]),s)?(0,D.jsx)("audio",{ref:o,controls:!0,src:s,className:"w-full"},n):null}ex.useAssetPointerSource=e=>{let{0:t,1:r}=(0,N.useState)(null),s=(0,v.NL)();return(0,N.useEffect)(()=>{e&&h.j.fetch(s,{asset:e}).then(e=>{r(e.url)})},[s,e]),t},ex.useAudioSource=e=>{let{0:t,1:r}=(0,N.useState)(null);return(0,N.useEffect)(()=>{if(e){let t=atob(e.payload),s=new Uint8Array(t.length);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);let i=new Blob([s],{type:"audio/".concat(e.format)}),n=URL.createObjectURL(i);return r(n),()=>{URL.revokeObjectURL(n)}}},[e]),t};let eb=S.Z.div(n||(n=(0,l.Z)(["overflow-y-auto h-full md:w-[250px] lg:w-[300px] xl:w-[350px] 2xl:w-[400px] md:border-l md:border-gray-100 md:dark:border-gray-700 popover bg-token-main-surface-primary"]))),ev=S.Z.pre(a||(a=(0,l.Z)(["whitespace-pre-wrap text-sm"]))),ej=S.Z.div(o||(o=(0,l.Z)(["px-6 py-4 flex flex-col gap-1 hover:bg-gray-50 dark:hover:bg-gray-500/10 cursor-pointer border-b dark:border-white/10 border-gray-200"]))),ey=(0,M.vU)({debugTitle:{id:"DebugSidebar.debugTitle",defaultMessage:"Debug"},copyText:{id:"DebugSidebar.copyText",defaultMessage:"Copy text"},downloadRawConversation:{id:"DebugSidebar.downloadRawConversation",defaultMessage:"Download raw conversation"},uploadRawConversation:{id:"DebugSidebar.uploadRawConversation",defaultMessage:"Upload conversation dump"},closeSidebar:{id:"DebugSidebar.closeSidebar",defaultMessage:"Close sidebar"}})},34455:function(e,t,r){r.d(t,{a:function(){return O}});var s=r(98601),i=r(99501),n=r(67437),a=r(66290),o=r(34977),l=r(76580),c=r(92379),d=r(9026),u=r(30478),p=r(39004),m=r(6530),g=r(24740),f=r(84760),h=r(92745);let x=e=>{let{asPath:t,replace:r}=(0,o.useRouter)(),s=(0,u.V_)(),i=(0,h.h9)();(0,f.a)({queryKey:["conversation",e],queryFn:()=>(0,h.Um)(e).catch(s=>{let i=(0,m.Bw)(t);throw r(null!=i?(0,p.un)(i):"/",void 0,{shallow:!0}),g.m.danger("Unable to load conversation ".concat(e)),s}),enabled:!(0,h.Zz)(e)&&!s&&!i})};var b=r(81107),v=r(2721);let j=e=>["conversation","init",e],y=e=>{let{clientThreadId:t,conversationMode:r,clientModelId:s}=e,i=(0,b.ln)(r),n=(0,h.Zz)(t)?null:t;return{gcTime:0,refetchOnWindowFocus:!0,refetchOnMount:"always",queryKey:j(t),queryFn:()=>v.Z.getConversationDetails({conversationId:n,gizmoId:i,requestedDefaultModel:s})}},w=e=>(0,f.a)(y(e));function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}let P=(e,t)=>{var r;for(let s of null!==(r="string"==typeof e?[e]:e)&&void 0!==r?r:[])if(s&&t.has(s))return s;return null},O=(e,t)=>{var r,u,p;let m=(0,n.iu)(),{query:g}=(0,o.useRouter)(),f=(0,n.WK)(g),{modelId:b=null}=null!==(r=(0,i._C)())&&void 0!==r?r:{};x(e);let v=[f,null!==(u=(0,h.GK)(e))&&void 0!==u?u:null,b],j=P(v,m);(0,c.useEffect)(()=>{h.tQ.initThread(e,t,j),d.bZ.reset()},[e]);let y=(0,a.Z)(),O=(0,c.useCallback)(()=>{let e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},g);delete e.model;let t=l.Z.stringify(e);y({search:t.length>0?"?".concat(t):""})},[g,y]),{isLoading:N,data:z}=w({clientThreadId:e,clientModelId:null!==(p=v.find(e=>!!e))&&void 0!==p?p:null,conversationMode:t}),C=(0,d.Sj)();(0,c.useEffect)(()=>{if(f&&!N){if(!m.has(f)||C.find(e=>e.model_slug===f))return O();h.tQ.setThreadModelId(e,f)}},[f,C,m,e]),(0,c.useEffect)(()=>{if(N||!z)return;let{default_model_slug:t}=z;f&&t&&f!==t&&O(),d.bZ.updateDetails(z),t&&h.tQ.setThreadModelId(e,t)},[N,z])}},13391:function(e,t,r){r.d(t,{n:function(){return Z},A3:function(){return C},yx:function(){return I},JS:function(){return _}});var s,i=r(98601),n=r(15858),a=r(70879),o=r(99976),l=r(61619),c=r(79746),d=r(82363),u=r(91530),p=r.n(u),m=r(92379),g=r(68306),f=r(16757),h=r(24740),x=r(92745),b=r(31438),v=r(49763),j=r(22433),y=r(45248);let w=m.useLayoutEffect;function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}let P=/```.*?\n([\s\S]+?)\n?```[^`]*$/gms;var O=((s=O||{}).Core="Core",s.Chat="Chat",s.Settings="Settings",s);let N=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({Mod:"mod",Comma:","},n.s),z={[N.Mod]:/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"⌘":"Ctrl",[N.Comma]:",",[N.Enter]:"⏎",[N.Escape]:"Esc",[N.ArrowUp]:"↑",[N.ArrowDown]:"↓",[N.ArrowLeft]:"←",[N.ArrowRight]:"→",[N.Backspace]:"⌫",[N.Delete]:"⌦",[N.Tab]:"⇥",[N.Control]:"Ctrl",[N.Shift]:"Shift"},C=e=>e.map(e=>{var t;return null!==(t=z[e])&&void 0!==t?t:e}),M=(0,g.vU)({newChat:{id:"keyboardActions.newChat",defaultMessage:"Open new chat"},focusPromptTextarea:{id:"keyboardActions.focusPromptTextarea",defaultMessage:"Focus chat input"},copyLastCodeBlock:{id:"keyboardActions.copyLastCodeBlock",defaultMessage:"Copy last code block"},copyLastResponse:{id:"keyboardActions.copyLastResponse",defaultMessage:"Copy last response"},toggleCustomInstructions:{id:"keyboardActions.toggleCustomInstructions",defaultMessage:"Set custom instructions"},navigationToggle:{id:"keyboardActions.navigationToggle",defaultMessage:"Toggle sidebar"},deleteChat:{id:"keyboardActions.deleteChat",defaultMessage:"Delete chat"},archiveChat:{id:"keyboardActions.archiveChat",defaultMessage:"Archive chat"},toggleKeyboardActions:{id:"keyboardActions.toggleKeyboardActions",defaultMessage:"Show shortcuts"}}),Z=new v.V,T=e=>{let{resetThreadAction:t,clientThreadId:r}=e;return[{key:"newChat",action:t||p(),actionMessageDescriptor:M.newChat,group:O.Core,keyboardBinding:[N.Mod,N.Shift,"o"],altKeyboardBindings:[[N.Mod,"k"]]},{key:"focusPromptTextarea",action:a.go,actionMessageDescriptor:M.focusPromptTextarea,group:O.Chat,keyboardBinding:[N.Shift,N.Escape]},{key:"copyLastCodeBlock",action:()=>{if(null!=r){let e=x.tQ.getThreadCurrentLeafId(r),t=x.tQ.getThreadConversationTurns(r,e);for(let e=t.length-1;e>=0;e--){let{messages:r}=t[e],s=[...r.reduce((e,t)=>null==t.err&&t.message.author.role===f.uU.Assistant&&"all"===t.message.recipient?e+(e?"\n\n":"")+(0,j.RR)(t.message):e,"").matchAll(P)],i=s.length?s[s.length-1][1]:null;if(null!=i){(0,c.v)(i).then(()=>{h.m.success("Copied code block to clipboard")});break}}}},actionMessageDescriptor:M.copyLastCodeBlock,group:O.Chat,keyboardBinding:[N.Mod,N.Shift,";"],altKeyboardBindings:[[N.Mod,N.Shift,":"]]},{key:"copyLastResponse",action:()=>{null!=r&&x.tQ.copyLastMessageToClipboard(r,"keyboard").then(()=>{h.m.success("Last response copied to clipboard")})},actionMessageDescriptor:M.copyLastResponse,group:O.Chat,keyboardBinding:[N.Mod,N.Shift,"c"]},{key:"toggleCustomInstructions",action:()=>b.vm.toggleModal(b.B.UserContext),actionMessageDescriptor:M.toggleCustomInstructions,group:O.Settings,keyboardBinding:[N.Mod,N.Shift,"i"]},{key:"navigationToggle",action:()=>b.vm.toggleDesktopNavCollapsed(),actionMessageDescriptor:M.navigationToggle,group:O.Core,keyboardBinding:[N.Mod,N.Shift,"s"]},{key:"deleteChat",action:()=>{if(r){let e=x.tQ.getServerThreadId(r);e&&Z.publish({kind:"deleteChat",serverThreadId:e})}},actionMessageDescriptor:M.deleteChat,group:O.Chat,keyboardBinding:[N.Mod,N.Shift,N.Backspace],altKeyboardBindings:[[N.Mod,N.Shift,N.Delete]]},{key:"toggleKeyboardActions",action:()=>b.vm.toggleModal(b.B.KeyboardActions),actionMessageDescriptor:M.toggleKeyboardActions,group:O.Settings,keyboardBinding:[N.Mod,"/"]}]},S=e=>(function(e,t,r){let s=e.map(e=>{let{keyboardBinding:t}=e,r=t.join("+");if(e.altKeyboardBindings){r=[r];let t=e.altKeyboardBindings.map(e=>e.join("+"));r=r.concat(t)}return(0,y.ZP)(r,{byKey:!0})});w(()=>{if((null==r?void 0:r.enabled)===!1)return;let i=r=>{if(!r.repeat)for(let i=0;i<s.length;i++)s[i](r)&&(void 0===e[i].enabled||e[i].enabled)&&(r.preventDefault(),t(e[i]),e[i].action())},n=e=>{void 0!==e.key&&i(e)},a=document;return a.addEventListener("keydown",n),()=>{a.removeEventListener("keydown",n)}},[e,r])})(e,e=>{o.A.logEvent(l.M.keyboardShortcut,{keyboardActionKey:e.key}),d.U.addAction("chatgpt_keyboard_shortcut",{keyboardActionKey:e.key})},{enabled:!0}),_=function(){let{resetThreadAction:e,clientThreadId:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,m.useMemo)(()=>T({resetThreadAction:e,clientThreadId:t}).filter(e=>{let{enabled:t=!0}=e;return t}),[t,e])},I=e=>{let{resetThreadAction:t,clientThreadId:r}=e;S(_({resetThreadAction:t,clientThreadId:r}))}},58015:function(e,t,r){r.d(t,{C:function(){return s}});async function s(){}}}]);
//# sourceMappingURL=172-78c2267f73cac013.js.map