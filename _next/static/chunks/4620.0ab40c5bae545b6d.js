"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4620],{74620:function(e,t,a){a.r(t),a.d(t,{BrowsingMessage:function(){return $},getVisitedUrl:function(){return j}});var s,l=a(41141),r=a(85734),n=a(96243),i=a(62538),o=a(33481),u=a(93223),c=a(27860),d=a(91257),m=a(19841),g=a(7290),x=a(58164),h=a(26123),f=a(74091),v=a(33423),p=a(44512),k=a(72427),y=a(651);function $(e){var t,a;let{messages:s,isRequestActive:l,isLastMessageInTurn:i}=e,o=s.map(e=>e.message),u=o.map((e,t)=>{if(e.author.role!==r.uU.Tool||t>0&&b(e)&&b(o[t-1]))return null;let a=e.metadata;if(!a)return null;let{command:s,status:l}=a;return s?{type:s,status:l,didError:e.content.content_type===r.PX.SystemError,message:e}:null}).filter(n.l),d=u.filter(e=>(function(e,t){switch(e.type){case r.$x.Search:return!0;case r.$x.Click:case r.$x.Lookup:case r.$x.MultiClick:case r.$x.OpenUrl:case r.$x.Quote:case r.$x.QuoteFull:case r.$x.QuoteLines:return t?null!=function(e){var t;let a=null===(t=e.message.metadata)||void 0===t||null===(t=t._cite_metadata)||void 0===t?void 0:t.metadata_list[0];return null!=a&&"file"===a.type?a.name:null}(e):null!=j(e);case r.$x.Back:case r.$x.Scroll:return!1}})(e,!1)),m=null!==(t=d[d.length-1])&&void 0!==t?t:void 0,g=(0,h.Z)();if(o.filter(e=>e.author.role===r.uU.Tool).some(e=>{let{content:t}=e;return t.content_type===r.PX.SystemError}))return null;let x=v.X.Running,f={count:d.length,domain:m?(0,c.SX)(null!==(a=j(m))&&void 0!==a?a:""):void 0,query:m?S(m):void 0},$=g.formatMessage({id:"message.tools.browse.running",defaultMessage:"Searching the web"});return(o.some(k.We)?(x=v.X.Stopped,$=g.formatMessage({id:"message.tools.browse.stopped",defaultMessage:"Search stopped"})):i&&l?d.length>0&&($=function(e,t,a){switch(null==a?void 0:a.type){case r.$x.Click:case r.$x.MultiClick:case r.$x.Lookup:case r.$x.OpenUrl:case r.$x.Quote:case r.$x.QuoteFull:case r.$x.QuoteLines:case r.$x.Scroll:case r.$x.Back:return e.formatMessage({id:"message.tools.browse.reading",defaultMessage:"Browsing {domain}"},t);case r.$x.Search:case void 0:return e.formatMessage({id:"message.tools.browse.searching",defaultMessage:'Searching "{query}"'},t)}}(g,f,d[d.length-1])):u.length>0&&u.every(e=>e.didError)?(x=v.X.Error,$=g.formatMessage({id:"message.tools.browse.failed",defaultMessage:"Search failed"})):(x=v.X.Finished,$=0===f.count?g.formatMessage({id:"message.tools.browse.started",defaultMessage:"Searching the web..."}):g.formatMessage({id:"message.tools.browse.finished",defaultMessage:"Searched {count, plural, =0 {0 sites} one {# site} other {# sites}}"},f)),d.length>0&&x!==v.X.Error)?(0,y.jsx)(p.D,{highlightedCommand:$,showWorkUserSetting:!1,status:x,children:0===d.length?null:(0,y.jsx)(M,{commands:d})}):(0,y.jsx)(_,{$isError:x===v.X.Error,children:$})}function b(e){var t,a,s;return(null===(t=e.metadata)||void 0===t?void 0:t.command)==="quote"||(null===(a=e.metadata)||void 0===a?void 0:a.command)==="quote_full"||(null===(s=e.metadata)||void 0===s?void 0:s.command)==="quote_lines"}function M(e){let{commands:t}=e,a=(0,h.Z)(),s=t.map(j).filter(e=>null!=e),l=(0,d.u)(s);return(0,y.jsx)("div",{className:"mb-4 divide-y divide-token-border-light rounded-xl border border-token-border-light text-sm",children:(0,y.jsx)(g.M,{initial:!1,children:t.map((e,s)=>{let{icon:n,url:d,title:g,externalLink:h}=function(e){var t;switch(e.type){case r.$x.Search:{let t=S(e);return{icon:o.W1M,url:"bing.com",externalLink:function(e){var t;let a=null===(t=e.message.metadata)||void 0===t||null===(t=t.args)||void 0===t?void 0:t[0];return void 0===a?null:u.Z.getBingLink({query:a})}(e),title:t?"“".concat(t,"”"):{id:"message.tools.browse.querying",defaultMessage:"Querying",description:"Status message when issuing a query"}}}case r.$x.Click:case r.$x.MultiClick:case r.$x.Lookup:case r.$x.OpenUrl:case r.$x.Quote:case r.$x.QuoteFull:case r.$x.QuoteLines:case r.$x.Scroll:return{url:j(e),title:null!==(t=function(e){var t;let a=null===(t=e.message.metadata)||void 0===t||null===(t=t._cite_metadata)||void 0===t?void 0:t.metadata_list[0];return null!=a&&"file"!==a.type?a.title:null}(e))&&void 0!==t?t:void 0};case r.$x.Back:return{}}}(e),f=d?(0,c.SX)(d):void 0,v=g?"string"==typeof g?g:a.formatMessage(g):null,p=d?l.get(d):null;return(0,y.jsx)(x.E.div,{initial:"collapsed",animate:"open",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:(0,y.jsxs)(w,{url:null!=h?h:d,className:(0,m.default)("flex items-start gap-3 px-4 py-3",g?"text-token-text-secondary":"text-token-text-primary",0===s&&"rounded-t-xl",s===t.length-1&&"rounded-b-xl"),children:[n?(0,y.jsx)(n,{className:"icon-sm mt-0.5 flex-shrink-0 text-token-text-secondary"}):d?(0,y.jsx)(i.Z,{url:d,className:"mt-1"}):null,(0,y.jsxs)("div",{children:[v&&(0,y.jsxs)("div",{className:"line-clamp-1 text-token-text-primary",children:[p&&"".concat(p," — "),v]}),(0,y.jsx)("div",{children:f})]})]})},s)})})})}function w(e){let{url:t,children:a,className:s}=e;return t?(0,y.jsxs)("a",{href:t,target:"_blank",className:(0,m.default)(s,"group relative hover:bg-token-main-surface-secondary"),children:[a,(0,y.jsx)("div",{className:"invisible absolute right-3 bg-gradient-to-l from-token-main-surface-secondary to-transparent pl-4  group-hover:visible",children:(0,y.jsx)(o.Pfi,{className:"icon-md text-token-text-secondary"})})]}):(0,y.jsx)("div",{className:s,children:a})}function S(e){var t;return null===(t=e.message.metadata)||void 0===t||null===(t=t.args)||void 0===t?void 0:t[0]}function j(e){var t;let a=null===(t=e.message.metadata)||void 0===t||null===(t=t._cite_metadata)||void 0===t?void 0:t.metadata_list[0];return null!=a&&"file"!==a.type?a.url:null}let _=f.Z.p(s||(s=(0,l.Z)(["juice:first:mt-0 my-1.5 juice:h-8 flex items-center ltr:mr-auto rtl:ml-auto\n",""])),e=>{let{$isError:t}=e;return t?"text-token-text-error":"text-token-text-secondary"})}}]);
//# sourceMappingURL=4620.0ab40c5bae545b6d.js.map