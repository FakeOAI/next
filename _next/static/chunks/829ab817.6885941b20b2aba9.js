"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7530],{92569:function(e,t,s){s.d(t,{AOx:function(){return tZ},Ao0:function(){return sM},IGC:function(){return t4},JZE:function(){return t$},QR:function(){return tX},WDe:function(){return t3},ZQL:function(){return sO},_y:function(){return t1},gQe:function(){return sE},nNj:function(){return tq},orf:function(){return si}});var r,n,i,a,o,l,d,u,c,h,p,m,g,f,y,v,S,k,E,b,M,O,w,A,P,C,T,R,N,H,_,K,D,I,L,V,B,F,U,W,G,j,q,X,J,z,Q,$,Y,Z,ee,et,es,er,en,ei,ea,eo,el,ed,eu,ec,eh,ep,em,eg,ef,ey,ev,eS,ex,ek,eE,eb,eM,eO,ew,eA,eP,eC,eT,eR,eN,eH,e_,eK,eD,eI,eL,eV,eB,eF,eU,eW,eG,ej,eq,eX,eJ,ez,eQ,e$,eY,eZ,e0,e1,e3=s(45430),e4=s(2794),e2=s(27117),e5=s(99229),e9=s(88577),e6=s(34530),e7=s(63005),e8=s(81171),te=s(60314),tt=s(31610),ts=s(12498),tr=s(59231),tn=s(71307),ti=s(80326),ta=s(26465),to=s(50813),tl=s(46533),td=s(68040),tu=Object.create,tc=Object.defineProperty,th=Object.defineProperties,tp=Object.getOwnPropertyDescriptor,tm=Object.getOwnPropertyDescriptors,tg=Object.getOwnPropertySymbols,tf=Object.prototype.hasOwnProperty,ty=Object.prototype.propertyIsEnumerable,tv=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),tS=e=>{throw TypeError(e)},tx=(e,t,s)=>t in e?tc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,tk=(e,t)=>{for(var s in t||(t={}))tf.call(t,s)&&tx(e,s,t[s]);if(tg)for(var s of tg(t))ty.call(t,s)&&tx(e,s,t[s]);return e},tE=(e,t)=>th(e,tm(t)),tb=(e,t)=>tc(e,"name",{value:t,configurable:!0}),tM=(e,t)=>{var s={};for(var r in e)tf.call(e,r)&&0>t.indexOf(r)&&(s[r]=e[r]);if(null!=e&&tg)for(var r of tg(e))0>t.indexOf(r)&&ty.call(e,r)&&(s[r]=e[r]);return s},tO=e=>{var t;return[,,,tu(null!=(t=null==e?void 0:e[tv("metadata")])?t:null)]},tw=["class","method","getter","setter","accessor","field","value","get","set"],tA=e=>void 0!==e&&"function"!=typeof e?tS("Function expected"):e,tP=(e,t,s,r,n)=>({kind:tw[e],name:t,metadata:r,addInitializer:e=>s._?tS("Already initialized"):n.push(tA(e||null))}),tC=(e,t)=>tx(t,tv("metadata"),e[3]),tT=(e,t,s,r)=>{for(var n=0,i=e[t>>1],a=i&&i.length;n<a;n++)1&t?i[n].call(s):r=i[n].call(s,r);return r},tR=(e,t,s,r,n,i)=>{var a,o,l,d,u,c=7&t,h=!!(8&t),p=!!(16&t),m=c>3?e.length+1:c?h?1:2:0,g=tw[c+5],f=c>3&&(e[m-1]=[]),y=e[m]||(e[m]=[]),v=c&&(p||h||(n=n.prototype),c<5&&(c>3||!p)&&tp(c<4?n:{get[s](){return tK(this,i)},set[s](x){return tI(this,i,x)}},s));c?p&&c<4&&tb(i,(c>2?"set ":c>1?"get ":"")+s):tb(n,s);for(var S=r.length-1;S>=0;S--)d=tP(c,s,l={},e[3],y),c&&(d.static=h,d.private=p,u=d.access={has:p?e=>t_(n,e):e=>s in e},3^c&&(u.get=p?e=>(1^c?tK:tL)(e,n,4^c?i:v.get):e=>e[s]),c>2&&(u.set=p?(e,t)=>tI(e,n,t,4^c?i:v.set):(e,t)=>e[s]=t)),o=(0,r[S])(c?c<4?p?i:v[g]:c>4?void 0:{get:v.get,set:v.set}:n,d),l._=1,4^c||void 0===o?tA(o)&&(c>4?f.unshift(o):c?p?i=o:v[g]=o:n=o):"object"!=typeof o||null===o?tS("Object expected"):(tA(a=o.get)&&(v.get=a),tA(a=o.set)&&(v.set=a),tA(a=o.init)&&f.unshift(a));return c||tC(e,n),v&&tc(n,s,v),p?4^c?i:v:n},tN=(e,t,s)=>tx(e,"symbol"!=typeof t?t+"":t,s),tH=(e,t,s)=>t.has(e)||tS("Cannot "+s),t_=(e,t)=>Object(t)!==t?tS('Cannot use the "in" operator on this value'):e.has(t),tK=(e,t,s)=>(tH(e,t,"read from private field"),s?s.call(e):t.get(e)),tD=(e,t,s)=>t.has(e)?tS("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),tI=(e,t,s,r)=>(tH(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s),tL=(e,t,s)=>(tH(e,t,"access private method"),s);function tV(e,t){return e===t}function tB(e){let{previousOptions:t,update:s,equals:r=tV}=e,n=(0,e3.vV)(tk(tk({},t),s)),i=(0,e3.Ry)();for(let e of(0,e3.XP)(t)){let s=t[e],a=n[e];if(r(s,a)){i[e]={changed:!1};continue}i[e]={changed:!0,previousValue:s,value:a}}return{changes:(0,e3.vV)(i),options:n,pickChanged:e=>{let t=(0,e3.Ry)();for(let s of e){let e=i[s];(null==e?void 0:e.changed)&&(t[s]=e.value)}return t}}}var tF={[e4.mA.DUPLICATE_HELPER_NAMES]:"helper method",[e4.mA.DUPLICATE_COMMAND_NAMES]:"command method"};function tU(e){let{name:t,set:s,code:r}=e,n=tF[r];(0,e3.kG)(!s.has(t),{code:r,message:"There is a naming conflict for the name: ".concat(t," used in this '").concat(n,"'. Please rename or remove from the editor to avoid runtime errors.")}),s.add(t)}var tW="__IGNORE__",tG=class{constructor(e,...[t]){tN(this,"~O",{}),tN(this,"_initialOptions"),tN(this,"_dynamicKeys"),tN(this,"_options"),tN(this,"_mappedHandlers"),tN(this,"onAddCustomHandler"),this._mappedHandlers=(0,e3.Ry)(),this.populateMappedHandlers(),this._options=this._initialOptions=(0,e3.RH)(e,this.constructor.defaultOptions,null!=t?t:(0,e3.Ry)(),this.createDefaultHandlerOptions()),this._dynamicKeys=this.getDynamicKeys(),this.init()}get options(){return this._options}get dynamicKeys(){return this._dynamicKeys}get initialOptions(){return this._initialOptions}init(){}getDynamicKeys(){let e=[],{customHandlerKeys:t,handlerKeys:s,staticKeys:r}=this.constructor;for(let n of(0,e3.XP)(this._options))r.includes(n)||s.includes(n)||t.includes(n)||e.push(n);return e}ensureAllKeysAreDynamic(e){if(e5.NZ.isProduction)return;let t=[];for(let s of(0,e3.XP)(e))this._dynamicKeys.includes(s)||t.push(s);(0,e3.kG)((0,e3.yD)(t),{code:e4.mA.INVALID_SET_EXTENSION_OPTIONS,message:"Invalid properties passed into the 'setOptions()' method: ".concat(JSON.stringify(t),".")})}setOptions(e){var t;let s=this.getDynamicOptions();this.ensureAllKeysAreDynamic(e);let{changes:r,options:n,pickChanged:i}=tB({previousOptions:s,update:e});this.updateDynamicOptions(n),null==(t=this.onSetOptions)||t.call(this,{reason:"set",changes:r,options:n,pickChanged:i,initialOptions:this._initialOptions})}resetOptions(){var e;let{changes:t,options:s,pickChanged:r}=tB({previousOptions:this.getDynamicOptions(),update:this._initialOptions});this.updateDynamicOptions(s),null==(e=this.onSetOptions)||e.call(this,{reason:"reset",options:s,changes:t,pickChanged:r,initialOptions:this._initialOptions})}getDynamicOptions(){return e9(this._options,[...this.constructor.customHandlerKeys,...this.constructor.handlerKeys])}updateDynamicOptions(e){this._options=tk(tk({},this._options),e)}populateMappedHandlers(){for(let e of this.constructor.handlerKeys)this._mappedHandlers[e]=[]}createDefaultHandlerOptions(){let e=(0,e3.Ry)();for(let t of this.constructor.handlerKeys)e[t]=(...e)=>{var s;let{handlerKeyOptions:r}=this.constructor,n=null==(s=r[t])?void 0:s.reducer,i=null==n?void 0:n.getDefault(...e);for(let[,s]of this._mappedHandlers[t]){let a=s(...e);if(function(e,t,s){let{__ALL__:r}=e,n=e[s];return(!!r||!!n)&&(!!n&&n.earlyReturnValue!==tW&&((0,e3.mf)(n.earlyReturnValue)?!0===n.earlyReturnValue(t):t===n.earlyReturnValue)||!!r&&r.earlyReturnValue!==tW&&((0,e3.mf)(r.earlyReturnValue)?!0===r.earlyReturnValue(t):t===r.earlyReturnValue))}(r,i=n?n.accumulator(i,a,...e):a,t))break}return i};return e}addHandler(e,t,s=e4.xV.Default){return this._mappedHandlers[e].push([s,t]),this.sortHandlers(e),()=>this._mappedHandlers[e]=this._mappedHandlers[e].filter(([,e])=>e!==t)}hasHandlers(e){var t;return(null!=(t=this._mappedHandlers[e])?t:[]).length>0}sortHandlers(e){this._mappedHandlers[e]=(0,e3.DY)(this._mappedHandlers[e],([e],[t])=>t-e)}addCustomHandler(e,t){var s,r;return null!=(r=null==(s=this.onAddCustomHandler)?void 0:s.call(this,{[e]:t}))?r:e3.ZT}};tN(tG,"defaultOptions",{}),tN(tG,"staticKeys",[]),tN(tG,"handlerKeys",[]),tN(tG,"handlerKeyOptions",{}),tN(tG,"customHandlerKeys",[]);var tj=class extends tG{constructor(...e){for(let t of(super(tJ,...e),tN(this,"priorityOverride"),tN(this,"_extensions"),tN(this,"extensionMap"),tN(this,"_store"),tN(this,"~E",{}),this._extensions=(0,e3.uw)(this.createExtensions(),e=>e.constructor),this.extensionMap=new Map,this._extensions))this.extensionMap.set(t.constructor,t)}get priority(){var e,t;return null!=(t=null!=(e=this.priorityOverride)?e:this.options.priority)?t:this.constructor.defaultPriority}get constructorName(){return"".concat((0,e2.Ho)(this.name),"Extension")}get store(){return(0,e3.kG)(this._store,{code:e4.mA.MANAGER_PHASE_ERROR,message:"An error occurred while attempting to access the 'extension.store' when the Manager has not yet set created the lifecycle methods."}),(0,e3.vV)(this._store,{requireKeys:!0})}get extensions(){return this._extensions}replaceChildExtension(e,t){this.extensionMap.has(e)&&(this.extensionMap.set(e,t),this._extensions=this.extensions.map(s=>t.constructor===e?t:s))}createExtensions(){return[]}getExtension(e){let t=this.extensionMap.get(e);return(0,e3.kG)(t,{code:e4.mA.INVALID_GET_EXTENSION,message:"'".concat(e.name,"' does not exist within the preset: '").concat(this.name,"'")}),t}isOfType(e){return this.constructor===e}setStore(e){this._store||(this._store=e)}clone(...e){return new this.constructor(...e)}setPriority(e){this.priorityOverride=e}};tN(tj,"defaultPriority",e4.xV.Default);var tq=class extends tj{static get[e4.By](){return e4.lk.PlainExtensionConstructor}get[e4.By](){return e4.lk.PlainExtension}};tN(class extends tj{static get[e4.By](){return e4.lk.MarkExtensionConstructor}get[e4.By](){return e4.lk.MarkExtension}get type(){return(0,e3.fp)(this.store.schema.marks,this.name)}constructor(...e){super(...e)}},"disableExtraAttributes",!1);var tX=class extends tj{static get[e4.By](){return e4.lk.NodeExtensionConstructor}get[e4.By](){return e4.lk.NodeExtension}get type(){return(0,e3.fp)(this.store.schema.nodes,this.name)}constructor(...e){super(...e)}};tN(tX,"disableExtraAttributes",!1);var tJ={priority:void 0,extraAttributes:{},disableExtraAttributes:!1,exclude:{}};function tz(e){return(0,e5.gf)(e)&&(0,e5.pI)(e,[e4.lk.PlainExtension,e4.lk.MarkExtension,e4.lk.NodeExtension])}function tQ(e){return(0,e5.gf)(e)&&(0,e5.pI)(e,e4.lk.PlainExtension)}function t$(e){return(0,e5.gf)(e)&&(0,e5.pI)(e,e4.lk.NodeExtension)}function tY(e){return(0,e5.gf)(e)&&(0,e5.pI)(e,e4.lk.MarkExtension)}function tZ(e){return(t,s)=>{if(s&&"class"!==s.kind)throw Error("The extension decorator can only be used on a class.");let{defaultOptions:r,customHandlerKeys:n,handlerKeys:i,staticKeys:a,defaultPriority:o,handlerKeyOptions:l}=e,d=tM(e,["defaultOptions","customHandlerKeys","handlerKeys","staticKeys","defaultPriority","handlerKeyOptions"]),u=(0,e3.RF)(t);for(let[e,t]of(r&&(u.defaultOptions=r),o&&(u.defaultPriority=o),l&&(u.handlerKeyOptions=l),u.staticKeys=null!=a?a:[],u.handlerKeys=null!=i?i:[],u.customHandlerKeys=null!=n?n:[],Object.entries(d)))u[e]||(u[e]=t);return(0,e3.RF)(u)}}var t0=class extends tq{constructor(){super(...arguments),tN(this,"attributeList",[]),tN(this,"attributeObject",(0,e3.Ry)()),tN(this,"updateAttributes",(e=!0)=>{this.transformAttributes(),e&&this.store.commands.forceUpdate("attributes")})}get name(){return"attributes"}onCreate(){this.transformAttributes(),this.store.setExtensionStore("updateAttributes",this.updateAttributes)}transformAttributes(){var e,t,s,r;if(this.attributeObject=(0,e3.Ry)(),null==(e=this.store.managerSettings.exclude)?void 0:e.attributes){this.store.setStoreKey("attributes",this.attributeObject);return}for(let e of(this.attributeList=[],this.store.extensions)){if(null==(t=e.options.exclude)?void 0:t.attributes)continue;let n=null==(s=e.createAttributes)?void 0:s.call(e),i=tE(tk({},n),{class:(0,e3.cx)(...null!=(r=e.classNames)?r:[],null==n?void 0:n.class)});this.attributeList.unshift(i)}for(let e of this.attributeList)this.attributeObject=tE(tk(tk({},this.attributeObject),e),{class:(0,e3.cx)(this.attributeObject.class,e.class)});this.store.setStoreKey("attributes",this.attributeObject)}};function t1(e={}){return(t,s)=>{let r=s.name;if("string"!=typeof r)throw TypeError("Invalid method name provided");return s.addInitializer(function(){var t;(null!=(t=this.decoratedHelpers)?t:this.decoratedHelpers={})[r]=e}),t}}function t3(e={}){return(t,s)=>{let r=s.name;if("string"!=typeof r)throw TypeError("Invalid method name provided");return s.addInitializer(function(){var t;(null!=(t=this.decoratedCommands)?t:this.decoratedCommands={})[r]=e}),t}}function t4(e){return(t,s)=>{let r=s.name;if("string"!=typeof r)throw TypeError("Invalid method name provided");return s.addInitializer(function(){var t;(null!=(t=this.decoratedKeybindings)?t:this.decoratedKeybindings={})[r]=e}),t}}var t2=class{constructor(e){this.promiseCreator=e,tN(this,"failureHandlers",[]),tN(this,"successHandlers",[]),tN(this,"validateHandlers",[]),tN(this,"generateCommand",()=>e=>{let t=!0,{view:s,tr:r,dispatch:n}=e;if(!s)return!1;for(let s of this.validateHandlers)if(!s(tE(tk({},e),{dispatch:()=>{}}))){t=!1;break}return n&&t?(this.promiseCreator(e).then(e=>{this.runHandlers(this.successHandlers,{value:e,state:s.state,tr:s.state.tr,dispatch:s.dispatch,view:s})}).catch(e=>{this.runHandlers(this.failureHandlers,{error:e,state:s.state,tr:s.state.tr,dispatch:s.dispatch,view:s})}),n(r),!0):t})}validate(e,t="push"){return this.validateHandlers[t](e),this}success(e,t="push"){return this.successHandlers[t](e),this}failure(e,t="push"){return this.failureHandlers[t](e),this}runHandlers(e,t){var s;for(let s of e)if(!s(tE(tk({},t),{dispatch:()=>{}})))break;null==(s=t.dispatch)||s.call(t,t.tr)}};D=[tZ({defaultPriority:e4.xV.Highest,defaultOptions:{trackerClassName:"remirror-tracker-position",trackerNodeName:"span"},staticKeys:["trackerClassName","trackerNodeName"]})];var t5=class extends(K=tq,_=[t3()],H=[t3()],N=[t3()],R=[t3()],T=[t3()],C=[t3()],P=[t3()],A=[t3()],w=[t3()],O=[t3()],M=[t3()],b=[t3()],E=[t3()],k=[t3()],S=[t3()],v=[t3()],y=[t3()],f=[t3()],g=[t3()],m=[t3()],p=[t3()],h=[t3()],c=[t3()],u=[t3({description:({t:e})=>e(e7.Vb.SELECT_ALL_DESCRIPTION),label:({t:e})=>e(e7.Vb.SELECT_ALL_LABEL),shortcut:e4.vO.SelectAll})],d=[t3({description:({t:e})=>e(e7.Vb.COPY_DESCRIPTION),label:({t:e})=>e(e7.Vb.COPY_LABEL),shortcut:e4.vO.Copy,icon:"fileCopyLine"})],l=[t3({description:({t:e})=>e(e7.Vb.PASTE_DESCRIPTION),label:({t:e})=>e(e7.Vb.PASTE_LABEL),shortcut:e4.vO.Paste,icon:"clipboardLine"})],o=[t3({description:({t:e})=>e(e7.Vb.CUT_DESCRIPTION),label:({t:e})=>e(e7.Vb.CUT_LABEL),shortcut:e4.vO.Cut,icon:"scissorsFill"})],a=[t3()],i=[t1()],n=[t1()],r=[t1()],K){constructor(){super(...arguments),tT(I,5,this),tN(this,"_transaction"),tN(this,"decorated",new Map),tN(this,"forceUpdateTransaction",(e,...t)=>{let{forcedUpdates:s}=this.getCommandMeta(e);return this.setCommandMeta(e,{forcedUpdates:(0,e3.Nb)([...s,...t])}),e})}get name(){return"commands"}get transaction(){let e=this.store.getState();this._transaction||(this._transaction=e.tr);let t=this._transaction.before.eq(e.doc),s=!(0,e3.yD)(this._transaction.steps);if(!t){let t=e.tr;if(s)for(let e of this._transaction.steps)t.step(e);this._transaction=t}return this._transaction}onCreate(){this.store.setStoreKey("getForcedUpdates",this.getForcedUpdates.bind(this))}onView(e){var t,s,r;let{extensions:n,helpers:i}=this.store,a=(0,e3.Ry)(),o=new Set,l=(0,e3.Ry)(),d=t=>{var s;let r=(0,e3.Ry)(),n=()=>null!=t?t:this.transaction,i=[],o=()=>i;for(let[e,t]of Object.entries(a))null!=(s=l[e])&&s.disableChaining||(r[e]=this.chainedFactory({chain:r,command:t.original,getTr:n,getChain:o}));let u=e=>{(0,e3.kG)(e===n(),{message:"Chaining currently only supports `CommandFunction` methods which do not use the `state.tr` property. Instead you should use the provided `tr` property."})};return r.run=(t={})=>{let s=i;for(let e of(i=[],s))if(!e(u)&&t.exitEarly)return;e.dispatch(n())},r.tr=()=>{let e=i;for(let t of(i=[],e))t(u);return n()},r.enabled=()=>{for(let e of i)if(!e())return!1;return!0},r.new=e=>d(e),r};for(let e of n){let n=null!=(s=null==(t=e.createCommands)?void 0:t.call(e))?s:{},d=null!=(r=e.decoratedCommands)?r:{},u={};for(let[t,s]of(l=tE(tk({},l),{decoratedCommands:d}),Object.entries(d))){let r=(0,e3.HD)(s.shortcut)&&s.shortcut.startsWith("_|")?{shortcut:i.getNamedShortcut(s.shortcut,e.options)}:void 0;this.updateDecorated(t,tk(tE(tk({},s),{name:e.name}),r)),n[t]=e[t].bind(e),s.active&&(u[t]=()=>{var t,r;return null!=(r=null==(t=s.active)?void 0:t.call(s,e.options,this.store))&&r})}(0,e3.Qr)(n)||this.addCommands({active:u,names:o,commands:a,extensionCommands:n})}for(let[e,t]of Object.entries(d()))d[e]=t;this.store.setStoreKey("commands",a),this.store.setStoreKey("chain",d),this.store.setExtensionStore("commands",a),this.store.setExtensionStore("chain",d)}onStateUpdate({state:e}){this._transaction=e.tr}createPlugin(){return{}}customDispatch(e){return e}insertText(e,t={}){return(0,e3.HD)(e)?function(e,t={}){return({tr:s,dispatch:r,state:n})=>{let i=n.schema,a=s.selection,{from:o=a.from,to:l=null!=o?o:a.to,marks:d={}}=t;if(!r)return!0;s.insertText(e,o,l);let u=(0,e3.fp)(s.steps,s.steps.length-1).getMap().map(l);for(let[e,t]of(0,e3.qh)(d))s.addMark(o,u,(0,e3.fp)(i.marks,e).create(t));return r(s),!0}}(e,t):this.store.createPlaceholderCommand({promise:e,placeholder:{type:"inline"},onSuccess:(e,s,r)=>this.insertText(e,tk(tk({},t),s))(r)}).generateCommand()}selectText(e,t={}){return({tr:s,dispatch:r})=>{let n=(0,e5.b0)(e,s.doc);return(s.selection.anchor!==n.anchor||s.selection.head!==n.head||!!t.forceUpdate)&&(null==r||r(s.setSelection(n)),!0)}}selectMark(e){return t=>{let{tr:s}=t,r=(0,e5.IH)(s.selection.$from,e);return!!r&&this.store.commands.selectText.original({from:r.from,to:r.to})(t)}}delete(e){return({tr:t,dispatch:s})=>{let{from:r,to:n}=null!=e?e:t.selection;return null==s||s(t.delete(r,n)),!0}}emptyUpdate(e){return({tr:t,dispatch:s})=>(s&&(null==e||e(),s(t)),!0)}forceUpdate(...e){return({tr:t,dispatch:s})=>(null==s||s(this.forceUpdateTransaction(t,...e)),!0)}updateNodeAttributes(e,t){return({tr:s,dispatch:r})=>(null==r||r(s.setNodeMarkup(e,void 0,t)),!0)}setContent(e,t){return s=>{let{tr:r,dispatch:n}=s,i=this.store.manager.createState({content:e,selection:t});return!!i&&(null==n||n(r.replaceRangeWith(0,r.doc.nodeSize-2,i.doc)),!0)}}resetContent(){return e=>{let{tr:t,dispatch:s}=e,r=this.store.manager.createEmptyDoc();return r?this.setContent(r)(e):(null==s||s(t.delete(0,t.doc.nodeSize)),!0)}}emptySelection(){return({tr:e,dispatch:t})=>!e.selection.empty&&(null==t||t(e.setSelection(te.Bs.near(e.selection.$anchor))),!0)}insertNewLine(){return({dispatch:e,tr:t})=>!!(0,e5.hT)(t.selection)&&(null==e||e(t.insertText("\n")),!0)}insertNode(e,t={}){return({dispatch:s,tr:r,state:n})=>{var i,a;let{attrs:o,range:l,selection:d,replaceEmptyParentBlock:u=!1}=t,{from:c,to:h,$from:p}=(0,e5.b0)(null!=(i=null!=d?d:l)?i:r.selection,r.doc);if((0,e5.PH)(e)||(0,e5.mt)(e)){let t=p.before(p.depth);return null==s||s(u&&c===h&&(0,e5.mp)(p.parent)?r.replaceWith(t,t+p.parent.nodeSize,e):r.replaceWith(c,h,e)),!0}let m=(0,e3.HD)(e)?n.schema.nodes[e]:e;(0,e3.kG)(m,{code:e4.mA.SCHEMA,message:"The requested node type ".concat(e," does not exist in the schema.")});let g=null==(a=t.marks)?void 0:a.map(e=>{if(e instanceof e8.vc)return e;let t=(0,e3.HD)(e)?n.schema.marks[e]:e;return(0,e3.kG)(t,{code:e4.mA.SCHEMA,message:"The requested mark type ".concat(e," does not exist in the schema.")}),t.create()}),f=m.createAndFill(o,(0,e3.HD)(t.content)?n.schema.text(t.content):t.content,g);if(!f)return!1;let y=c!==h;return null==s||s(y?r.replaceRangeWith(c,h,f):r.insert(c,f)),!0}}focus(e){return t=>{let{dispatch:s,tr:r}=t,{view:n}=this.store;if(!1===e||n.hasFocus()&&(void 0===e||!0===e))return!1;if(void 0===e||!0===e){let{from:t=0,to:s=t}=r.selection;e={from:t,to:s}}return s&&this.delayedFocus(),this.selectText(e)(t)}}blur(e){return t=>{let{view:s}=this.store;return!!s.hasFocus()&&(requestAnimationFrame(()=>{s.dom.blur()}),!e||this.selectText(e)(t))}}setBlockNodeType(e,t,s,r=!0){return(0,e5.uJ)(e,t,s,r)}toggleWrappingNode(e,t,s){return(0,e5.bm)(e,t,s)}toggleBlockNodeItem(e){return(0,e5.zU)(e)}wrapInNode(e,t,s){return(0,e5.ym)(e,t,s)}applyMark(e,t,s){return({tr:r,dispatch:n,state:i})=>{let a=(0,e5.b0)(null!=s?s:r.selection,r.doc),o=(0,e5.Lp)(a),l=(0,e3.HD)(e)?i.schema.marks[e]:e;if((0,e3.kG)(l,{code:e4.mA.SCHEMA,message:"Mark type: ".concat(e," does not exist on the current schema.")}),a.empty&&!o||!function(e,t,s){for(let{$from:r,$to:n}of s){let s=0===r.depth&&t.type.allowsMarkType(e);if(t.nodesBetween(r.pos,n.pos,t=>{if(s)return!1;s=t.inlineContent&&t.type.allowsMarkType(e)}),s)return!0}return!1}(l,r.doc,a.ranges))return!1;if(!n)return!0;if(o)return r.removeStoredMark(l),t&&r.addStoredMark(l.create(t)),n(r),!0;let d=!1;for(let{$from:e,$to:t}of a.ranges){if(d)break;d=r.doc.rangeHasMark(e.pos,t.pos,l)}for(let{$from:e,$to:s}of a.ranges)d&&r.removeMark(e.pos,s.pos,l),t&&r.addMark(e.pos,s.pos,l.create(t));return n(r),!0}}toggleMark(e){return function(e){let{type:t,attrs:s,range:r,selection:n}=e;return e=>{var i;let{dispatch:a,tr:o,state:l}=e,d=(0,e3.HD)(t)?l.schema.marks[t]:t;if((0,e3.kG)(d,{code:e4.mA.SCHEMA,message:"Mark type: ".concat(t," does not exist on the current schema.")}),r||n){let{from:e,to:l}=(0,e5.b0)(null!=(i=null!=n?n:r)?i:o.selection,o.doc);return(0,e5.yw)(tk({trState:o,type:t},r))?null==a||a(o.removeMark(e,l,d)):null==a||a(o.addMark(e,l,d.create(s))),!0}return(0,tt.A_)((0,ts.w9)(d,s))(e)}}(e)}removeMark(e){return(0,e5.P9)(e)}setMeta(e,t){return({tr:s})=>(s.setMeta(e,t),!0)}selectAll(){return this.selectText("all")}copy(){return e=>!e.tr.selection.empty&&(e.dispatch&&document.execCommand("copy"),!0)}paste(){return this.store.createPlaceholderCommand({promise:async()=>{var e;return(null==(e=navigator.clipboard)?void 0:e.readText)?await navigator.clipboard.readText():""},placeholder:{type:"inline"},onSuccess:(e,t,s)=>this.insertNode((0,e5.OC)({content:e,schema:s.state.schema}),{selection:t})(s)}).generateCommand()}cut(){return e=>!e.tr.selection.empty&&(e.dispatch&&document.execCommand("cut"),!0)}replaceText(e){return(0,e5.lp)(e)}getAllCommandOptions(){let e={};for(let[t,s]of this.decorated)(0,e3.Qr)(s)||(e[t]=s);return e}getCommandOptions(e){return this.decorated.get(e)}getCommandProp(){return{tr:this.transaction,dispatch:this.store.view.dispatch,state:this.store.view.state,view:this.store.view}}updateDecorated(e,t){var s;if(!t){this.decorated.delete(e);return}let r=null!=(s=this.decorated.get(e))?s:{name:""};this.decorated.set(e,tk(tk({},r),t))}handleIosFocus(){e5.NZ.isIos&&this.store.view.dom.focus()}delayedFocus(){this.handleIosFocus(),requestAnimationFrame(()=>{this.store.view.focus(),this.store.view.dispatch(this.transaction.scrollIntoView())})}getForcedUpdates(e){return this.getCommandMeta(e).forcedUpdates}getCommandMeta(e){var t;let s=null!=(t=e.getMeta(this.pluginKey))?t:{};return tk(tk({},t9),s)}setCommandMeta(e,t){let s=this.getCommandMeta(e);e.setMeta(this.pluginKey,tk(tk({},s),t))}addCommands(e){let{extensionCommands:t,commands:s,names:r,active:n}=e;for(let[e,i]of(0,e3.qh)(t))tU({name:e,set:r,code:e4.mA.DUPLICATE_COMMAND_NAMES}),(0,e3.kG)(!t6.has(e),{code:e4.mA.DUPLICATE_COMMAND_NAMES,message:"The command name you chose is forbidden."}),s[e]=this.createUnchainedCommand(i,n[e])}unchainedFactory(e){return(...t)=>{let s;let{shouldDispatch:r=!0,command:n}=e,{view:i}=this.store,{state:a}=i;return r&&(s=i.dispatch),n(...t)({state:a,dispatch:s,view:i,tr:a.tr})}}createUnchainedCommand(e,t){let s=this.unchainedFactory({command:e});return s.enabled=this.unchainedFactory({command:e,shouldDispatch:!1}),s.original=e,s.active=t,s}chainedFactory(e){return(...t)=>{let{chain:s,command:r,getTr:n,getChain:i}=e,a=i(),{view:o}=this.store,{state:l}=o;return a.push(e=>r(...t)({state:l,dispatch:e,view:o,tr:n()})),s}}};tR(I=tO(K),1,"customDispatch",_,t5),tR(I,1,"insertText",H,t5),tR(I,1,"selectText",N,t5),tR(I,1,"selectMark",R,t5),tR(I,1,"delete",T,t5),tR(I,1,"emptyUpdate",C,t5),tR(I,1,"forceUpdate",P,t5),tR(I,1,"updateNodeAttributes",A,t5),tR(I,1,"setContent",w,t5),tR(I,1,"resetContent",O,t5),tR(I,1,"emptySelection",M,t5),tR(I,1,"insertNewLine",b,t5),tR(I,1,"insertNode",E,t5),tR(I,1,"focus",k,t5),tR(I,1,"blur",S,t5),tR(I,1,"setBlockNodeType",v,t5),tR(I,1,"toggleWrappingNode",y,t5),tR(I,1,"toggleBlockNodeItem",f,t5),tR(I,1,"wrapInNode",g,t5),tR(I,1,"applyMark",m,t5),tR(I,1,"toggleMark",p,t5),tR(I,1,"removeMark",h,t5),tR(I,1,"setMeta",c,t5),tR(I,1,"selectAll",u,t5),tR(I,1,"copy",d,t5),tR(I,1,"paste",l,t5),tR(I,1,"cut",o,t5),tR(I,1,"replaceText",a,t5),tR(I,1,"getAllCommandOptions",i,t5),tR(I,1,"getCommandOptions",n,t5),tR(I,1,"getCommandProp",r,t5),t5=tR(I,0,"CommandsExtension",D,t5),tT(I,1,t5);var t9={forcedUpdates:[]},t6=new Set(["run","chain","original","raw","enabled","tr","new"]);q=[tZ({defaultOptions:{persistentSelectionClass:void 0,placeholderClassName:"placeholder",placeholderNodeName:"span"},staticKeys:["placeholderClassName","placeholderNodeName"],handlerKeys:["decorations"],handlerKeyOptions:{decorations:{reducer:{accumulator:(e,t,s)=>e.add(s.doc,t.find()),getDefault:()=>tr.EH.empty}}},defaultPriority:e4.xV.Low})];var t7=class extends(j=tq,G=[t3()],W=[t3()],U=[t3()],F=[t3()],B=[t3()],V=[t1()],L=[t1()],j){constructor(){super(...arguments),tT(X,5,this),tN(this,"placeholders",tr.EH.empty),tN(this,"placeholderWidgets",new Map),tN(this,"createPlaceholderCommand",e=>{let t=(0,e3.EL)(),{promise:s,placeholder:r,onFailure:n,onSuccess:i}=e;return new t2(s).validate(e=>this.addPlaceholder(t,r)(e)).success(e=>{var s;let{state:r,tr:a,dispatch:o,view:l,value:d}=e,u=this.store.helpers.findPlaceholder(t);if(!u){let e=Error("The placeholder has been removed");return null!=(s=null==n?void 0:n({error:e,state:r,tr:a,dispatch:o,view:l}))&&s}return this.removePlaceholder(t)({state:r,tr:a,view:l,dispatch:()=>{}}),i(d,u,{state:r,tr:a,dispatch:o,view:l})}).failure(e=>{var s;return this.removePlaceholder(t)(tE(tk({},e),{dispatch:()=>{}})),null!=(s=null==n?void 0:n(e))&&s})})}get name(){return"decorations"}onCreate(){this.store.setExtensionStore("createPlaceholderCommand",this.createPlaceholderCommand)}createPlugin(){return{state:{init:()=>{},apply:e=>{var t,s,r,n,i,a;let{added:o,clearTrackers:l,removed:d,updated:u}=this.getMeta(e);if(l){for(let[,e]of(this.placeholders=tr.EH.empty,this.placeholderWidgets))null==(s=(t=e.spec).onDestroy)||s.call(t,this.store.view,e.spec.element);this.placeholderWidgets.clear();return}for(let[,t]of(this.placeholders=this.placeholders.map(e.mapping,e.doc,{onRemove:e=>{var t,s;let r=this.placeholderWidgets.get(e.id);r&&(null==(s=(t=r.spec).onDestroy)||s.call(t,this.store.view,r.spec.element))}}),this.placeholderWidgets))null==(n=(r=t.spec).onUpdate)||n.call(r,this.store.view,t.from,t.spec.element,t.spec.data);for(let t of o){if("inline"===t.type){this.addInlinePlaceholder(t,e);continue}if("node"===t.type){this.addNodePlaceholder(t,e);continue}if("widget"===t.type){this.addWidgetPlaceholder(t,e);continue}}for(let{id:t,data:s}of u){let r=this.placeholderWidgets.get(t);if(!r)continue;let n=tr.p.widget(r.from,r.spec.element,tE(tk({},r.spec),{data:s}));this.placeholders=this.placeholders.remove([r]).add(e.doc,[n]),this.placeholderWidgets.set(t,n)}for(let e of d){let t=this.placeholders.find(void 0,void 0,t=>t.id===e&&t.__type===se),s=this.placeholderWidgets.get(e);s&&(null==(a=(i=s.spec).onDestroy)||a.call(i,this.store.view,s.spec.element)),this.placeholders=this.placeholders.remove(t),this.placeholderWidgets.delete(e)}}},props:{decorations:e=>{let t=this.options.decorations(e);for(let s of(t=t.add(e.doc,this.placeholders.find()),this.store.extensions)){if(!s.createDecorations)continue;let r=s.createDecorations(e).find();t=t.add(e.doc,r)}return t},handleDOMEvents:{blur:e=>(this.options.persistentSelectionClass&&e.dispatch(e.state.tr.setMeta(st,!1)),!1),focus:e=>(this.options.persistentSelectionClass&&e.dispatch(e.state.tr.setMeta(st,!0)),!1)}}}}updateDecorations(){return({tr:e,dispatch:t})=>(null==t||t(e),!0)}addPlaceholder(e,t,s){return({dispatch:r,tr:n})=>!!this.addPlaceholderTransaction(e,t,n,!r)&&(null==r||r(s?n.deleteSelection():n),!0)}updatePlaceholder(e,t){return({dispatch:s,tr:r})=>!!this.updatePlaceholderTransaction({id:e,data:t,tr:r,checkOnly:!s})&&(null==s||s(r),!0)}removePlaceholder(e){return({dispatch:t,tr:s})=>!!this.removePlaceholderTransaction({id:e,tr:s,checkOnly:!t})&&(null==t||t(s),!0)}clearPlaceholders(){return({tr:e,dispatch:t})=>!!this.clearPlaceholdersTransaction({tr:e,checkOnly:!t})&&(null==t||t(e),!0)}findPlaceholder(e){return this.findAllPlaceholders().get(e)}findAllPlaceholders(){let e=new Map;for(let t of this.placeholders.find(void 0,void 0,e=>e.__type===se))e.set(t.spec.id,{from:t.from,to:t.to});return e}createDecorations(e){var t,s,r;let{persistentSelectionClass:n}=this.options;return!n||(null==(t=this.store.view)?void 0:t.hasFocus())||(null==(r=(s=this.store.helpers).isInteracting)?void 0:r.call(s))?tr.EH.empty:function(e,t,s){let{selection:r,doc:n}=e;if(r.empty)return t;let{from:i,to:a}=r,o=(0,e5.EG)(r)?tr.p.node(i,a,s):tr.p.inline(i,a,s);return t.add(n,[o])}(e,tr.EH.empty,{class:(0,e3.HD)(n)?n:"selection"})}onApplyState(){}addWidgetPlaceholder(e,t){var s;let{pos:r,createElement:n,onDestroy:i,onUpdate:a,className:o,nodeName:l,id:d,type:u}=e,c=null!=(s=null==n?void 0:n(this.store.view,r))?s:document.createElement(l);c.classList.add(o);let h=tr.p.widget(r,c,{id:d,__type:se,type:u,element:c,onDestroy:i,onUpdate:a});this.placeholderWidgets.set(d,h),this.placeholders=this.placeholders.add(t.doc,[h])}addInlinePlaceholder(e,t){let s;let{from:r=t.selection.from,to:n=t.selection.to,className:i,nodeName:a,id:o,type:l}=e;if(r===n){let e=document.createElement(a);e.classList.add(i),s=tr.p.widget(r,e,{id:o,type:l,__type:se,widget:e})}else s=tr.p.inline(r,n,{nodeName:a,class:i},{id:o,__type:se});this.placeholders=this.placeholders.add(t.doc,[s])}addNodePlaceholder(e,t){let{pos:s,className:r,nodeName:n,id:i}=e,a=(0,e3.hj)(s)?t.doc.resolve(s):t.selection.$from,o=(0,e3.hj)(s)?a.nodeAfter?{pos:s,end:a.nodeAfter.nodeSize}:void 0:(0,e5.hK)(a);if(!o)return;let l=tr.p.node(o.pos,o.end,{nodeName:n,class:r},{id:i,__type:se});this.placeholders=this.placeholders.add(t.doc,[l])}withRequiredBase(e,t){let{placeholderNodeName:s,placeholderClassName:r}=this.options,{nodeName:n=s,className:i}=t,a=tM(t,["nodeName","className"]);return tE(tk({nodeName:n,className:(i?[r,i]:[r]).join(" ")},a),{id:e})}getMeta(e){var t;let s=null!=(t=e.getMeta(this.pluginKey))?t:{};return tk(tk({},t8),s)}setMeta(e,t){let s=this.getMeta(e);e.setMeta(this.pluginKey,tk(tk({},s),t))}addPlaceholderTransaction(e,t,s,r=!1){if(this.findPlaceholder(e))return!1;if(r)return!0;let{added:n}=this.getMeta(s);return this.setMeta(s,{added:[...n,this.withRequiredBase(e,t)]}),!0}updatePlaceholderTransaction(e){let{id:t,tr:s,checkOnly:r=!1,data:n}=e;if(!this.findPlaceholder(t))return!1;if(r)return!0;let{updated:i}=this.getMeta(s);return this.setMeta(s,{updated:(0,e3.Nb)([...i,{id:t,data:n}])}),!0}removePlaceholderTransaction(e){let{id:t,tr:s,checkOnly:r=!1}=e;if(!this.findPlaceholder(t))return!1;if(r)return!0;let{removed:n}=this.getMeta(s);return this.setMeta(s,{removed:(0,e3.Nb)([...n,t])}),!0}clearPlaceholdersTransaction(e){let{tr:t,checkOnly:s=!1}=e;return this.getPluginState()!==tr.EH.empty&&(!!s||(this.setMeta(t,{clearTrackers:!0}),!0))}};tR(X=tO(j),1,"updateDecorations",G,t7),tR(X,1,"addPlaceholder",W,t7),tR(X,1,"updatePlaceholder",U,t7),tR(X,1,"removePlaceholder",F,t7),tR(X,1,"clearPlaceholders",B,t7),tR(X,1,"findPlaceholder",V,t7),tR(X,1,"findAllPlaceholders",L,t7),t7=tR(X,0,"DecorationsExtension",q,t7),tT(X,1,t7);var t8={added:[],updated:[],clearTrackers:!1,removed:[]},se="placeholderDecoration",st="persistentSelectionFocus";J=[tZ({handlerKeys:["docChanged"],handlerKeyOptions:{docChanged:{earlyReturnValue:!1}},defaultPriority:e4.xV.Lowest})];var ss=class extends(Q=tq){get name(){return"docChanged"}onStateUpdate(e){let{firstUpdate:t,transactions:s,tr:r}=e;!t&&(null!=s?s:[r]).some(e=>null==e?void 0:e.docChanged)&&this.options.docChanged(e)}};ss=tR(z=tO(Q),0,"DocChangedExtension",J,ss),tT(z,1,ss),ea=[tZ({})];var sr=class extends(ei=tq,en=[t1()],er=[t1()],es=[t1()],et=[t1()],ee=[t3()],Z=[t1()],Y=[t1()],$=[t1()],ei){constructor(){super(...arguments),tT(eo,5,this)}get name(){return"helpers"}onCreate(){var e,t,s;this.store.setStringHandler("text",this.textToProsemirrorNode.bind(this)),this.store.setStringHandler("html",e5.OC);let r=(0,e3.Ry)(),n=(0,e3.Ry)(),i=(0,e3.Ry)(),a=new Set;for(let o of this.store.extensions){t$(o)&&(n[o.name]=e=>(0,e5.Ig)({state:this.store.getState(),type:o.type,attrs:e}),i[o.name]=e=>{var t;return null==(t=(0,e5.EM)({state:this.store.getState(),type:o.type,attrs:e}))?void 0:t.node.attrs}),tY(o)&&(n[o.name]=e=>(0,e5.yw)({trState:this.store.getState(),type:o.type,attrs:e}),i[o.name]=e=>{let t=(0,e5.IH)(this.store.getState().selection.$from,o.type);return t&&e?(0,e5.V1)(t.mark,e)?t.mark.attrs:void 0:null==t?void 0:t.mark.attrs});let l=null!=(t=null==(e=o.createHelpers)?void 0:e.call(o))?t:{};for(let e of Object.keys(null!=(s=o.decoratedHelpers)?s:{}))l[e]=o[e].bind(o);if(!(0,e3.Qr)(l))for(let[e,t]of(0,e3.qh)(l))tU({name:e,set:a,code:e4.mA.DUPLICATE_HELPER_NAMES}),r[e]=t}this.store.setStoreKey("attrs",i),this.store.setStoreKey("active",n),this.store.setStoreKey("helpers",r),this.store.setExtensionStore("attrs",i),this.store.setExtensionStore("active",n),this.store.setExtensionStore("helpers",r)}isSelectionEmpty(e=this.store.getState()){return(0,e5.Ab)(e)}isViewEditable(e=this.store.getState()){var t,s,r;return null!=(r=null==(s=(t=this.store.view.props).editable)?void 0:s.call(t,e))&&r}getStateJSON(e=this.store.getState()){return e.toJSON()}getJSON(e=this.store.getState()){return e.doc.toJSON()}insertHtml(e,t){return s=>{let{state:r}=s,n=(0,e5.OC)({content:e,schema:r.schema,fragment:!0});return this.store.commands.insertNode.original(n,t)(s)}}getText({lineBreakDivider:e="\n\n",state:t=this.store.getState()}={}){return t.doc.textBetween(0,t.doc.content.size,e,e4.Vp)}getTextBetween(e,t,s=this.store.getState().doc){return s.textBetween(e,t,"\n\n",e4.Vp)}getHTML(e=this.store.getState()){return(0,e5.Em)(e.doc,this.store.document)}textToProsemirrorNode(e){let t="<pre>".concat(e.content,"</pre>");return this.store.stringHandlers.html(tE(tk({},e),{content:t}))}};tR(eo=tO(ei),1,"isSelectionEmpty",en,sr),tR(eo,1,"isViewEditable",er,sr),tR(eo,1,"getStateJSON",es,sr),tR(eo,1,"getJSON",et,sr),tR(eo,1,"insertHtml",ee,sr),tR(eo,1,"getText",Z,sr),tR(eo,1,"getTextBetween",Y,sr),tR(eo,1,"getHTML",$,sr),sr=tR(eo,0,"HelpersExtension",ea,sr),tT(eo,1,sr),el=[tZ({defaultPriority:e4.xV.Default,handlerKeys:["shouldSkipInputRule"],handlerKeyOptions:{shouldSkipInputRule:{earlyReturnValue:!0}}})];var sn=class extends(eu=tq){get name(){return"inputRules"}onCreate(){this.store.setExtensionStore("rebuildInputRules",this.rebuildInputRules.bind(this))}createExternalPlugins(){return[this.generateInputRulesPlugin()]}generateInputRulesPlugin(){var e,t;let s=[],r=this.store.markTags[e4.eX.ExcludeInputRules];for(let n of this.store.extensions)if((null==(e=this.store.managerSettings.exclude)||!e.inputRules)&&n.createInputRules&&(null==(t=n.options.exclude)||!t.inputRules))for(let e of n.createInputRules())e.shouldSkip=this.options.shouldSkipInputRule,e.invalidMarks=r,s.push(e);return(0,tn.Hw)({rules:s})}rebuildInputRules(){this.store.updateExtensionPlugins(this)}};sn=tR(ed=tO(eu),0,"InputRulesExtension",el,sn),tT(ed,1,sn),ef=[tZ({defaultPriority:e4.xV.Low,defaultOptions:{shortcuts:"default",undoInputRuleOnBackspace:!0,selectParentNodeOnEscape:!1,excludeBaseKeymap:!1,exitMarksOnArrowPress:!0},customHandlerKeys:["keymap"]})];var si=class extends(eg=tq,em=[t4({shortcut:"ArrowRight",isActive:e=>e.exitMarksOnArrowPress})],ep=[t4({shortcut:"ArrowLeft",isActive:e=>e.exitMarksOnArrowPress})],eh=[t4({shortcut:"Backspace",isActive:e=>e.exitMarksOnArrowPress})],ec=[t1()],eg){constructor(){super(...arguments),tT(ey,5,this),tN(this,"extraKeyBindings",[]),tN(this,"backwardMarkExitTracker",new Map),tN(this,"keydownHandler",null),tN(this,"onAddCustomHandler",({keymap:e})=>{var t,s;if(e)return this.extraKeyBindings=[...this.extraKeyBindings,e],null==(s=(t=this.store).rebuildKeymap)||s.call(t),()=>{var t,s;this.extraKeyBindings=this.extraKeyBindings.filter(t=>t!==e),null==(s=(t=this.store).rebuildKeymap)||s.call(t)}}),tN(this,"rebuildKeymap",()=>{this.setupKeydownHandler()})}get name(){return"keymap"}get shortcutMap(){let{shortcuts:e}=this.options;return(0,e3.HD)(e)?su[e]:e}onCreate(){this.store.setExtensionStore("rebuildKeymap",this.rebuildKeymap)}createExternalPlugins(){var e;return(null==(e=this.store.managerSettings.exclude)?void 0:e.keymap)?[]:(this.setupKeydownHandler(),[new te.Sy({props:{handleKeyDown:(e,t)=>{var s;return null==(s=this.keydownHandler)?void 0:s.call(this,e,t)}}})])}setupKeydownHandler(){let e=this.generateKeymapBindings();this.keydownHandler=(0,ti.$)(e)}generateKeymapBindings(){var e,t,s;let r=[],n=this.shortcutMap,i=this.store.getExtension(t5),a=e=>t=>sa({shortcut:t,map:n,store:this.store,options:e.options});for(let o of this.store.extensions){let l=null!=(e=o.decoratedKeybindings)?e:{};if(null==(t=o.options.exclude)||!t.keymap)for(let[e,t]of(o.createKeymap&&r.push(function(e,t){let s,r;let n={};for(let[i,a]of((0,e3.kJ)(e)?[r,s]=e:s=e,(0,e3.qh)(s)))n[so(i,t)]=a;return(0,e3.o8)(r)?n:[r,n]}(o.createKeymap(a(o)),n)),(0,e3.qh)(l))){if(t.isActive&&!t.isActive(o.options,this.store))continue;let a=o[e].bind(o),l=sa({shortcut:t.shortcut,map:n,options:o.options,store:this.store}),d=(0,e3.mf)(t.priority)?t.priority(o.options,this.store):null!=(s=t.priority)?s:e4.xV.Low,u=(0,e3.Ry)();for(let e of l)u[e]=a;r.push([d,u]),t.command&&i.updateDecorated(t.command,{shortcut:l})}}let o=this.sortKeymaps([...this.extraKeyBindings,...r]);return(0,e5.bk)(o)}arrowRightShortcut(e){let t=this.store.markTags[e4.eX.PreventExits],s=this.store.nodeTags[e4.eX.PreventExits];return this.exitMarkForwards(t,s)(e)}arrowLeftShortcut(e){let t=this.store.markTags[e4.eX.PreventExits],s=this.store.nodeTags[e4.eX.PreventExits];return(0,e5.Q2)(this.exitNodeBackwards(s),this.exitMarkBackwards(t,s))(e)}backspace(e){let t=this.store.markTags[e4.eX.PreventExits],s=this.store.nodeTags[e4.eX.PreventExits];return(0,e5.Q2)(this.exitNodeBackwards(s,!0),this.exitMarkBackwards(t,s,!0))(e)}createKeymap(){let{selectParentNodeOnEscape:e,undoInputRuleOnBackspace:t,excludeBaseKeymap:s}=this.options,r=(0,e3.Ry)();if(!s)for(let[e,t]of(0,e3.qh)(ts.YR))r[e]=(0,tt.A_)(t);return t&&ts.YR.Backspace&&(r.Backspace=(0,tt.A_)((0,ts.QF)(tn.dU,ts.YR.Backspace))),e&&(r.Escape=(0,tt.A_)(ts.N0)),[e4.xV.Low,r]}getNamedShortcut(e,t={}){return e.startsWith("_|")?sa({shortcut:e,map:this.shortcutMap,store:this.store,options:t}):[e]}onSetOptions(e){var t,s;let{changes:r}=e;(r.excludeBaseKeymap.changed||r.selectParentNodeOnEscape.changed||r.undoInputRuleOnBackspace.changed)&&(null==(s=(t=this.store).rebuildKeymap)||s.call(t))}sortKeymaps(e){return(0,e3.DY)(e.map(e=>(0,e3.kJ)(e)?e:[e4.xV.Default,e]),(e,t)=>t[0]-e[0]).map(e=>e[1])}exitMarkForwards(e,t){return s=>{let{tr:r,dispatch:n}=s;if(!(0,e5.OA)(r.selection)||(0,e5.Tr)({selection:r.selection,types:t}))return!1;let i=r.selection.$from.marks().filter(t=>!e.includes(t.type.name));if((0,e3.yD)(i))return!1;if(!n)return!0;for(let e of i)r.removeStoredMark(e);return n(r.insertText(" ",r.selection.from)),!0}}exitNodeBackwards(e,t=!1){return s=>{let{tr:r}=s;if(!(t?e5.GK:e5.sg)(r.selection))return!1;let n=r.selection.$anchor.node();return!(!(0,e5.mp)(n)||(0,e5.xN)(n)||e.includes(n.type.name))&&this.store.commands.toggleBlockNodeItem.original({type:n.type})(s)}}exitMarkBackwards(e,t,s=!1){return r=>{var n;let{tr:i,dispatch:a}=r;if(!(s?e5.GK:e5.sg)(i.selection)||this.backwardMarkExitTracker.has(i.selection.anchor))return this.backwardMarkExitTracker.clear(),!1;if((0,e5.Tr)({selection:i.selection,types:t}))return!1;let o=[...null!=(n=i.storedMarks)?n:[],...i.selection.$from.marks()].filter(t=>!e.includes(t.type.name));if((0,e3.yD)(o))return!1;if(!a)return!0;for(let e of o)i.removeStoredMark(e);return this.backwardMarkExitTracker.set(i.selection.anchor,!0),a(i),!0}}};function sa({shortcut:e,map:t,options:s,store:r}){return(0,e3.HD)(e)?[so(e,t)]:(0,e3.kJ)(e)?e.map(e=>so(e,t)):sa({shortcut:e=e(s,r),map:t,options:s,store:r})}function so(e,t){return(0,e3.q9)((0,e3.VO)(e4.vO),e)?t[e]:e}tR(ey=tO(eg),1,"arrowRightShortcut",em,si),tR(ey,1,"arrowLeftShortcut",ep,si),tR(ey,1,"backspace",eh,si),tR(ey,1,"getNamedShortcut",ec,si),si=tR(ey,0,"KeymapExtension",ef,si),tT(ey,1,si);var sl={[e4.vO.Copy]:"Mod-c",[e4.vO.Cut]:"Mod-x",[e4.vO.Paste]:"Mod-v",[e4.vO.PastePlain]:"Mod-Shift-v",[e4.vO.SelectAll]:"Mod-a",[e4.vO.Undo]:"Mod-z",[e4.vO.Redo]:e5.NZ.isMac?"Shift-Mod-z":"Mod-y",[e4.vO.Bold]:"Mod-b",[e4.vO.Italic]:"Mod-i",[e4.vO.Underline]:"Mod-u",[e4.vO.Strike]:"Mod-d",[e4.vO.Code]:"Mod-`",[e4.vO.Paragraph]:"Mod-Shift-0",[e4.vO.H1]:"Mod-Shift-1",[e4.vO.H2]:"Mod-Shift-2",[e4.vO.H3]:"Mod-Shift-3",[e4.vO.H4]:"Mod-Shift-4",[e4.vO.H5]:"Mod-Shift-5",[e4.vO.H6]:"Mod-Shift-6",[e4.vO.TaskList]:"Mod-Shift-7",[e4.vO.BulletList]:"Mod-Shift-8",[e4.vO.OrderedList]:"Mod-Shift-9",[e4.vO.Quote]:"Mod->",[e4.vO.Divider]:"Mod-Shift-|",[e4.vO.Codeblock]:"Mod-Shift-~",[e4.vO.ClearFormatting]:"Mod-Shift-C",[e4.vO.Superscript]:"Mod-.",[e4.vO.Subscript]:"Mod-,",[e4.vO.LeftAlignment]:"Mod-Shift-L",[e4.vO.CenterAlignment]:"Mod-Shift-E",[e4.vO.RightAlignment]:"Mod-Shift-R",[e4.vO.JustifyAlignment]:"Mod-Shift-J",[e4.vO.InsertLink]:"Mod-k",[e4.vO.Find]:"Mod-f",[e4.vO.FindBackwards]:"Mod-Shift-f",[e4.vO.FindReplace]:"Mod-Shift-H",[e4.vO.AddFootnote]:"Mod-Alt-f",[e4.vO.AddComment]:"Mod-Alt-m",[e4.vO.ContextMenu]:"Mod-Shift-\\",[e4.vO.IncreaseFontSize]:"Mod-Shift-.",[e4.vO.DecreaseFontSize]:"Mod-Shift-,",[e4.vO.IncreaseIndent]:"Tab",[e4.vO.DecreaseIndent]:"Shift-Tab",[e4.vO.Shortcuts]:"Mod-/",[e4.vO.Format]:e5.NZ.isMac?"Alt-Shift-f":"Shift-Ctrl-f"},sd=tE(tk({},sl),{[e4.vO.Strike]:"Mod-Shift-S",[e4.vO.Code]:"Mod-Shift-M",[e4.vO.Paragraph]:"Mod-Alt-0",[e4.vO.H1]:"Mod-Alt-1",[e4.vO.H2]:"Mod-Alt-2",[e4.vO.H3]:"Mod-Alt-3",[e4.vO.H4]:"Mod-Alt-4",[e4.vO.H5]:"Mod-Alt-5",[e4.vO.H6]:"Mod-Alt-6",[e4.vO.OrderedList]:"Mod-Alt-7",[e4.vO.BulletList]:"Mod-Alt-8",[e4.vO.Quote]:"Mod-Alt-9",[e4.vO.ClearFormatting]:"Mod-\\",[e4.vO.IncreaseIndent]:"Mod-[",[e4.vO.DecreaseIndent]:"Mod-]"}),su={default:sl,googleDoc:sd},sc=class extends tq{get name(){return"nodeViews"}createPlugin(){var e;let t=[],s=(0,e3.Ry)();for(let e of this.store.extensions){if(!e.createNodeViews)continue;let s=e.createNodeViews();t.unshift((0,e3.mf)(s)?{[e.name]:s}:s)}for(let r of(t.unshift(null!=(e=this.store.managerSettings.nodeViews)?e:{}),t))Object.assign(s,r);return{props:{nodeViews:s}}}},sh=class extends tq{get name(){return"pasteRules"}createExternalPlugins(){return[this.generatePasteRulesPlugin()]}generatePasteRulesPlugin(){var e,t;let s=[];for(let r of this.store.extensions){if((null==(e=this.store.managerSettings.exclude)?void 0:e.pasteRules)||!r.createPasteRules||(null==(t=r.options.exclude)?void 0:t.pasteRules))continue;let n=r.createPasteRules(),i=(0,e3.kJ)(n)?n:[n];s.push(...i)}return(0,ta.N)(s)}};ev=[tZ({defaultPriority:e4.xV.Highest,handlerKeys:["applyState","appendTransaction"]})];var sp=class extends(ex=tq){constructor(){super(...arguments),tN(this,"plugins",[]),tN(this,"managerPlugins",[]),tN(this,"applyStateHandlers",[]),tN(this,"initStateHandlers",[]),tN(this,"appendTransactionHandlers",[]),tN(this,"pluginKeys",(0,e3.Ry)()),tN(this,"stateGetters",new Map),tN(this,"getPluginStateCreator",e=>t=>e.getState(null!=t?t:this.store.getState())),tN(this,"getStateByName",e=>{let t=this.stateGetters.get(e);return(0,e3.kG)(t,{message:"No plugin exists for the requested extension name."}),t()})}get name(){return"plugins"}onCreate(){let{setStoreKey:e,setExtensionStore:t,managerSettings:s,extensions:r}=this.store;this.updateExtensionStore();let{plugins:n=[]}=s;for(let e of(this.updatePlugins(n,this.managerPlugins),r))e.onApplyState&&this.applyStateHandlers.push(e.onApplyState.bind(e)),e.onInitState&&this.initStateHandlers.push(e.onInitState.bind(e)),e.onAppendTransaction&&this.appendTransactionHandlers.push(e.onAppendTransaction.bind(e)),this.extractExtensionPlugins(e);this.managerPlugins=n,this.store.setStoreKey("plugins",this.plugins),e("pluginKeys",this.pluginKeys),e("getPluginState",this.getStateByName),t("getPluginState",this.getStateByName)}createPlugin(){return{appendTransaction:(e,t,s)=>{let r=s.tr,n={previousState:t,tr:r,transactions:e,state:s};for(let e of this.appendTransactionHandlers)e(n);return this.options.appendTransaction(n),r.docChanged||r.steps.length>0||r.selectionSet||r.storedMarksSet?r:void 0},state:{init:(e,t)=>{for(let e of this.initStateHandlers)e(t)},apply:(e,t,s,r)=>{let n={previousState:s,state:r,tr:e};for(let e of this.applyStateHandlers)e(n);this.options.applyState(n)}}}}extractExtensionPlugins(e){var t,s;if((e.createPlugin||e.createExternalPlugins)&&(null==(t=this.store.managerSettings.exclude)||!t.plugins)&&(null==(s=e.options.exclude)||!s.plugins)){if(e.createPlugin){let t=new te.H$(e.name);this.pluginKeys[e.name]=t;let s=this.getPluginStateCreator(t);e.pluginKey=t,e.getPluginState=s,this.stateGetters.set(e.name,s),this.stateGetters.set(e.constructor,s);let r=tE(tk({},e.createPlugin()),{key:t}),n=new te.Sy(r);this.updatePlugins([n],e.plugin?[e.plugin]:void 0),e.plugin=n}if(e.createExternalPlugins){let t=e.createExternalPlugins();this.updatePlugins(t,e.externalPlugins),e.externalPlugins=t}}}updatePlugins(e,t){if(!t||(0,e3.yD)(t)){this.plugins=[...this.plugins,...e];return}if(e.length!==t.length){this.plugins=[...this.plugins.filter(e=>!t.includes(e)),...e];return}let s=new Map;for(let[r,n]of e.entries())s.set((0,e3.fp)(t,r),n);this.plugins=this.plugins.map(e=>t.includes(e)?s.get(e):e)}updateExtensionStore(){let{setExtensionStore:e}=this.store;e("updatePlugins",this.updatePlugins.bind(this)),e("dispatchPluginUpdate",this.dispatchPluginUpdate.bind(this)),e("updateExtensionPlugins",this.updateExtensionPlugins.bind(this))}updateExtensionPlugins(e){let t=tz(e)?e:(0,e5.gf)(e)&&(0,e5.pI)(e,[e4.lk.PlainExtensionConstructor,e4.lk.MarkExtensionConstructor,e4.lk.NodeExtensionConstructor])?this.store.manager.getExtension(e):this.store.extensions.find(t=>t.name===e);(0,e3.kG)(t,{code:e4.mA.INVALID_MANAGER_EXTENSION,message:"The extension ".concat(e," does not exist within the editor.")}),this.extractExtensionPlugins(t),this.store.setStoreKey("plugins",this.plugins),this.dispatchPluginUpdate()}dispatchPluginUpdate(){(0,e3.kG)(this.store.phase>=e4.RC.EditorView,{code:e4.mA.MANAGER_PHASE_ERROR,message:"`dispatchPluginUpdate` should only be called after the view has been added to the manager."});let{view:e,updateState:t}=this.store;t(e.state.reconfigure({plugins:this.plugins}))}};sp=tR(eS=tO(ex),0,"PluginsExtension",ev,sp),tT(eS,1,sp),ek=[tZ({defaultPriority:e4.xV.Highest})];var sm=class extends(eb=tq){constructor(){super(...arguments),tN(this,"dynamicAttributes",{marks:(0,e3.Ry)(),nodes:(0,e3.Ry)()})}get name(){return"schema"}onCreate(){var e;let{managerSettings:t,tags:s,markNames:r,nodeNames:n,extensions:i}=this.store,{defaultBlockNode:a,disableExtraAttributes:o,nodeOverride:l,markOverride:d}=t;if(t.schema){let{nodes:e,marks:s}=function(e){let t=(0,e3.Ry)(),s=(0,e3.Ry)();for(let[s,r]of Object.entries(e.nodes))t[s]=r.spec;for(let[t,r]of Object.entries(e.marks))s[t]=r.spec;return{nodes:t,marks:s}}(t.schema);this.addSchema(t.schema,e,s);return}let u=a&&s[e4.eX.Block].includes(a)?{doc:(0,e3.Ry)(),[a]:(0,e3.Ry)()}:(0,e3.Ry)(),c=(0,e3.Ry)(),h=function(e){var t,s;let{settings:r,gatheredSchemaAttributes:n,nodeNames:i,markNames:a,tags:o}=e,l=(0,e3.Ry)();if(r.disableExtraAttributes)return l;let d=[...n,...null!=(t=r.extraAttributes)?t:[]];for(let e of null!=d?d:[])for(let t of function(e){var t;let{identifiers:s,nodeNames:r,markNames:n,tags:i}=e;if("nodes"===s)return r;if("marks"===s)return n;if("all"===s)return[...r,...n];if((0,e3.kJ)(s))return s;(0,e3.kG)((0,e3.PO)(s)&&(0,e3.kJ)(s.tags),{code:e4.mA.EXTENSION_EXTRA_ATTRIBUTES,message:"Invalid value passed as an identifier when creating `extraAttributes`."});let{tags:a=[],names:o=[],behavior:l="any",excludeNames:d,excludeTags:u,type:c}=s,h=new Set,p="mark"===c?n:"node"===c?r:[...n,...r],m=e=>p.includes(e)&&!(null==d?void 0:d.includes(e));for(let e of o)m(e)&&h.add(e);let g=new Map;for(let e of a)if(null==u||!u.includes(e))for(let s of i[e]){if(!m(s))continue;if("any"===l){h.add(s);continue}let r=null!=(t=g.get(s))?t:new Set;r.add(e),g.set(s,r)}for(let[e,t]of g)t.size===a.length&&h.add(e);return[...h]}({identifiers:e.identifiers,nodeNames:i,markNames:a,tags:o})){let r=null!=(s=l[t])?s:{};l[t]=tk(tk({},r),e.attributes)}return l}({settings:t,gatheredSchemaAttributes:this.gatherExtraAttributes(i),nodeNames:n,markNames:r,tags:s});for(let t of i){h[t.name]=tk(tk({},h[t.name]),t.options.extraAttributes);let s=!0===o||!0===t.options.disableExtraAttributes||!0===t.constructor.disableExtraAttributes;if(t$(t)){let{spec:e,dynamic:r}=sg({createExtensionSpec:(e,s)=>t.createNodeSpec(e,s),extraAttributes:(0,e3.fp)(h,t.name),override:tk(tk({},l),t.options.nodeOverride),ignoreExtraAttributes:s,name:t.constructorName,tags:t.tags});t.spec=e,u[t.name]=e,Object.keys(r).length>0&&(this.dynamicAttributes.nodes[t.name]=r)}if(tY(t)){let{spec:r,dynamic:n}=sg({createExtensionSpec:(e,s)=>t.createMarkSpec(e,s),extraAttributes:(0,e3.fp)(h,t.name),override:tk(tk({},d),t.options.markOverride),ignoreExtraAttributes:s,name:t.constructorName,tags:null!=(e=t.tags)?e:[]});t.spec=r,c[t.name]=r,Object.keys(n).length>0&&(this.dynamicAttributes.marks[t.name]=n)}}let p=new e8.V_({nodes:u,marks:c,topNode:"doc"});this.addSchema(p,u,c)}createPlugin(){return{appendTransaction:(e,t,s)=>{let{tr:r}=s;return e.some(e=>e.docChanged)&&(0!==Object.keys(this.dynamicAttributes.nodes).length||0!==Object.keys(this.dynamicAttributes.marks).length)?(r.doc.descendants((e,t)=>(this.checkAndUpdateDynamicNodes(e,t,r),this.checkAndUpdateDynamicMarks(e,t,r),!0)),r.steps.length>0?r:null):null}}}addSchema(e,t,s){for(let r of(this.store.setStoreKey("nodes",t),this.store.setStoreKey("marks",s),this.store.setStoreKey("schema",e),this.store.setExtensionStore("schema",e),this.store.setStoreKey("defaultBlockNode",(0,e5.JN)(e).name),Object.values(e.nodes)))if("doc"!==r.name&&(r.isBlock||r.isTextblock))break}checkAndUpdateDynamicNodes(e,t,s){for(let[r,n]of(0,e3.qh)(this.dynamicAttributes.nodes))if(e.type.name===r)for(let[r,i]of(0,e3.qh)(n)){if(!(0,e3.le)(e.attrs[r]))continue;let n=tE(tk({},e.attrs),{[r]:i(e)});s.setNodeMarkup(t,void 0,n),(0,to.gn)(s)}}checkAndUpdateDynamicMarks(e,t,s){for(let[r,n]of(0,e3.qh)(this.dynamicAttributes.marks)){let i=(0,e3.fp)(this.store.schema.marks,r),a=e.marks.find(e=>e.type.name===r);if(a)for(let[e,r]of(0,e3.qh)(n)){if(!(0,e3.le)(a.attrs[e]))continue;let n=(0,e5.IH)(s.doc.resolve(t),i);if(!n)continue;let{from:o,to:l}=n,d=i.create(tE(tk({},a.attrs),{[e]:r(a)}));s.removeMark(o,l,i).addMark(o,l,d),(0,to.gn)(s)}}}gatherExtraAttributes(e){let t=[];for(let s of e)s.createSchemaAttributes&&t.push(...s.createSchemaAttributes());return t}};function sg(e){var t,s,r,n;let{createExtensionSpec:i,extraAttributes:a,ignoreExtraAttributes:o,name:l,tags:d,override:u}=e,c=(0,e3.Ry)(),h=!1,p=i({defaults:(r=function(){h=!0},n=function(e,t){c[e]=t},()=>{r();let e=(0,e3.Ry)();if(o)return e;for(let[t,s]of(0,e3.qh)(a)){let r=sf(s).default;(0,e3.mf)(r)&&(n(t,r),r=null),e[t]=void 0===r?{}:{default:r}}return e}),parse:e=>{var t,s,r;let n=(0,e3.Ry)();if(o)return n;for(let[i,o]of(0,e3.qh)(a)){let a=sf(o),{parseDOM:l}=a,d=tM(a,["parseDOM"]);if((0,e5.jd)(e)){if((0,e3.le)(l)){n[i]=null!=(t=e.getAttribute(i))?t:d.default;continue}if((0,e3.mf)(l)){n[i]=null!=(s=l(e))?s:d.default;continue}n[i]=null!=(r=e.getAttribute(l))?r:d.default}}return n},dom:e=>{let t=(0,e3.Ry)();if(o)return t;function s(s,r){if(s){if((0,e3.HD)(s)){t[r]=s;return}if((0,e3.kJ)(s)){let[n,i]=s;t[n]=null!=i?i:e.attrs[r];return}for(let[e,r]of(0,e3.qh)(s))t[e]=r}}for(let[r,n]of(0,e3.qh)(a)){let{toDOM:i,parseDOM:a}=sf(n);if((0,e3.le)(i)){t[(0,e3.HD)(a)?a:r]=e.attrs[r];continue}if((0,e3.mf)(i)){s(i(e.attrs,(0,e5.PH)(e)?{node:e}:(0,e5.K_)(e)?{mark:e}:{}),r);continue}s(i,r)}return t}},u);return(0,e3.kG)(o||h,{code:e4.mA.EXTENSION_SPEC,message:"When creating a node specification you must call the 'defaults', and parse, and 'dom' methods. To avoid this error you can set the static property 'disableExtraAttributes' of '".concat(l,"' to 'true'.")}),p.group=[...null!=(s=null==(t=p.group)?void 0:t.split(" "))?s:[],...d].join(" ")||void 0,{spec:p,dynamic:c}}function sf(e){return(0,e3.HD)(e)||(0,e3.mf)(e)?{default:e}:((0,e3.kG)(e,{message:"".concat((0,e3.BB)(e)," is not supported"),code:e4.mA.EXTENSION_EXTRA_ATTRIBUTES}),e)}sm=tR(eE=tO(eb),0,"SchemaExtension",ek,sm),tT(eE,1,sm),eP=[tZ({customHandlerKeys:["suggester"]})];var sy=class extends(eA=tq,ew=[t1()],eO=[t1()],eM=[t1()],eA){constructor(){super(...arguments),tT(eC,5,this),tN(this,"onAddCustomHandler",({suggester:e})=>{var t;if(e&&(null==(t=this.store.managerSettings.exclude)||!t.suggesters))return(0,to.Ek)(this.store.getState(),e)})}get name(){return"suggest"}onCreate(){this.store.setExtensionStore("addSuggester",e=>(0,to.Ek)(this.store.getState(),e)),this.store.setExtensionStore("removeSuggester",e=>(0,to.C$)(this.store.getState(),e))}createExternalPlugins(){var e,t;let s=[];for(let r of this.store.extensions){if(null==(e=this.store.managerSettings.exclude)?void 0:e.suggesters)break;if(!r.createSuggesters||(null==(t=r.options.exclude)?void 0:t.suggesters))continue;let n=r.createSuggesters(),i=(0,e3.kJ)(n)?n:[n];s.push(...i)}return[(0,to.D7)(...s)]}getSuggestState(e){return(0,to.hu)(null!=e?e:this.store.getState())}getSuggestMethods(){let{addIgnored:e,clearIgnored:t,removeIgnored:s,ignoreNextExit:r,setMarkRemoved:n,findMatchAtPosition:i,findNextTextSelection:a,setLastChangeFromAppend:o}=this.getSuggestState();return{addIgnored:e,clearIgnored:t,removeIgnored:s,ignoreNextExit:r,setMarkRemoved:n,findMatchAtPosition:i,findNextTextSelection:a,setLastChangeFromAppend:o}}isSuggesterActive(e){var t;return(0,e3.q9)((0,e3.kJ)(e)?e:[e],null==(t=this.getSuggestState().match)?void 0:t.suggester.name)}};tR(eC=tO(eA),1,"getSuggestState",ew,sy),tR(eC,1,"getSuggestMethods",eO,sy),tR(eC,1,"isSuggesterActive",eM,sy),sy=tR(eC,0,"SuggestExtension",eP,sy),tT(eC,1,sy),eT=[tZ({defaultPriority:e4.xV.Highest})];var sv=class extends(eN=tq){constructor(){super(...arguments),tN(this,"allTags",(0,e3.Ry)()),tN(this,"plainTags",(0,e3.Ry)()),tN(this,"markTags",(0,e3.Ry)()),tN(this,"nodeTags",(0,e3.Ry)())}get name(){return"tags"}onCreate(){for(let e of(this.resetTags(),this.store.extensions))this.updateTagForExtension(e);this.store.setStoreKey("tags",this.allTags),this.store.setExtensionStore("tags",this.allTags),this.store.setStoreKey("plainTags",this.plainTags),this.store.setExtensionStore("plainTags",this.plainTags),this.store.setStoreKey("markTags",this.markTags),this.store.setExtensionStore("markTags",this.markTags),this.store.setStoreKey("nodeTags",this.nodeTags),this.store.setExtensionStore("nodeTags",this.nodeTags)}resetTags(){let e=(0,e3.Ry)(),t=(0,e3.Ry)(),s=(0,e3.Ry)(),r=(0,e3.Ry)();for(let n of(0,e3.VO)(e4.eX))e[n]=[],t[n]=[],s[n]=[],r[n]=[];this.allTags=e,this.plainTags=t,this.markTags=s,this.nodeTags=r}updateTagForExtension(e){var t,s,r,n,i,a;let o=new Set([...null!=(t=e.tags)?t:[],...null!=(r=null==(s=e.createTags)?void 0:s.call(e))?r:[],...null!=(n=e.options.extraTags)?n:[],...null!=(a=null==(i=this.store.managerSettings.extraTags)?void 0:i[e.name])?a:[]]);for(let t of o)(0,e3.kG)((0,e3.q9)((0,e3.VO)(e4.eX),t),{code:e4.mA.EXTENSION,message:"The tag provided by the extension: ".concat(e.constructorName," is not supported by the editor. To add custom tags you can use the 'mutateTag' method.")}),this.allTags[t].push(e.name),tQ(e)&&this.plainTags[t].push(e.name),tY(e)&&this.markTags[t].push(e.name),t$(e)&&this.nodeTags[t].push(e.name);e.tags=[...o]}};sv=tR(eR=tO(eN),0,"TagsExtension",eT,sv),tT(eR,1,sv);var sS=new te.H$("remirrorFilePlaceholderPlugin"),sx=class extends tq{get name(){return"upload"}createExternalPlugins(){return[function(){let e=new te.Sy({key:sS,state:{init:()=>({set:tr.EH.empty,payloads:new Map}),apply(t,{set:s,payloads:r}){s=s.map(t.mapping,t.doc);let n=t.getMeta(e);if(n){if(0===n.type){let e=document.createElement("placeholder"),i=tr.p.widget(n.pos,e,{id:n.id});s=s.add(t.doc,[i]),r.set(n.id,n.payload)}else 1===n.type&&(s=s.remove(s.find(void 0,void 0,e=>e.id===n.id)),r.delete(n.id))}return{set:s,payloads:r}}},props:{decorations(t){var s,r;return null!=(r=null==(s=e.getState(t))?void 0:s.set)?r:null}}});return e}()]}};eH=[tZ({defaultOptions:{capture:e5.NZ.isDevelopment},staticKeys:["capture"],defaultPriority:e4.xV.Highest})];var sk=class extends(eK=tq){get name(){return"meta"}onCreate(){if(this.store.setStoreKey("getCommandMeta",this.getCommandMeta.bind(this)),this.options.capture)for(let e of this.store.extensions)this.captureCommands(e),this.captureKeybindings(e)}createPlugin(){return{}}captureCommands(e){var t;let s=null!=(t=e.decoratedCommands)?t:{},r=e.createCommands;for(let t of Object.keys(s)){let s=e[t];e[t]=(...r)=>n=>{var i;let a=s(...r)(n);return n.dispatch&&a&&this.setCommandMeta(n.tr,{type:"command",chain:n.dispatch!==(null==(i=n.view)?void 0:i.dispatch),name:t,extension:e.name,decorated:!0}),a}}r&&(e.createCommands=()=>{let t=r();for(let[s,r]of Object.entries(t))t[s]=(...t)=>n=>{var i;let a=r(...t)(n);return n.dispatch&&a&&this.setCommandMeta(n.tr,{type:"command",chain:n.dispatch!==(null==(i=n.view)?void 0:i.dispatch),name:s,extension:e.name,decorated:!1}),a};return t})}captureKeybindings(e){}getCommandMeta(e){var t;return null!=(t=e.getMeta(this.pluginKey))?t:[]}setCommandMeta(e,t){let s=this.getCommandMeta(e);e.setMeta(this.pluginKey,[...s,t])}};sk=tR(e_=tO(eK),0,"MetaExtension",eH,sk),tT(e_,1,sk);var sE=class{constructor(e){tD(this,eD,(0,e3.EL)()),tD(this,eI),tD(this,eL),tN(this,"previousStateOverride"),tD(this,eV,!0),tD(this,eB,(0,tl.i)()),tD(this,eF),tD(this,eU),tN(this,"getState",()=>{var e;return null!=(e=this.view.state)?e:this.initialEditorState}),tN(this,"getPreviousState",()=>this.previousState),tN(this,"dispatchTransaction",e=>{var t,s,r;(0,e3.kG)(!this.manager.destroyed,{code:e4.mA.MANAGER_PHASE_ERROR,message:"A transaction was dispatched to a manager that has already been destroyed. Please check your set up, or open an issue."}),e=null!=(r=null==(s=(t=this.props).onDispatchTransaction)?void 0:s.call(t,e,this.getState()))?r:e;let n=this.getState(),{state:i,transactions:a}=n.applyTransaction(e);tI(this,eL,n),this.updateState({state:i,tr:e,transactions:a});let o=this.manager.store.getForcedUpdates(e);(0,e3.yD)(o)||this.updateViewProps(...o)}),tN(this,"onChange",(e=(0,e3.Ry)())=>{var t,s;let r=this.eventListenerProps(e);tK(this,eV)&&tI(this,eV,!1),null==(s=(t=this.props).onChange)||s.call(t,r)}),tN(this,"onBlur",e=>{var t,s;let r=this.eventListenerProps();null==(s=(t=this.props).onBlur)||s.call(t,r,e),tK(this,eB).emit("blur",r,e)}),tN(this,"onFocus",e=>{var t,s;let r=this.eventListenerProps();null==(s=(t=this.props).onFocus)||s.call(t,r,e),tK(this,eB).emit("focus",r,e)}),tN(this,"setContent",(e,{triggerChange:t=!1}={})=>{let{doc:s}=this.manager.createState({content:e}),r=this.getState(),{state:n}=this.getState().applyTransaction(r.tr.replaceRangeWith(0,r.doc.nodeSize-2,s));if(t)return this.updateState({state:n,triggerChange:t});this.view.updateState(n)}),tN(this,"clearContent",({triggerChange:e=!1}={})=>{this.setContent(this.manager.createEmptyDoc(),{triggerChange:e})}),tN(this,"createStateFromContent",(e,t)=>this.manager.createState({content:e,selection:t})),tN(this,"focus",e=>{this.manager.store.commands.focus(e)}),tN(this,"blur",e=>{this.manager.store.commands.blur(e)});let{getProps:t,initialEditorState:s,element:r}=e;if(tI(this,eI,t),tI(this,eU,s),this.manager.attachFramework(this,this.updateListener.bind(this)),this.manager.view)return;let n=this.createView(s,r);this.manager.addView(n)}get addHandler(){var e;return null!=(e=tK(this,eF))?e:tI(this,eF,tK(this,eB).on.bind(tK(this,eB)))}get updatableViewProps(){return{attributes:()=>this.getAttributes(),editable:()=>{var e;return null==(e=this.props.editable)||e}}}get firstRender(){return tK(this,eV)}get props(){return tK(this,eI).call(this)}get previousState(){var e,t;return null!=(t=null!=(e=this.previousStateOverride)?e:tK(this,eL))?t:this.initialEditorState}get manager(){return this.props.manager}get view(){return this.manager.view}get uid(){return tK(this,eD)}get initialEditorState(){return tK(this,eU)}updateListener(e){let{state:t,tr:s}=e;return tK(this,eB).emit("updated",this.eventListenerProps({state:t,tr:s}))}update(e){let{getProps:t}=e;return tI(this,eI,t),this}updateViewProps(...e){let t=e6(this.updatableViewProps,e);this.view.setProps(tk(tk({},this.view.props),t))}getAttributes(e){var t;let{attributes:s,autoFocus:r,classNames:n=[],label:i,editable:a}=this.props,o=null==(t=this.manager.store)?void 0:t.attributes,l=(0,e3.mf)(s)?s(this.eventListenerProps()):s,d={};(r||(0,e3.hj)(r))&&(d=e?{autoFocus:!0}:{autofocus:"true"});let u=(0,e3.Nb)((0,e3.cx)(e&&"Prosemirror","remirror-editor",null==o?void 0:o.class,...n).split(" ")).join(" "),c=tE(tk(tE(tk(tE(tk({role:"textbox"},d),{"aria-multiline":"true"}),null==a||a?{}:{"aria-readonly":"true"}),{"aria-label":null!=i?i:""}),o),{class:u});return(0,e3.Yc)(tk(tk({},c),l))}addFocusListeners(){this.view.dom.addEventListener("blur",this.onBlur),this.view.dom.addEventListener("focus",this.onFocus)}removeFocusListeners(){this.view.dom.removeEventListener("blur",this.onBlur),this.view.dom.removeEventListener("focus",this.onFocus)}destroy(){tK(this,eB).emit("destroy"),this.view&&this.removeFocusListeners()}eventListenerProps(e=(0,e3.Ry)()){let{state:t,tr:s,transactions:r}=e;return{tr:s,transactions:r,internalUpdate:!s,view:this.view,firstRender:tK(this,eV),state:null!=t?t:this.getState(),createStateFromContent:this.createStateFromContent,previousState:this.previousState,helpers:this.manager.store.helpers}}get baseOutput(){return tE(tk({manager:this.manager},this.manager.store),{addHandler:this.addHandler,focus:this.focus,blur:this.blur,uid:tK(this,eD),view:this.view,getState:this.getState,getPreviousState:this.getPreviousState,getExtension:this.manager.getExtension.bind(this.manager),hasExtension:this.manager.hasExtension.bind(this.manager),clearContent:this.clearContent,setContent:this.setContent})}};eD=new WeakMap,eI=new WeakMap,eL=new WeakMap,eV=new WeakMap,eB=new WeakMap,eF=new WeakMap,eU=new WeakMap;var sb=class e{constructor(e,t={}){tD(this,eW),tD(this,eG,(0,e3.Ry)()),tD(this,ej,(0,e3.Ry)()),tD(this,eq),tD(this,eX),tD(this,eJ,e4.RC.None),tD(this,ez),tD(this,eQ,!0),tD(this,e$,{create:[],view:[],update:[],destroy:[]}),tD(this,eY,[]),tD(this,eZ,(0,tl.i)()),tD(this,e0),tD(this,e1),tN(this,"getState",()=>{var e;return tK(this,eJ)>=e4.RC.EditorView?this.view.state:((0,e3.kG)(tK(this,e0),{code:e4.mA.MANAGER_PHASE_ERROR,message:"`getState` can only be called after the `Framework` or the `EditorView` has been added to the manager`. Check your plugins to make sure that the decorations callback uses the state argument."}),null==(e=tK(this,e0))?void 0:e.initialEditorState)}),tN(this,"updateState",e=>{let t=this.getState();this.view.updateState(e),this.onStateUpdate({previousState:t,state:e})});let{extensions:s,extensionMap:r}=function(e,t){let s=[],r=new WeakMap,n=new WeakMap,i=[],a={duplicateMap:n,parentExtensions:[],gatheredExtensions:i,settings:t};for(let t of e)!function e(t,s){var r;let{gatheredExtensions:n,duplicateMap:i,parentExtensions:a,settings:o}=t,{extension:l,parentExtension:d}=s,{names:u=[]}=s;(0,e3.kG)(tz(l),{code:e4.mA.INVALID_MANAGER_EXTENSION,message:"An invalid extension: ".concat(l," was provided to the [[`RemirrorManager`]].")});let c=l.extensions;if(l.setPriority(null==(r=o.priority)?void 0:r[l.name]),n.push(l),function(e){let{duplicateMap:t,extension:s,parentExtension:r}=e,n=s.constructor,i=t.get(n),a=r?[r]:[];t.set(n,i?[...i,...a]:a)}({duplicateMap:i,extension:l,parentExtension:d}),0!==c.length){if(u.includes(l.name)){(0,td.Z)(!1,"Circular dependency encountered when loading extensions: ".concat(u.join(" > ")," > ").concat(l.name));return}for(let s of(u=[...u,l.name],a.push(l),c))e(t,{names:u,extension:s,parentExtension:l})}}(a,{extension:t});i=(0,e3.DY)(i,(e,t)=>t.priority-e.priority);let o=new WeakSet,l=new Set;for(let e of i){let t=e.constructor,i=e.name,a=n.get(t);(0,e3.kG)(a,{message:"No entries were found for the ExtensionConstructor ".concat(e.name),code:e4.mA.INTERNAL}),o.has(t)||l.has(i)||(o.add(t),l.add(i),s.push(e),r.set(t,e),a.forEach(s=>null==s?void 0:s.replaceChildExtension(t,e)))}let d=[];for(let e of s)!function(e){var t;let{extension:s,found:r,missing:n}=e;if(s.requiredExtensions)for(let e of null!=(t=s.requiredExtensions)?t:[])r.has(e)||n.push({Constructor:e,extension:s})}({extension:e,found:o,missing:d});return(0,e3.kG)((0,e3.yD)(d),{code:e4.mA.MISSING_REQUIRED_EXTENSION,message:d.map(({Constructor:e,extension:t})=>"The extension '".concat(t.name,"' requires '").concat(e.name," in order to run correctly.")).join("\n")}),{extensions:s,extensionMap:r}}(e,t);for(let e of(tI(this,ez,t),tI(this,eq,(0,e3.vV)(s)),tI(this,eX,r),tI(this,eW,this.createExtensionStore()),tI(this,eJ,e4.RC.Create),this.setupLifecycleHandlers(),tK(this,e$).create)){let t=e();t&&tK(this,eY).push(t)}}static create(t,s={}){return new e([...(0,e3.r2)(t),...function(e={}){let t=e6(e=tk(tk({},{exitMarksOnArrowPress:si.defaultOptions.exitMarksOnArrowPress,excludeBaseKeymap:si.defaultOptions.excludeBaseKeymap,selectParentNodeOnEscape:si.defaultOptions.selectParentNodeOnEscape,undoInputRuleOnBackspace:si.defaultOptions.undoInputRuleOnBackspace,persistentSelectionClass:t7.defaultOptions.persistentSelectionClass}),e),["excludeBaseKeymap","selectParentNodeOnEscape","undoInputRuleOnBackspace"]),s=e6(e,["persistentSelectionClass"]);return[new sv,new sm,new t0,new sp,new sn,new sh,new sc,new sy,new t5,new sr,new si(t),new ss,new sx,new t7(s)]}(s.builtin)],s)}get[e4.By](){return e4.lk.Manager}get destroyed(){return tK(this,eJ)===e4.RC.Destroy}get mounted(){return tK(this,eJ)>=e4.RC.EditorView&&tK(this,eJ)<e4.RC.Destroy}get output(){var e;return null==(e=tK(this,e0))?void 0:e.frameworkOutput}get frameworkAttached(){return!!tK(this,e0)}get extensions(){return tK(this,eq)}get stringHandlers(){return tK(this,eG)}get store(){return(0,e3.vV)(tK(this,ej))}get extensionStore(){return(0,e3.vV)(tK(this,eW))}get tr(){return this.getExtension(t5).transaction}get nodes(){return tK(this,ej).nodes}get marks(){return tK(this,ej).marks}get schema(){return tK(this,ej).schema}get extensionTags(){return tK(this,ej).tags}get view(){return tK(this,ej).view}get settings(){return tK(this,ez)}get document(){var e;return null!=(e=tK(this,ez).document)?e:(0,e5.Me)()}setupLifecycleHandlers(){let e=tK(this,eW),t=tK(this,e$),s=[],r=[],n=[];for(let i of(e.nodeNames=s,e.markNames=r,e.plainNames=n,tK(this,eq)))!function(e){var t,s,r,n;let{extension:i,nodeNames:a,markNames:o,plainNames:l,store:d,handlers:u}=e;i.setStore(d);let c=null==(t=i.onCreate)?void 0:t.bind(i),h=null==(s=i.onView)?void 0:s.bind(i),p=null==(r=i.onStateUpdate)?void 0:r.bind(i),m=null==(n=i.onDestroy)?void 0:n.bind(i);c&&u.create.push(c),h&&u.view.push(h),p&&u.update.push(p),m&&u.destroy.push(m),tY(i)&&o.push(i.name),t$(i)&&"doc"!==i.name&&a.push(i.name),tQ(i)&&l.push(i.name)}({extension:i,nodeNames:s,markNames:r,plainNames:n,handlers:t,store:e})}setStringHandler(e,t){tK(this,eG)[e]=t}setStoreKey(e,t){tK(this,ej)[e]=t}getStoreKey(e){let t=tK(this,ej)[e];return(0,e3.kG)(!(0,e3.le)(t),{code:e4.mA.MANAGER_PHASE_ERROR,message:"`getStoreKey` should not be called before the values are available."}),t}setExtensionStore(e,t){(0,e3.kG)(tK(this,eJ)<=e4.RC.EditorView,{code:e4.mA.MANAGER_PHASE_ERROR,message:"`setExtensionStore` should only be called during the `onCreate` lifecycle hook. Make sure to only call it within the returned methods."}),tK(this,eW)[e]=t}createExtensionStore(){let e,t;let s=(0,e3.Ry)();return Object.defineProperties(s,{extensions:{get:()=>tK(this,eq),enumerable:!0},phase:{get:()=>tK(this,eJ),enumerable:!0},view:{get:()=>this.view,enumerable:!0},managerSettings:{get:()=>(0,e3.vV)(tK(this,ez)),enumerable:!0},getState:{value:this.getState,enumerable:!0},updateState:{value:this.updateState,enumerable:!0},isMounted:{value:()=>this.mounted,enumerable:!0},getExtension:{value:this.getExtension.bind(this),enumerable:!0},manager:{get:()=>this,enumerable:!0},document:{get:()=>this.document,enumerable:!0},stringHandlers:{get:()=>tK(this,eG),enumerable:!0},currentState:{get:()=>null!=e?e:e=this.getState(),set:t=>{e=t},enumerable:!0},previousState:{get:()=>t,set:e=>{t=e},enumerable:!0}}),s.getStoreKey=this.getStoreKey.bind(this),s.setStoreKey=this.setStoreKey.bind(this),s.setExtensionStore=this.setExtensionStore.bind(this),s.setStringHandler=this.setStringHandler.bind(this),s}addView(e){if(tK(this,eJ)>=e4.RC.EditorView)return this;for(let t of(tI(this,eQ,!0),tI(this,eJ,e4.RC.EditorView),tK(this,ej).view=e,tK(this,e$).view)){let s=t(e);s&&tK(this,eY).push(s)}return this}attachFramework(e,t){var s;tK(this,e0)!==e&&(tK(this,e0)&&(tK(this,e0).destroy(),null==(s=tK(this,e1))||s.call(this)),tI(this,e0,e),tI(this,e1,this.addHandler("stateUpdate",t)))}createEmptyDoc(){var e;let t=null==(e=this.schema.nodes.doc)?void 0:e.createAndFill();return(0,e3.kG)(t,{code:e4.mA.INVALID_CONTENT,message:"An empty node could not be created due to an invalid schema."}),t}createState(e={}){let{onError:t,defaultSelection:s="end"}=this.settings,{content:r=this.createEmptyDoc(),selection:n=s,stringHandler:i=this.settings.stringHandler}=e,{schema:a,plugins:o}=this.store,l=(0,e5.EP)({stringHandler:(0,e3.HD)(i)?this.stringHandlers[i]:i,document:this.document,content:r,onError:t,schema:a,selection:n});return te.yy.create({schema:a,doc:l,plugins:o,selection:(0,e5.b0)(n,l)})}addHandler(e,t){return tK(this,eZ).on(e,t)}onStateUpdate(e){let t=tK(this,eQ);tK(this,eW).currentState=e.state,tK(this,eW).previousState=e.previousState,t&&(tI(this,eJ,e4.RC.Runtime),tI(this,eQ,!1));let s=tE(tk({},e),{firstUpdate:t});for(let e of tK(this,e$).update)e(s);tK(this,eZ).emit("stateUpdate",s)}getExtension(e){let t=tK(this,eX).get(e);return(0,e3.kG)(t,{code:e4.mA.INVALID_MANAGER_EXTENSION,message:"'".concat(e.name,"' doesn't exist within this manager. Make sure it is properly added before attempting to use it.")}),t}hasExtension(e){return!!tK(this,eX).get(e)}clone(){let t=tK(this,eq).map(e=>e.clone(e.options)),s=e.create(()=>t,tK(this,ez));return tK(this,eZ).emit("clone",s),s}recreate(t=[],s={}){let r=tK(this,eq).map(e=>e.clone(e.initialOptions)),n=e.create(()=>[...r,...t],s);return tK(this,eZ).emit("recreate",n),n}destroy(){var e,t,s,r,n,i,a;for(let n of(tI(this,eJ,e4.RC.Destroy),null!=(t=null==(e=this.view)?void 0:e.state.plugins)?t:[]))null==(r=null==(s=n.getState(this.view.state))?void 0:s.destroy)||r.call(s);for(let e of(null==(n=tK(this,e0))||n.destroy(),null==(i=tK(this,e1))||i.call(this),tK(this,eY)))e();for(let e of tK(this,e$).destroy)e();null==(a=this.view)||a.destroy(),tK(this,eZ).emit("destroy")}includes(e){let t=[],s=[];for(let e of tK(this,eq))t.push(e.name,e.constructorName),s.push(e.constructor);return e.every(e=>(0,e3.HD)(e)?(0,e3.q9)(t,e):(0,e3.q9)(s,e))}};eW=new WeakMap,eG=new WeakMap,ej=new WeakMap,eq=new WeakMap,eX=new WeakMap,eJ=new WeakMap,ez=new WeakMap,eQ=new WeakMap,e$=new WeakMap,eY=new WeakMap,eZ=new WeakMap,e0=new WeakMap,e1=new WeakMap;var sM=sb;function sO(e,t){return!!((0,e5.gf)(e)&&(0,e5.pI)(e,e4.lk.Manager))&&(!t||e.includes(t))}}}]);
//# sourceMappingURL=829ab817.6885941b20b2aba9.js.map