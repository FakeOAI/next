"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2350],{7937:function(e,t,n){function r(e){return null!=e}n.d(t,{BB:function(){return c},He:function(){return d},OP:function(){return h},PO:function(){return o},WU:function(){return p},aS:function(){return u},lm:function(){return r},qo:function(){return a},r3:function(){return i},sw:function(){return f}});let i=(e,t)=>e.includes(t),a=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null==e)return n;let r=Array.isArray(e)?e:[e];return t?r.map(t):r},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return n=>a(n,e,t)},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return"object"!=typeof e||null==e||Array.isArray(e)?t:e},l=(e,t)=>{let n=s(e),r={};for(let e in t)r[e]=t[e](n?.[e]);return r},u=e=>t=>l(t,e),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"object"==typeof e||null==e?t:String(e)},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("object"==typeof e||null==e)return t;let n=Number(e);return isNaN(n)?t:n},f=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("boolean"==typeof e)return e;if("number"==typeof e){if(0===e)return!1;if(1===e)return!0}if("string"==typeof e){let t=e.toLowerCase();if("false"===t)return!1;if("true"===t)return!0}return t},p=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t[0];return i(t,e)?e:n},h=e=>t=>void 0===t?void 0:e(t)},57098:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(84760),i=n(82363),a=n(651);function o(e){let{url:t,size:n=16,minSize:r,fallback:o,className:u}=e,c=function(e,t){if(!e)return null;try{let{origin:n}=new URL(e);return`https://www.google.com/s2/favicons?domain=${n}&sz=${t}`}catch(e){return i.U.addError(e),null}}(t,n);return null==c?o??null:null!=r?(0,a.jsx)(s,{faviconUrl:c,size:n,minSize:r,fallback:o,className:u}):(0,a.jsx)(l,{faviconUrl:c,size:n,className:u})}function s(e){let{faviconUrl:t,size:n,minSize:i,fallback:o,className:s}=e,{data:u,isLoading:c}=(0,r.a)({queryKey:["imageSize",t],queryFn:()=>new Promise((e,n)=>{let r=new Image;r.onload=()=>{e(Math.min(r.width,r.height))},r.onerror=()=>{n()},r.src=t})});return c?(0,a.jsx)("div",{className:s}):null==u||u<i?o??null:(0,a.jsx)(l,{faviconUrl:t,size:n,className:s})}function l(e){let{faviconUrl:t,size:n,className:r}=e;return(0,a.jsx)("img",{src:t,alt:"Favicon",width:n,height:n,className:r})}},22594:function(e,t,n){n.d(t,{D:function(){return x},Z:function(){return m}});var r=n(21389),i=n(88600),a=n(89678),o=n.n(a),s=n(92379),l=n(49764),u=n(75325),c=n(15478),d=n(11550),f=n(6440),p=n(82164),h=n(24434),g=n(651);function m(e){let{tagOptions:t,onSubmit:n,onMoreClicked:a,onCancel:c,maxInlineTags:m=5,modalOnly:y=!1,modalTitle:b,multiple:v,children:w,allowEmptySubmit:_=!1}=e,C=(0,l.Z)(),{0:j,1:M}=(0,s.useState)(y?"modal":"inline"),{0:O,1:T}=(0,s.useState)([]),{0:k,1:N}=(0,s.useState)(void 0),P=(0,s.useCallback)(e=>{n(e),M("submitted"),setTimeout(()=>{M("closed")},1500)},[n]),E=(0,s.useMemo)(()=>o()(P,500),[P]),U=e=>{let t=[];return T(t=v?O.includes(e)?O.filter(t=>t!==e):[...O,e]:[e]),t},F=()=>{P({tags:O,textFeedback:k,tagChoices:S,source:"modal"})},S=t.map(e=>e.value),A=function(e){let t={};return e.forEach(e=>{let n=e.group??"Default";t[n]||(t[n]=[]),t[n].push(e)}),t}(t),D=Object.keys(A);return(0,g.jsxs)(g.Fragment,{children:[!y&&(0,g.jsx)(r.M,{children:"closed"!==j&&(0,g.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"min-h-[96px] w-full",children:["submitted"===j&&(0,g.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"text-center",children:(0,g.jsx)("div",{className:"inline-flex rounded-lg border border-token-border-light p-4",children:(0,g.jsx)("div",{className:"text-sm",children:(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.submitted",defaultMessage:"Thanks for your feedback!"})})})}),["inline","modal"].includes(j)&&(0,g.jsxs)("div",{className:"relative mt-2 flex w-full flex-col gap-3 rounded-lg border border-token-border-light p-4",children:[(0,g.jsx)("button",{className:"absolute right-4 top-4 text-sm font-bold",onClick:()=>{M("closed"),E.cancel(),c?.()},children:(0,g.jsx)(p.tPq,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})}),(0,g.jsx)("div",{className:"text-sm text-token-text-secondary",children:(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.inlineTitle",defaultMessage:"Tell us more:"})}),(0,g.jsxs)("div",{className:"flex flex-wrap gap-3",children:[t.slice(0,m).map(e=>(0,g.jsx)(x,{$selected:O.includes(e.value),onClick:()=>{E({tags:U(e.value),tagChoices:S,source:"inline"})},children:e.label},e.value)),(0,g.jsx)(x,{onClick:()=>{a?.(),E.cancel(),M("modal")},children:(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.moreOptions.1",defaultMessage:"More..."})})]})]})]},"main")}),"modal"===j&&(0,g.jsxs)(h.Z,{type:"success",isOpen:!0,className:"max-w-xl",size:"custom",title:b??(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.modalTitle",defaultMessage:"Provide additional feedback"}),onClose:()=>{T([]),M(y?"closed":"inline"),y&&c?.()},showCloseButton:!0,primaryButton:(0,g.jsx)(d.z,{color:"primary",disabled:0===O.length&&!k&&!_,onClick:F,children:(0,g.jsx)(u.Z,{id:"ConversationTurnInlineMessageFeedback.submit",defaultMessage:"Submit"})}),rootClassName:"z-50",children:[(0,g.jsx)("div",{className:"flex flex-col gap-6",children:D.map(e=>(0,g.jsxs)("div",{children:[D.length>1&&(0,g.jsx)("div",{className:"mb-3 text-sm font-semibold",children:e}),(0,g.jsx)("div",{className:"flex flex-wrap gap-3",children:A[e].map(e=>(0,g.jsx)(x,{$selected:O.includes(e.value),onClick:()=>U(e.value),children:e.label},e.value))},e)]},e))}),(0,g.jsx)(f.Z,{name:"feedback",type:"text",className:"mt-6",placeholder:C.formatMessage({id:"ConversationTurnInlineMessageFeedback.feedbackPlaceholder.1",defaultMessage:"(Optional) Feel free to add specific details"}),value:k??"",onChange:e=>N(e.target.value),onPressEnter:F}),w]})]})}let x=c.Z.button`
  rounded-lg border border-token-border-light px-3 py-1 text-sm text-token-text-secondary hover:text-token-text-primary hover:bg-token-main-surface-secondary
  ${e=>{let{$selected:t}=e;return t&&"!bg-token-text-primary !text-token-main-surface-primary"}}
`},42606:function(e,t,n){n.d(t,{I:function(){return a},o:function(){return o}});let r=["xlsx","pptx","docx"],i={"application/vnd.google-apps.spreadsheet":"xlsx","application/vnd.google-apps.presentation":"pptx","application/vnd.google-apps.document":"docx"};function a(e){return e?i[e.split(";")[0]]??null:null}function o(e){return e&&r.includes(e)?e:null}},93866:function(e,t,n){n.d(t,{AJ:function(){return o},XX:function(){return l},xA:function(){return s}});var r,i,a=n(42606);let o=((r={})[r.None=0]="None",r[r.Multimodal=1]="Multimodal",r[r.Interpreter=2]="Interpreter",r[r.Retrieval=3]="Retrieval",r[r.ContextConnector=4]="ContextConnector",r[r.ProfilePicture=5]="ProfilePicture",r);function s(e){if(e)return{contextConnector:e.context_connector,sourceUrl:e.source_url,syntheticExtension:(0,a.o)(e.synthetic_extension),type:e.type}}let l=((i={}).Uploading="uploading",i.Ready="ready",i)},66114:function(e,t,n){n.d(t,{$H:function(){return m},$p:function(){return N},Ad:function(){return D},B:function(){return A},BV:function(){return U},CO:function(){return P},Iy:function(){return h},KL:function(){return T},L8:function(){return g},O6:function(){return b},Tu:function(){return F},VF:function(){return y},Vm:function(){return E},WI:function(){return S},YN:function(){return w},Z8:function(){return k},Zp:function(){return M},_0:function(){return j},kr:function(){return x},p0:function(){return O},s1:function(){return _},ww:function(){return v},xs:function(){return C}});var r=n(99333),i=n(16757),a=n(2721),o=n(86025),s=n(58695),l=n(82363),u=n(92379),c=n(49764),d=n(47584),f=n(24740),p=n(93866);function h(e){return e.replace("file-service://","")}function g(e){return"file-service://"+e}function m(e){return e.startsWith("file-service://")}function x(e,t,n){switch(t){case"file_zero_bytes":return e.formatMessage(L.fileZeroBytes,n);case"file_too_large":return e.formatMessage(L.fileTooLarge,n);case"over_user_quota":return e.formatMessage(L.overUserQuota,n);case"file_not_found":case"file_expired":return e.formatMessage(L.fileNotFound,n);case"file_timed_out":return e.formatMessage(L.fileTimedOut,n);case"ace_pod_expired":return e.formatMessage(L.codeInterpreterSessionTimeout,n);case"permission_error":return e.formatMessage(L.permissionError,n);case"default_upload_error":case"file_rejected":return e.formatMessage(L.defaultCreateEntryError,n);case"default_download_link_error":return e.formatMessage(L.defaultDownloadLinkError,n);case"file_empty":return e.formatMessage(L.fileEmpty,n);case"too_many_tokens":return e.formatMessage(L.fileTooManyTokens,n);case"file_encrypted":return e.formatMessage(L.fileEncrypted,n);case"file_corrupted":return e.formatMessage(L.fileCorrupted,n);case"failed_upload_to_blobstore":return e.formatMessage(L.failedUploadToBlobStore,n);default:return e.formatMessage(L.unknownError)}}function y(){let e=(0,c.Z)();return(0,u.useCallback)((t,n)=>x(e,t,n),[e])}function b(){let{session:e}=(0,s.kP)(),{isUnauthenticated:t}=(0,o.u)(),n=(0,c.Z)();return async(i,o)=>{if(!t&&null==e)return f.m.danger(n.formatMessage(L.fileDownloadFailed)),!1;try{let e=await a.Z.getFileDownloadLink(i,void 0,t);if(e.status!==r.KF.Success)throw Error("File is not ready to download: "+JSON.stringify(e));let n=e.download_url,s=document.createElement("a");s.href=n,s.download=o,s.click(),window.open(n,"_blank")}catch(e){return f.m.danger(n.formatMessage(L.fileDownloadFailed)),!1}return!0}}function v(e,t){return t?.kind===i.OL.GizmoInteraction||t?.kind===i.OL.GizmoTest?t.gizmo?.product_features:e?.product_features}function w(e,t){let n=v(e,t);return n?.attachments?.type===r.Cd.CodeInterpreter?p.AJ.Interpreter:n?.attachments?.type===r.Cd.Multimodal?p.AJ.Multimodal:n?.attachments?.type===r.Cd.Retrieval?p.AJ.Retrieval:n?.attachments?.type===r.Cd.ContextConnector?p.AJ.ContextConnector:p.AJ.None}function _(e){return({md:"text/markdown",java:"text/x-java",py:"text/x-script.python",c:"text/x-c",cpp:"text/x-c++",h:"text/x-c++",php:"text/x-php",rb:"text/x-ruby",tex:"application/x-latext",ts:"text/x-typescript",cs:"text/x-csharp"})[e.split(".").pop()?.toLowerCase()??""]||""}function C(e,t,n,r,i){if(null==i)return e;let a=_(t);a&&(n=a),r&&(n=function(e){switch(e){case"application/vnd.google-apps.spreadsheet":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"application/vnd.google-apps.document":case"application/vnd.google-apps.presentation":return"text/plain";default:return e}}(n));let{accepted_mime_types:o,can_accept_all_mime_types:s}=i;return null!=o&&0!==o.length&&s?o.includes(n)?e:p.AJ.Interpreter:e}function j(e,t,n){let i=""!==t?t:_(n),a=e?.product_features?.attachments;return null==a?void 0:a.accepted_mime_types?.includes(i)?a.type:a.image_mime_types?.includes(i)?r.Cd.Multimodal:r.Cd.CodeInterpreter}function M(e,t){let n=v(e,t);return n?.attachments?.can_accept_all_mime_types?void 0:n?.attachments?.accepted_mime_types}function O(e,t){let{attachments:n}=v(e,t)??{};return n?.image_mime_types?n.image_mime_types:n?.type==="multimodal"?n.accepted_mime_types??T:[]}let T=["image/png","image/jpeg","image/gif","image/webp"];function k(e){return(0,u.useMemo)(()=>{if(void 0===e)return{};let t={"image/jpeg":[".jpg",".jpeg"],"image/svg+xml":[".svg"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"]};return{accept:e.reduce((e,n)=>(n in t?e[n]=t[n]:n.includes("/")&&(e[n]=[`.${n.split("/")[1]}`]),e),{})}},[e])}function N(e){return e.split(".").pop()?.toLowerCase()}function P(e){let t=N(e);return null!=t&&["jpg","jpeg","png","gif","webp"].includes(t)}function E(e){let t=N(e);return null!=t&&["xls","xlsx","csv"].includes(t)}function U(e){let t=N(e);return null!=t&&["xls","xlsx"].includes(t)}function F(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fit";return new Promise((r,i)=>{let a=new FileReader;a.onerror=e=>{l.U.addError(Error("File reading has failed:",{cause:e})),i(Error("Failed to read the file."))},a.onload=a=>{let o=new Image;o.onerror=e=>{l.U.addError(Error("Image loading has failed:",{cause:e})),i(Error("Failed to load the image."))},o.onload=()=>{let a=document.createElement("canvas"),s,u=0,c=0;switch(n){case"fill":case"square":s=t/Math.min(o.width,o.height);break;case"fit":s=t/Math.max(o.width,o.height)}let d=o.width*s,f=o.height*s;"square"===n?(a.width=t,a.height=t,u=(t-d)/2,c=(t-f)/2):(a.width=d,a.height=f);let p=a.getContext("2d");if(null==p){l.U.addError("Canvas context creation failed. Your environment might not fully support HTML5 canvas."),i(Error("Failed to create canvas context."));return}p.drawImage(o,u,c,d,f);let h=e.type||"image/png";a.toBlob(t=>{t?r(new File([t],e.name,{type:h})):(l.U.addError("Blob creation failed. Blob is null."),i(Error("Failed to create blob from image data.")))},h)},null==a.target?(l.U.addError("Event target is null. Failed to load image."),i("Failed to load image.")):o.src=a.target.result},a.readAsDataURL(e)})}function S(e,t){return F(e,t,"square")}function A(e){let t=e.name.split("/")??[];return(t[t.length-1]??"").replace(/[-_]/g," ").split(".")[0]}function D(e,t){return t?e.slice(0,-t.length-1):e}let L=(0,d.vU)({defaultCreateEntryError:{id:"fileUpload.defaultCreateEntryError",defaultMessage:"Unable to upload {fileName}"},defaultDownloadLinkError:{id:"fileUpload.defaultDownloadLinkError",defaultMessage:"Failed to get upload status for {fileName}"},unknownError:{id:"fileUpload.unknownError",defaultMessage:"Unknown error occurred"},fileZeroBytes:{id:"fileUpload.fileZeroBytes",defaultMessage:"File is empty"},fileTooLarge:{id:"fileUpload.fileTooLarge",defaultMessage:"File is too large"},overUserQuota:{id:"fileUpload.overUserQuota",defaultMessage:"User quota exceeded"},fileNotFound:{id:"fileUpload.fileNotFound",defaultMessage:"File not found"},fileTimedOut:{id:"fileUpload.fileTimedOut",defaultMessage:"File upload timed out. Please try again."},fileEmpty:{id:"fileUpload.fileEmpty",defaultMessage:"No text could be extracted from this file."},fileTooManyTokens:{id:"fileUpload.fileTooManyTokens",defaultMessage:"This file contains too much text content. Please try again with a smaller file."},fileEncrypted:{id:"fileUpload.fileEncrypted",defaultMessage:"This file is encrypted/requires a password to access. Please try again with an unencrypted file."},fileCorrupted:{id:"fileUpload.fileCorrupted",defaultMessage:"This file is corrupted. Please ensure the file is not corrupted and try again."},codeInterpreterSessionTimeout:{id:"fileUpload.codeInterpreterSessionTimeout",defaultMessage:"Code interpreter session expired"},permissionError:{id:"fileUpload.permissionError",defaultMessage:"Missing permission to access file"},fileDownloadFailed:{id:"filesModal.fileDownloadFailed",defaultMessage:"File download failed. Please try again."},failedUploadToBlobStore:{id:"fileUpload.failedUploadToBlobStore",defaultMessage:"Failed upload to files.oaiusercontent.com. Please ensure your network settings allow access to this site or contact your network administrator."}})},47313:function(e,t,n){n.d(t,{G:function(){return r}});let r=(0,n(92379).createContext)(void 0)},65994:function(e,t,n){n.d(t,{b:function(){return r}});let r="contentReference"},76482:function(e,t,n){n.d(t,{lx:function(){return o}});var r=n(38482),i=n.n(r);let a=i()(()=>Promise.all([n.e(6835),n.e(6617),n.e(893),n.e(1981),n.e(7398),n.e(4169),n.e(306),n.e(2854),n.e(798)]).then(n.bind(n,52854)).then(e=>e.FormattedText),{loadableGenerated:{webpack:()=>[52854]}});t.ZP=a;let o=i()(()=>Promise.all([n.e(6835),n.e(6617),n.e(893),n.e(1981),n.e(7398),n.e(4169),n.e(306),n.e(2854),n.e(798)]).then(n.bind(n,52854)).then(e=>e.UserFormattedText),{loadableGenerated:{webpack:()=>[52854]}})},55357:function(e,t,n){n.d(t,{B:function(){return o},X:function(){return a}});var r=n(16757),i=n(7937);let a=e=>(0,i.r3)([r.OL.GizmoMagicCreate,r.OL.GizmoTest],e?.kind),o=e=>(0,i.r3)([r.OL.GizmoInteraction,r.OL.GizmoMagicCreate,r.OL.GizmoTest],e?.kind)},44885:function(e,t,n){n.d(t,{R3:function(){return c},Zl:function(){return p},eX:function(){return u},fL:function(){return d}});var r=n(98601),i=n(23763),a=n.n(i),o=n(56290);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}class l{constructor(e,t,n,i){this.textMessageParts=e,this.updateReactComponentDisplay=t,this.isActivelyStreaming=n,(0,r.Z)(this,"displayedTextLength",void 0),(0,r.Z)(this,"textMessagePartsTextLength",void 0),(0,r.Z)(this,"requestUpdateRaf",null),(0,r.Z)(this,"prevBuffer",void 0),(0,r.Z)(this,"nextBuffer",void 0),this.textMessagePartsTextLength=(0,o.Vh)(e).length,this.displayedTextLength=i?0:this.textMessagePartsTextLength,i&&!i.isComplete()&&(i.nextBuffer=this,this.prevBuffer=i)}onMessagePartsUpdated(e,t){this.textMessageParts=e,this.textMessagePartsTextLength=(0,o.Vh)(e).length,this.isActivelyStreaming=t,this.shouldUpdate()&&this.updateBufferedState()}shouldUpdate(){return!this.prevBuffer&&this.isBuffering()}isBuffering(){return this.displayedTextLength<this.textMessagePartsTextLength}isComplete(){return!this.isActivelyStreaming&&!this.isBuffering()}getNumBufferedChars(){let e=this.textMessagePartsTextLength,t=this.nextBuffer;for(;t;)e+=t.textMessagePartsTextLength,t=t.nextBuffer;return e-this.displayedTextLength}requestUpdate(){this.requestUpdateRaf||(this.requestUpdateRaf=window.requestAnimationFrame(()=>{this.requestUpdateRaf=null,this.updateReactComponentDisplay((0,o.$w)(this.textMessageParts,this.displayedTextLength),this.isComplete()),this.isComplete()&&this.resolveDependency()}))}resolveDependency(){if(this.nextBuffer){let e=this.nextBuffer;this.nextBuffer=e.prevBuffer=void 0,e.shouldUpdate()&&e.updateBufferedState()}}destroy(){this.resolveDependency(),this.requestUpdateRaf&&(window.cancelAnimationFrame(this.requestUpdateRaf),this.requestUpdateRaf=null)}}class u extends l{constructor(e,t,n,i){super(e,t,n,i),this.updateReactComponentDisplay=t,(0,r.Z)(this,"displayNextCharTimeout",void 0),(0,r.Z)(this,"displayNextCharDelayMs",void 0),this.displayNextCharDelayMs=u.MAX_BUFFERING_MS_PER_CHAR}displayNextChar(){this.displayNextCharTimeout=void 0,this.shouldUpdate()&&(this.displayedTextLength++,this.requestUpdate(),this.displayNextCharTimeout=window.setTimeout(()=>this.displayNextChar(),this.displayNextCharDelayMs))}updateBufferedState(){let e=this.getNumBufferedChars();if(e>0){let t=u.MAX_BUFFERING_LAG_MS/e;this.displayNextCharDelayMs=Math.min(t,u.MAX_BUFFERING_MS_PER_CHAR)}null==this.displayNextCharTimeout&&this.displayNextChar()}destroy(){super.destroy(),window.clearTimeout(this.displayNextCharTimeout)}}(0,r.Z)(u,"MAX_BUFFERING_LAG_MS",500),(0,r.Z)(u,"MAX_BUFFERING_MS_PER_CHAR",30);class c extends l{constructor(e,t,n,i){super(e,t,n,i),this.updateReactComponentDisplay=t,(0,r.Z)(this,"chunkLength",void 0),(0,r.Z)(this,"displayNextChunkTimeout",void 0),this.chunkLength=0}displayNextChunk(){this.displayNextChunkTimeout=void 0,this.shouldUpdate()&&(this.displayedTextLength=Math.min(this.displayedTextLength+this.chunkLength,this.textMessagePartsTextLength),this.requestUpdate(),this.displayNextChunkTimeout=window.setTimeout(()=>this.displayNextChunk(),c.UPDATE_FREQUENCY_MS))}updateBufferedState(){let e=this.getNumBufferedChars();e>=c.MIN_CHARS_BEHIND_TO_CATCHUP?this.chunkLength=Math.ceil(e*c.UPDATE_FREQUENCY_MS/c.CATCHUP_TIME_MS):this.chunkLength=this.textMessagePartsTextLength-this.displayedTextLength,null==this.displayNextChunkTimeout&&this.displayNextChunk()}destroy(){super.destroy(),window.clearTimeout(this.displayNextChunkTimeout)}}(0,r.Z)(c,"MIN_CHARS_BEHIND_TO_CATCHUP",20),(0,r.Z)(c,"CATCHUP_TIME_MS",300),(0,r.Z)(c,"UPDATE_FREQUENCY_MS",30);class d extends l{constructor(e,t,n,i,l){super(e,t,n,i),this.updateReactComponentDisplay=t,(0,r.Z)(this,"LAG_FACTORS",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({".":15,"!":15,"?":15,"\n":15,",":8,":":8,";":8,DEFAULT_LAG_FACTOR:.9,BUFFER_FACTOR:.08},window.__PUNCTUATION_BUFFER_LAG_FACTORS)),(0,r.Z)(this,"concatenatedText",void 0),(0,r.Z)(this,"displayNextCharTimeout",void 0),(0,r.Z)(this,"debug",void 0),(0,r.Z)(this,"streamStartMs",void 0),(0,r.Z)(this,"averageMsPerChar",void 0),(0,r.Z)(this,"_throttledDebugLog",a()(e=>{console.debug(e)},500,{leading:!0,trailing:!0})),this.concatenatedText=(0,o.Vh)(this.textMessageParts),this.debug=l?.debug??!1,this.streamStartMs=0,this.averageMsPerChar=0,this.debug&&console.debug(`PunctuationBuffer:
[lagFactors: ${JSON.stringify(this.LAG_FACTORS,null,2)}]`)}displayNextChar(){this.displayNextCharTimeout=void 0,this.shouldUpdate()&&(this.displayedTextLength++,this.requestUpdate(),this.displayNextCharTimeout=window.setTimeout(()=>this.displayNextChar(),this._getNextCharDelayMs()))}updateBufferedState(){this.concatenatedText=(0,o.Vh)(this.textMessageParts),0===this.streamStartMs?this.streamStartMs=Date.now():this.averageMsPerChar=(Date.now()-this.streamStartMs)/this.textMessagePartsTextLength,this.displayNextCharTimeout||this.displayNextChar()}destroy(){super.destroy(),window.clearTimeout(this.displayNextCharTimeout)}_getNextCharDelayMs(){let e=this.concatenatedText[this.displayedTextLength-1],t=this.getNumBufferedChars(),n=1/Math.max(t*this.LAG_FACTORS.BUFFER_FACTOR,1),r=(this.LAG_FACTORS[e]??this.LAG_FACTORS.DEFAULT_LAG_FACTOR)*n,i=this.averageMsPerChar*r;return this.debug&&this._throttledDebugLog(`PunctuationBuffer:
[lagMs: ${i}]
[lastChar: "${e}"]
[averageMsPerChar: ${this.averageMsPerChar}]
[lagFactor: ${r}]
[bufferLagFactor: ${n}]
[numBufferedChars: ${t}]
===`),i}}function f(e){return"text"===e.type}class p{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;(0,r.Z)(this,"buffer",void 0),(0,r.Z)(this,"text",void 0),this.buffer=new e([n],(e,n)=>{t(e.filter(f).map(e=>e.text).join(""),n)},i,a),this.text=n}setText(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.text=e,this.buffer.onMessagePartsUpdated([this.text],t)}isBuffering(){return this.buffer.isBuffering()}isComplete(){return this.buffer.isComplete()}destroy(){return this.buffer.destroy()}}},41871:function(e,t,n){n.d(t,{O1:function(){return v},XX:function(){return p},Xt:function(){return g},i$:function(){return y},xB:function(){return h}});var r=n(16757),i=n(66114),a=n(76482),o=n(47416),s=n(82363),l=n(19841),u=n(99661);n(92379);var c=n(49764),d=n(59122),f=n(651);function p(e){let{message:t}=e,{resolvedTheme:n}=(0,u.F)();return(0,f.jsx)(o.c.Provider,{value:{isWithinDataAnalysisToolMessage:!0},children:(0,f.jsx)(a.ZP,{className:(0,l.default)("markdown prose w-full break-words dark:prose-invert","dark"===n?"dark":"light"),children:h(t)})})}function h(e){function t(e,t){return`\`\`\`${t}
${e}
\`\`\``}if("code"===e.content.content_type)return t(e.content.text,"python");if("python"===e.recipient){if("text"!==e.content.content_type)throw Error("Unexpected content type for code message");let n=e.content.parts;if(1!==n.length||"string"!=typeof n[0])throw Error("Unexpected parts for code message");return t(n[0],"python")}throw Error("Unexpected code message format")}function g(e){let{message:t}=e,n=(0,c.Z)();if(t.content.content_type!==r.PX.ExecutionOutput)return null;let i=t.metadata?.aggregate_result;if(!i)return s.U.addError("Corrupt code execution result message"),null;let a=i.messages.filter(b),o=a.length>0,l=null!=i.final_expression_output,u=null!=i.in_kernel_exception;return(0,f.jsxs)(f.Fragment,{children:[o&&(0,f.jsx)(m,{label:"STDOUT/STDERR",output:a.map((e,t)=>(0,f.jsx)("span",{className:"stderr"===e.stream_name?"text-red-500":"",children:e.text},`${t}`))}),l&&(0,f.jsx)(m,{label:n.formatMessage({id:"codeInterpreterMessage.resultLabel",defaultMessage:"Result"}),output:i.final_expression_output}),u&&(0,f.jsx)(x,{traceback:i.in_kernel_exception.traceback.join("")})]})}function m(e){let{label:t,output:n}=e;return(0,f.jsxs)("div",{className:"bg-gray-700 p-4 text-xs",children:[(0,f.jsx)("div",{className:"mb-1 text-gray-400",children:t}),(0,f.jsx)("div",{className:"prose flex flex-col-reverse text-white",children:(0,f.jsx)("pre",{className:"shrink-0",children:n})})]})}function x(e){let{traceback:t}=e;return(0,f.jsx)("div",{className:"overflow-auto border-t border-gray-500 text-white",children:(0,f.jsx)("div",{className:"border-l-4 border-red-500 p-2 text-xs",children:(0,f.jsx)("div",{className:"scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-700 flex max-h-64 flex-col-reverse",children:(0,f.jsx)("pre",{className:"shrink-0",children:t})})})})}function y(e){let{message:t}=e;if(t.content.content_type!==r.PX.ExecutionOutput)return null;let n=t.metadata?.aggregate_result;return n?(0,f.jsx)(f.Fragment,{children:n.messages.filter(v).map((e,t)=>(0,f.jsx)(d.Z,{jupyterMessage:e},t))}):(s.U.addError("Corrupt code execution result message"),null)}function b(e){return"stream"===e.message_type}function v(e){return"image"===e.message_type||"image_url"in e&&(0,i.$H)(e.image_url+"")}},59122:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(98601),i=n(99333),a=n(82164),o=n(66114),s=n(2721),l=n(92745),u=n(84760),c=n(92379),d=n(49764),f=n(75325),p=n(47584),h=n(651);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){let{jupyterMessage:t}=e,n=(0,l.h9)(),i=(0,d.Z)();if(n)return(0,h.jsxs)("div",{className:"my-1 flex h-52 w-full max-w-xs flex-col items-center justify-center gap-2 rounded-md border-black/5 bg-gray-100 p-7 text-center text-token-text-tertiary dark:border-white/10",children:[(0,h.jsx)(a.zS0,{className:"icon-lg"}),(0,h.jsx)(f.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},b.imageNotSupported))]});if(null!=t.image_payload)return(0,h.jsx)("img",{className:"my-1",src:`data:image/png;base64,${t.image_payload}`,alt:i.formatMessage(b.altText)});if(null!=t.image_url){let e=(0,o.Iy)(t.image_url);return(0,h.jsx)(y,{fileId:e})}return null}let x=Math.log(151)/Math.log(1.5);function y(e){let{fileId:t}=e,n=(0,d.Z)(),{data:r,isLoading:a,refetch:o}=(0,u.a)({queryKey:["getFileDownloadLink",t],queryFn:()=>s.Z.getFileDownloadLink(t),refetchInterval:e=>{let t=e.state.dataUpdateCount;return e.state.data?.status!==i.KF.Success&&!(t>x)&&e.state.status!==i.KF.Error&&100*Math.pow(1.5,t)}});return((0,c.useEffect)(()=>{if(r?.status===i.KF.Success){let e=new URL(r.download_url,location.toString()).searchParams.get("se");null!=e&&!a&&new Date>new Date(e)&&o()}},[r,a,o]),r?.status!==i.KF.Success)?null:(0,h.jsx)("img",{src:r.download_url,className:"my-1 max-h-full max-w-full",alt:n.formatMessage(b.altText)})}let b=(0,p.vU)({imageNotSupported:{id:"CodeExecutionOutputImage.imageNotSupported",defaultMessage:"Image output is not supported in a shared chat"},altText:{id:"CodeExecutionOutputImage.altText",defaultMessage:"Output image"}})},47416:function(e,t,n){n.d(t,{c:function(){return r}});let r=(0,n(92379).createContext)({isWithinDataAnalysisToolMessage:!1})},56290:function(e,t,n){n.d(t,{$w:function(){return o},Lm:function(){return s},Qq:function(){return a},Vh:function(){return i},xz:function(){return l}});var r=n(16757);function i(e){return e.map(e=>"string"==typeof e?e:"").join("")}function a(e){return e.map(e=>"text"===e.type?e.text:"").join("\n")}function o(e,t){let n=[],i=0;for(let a=0;a<e.length;a++){let o=e[a];if("string"==typeof o){if(null!=t&&t<i+o.length){n.push({type:"text",text:o.slice(0,t-i)});break}n.push({type:"text",text:o}),i+=o.length}else if(o.content_type===r.wW.ImageAssetPointer){let e=a>0?n[a-1]:null;e?.type==="images"?e.imageAssets.push(o):n.push({type:"images",imageAssets:[o]})}else o.content_type===r.wW.AudioTranscription&&n.push({type:"transcription",text:o.text})}return n}function s(e){let{isUserTurn:t,parts:n}=e;if(!t)return o(n);let i={text:[],images:[]};for(let e=0;e<n.length;e++){let t=n[e];"string"==typeof t?t.trim().length>0&&i.text.push({type:"text",text:t}):t.content_type===r.wW.AudioTranscription?i.text.push({type:"transcription",text:t.text}):t.content_type===r.wW.ImageAssetPointer&&i.images.push(t)}let a=[];return i.images.length>0&&a.unshift({type:"images",imageAssets:i.images}),a.push(...i.text.map(e=>({type:e.type,text:e.text}))),a}function l(e){let t=e&&new Date(e),n=t&&new Date(t);return n?`after ${n.getHours()%12||12}:${10>n.getMinutes()?"0":""}${n.getMinutes()} ${n.getHours()>=12?"PM":"AM"}`:"later"}},40833:function(e,t,n){n.d(t,{v:function(){return p}});var r=n(98601),i=n(10449),a=n(19841),o=n(92379),s=n(75325),l=n(47584),u=n(82164),c=n(651);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function p(e){let{align:t,arrowPadding:n,alignOffset:r,show:l,onDismiss:d,children:p,title:g,side:m,sideOffset:x,theme:y="default",badge:b="new",description:v,dismissOnOutsideClick:w=!1}=e,_=(0,o.useRef)(null);return(0,c.jsxs)(i.fC,{open:l,onOpenChange:e=>{e||d()},children:[(0,c.jsx)(i.xz,{asChild:!0,onClick:()=>{d()},ref:_,children:p}),(0,c.jsx)(i.h_,{children:(0,c.jsxs)(i.VY,{arrowPadding:n,alignOffset:r,align:t,side:m,sideOffset:x,onOpenAutoFocus:e=>{e.preventDefault()},onCloseAutoFocus:e=>{e.preventDefault()},onInteractOutside:e=>{e.target instanceof Element&&_.current?.contains(e.target)?e.preventDefault():w?d():e.preventDefault()},updatePositionStrategy:"always",className:(0,a.default)("relative z-10 animate-slideLeftAndFade select-none rounded-xl p-4 text-sm shadow-sm","default"===y?"bg-gray-900 text-white dark:bg-gray-50 dark:text-gray-700":"bg-blue-400 text-white"),children:[(0,c.jsxs)("div",{className:"flex max-w-xs flex-col gap-1",children:[(0,c.jsxs)("div",{className:"mb-0.5 flex gap-2",children:["new"===b?(0,c.jsx)("span",{className:(0,a.default)("rounded px-1.5 py-0.5 text-[10px] font-semibold uppercase leading-normal","default"===y?"bg-green-500 text-white":"bg-white text-blue-selection"),children:(0,c.jsx)(s.Z,f({},h.new))}):"beta"===b&&(0,c.jsx)("span",{className:"rounded-full bg-blue-100 px-1.5 text-[10px] font-semibold text-blue-600",children:(0,c.jsx)(s.Z,f({},h.beta))}),(0,c.jsx)("div",{className:"grow font-semibold",children:g}),(0,c.jsx)(i.x8,{className:"-my-1 -mr-1 p-1 opacity-70 transition hover:opacity-100",children:(0,c.jsx)(u.tPq,{className:"icon-sm"})})]}),void 0!==v&&(0,c.jsx)("div",{className:"",children:v})]}),(0,c.jsx)(i.Eh,{asChild:!0,children:(0,c.jsx)("div",{className:(0,a.default)("relative top-[-6px] h-3 w-3 rotate-45 transform rounded-br-sm","default"===y?"bg-gray-900 dark:bg-gray-50":"bg-blue-400")})})]})})]})}let h=(0,l.vU)({new:{id:"announcementTooltip.new",defaultMessage:"New"},beta:{id:"announcementTooltip.beta",defaultMessage:"Beta"}})},5132:function(e,t,n){n.d(t,{W4:function(){return l},XB:function(){return d},XM:function(){return c},ri:function(){return f},t5:function(){return p},to:function(){return a}});var r=n(16757),i=n(65012);let a=2592e3,o="last_checked_loc",s="last_denied_loc";function l(e){return e.author.metadata?.real_author===r.d1.ToolWeb}let u={latitude:null,longitude:null,locationAccuracy:null};async function c(){return navigator?.permissions?await navigator.permissions.query({name:"geolocation"}):null}async function d(e){let{enabled:t}=e;if(!t)return f();if((await c())?.state!=="granted"){let e=localStorage.getItem(o);if(e){let t=Number(e);if(Date.now()-864e5<t)try{return JSON.parse(i.bX.getCookie(i.cn.LastLocation))}catch{}}}let n=localStorage.getItem(s);if(n){let e=Number(n);if(Date.now()-36e5<e)return null}return await new Promise(e=>{navigator.geolocation.getCurrentPosition(t=>{let n={latitude:t.coords.latitude,longitude:t.coords.longitude,locationAccuracy:t.coords.accuracy};i.bX.setCookie(i.cn.LastLocation,JSON.stringify(n),{maxAge:a}),localStorage.setItem(o,Date.now().toString()),e(n)},()=>{localStorage.setItem(s,Date.now().toString()),e(f())},{enableHighAccuracy:!0,maximumAge:0})})}function f(){return i.bX.setCookie(i.cn.LastLocation,JSON.stringify(u),{maxAge:a}),localStorage.removeItem(o),localStorage.removeItem(s),null}function p(e,t){return`https://chatgpt.com/search/evals/permalink/${e}/${t}`}},66234:function(e,t,n){n.d(t,{D7:function(){return c},HY:function(){return d},LA:function(){return g},Uq:function(){return f}});var r=n(98601),i=n(88667),a=n(18939),o=n.n(a),s=n(85302);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length)return e;let n=t.filter(t=>t.end_ix<=e.length&&"tether_markdown"===t.citation_format_type&&t.metadata?.type==="webpage");for(let t=n.length-1;t>=0;t--){let r=n[t];if(r.metadata?.type!=="webpage")continue;let{start_ix:i,end_ix:a,metadata:o}=r,s=e.substring(i,a).replace(/\[(.*?)\]\((\d+)\)/g,`[$1](${o?.url})`);e=e.substring(0,i)+s+e.substring(a)}return e}(e,t),a=[...n.length>0?[]:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length)return[];let n=[],r=t.filter(t=>t.end_ix<=e.length&&"tether_markdown"!==t.citation_format_type),i=(0,s.Jx)(e);for(let e=r.length-1;e>=0;e--){let t;let o=r[e],{start_ix:s,end_ix:l,metadata:c,invalid_reason:d}=o;if(!c?.type)continue;let f=i.slice(s,l).join("");switch(c.type){case"webpage":var a;t=u(u({},c),{},{type:"webpage",title:c.title??"",snippet:c.text??null,pub_date:null==(a=c.pub_date)?null:new Date(a).getTime()/1e3,matched_text:f,start_idx:s,end_idx:l,alt:null});break;case"file":t=u(u({},c),{},{matched_text:f,start_idx:s,end_idx:l,alt:null})}d&&(t={type:"invalid",alt:d,start_idx:s,end_idx:l,matched_text:f,invalid:!0});let p=!1;if(n.length>0){let e=n[n.length-1];h(e)===h(t)&&0===i.slice(e.end_idx,o.start_ix).join("").trim().length&&(n[n.length-1].end_idx=o.end_ix,p=!0)}!p&&t&&n.push(t)}return n}(i,t),...n];return{text:i,contentReferences:o()(a.map(e=>"file"===e.type?g(r,e):e))}}function d(){let{config:e}=(0,i.xb)("1001765573"),t=(0,i.xb)("3168246095");return e.get("ca_enabled",!1)?t.config.get("gizmo_ids",[],p):[]}function f(){return(0,i.xb)("1001765573").config.get("ca_enabled",!1)}function p(e){return Array.isArray(e)&&e.every(e=>"string"==typeof e)}function h(e){switch(e.type){case"file":return e.id;case"webpage":return e.url;case"invalid":return e.alt}}function g(e,t){let n;if(!e)return t;let r=t.name.split("\xa4");if(3!==r.length)return t;let[i,a,o]=r,s=o,l=o.lastIndexOf(".");-1!==l&&(s=o.slice(0,l));let c="Google Drive";if("gdrive"===i)n=`https://drive.google.com/file/d/${a}/view`,c="Google Drive";else if("gdoc"===i)n=`https://docs.google.com/document/d/${a}`,c="Google Docs";else{if("notion"!==i)return t;n=`https://www.notion.so/openai/${a}`,c="Notion"}return u(u({},t),{},{type:"webpage",url:n,title:s,snippet:c,pub_date:null})}},31353:function(e,t,n){n.d(t,{AW:function(){return h},Cp:function(){return d}});var r=n(98601),i=n(65994),a=n(22433),o=n(85302),s=n(18939),l=n.n(s);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function d(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=0,u=!1,d=!1,f=[...n].sort((e,t)=>e.start_idx-t.start_idx||e.end_idx-t.end_idx).reduce((t,n)=>{let r,a;if(n.end_idx>e.length)return t;switch(n.type){case"invalid":case"hidden":r=c(c({},n),{},{type:"hidden",invalid:"invalid"===n.type});break;case"image_v2":case"nav_list":case"tldr":case"optimistic_image_citation":a="block",r=c({},n);break;case"file":case"title_citation":case"location_search":case"time":a="inline",r=c({},n);break;case"webpage":case"webpage_extended":a="inline",r={type:"grouped_webpages",items:[c(c({},n),{},{type:"webpage"})]};break;case"calculator":case"stock":case"forecast":case"sports":a="block",u=!0,d="stock"===n.type,r=c({},n);break;default:r=c(c({},n),{},{type:"hidden",invalid:!0}),a="alt"}return t.push({originalContentReference:n,newContentReference:r,index:s++,displayType:a}),i&&t.push({originalContentReference:n,newContentReference:c({type:"debug",matched_text:n.matched_text.replace(/(^【|】$)/g,"")},"webpage_extended"===n.type&&n.pub_date&&{pub_date:new Date(1e3*n.pub_date).toLocaleString()}),index:s++}),t},[]);!function(e){let t=new Map;e.forEach((n,r)=>{let{originalContentReference:i,newContentReference:a,index:o}=n;if("grouped_webpages"!==a.type)return;a.items=a.items.map(e=>(t.has(e.url)||t.set(e.url,{index:o??r}),c(c({},e),{},{index:t.get(e.url)?.index})));let s=e[r+1];if(null==s)return;let{newContentReference:l,originalContentReference:u}=s;"grouped_webpages"===l.type&&i.end_idx+1>=u.start_idx&&(l.items=[...a.items.map(e=>c(c({},e),{},{index:o??void 0})),...l.items],n.displayType=void 0)})}(f);let g=l()(f.filter(e=>{let{index:t,displayType:n}=e;return null!=t&&n}).map(e=>{let{newContentReference:t}=e;return t})),m=function(e,t){let n="",r=0,i=(0,o.km)(t),a=new Set(["forecast"]),s=-1,l=0;for(let t of e){let{originalContentReference:e,displayType:u}=t;a.has(e.type)&&(s=l);let{start_idx:c,end_idx:d}=e,f=i.slice(r,c);if(n+=(0,o.dP)(f),r=d,u){switch(u){case"block":n+=p(l,"leaf","newline","newline");break;case"inline":{let e=0!==n.length&&n[n.length-1].match(/\s/)?void 0:"zero-width-space";n+=p(l,"inline",e);break}case"alt":n+=e.alt??""}l++}}return n+=(0,o.dP)(i.slice(r)),s>-1&&(n=p(s,"leaf")),n}(f,e);return m=h(m),t=g,g=u?t.map(e=>"tldr"===e.type?c(c({},e),{},{url:""}):e):t,d&&(g=function(e,t){let n=(t??[]).find(e=>"tldr"===e.type);return n?.url?e.map(e=>"stock"===e.type?c(c({},e),{},{url:e.url??n.url??""}):e):e}(g,n)),r&&({updatedText:m,updatedReferences:g}=function(e,t,n){let r=e.find(e=>(0,a.rH)(e)===a.Cs.CodeInterpreter),i=e.find(e=>(0,a.rH)(e)===a.Cs.CodeInterpreterTool);if(null!=r&&null!=i){let e=t.length;n.endsWith("```")&&(n+="\n"),n+=" "+p(e,"inline","zero-width-space","zero-width-space"),t.push({type:"code_execution",codeMessage:r,codeExecutionOutputMessage:i})}return{updatedText:n,updatedReferences:t}}(r,g,m)),{processedText:m,displayedContentReferences:g}}let f="&#8203;";function p(e,t,n,r){let a=`${i.b}[oaicite:${e}]{index=${e}}`;return`${"zero-width-space"===n?f:"newline"===n?"\n":""}${"leaf"===t?"::":":"}${a}${"zero-width-space"===r?f:"newline"===n?"\n":""}`}function h(e){let t=e,n=(t=t.replace(/【[^】]*$/g,"")).match(/(\n|^):::/g);return n&&n.length%2==1&&(t+="\n:::"),t=t.replace(/^\d+$/,"")}},85302:function(e,t,n){function r(e){try{let t=new Intl.Segmenter("en-US",{granularity:"grapheme"}).segment(e),n=[];for(let e of t)n.push(e.segment);return n}catch{return e.split("")}}function i(e){let t=[];for(let n=0;n<e.length;n++){let r=e.codePointAt(n);void 0!==r&&(t.push(r),r>65535&&n++)}return t}function a(e){return String.fromCodePoint(...e)}n.d(t,{Jx:function(){return r},dP:function(){return a},km:function(){return i}})},39696:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(92379);function i(e,t){let n=(0,r.useRef)(e);(0,r.useEffect)(()=>{n.current=e},[e]),(0,r.useEffect)(()=>{if(null!=t){let e=window.setInterval(function(){n.current()},t);return()=>clearInterval(e)}},[t])}},15174:function(e,t,n){var r=n(92379);t.Z=function(){let e=(0,r.useRef)(!1);return(0,r.useEffect)(()=>(e.current=!0,()=>{e.current=!1}),[]),(0,r.useCallback)(()=>e.current,[])}}}]);
//# sourceMappingURL=2350-4e5d53d6f0dd26f3.js.map