(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6964],{51516:function(e,t,r){"use strict";function n(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}r.d(t,{Z:function(){return n}})},89678:function(e,t,r){var n=r(6627),i=r(85365),a=r(67948),s=Math.max,o=Math.min;e.exports=function(e,t,r){var l,c,d,u,f,p,m=0,g=!1,v=!1,y=!0;if("function"!=typeof e)throw TypeError("Expected a function");function h(t){var r=l,n=c;return l=c=void 0,m=t,u=e.apply(n,r)}function b(e){var r=e-p,n=e-m;return void 0===p||r>=t||r<0||v&&n>=d}function x(){var e,r,n,a=i();if(b(a))return j(a);f=setTimeout(x,(e=a-p,r=a-m,n=t-e,v?o(n,d-r):n))}function j(e){return(f=void 0,y&&l)?h(e):(l=c=void 0,u)}function w(){var e,r=i(),n=b(r);if(l=arguments,c=this,p=r,n){if(void 0===f)return m=e=p,f=setTimeout(x,t),g?h(e):u;if(v)return clearTimeout(f),f=setTimeout(x,t),h(p)}return void 0===f&&(f=setTimeout(x,t)),u}return t=a(t)||0,n(r)&&(g=!!r.leading,d=(v="maxWait"in r)?s(a(r.maxWait)||0,t):d,y="trailing"in r?!!r.trailing:y),w.cancel=function(){void 0!==f&&clearTimeout(f),m=0,l=p=c=f=void 0},w.flush=function(){return void 0===f?u:j(i())},w}},85365:function(e,t,r){var n=r(73401);e.exports=function(){return n.Date.now()}},74951:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return ef},default:function(){return ep}});var n,i,a=r(97410),s=r(77768),o=r(15316),l=r(48609),c=r(44575),d=r(81743),u=r(65462),f=r(19841),p=r(89678),m=r.n(p),g=r(68305),v=r.n(g),y=r(32307),h=r(92379),b=r(62984),x=r(75172),j=r(68306),w=r(15478),k=r(9519),I=r(48198),P=r(49146),M=r(47453),O=r.n(M),E=r(90681),Z=r(47797),F=r(64031),C=r(89721),S=r(84760),R=r(42420),U=r(56032),D=r(31161);function T(e){let t=(0,x.Z)(),r=(0,R.NL)();return(0,U.D)({mutationFn:r=>{let{inviteId:n,role:i,acceptRequest:a}=r;return C.Z.patchWorkspaceInvite(e,n,{role:i,acceptRequest:a}).catch(e=>{D.m.danger(t.formatMessage(q.updateInviteError,{error:e.message}))})},onSuccess:()=>{r.invalidateQueries({queryKey:["workspace",e,"invites"]}),r.invalidateQueries({queryKey:["workspace",e,"invites","requests"]}),r.invalidateQueries({queryKey:["workspace",e]})}})}function N(e){let t=(0,x.Z)(),r=(0,R.NL)();return(0,U.D)({mutationFn:r=>{let{email:n}=r;return C.Z.deleteWorkspaceInvite(e,n).catch(e=>{D.m.danger(t.formatMessage(q.deleteInviteError,{email:n,error:e.message}))})},onSuccess:()=>{r.invalidateQueries({queryKey:["workspace",e,"invites"]}),r.invalidateQueries({queryKey:["workspace",e,"invites","requests"]})}})}let q=(0,j.vU)({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to update invite from workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}});var _=r(93180),A=r(41508),W=r(651);function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let G=O()(()=>r.e(6827).then(r.bind(r,46827)).then(e=>e.DirectorySyncResourceManagedIndication),{loadableGenerated:{webpack:()=>[46827]}});function L(e){var t,r;let{workspaceId:n,filterInputValue:i}=e,{0:a,1:s}=(0,h.useState)(0),o=(0,A.Gk)(n),l=(0,A.bE)(n),c=o||l,{data:d}=(r=25*a,(0,S.a)({queryKey:["workspace",n,"invites",r,i],queryFn:async()=>await C.Z.getWorkspaceInvites(n,r,25,i)}));if(void 0===d)return(0,W.jsx)(_.bq,{});let u=d.items,f=Math.ceil((null!==(t=d.total)&&void 0!==t?t:0)/25);return a>=f&&0!==f&&s(Math.max(f-1,0)),(0,W.jsxs)("div",{children:[(0,W.jsxs)(Z.Z.Root,{fixed:!0,size:"normal",children:[(0,W.jsxs)(Z.Z.Header,{children:[(0,W.jsx)(Z.Z.HeaderCell,{className:"bg-token-main-surface-primary",children:(0,W.jsx)(b.Z,X({},Q.email))}),(0,W.jsx)(Z.Z.HeaderCell,{className:"w-28 bg-token-main-surface-primary",children:(0,W.jsx)("span",{className:c?"pl-3":"",children:(0,W.jsx)(b.Z,X({},Q.role))})}),c&&(0,W.jsx)(Z.Z.HeaderCell,{className:"w-16 bg-token-main-surface-primary"})]}),(0,W.jsxs)(Z.Z.Body,{children:[u.map(e=>(0,W.jsx)(B,{workspaceId:n,invite:e,isCurrentUserOwner:o,currentUserHasAdminRights:c},e.id)),0===u.length&&(0,W.jsx)(Z.Z.Row,{children:(0,W.jsx)(Z.Z.Cell,{children:(0,W.jsx)("div",{className:"text-token-text-tertiary",children:(0,W.jsx)(b.Z,X({},Q.noResults))})})})]})]}),f>1&&(0,W.jsx)("div",{className:"mt-2 flex justify-center",children:(0,W.jsx)(F.t,{currentPage:a,onChangeIndex:s,length:f})})]})}function B(e){let{workspaceId:t,invite:r,isCurrentUserOwner:n,currentUserHasAdminRights:i}=e,a=(0,A.Ap)(),s=T(t),o=N(t),l=function(e){let t=(0,x.Z)(),r=(0,R.NL)();return(0,U.D)({mutationFn:r=>{let{role:n,email:i}=r;return C.Z.addWorkspaceUsers(e,[i],n,!0).then(e=>{let{account_invites:r,errored_emails:n}=e;if(n.length>0)throw Error(n[0].error);r.length>0&&D.m.success(t.formatMessage(q.resendInviteSuccess,{email:i}))}).catch(e=>{D.m.danger(t.formatMessage(q.resendInviteError,{email:i,error:e.message}))})},onSuccess:()=>{r.invalidateQueries({queryKey:["workspace",e,"invites"]}),r.invalidateQueries({queryKey:["workspace",e,"invites","requests"]})}})}(t),{value:c}=(0,E.sB)("3999712942");return(0,W.jsxs)(Z.Z.Row,{disabled:s.isPending||o.isPending||o.isSuccess||l.isPending,children:[(0,W.jsx)(Z.Z.Cell,{children:(0,W.jsxs)("span",{className:"flex flex-grow justify-between",children:[(0,W.jsx)("span",{children:r.email_address}),c&&r.is_scim_managed&&(0,W.jsx)(G,{})]})}),(0,W.jsx)(Z.Z.Cell,{children:n?(0,W.jsx)(_.mJ,{currentRole:r.role,onUpdateUserRole:e=>{s.mutate({inviteId:r.id,role:e})}}):a[r.role]}),i&&(0,W.jsx)(W.Fragment,{children:(0,W.jsx)(Z.Z.Cell,{children:(0,W.jsx)(K,{onDeleteUser:()=>{var e;o.mutate({email:null!==(e=r.email_address)&&void 0!==e?e:""})},onResendInvite:()=>{var e,t;l.mutate({email:null!==(e=r.email_address)&&void 0!==e?e:"",role:null!==(t=r.role)&&void 0!==t?t:""})}})})})]})}function K(e){let{onDeleteUser:t,onResendInvite:r}=e;return(0,W.jsxs)(l.Z.Root,{children:[(0,W.jsx)(l.Z.Trigger,{children:(0,W.jsx)(I.nWS,{className:"icon-sm"})}),(0,W.jsx)(l.Z.Portal,{children:(0,W.jsxs)(l.Z.Content,{children:[(0,W.jsx)(l.Z.Item,{onClick:r,children:(0,W.jsx)(b.Z,X({},Q.resendInvite))}),(0,W.jsx)(l.Z.Item,{onClick:t,children:(0,W.jsx)(b.Z,X({},Q.revokeInvite))})]})})]})}let Q=(0,j.vU)({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Role"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}});function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function V(e){var t;let{workspaceId:r,filterInputValue:n}=e,{0:i,1:a}=(0,h.useState)(0),{data:s}=(t=25*i,(0,S.a)({queryKey:["workspace",r,"invites","requests",t,n],queryFn:async()=>await C.Z.getWorkspaceInviteRequests(r,t,25,n)})),o=(0,A.Gk)(r),l=(0,A.bE)(r),c=(0,x.Z)(),d=o||l;if(void 0===s)return(0,W.jsx)(_.bq,{});let u=s.items,f=Math.ceil(s.total/25);return i>=f&&0!==f&&a(Math.max(f-1,0)),(0,W.jsxs)("div",{children:[(0,W.jsxs)(Z.Z.Root,{fixed:!0,size:"normal",children:[(0,W.jsxs)(Z.Z.Header,{children:[(0,W.jsx)(Z.Z.HeaderCell,{className:"bg-token-main-surface-primary",children:(0,W.jsx)(b.Z,J({},Y.email))}),(0,W.jsx)(Z.Z.HeaderCell,{className:"w-28 bg-token-main-surface-primary",children:(0,W.jsx)("span",{className:d?"pl-3":"",children:(0,W.jsx)(b.Z,J({},Y.role))})}),d&&(0,W.jsx)(Z.Z.HeaderCell,{className:"w-40 bg-token-main-surface-primary",children:c.formatMessage(Y.actions)})]}),(0,W.jsxs)(Z.Z.Body,{children:[u.map(e=>(0,W.jsx)($,{workspaceId:r,invite:e,isCurrentUserOwner:o,currentUserHasAdminRights:d},e.id)),0===u.length&&(0,W.jsx)(Z.Z.Row,{children:(0,W.jsx)(Z.Z.Cell,{children:(0,W.jsx)("div",{className:"text-token-text-tertiary",children:(0,W.jsx)(b.Z,J({},Y.noResults))})})})]})]}),f>1&&(0,W.jsx)("div",{className:"mt-2 flex justify-center",children:(0,W.jsx)(F.t,{currentPage:i,onChangeIndex:a,length:f})})]})}function $(e){let{workspaceId:t,invite:r,isCurrentUserOwner:n,currentUserHasAdminRights:i}=e,a=(0,A.Ap)(),s=T(t),o=N(t),l=(0,x.Z)();return(0,W.jsxs)(Z.Z.Row,{disabled:s.isPending||o.isPending||o.isPending,children:[(0,W.jsx)(Z.Z.Cell,{children:r.email_address}),(0,W.jsx)(Z.Z.Cell,{children:n?(0,W.jsx)(_.mJ,{currentRole:r.role,onUpdateUserRole:e=>{s.mutate({inviteId:r.id,role:e})}}):a[r.role]}),i&&(0,W.jsx)(W.Fragment,{children:(0,W.jsx)(Z.Z.Cell,{children:(0,W.jsxs)("div",{className:"flex gap-2",children:[(0,W.jsx)(k.z,{onClick:()=>s.mutate({inviteId:r.id,acceptRequest:!0}),children:l.formatMessage(Y.accept)}),(0,W.jsx)(k.z,{color:"secondary",onClick:()=>o.mutate({email:r.email_address}),children:l.formatMessage(Y.reject)})]})})})]})}let Y=(0,j.vU)({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Role"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}});var ee=r(13271);function et(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?et(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):et(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var en=((n=en||{}).Members="members",n.Invites="invites",n.Requests="requests",n);function ei(e){let{tab:t}=e;switch(t){case en.Members:return(0,W.jsx)(b.Z,er({},ed.allMembers));case en.Invites:return(0,W.jsx)(b.Z,er({},ed.pendingInvites));case en.Requests:return(0,W.jsx)(b.Z,er({},ed.pendingRequests))}}function ea(e){let{tab:t,filterInputValue:r,workspaceId:n}=e;switch(t){case en.Members:return(0,W.jsx)(_.ZP,{workspaceId:n,filterInputValue:r});case en.Invites:return(0,W.jsx)(L,{workspaceId:n,filterInputValue:r});case en.Requests:return(0,W.jsx)(V,{workspaceId:n,filterInputValue:r})}}let es=(0,u.b)(en);function eo(e){var t;let{currentWorkspaceId:r}=e,n=(0,x.Z)(),i=(0,c.t)(),a=null!==(t=(0,_.p5)(r))&&void 0!==t?t:"?",o=(0,A.qH)(i),u=null==i?void 0:i.isTeam(),f=(0,y.useRouter)(),p="string"==typeof f.query.tab&&es(f.query.tab)?f.query.tab:en.Members,{0:g,1:j}=(0,h.useState)(""),{0:w,1:M}=(0,h.useState)("");(0,h.useEffect)(()=>{M("")},[p]);let O=(0,h.useCallback)(m()(e=>{M(e)},250),[]),E=(0,ee.Wv)();if(!i)return null;let Z=i.isAdminOfAccount(),F=i.isOwnerOfAccount(),C=u||!E?[en.Members,en.Invites]:[en.Members,en.Invites,en.Requests];return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(v(),{children:(0,W.jsx)("title",{children:n.formatMessage(ed.adminBrowserPageTitle)})}),(0,W.jsx)(s.yG,{title:n.formatMessage(ed.adminPageTitle),subtitle:(0,W.jsx)(b.Z,er({values:{totalMembers:a,planName:o}},ed.totalMembers))}),(0,W.jsxs)(s.hb,{children:[(0,W.jsxs)(ec,{children:[(0,W.jsx)("div",{className:"mb-6 flex gap-2",children:C.map(e=>(0,W.jsx)(el,{onClick:()=>{f.push(null!=e?"/admin?tab=".concat(e):"/admin")},isSelected:p===e,children:(0,W.jsx)(ei,{tab:e})},e))}),(0,W.jsxs)("div",{className:"flex gap-2",children:[(0,W.jsxs)("div",{className:"relative",children:[(0,W.jsx)(I.W1M,{className:"icon-sm absolute left-2 top-1/2 -translate-y-1/2 transform text-token-text-tertiary"}),(0,W.jsx)("input",{type:"text",value:g,onChange:e=>{j(e.target.value),O(e.target.value)},placeholder:n.formatMessage(ed.search),className:"w-48 rounded-lg border border-token-border-light bg-token-main-surface-primary pl-8 placeholder:text-token-text-tertiary"})]}),(Z||F||u)&&(0,W.jsx)(k.z,{onClick:()=>{d.vm.openModal(d.B.InviteUsersToWorkspace)},icon:I.Vz5,children:(0,W.jsx)(b.Z,er({},ed.inviteMemberButton))}),u?(0,W.jsx)(l.d,{triggerButton:(0,W.jsx)(k.z,{color:"secondary",icon:I.nWS}),children:(0,W.jsx)(l.Z.Item,{onClick:()=>{i&&d.vm.setLeaveWorkspaceData(i)},children:(0,W.jsx)(b.Z,er({},ed.leaveWorkspace))})}):null]})]}),(0,W.jsx)(ea,{workspaceId:r,tab:p,filterInputValue:w})]}),null!=i?(0,W.jsx)(P.Z,{workspace:i}):null]})}function el(e){let{children:t,isSelected:r,onClick:n}=e;return(0,W.jsx)(k.z,{color:"ghost",className:(0,f.default)(r?"bg-token-main-surface-tertiary":"hover:bg-token-main-surface-tertiary"),onClick:n,children:t})}let ec=w.Z.div(i||(i=(0,o.Z)(["mb-4 py-6 flex flex-col gap-4 lg:flex-row md:items-start lg:justify-between"]))),ed=(0,j.vU)({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Member admin"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} \xb7 {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"All members"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"},analytics:{id:"adminPage.analytics",defaultMessage:"Analytics"},inviteMemberButton:{id:"adminPage.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"},search:{id:"adminPage.search",defaultMessage:"Search"}});function eu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var ef=!0;function ep(e){return(0,W.jsx)(eo,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eu(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e))}ep.getLayout=function(e){return(0,W.jsx)(s.ZP,{mobilePageTitle:"Members",children:e})}},13271:function(e,t,r){"use strict";r.d(t,{Bd:function(){return y},DD:function(){return x},Fc:function(){return b},Ji:function(){return v},OR:function(){return j},Wv:function(){return g},f_:function(){return m},sd:function(){return k},z0:function(){return w}});var n,i=r(15316),a=r(34608),s=r(31161),o=r(89721),l=r(25968),c=r(84760),d=r(56032),u=r(42420),f=r(75172),p=r(68306);function m(e,t){return(0,c.a)({queryKey:["workspace/identity",e],queryFn:async()=>{if(void 0!==e)return await o.Z.getWorkspaceIdentitySettings(e)},enabled:t})}function g(){let e=(0,l.ec)(l.F_.workspaceId),{data:t}=m(null!=e?e:void 0,null!=e);return(null==t?void 0:t.domains)&&(null==t?void 0:t.domains.filter(e=>"verified"==e.status))}function v(e){let t=(0,f.Z)();return(0,d.D)({mutationFn:r=>{let{shouldAutoProvision:n}=r;return o.Z.setWorkspaceShouldAutoProvision(e,n).then(e=>{let r=n?I.autoProvisionEnabledToast:I.autoProvisionDisabledToast;return s.m.success(t.formatMessage(r),{duration:3}),e}).catch(e=>{throw s.m.danger(e.message),e})}})}function y(e){let t=(0,u.NL)();return(0,d.D)({mutationFn:t=>{let{domainId:r}=t;return o.Z.removeDomainFromWorkspace(e,r)},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]}),t.refetchQueries({queryKey:["builderProfile"]})}})}function h(e){let t=e;return t.startsWith("-----BEGIN")||(t="-----BEGIN CERTIFICATE-----\n".concat(t)),t.endsWith("CERTIFICATE-----")||(t="".concat(t,"\n-----END CERTIFICATE-----")),t}function b(e){let t=(0,u.NL)();return(0,d.D)({mutationFn:t=>{let{signInEndpoint:r,cert:n}=t;return o.Z.createSAMLConnection(e,r,h(n))},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}function x(e){let t=(0,u.NL)();return(0,d.D)({mutationFn:t=>{let{connectionId:r,signInEndpoint:n,cert:i,active:a,enforcedClients:s}=t;return o.Z.updateSAMLConnection(e,r,{signInEndpoint:n,cert:void 0!==i?h(i):void 0,active:a,enforcedClients:s})},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}function j(e){let t=(0,u.NL)();return(0,d.D)({mutationFn:t=>{let{connectionId:r}=t;return o.Z.deleteSAMLConnection(e,r)},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}let w=r(15478).Z.div(n||(n=(0,i.Z)(["text-md mb-4 text-token-text-secondary"]))),k={[a.pT.VERIFIED]:(0,p.Em)({id:"i7FkyS",defaultMessage:"Verified"}),[a.pT.PENDING]:(0,p.Em)({id:"THBv/l",defaultMessage:"Pending"}),[a.pT.EXPIRED]:(0,p.Em)({id:"+sjWGK",defaultMessage:"Expired"})},I=(0,p.vU)({autoProvisionEnabledToast:{id:"workspaceIdentity.autoProvisionEnabledToast",defaultMessage:"Auto provisioning enabled for this workspace"},autoProvisionDisabledToast:{id:"workspaceIdentity.autoProvisionDisabledToast",defaultMessage:"Auto provisioning disabled for this workspace"}})},76126:function(e,t,r){"use strict";r.d(t,{$e:function(){return a},EZ:function(){return s},Ql:function(){return i},dO:function(){return n},xC:function(){return o}});let n=10,i=4,a={duration:20,hasCloseButton:!0},s=512,o=536870912},2744:function(e,t,r){"use strict";r.d(t,{R3:function(){return j},W7:function(){return h},cT:function(){return x},lU:function(){return w},po:function(){return b}});var n=r(97410),i=r(34608),a=r(89721),s=r(7667),o=r(99140),l=r(66943),c=r(7569),d=r(68306),u=r(31245),f=r(31161),p=r(47246),m=r(11655);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let y={duration:20,hasCloseButton:!0};function h(e){return JSON.stringify({file:e.name,modified:e.lastModified,currentTime:new Date().toString()})}function b(e){return new Promise((t,r)=>{let n=new FileReader,i=new Image;n.onload=()=>{i.onload=()=>t(i),i.onerror=e=>r(e),i.src=n.result},n.readAsDataURL(e)})}async function x(e,t,r,n,c,d){var p,m,g;let v=u.N.getState().resetRateLimits,h=i.EG.Initial;o.A.logEvent(l.M.uploadFileInitiated,{client:"web",useCase:n.kind,uploadEntry:"local"});let b=d.usesRetrievalIndex?performance.now():void 0;try{let{file_id:s,upload_url:o}=await a.Z.createFile(t.name,t.size,n,!!v);c.onFileCreated(e,s,o),h=i.EG.FileCreated;let l=n.kind===i.Ei.Gizmo?n.gizmoId:void 0,u=null!==(p=d.shouldUpdateProgress)&&void 0!==p&&p,g=null!==(m=d.usesRetrievalIndex)&&void 0!==m&&m,x=await a.Z.uploadFileToAzureStorage(t,o,t=>{u&&c.onFileUploadProgress(e,10+80*t)});if(c.onFileUploadProgress(e,90),201!==x.status&&I(x,s,g),h=i.EG.FileUploaded,await a.Z.processFileUpload(s,{gizmoId:l}),h=i.EG.FileProcessed,d.usesRetrievalIndex){let t=await k(s,l);(null==t?void 0:t.status)===i.Xf.Skipped&&f.m.danger(r.formatMessage(M.retrievalSkippedFile,{fileName:t.name}),y),c.onFileUploaded(e,s,void 0,{fileTokenSize:t.file_size_tokens}),h=i.EG.RetrievalIndexCreated}else c.onFileUploaded(e,s,d.imageDimensions);null!=b&&a.Z.postRetrievalTiming({e2eLatencyMs:performance.now()-b,type:"file"})}catch(a){P(r,t.name,a);let i="NotInstanceOfError";a instanceof s.gK?i=a.name:a instanceof s.Q0?i="FatalServerError_type_".concat(null!==(g=a.type)&&void 0!==g?g:"undefined"):a instanceof Error?i=a.name:a instanceof s.vq&&(i=a.name),c.onError(e,"error",i,n,h)}}async function j(e,t,r,n,d,u,g){let h=performance.now();o.A.logEvent(l.M.uploadFileInitiated,{client:"web",useCase:r.kind,contextConnector:d.contextConnector,fileSourceType:d.type});let b=i.EG.Initial;r.kind===i.Ei.Gizmo&&(r=v(v({},r),{},{kind:n.includes(t.type)?i.Ei.Multimodal:i.Ei.MyFiles}));try{let n=await a.Z.uploadConnectorAPI(e,d.contextConnector,r,t,u,d.o365DriveId);switch(n.type){case"error":throw function(e){let{status_code:t,error_code:r,error_message:n}=e;if(!t||!(t<500))return new s.Q0(n);{let e="internal_error";return r?e=r:404===t?e="file_not_found":403===t?e="permission_error":413===t&&(e="file_too_large"),new s.vq(n,e)}}(n.error);case"file":switch(p.MP.onFileCreated(e,n.file.id,"",d.contextConnector),b=i.EG.FileProcessed,r.kind){case i.Ei.MyFiles:{p.MP.onFileUploadProgress(e,90);let t=await k(n.file.file_id,u);(null==t?void 0:t.status)===i.Xf.Skipped&&f.m.danger(g.formatMessage(M.retrievalSkippedFile,{fileName:t.name}),y),p.MP.onFileUploaded(e,n.file.file_id,void 0,{fileTokenSize:t.file_size_tokens,mimeType:n.file.mime_type}),b=i.EG.RetrievalIndexCreated;break}case i.Ei.Multimodal:p.MP.onFileUploaded(e,n.file.file_id,{width:512,height:512},{mimeType:n.file.mime_type});break;case i.Ei.AceUpload:p.MP.onFileUploaded(e,n.file.file_id,void 0,{mimeType:n.file.mime_type});break;case i.Ei.DalleAgent:case i.Ei.Gizmo:case i.Ei.ProfilePicture:throw new s.vq("Use case not supported by cloud doc: ".concat(r.kind))}break;case"folder":throw new s.vq("Folder type not supported")}a.Z.postRetrievalTiming({e2eLatencyMs:performance.now()-h,type:d.contextConnector})}catch(n){c.U.addError(Error("Failed to upload connected file by ".concat(d.contextConnector),{cause:n})),P(g,(0,m.Ad)(t.name,null==d?void 0:d.syntheticExtension),n);let r="NotInstanceOfError";if(n instanceof s.Q0){var x;r="FatalServerError_type_".concat(null!==(x=n.type)&&void 0!==x?x:"undefined")}else(n instanceof s.gK||n instanceof Error||n instanceof s.vq)&&(r=n.name);p.MP.onError(e,"error",r,{kind:i.Ei.MyFiles},b)}}async function w(e,t,r,n,i){let{width:a,height:s}=await b(t);return x(e,t,r,{kind:n},i,{imageDimensions:{width:a,height:s}})}async function k(e,t){let r=Date.now()+6e4,n=e=>new Promise(t=>setTimeout(t,e)),o=0;for(;Date.now()<r;){let r=await a.Z.getRetrievalStatus(e,t);if(r.status===i.Xf.Success||r.status===i.Xf.Skipped)return r;if(r.status===i.Xf.Failed)throw new s.vq("Context extraction failed",r.error_code);o++,await n(Math.min(1e3,100*o))}throw new s.vq("Retrieval indexing timed out")}async function I(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="Unknown error";try{n=await e.data}catch(e){}throw r&&a.Z.markFileUploadFailed(t,{error:n}),new s.vq("File upload to blobstore failed","failed_upload_to_blobstore")}function P(e,t,r){let n=(0,m.kr)(e,"default_upload_error",{fileName:t});r instanceof s.vq&&null!=r.code&&(n=(0,m.kr)(e,r.code)),f.m.danger(n,y)}let M=(0,d.vU)({retrievalSkippedFile:{id:"useFilePickerState.retrievalSkippedFile",defaultMessage:'Unable to extract text from "{fileName}"'}})},47246:function(e,t,r){"use strict";r.d(t,{Dw:function(){return x},HR:function(){return b},MP:function(){return j},gF:function(){return h}});var n=r(97410),i=r(34608),a=r(99140),s=r(66943),o=r(7569),l=r(68306),c=r(68810),d=r(31161),u=r(76126),f=r(20151),p=r(2744),m=r(11655);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let y={files:[],connectorFileData:{}},h=(0,c.Ue)(()=>y),b={hasUploadInProgress:e=>{let{files:t}=e;return t.some(e=>e.status===f.XX.Uploading)},getReadyFiles:e=>{let{files:t}=e;return t.filter(e=>e.status===f.XX.Ready)}},x={reset:()=>{h.setState(y)},uploadFile:async function(e,t,r,n,l){let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},g=arguments.length>6?arguments[6]:void 0,v=arguments.length>7?arguments[7]:void 0,{gizmoId:y}=c,b=h.getState().files,x=(0,m.xs)(r,t.name,t.type,null==v?void 0:v.contextConnector,g),k={tempId:e,gizmoId:c.gizmoId,status:f.XX.Uploading,file:t,progress:1,fileId:null,cdnUrl:null,contextConnectorInfo:v,contextConnector:null==v?void 0:v.contextConnector};if(b.length===u.dO)a.A.logEvent(s.M.uploadedMaxFilesError),d.m.danger(l.formatMessage(w.maxUploadsAtATime,{maxUploads:u.dO,fileName:t.name}),u.$e);else if(b.some(t=>t.tempId===e))a.A.logEvent(s.M.uploadedDuplicateFileError),d.m.danger(l.formatMessage(w.duplicateFileAttached,{fileName:t.name.length>20?t.name.slice(0,19)+"â€¦":t.name}),u.$e);else{let r;h.setState(e=>{let{files:t}=e;return{files:[...t,k]}});let a={};if(n.includes(t.type)){if(r={kind:i.Ei.Multimodal},!v){let{width:e,height:r}=await (0,p.po)(t);if(e>2048||r>2048)try{let n=await (0,m.Tu)(t,2048),i=await (0,p.po)(n);e=i.width,r=i.height,t=n}catch(e){o.U.addError(Error("Error resizing image:",{cause:e}))}a.imageDimensions={width:e,height:r}}}else switch(x){case f.AJ.Multimodal:throw Error("Multimodal file upload not supported mime type, ".concat(t.type,"\nSupported mime types: ")+n.join(", "));case f.AJ.Interpreter:r={kind:i.Ei.AceUpload};break;case f.AJ.Retrieval:r={kind:i.Ei.MyFiles},a.usesRetrievalIndex=!0;break;case f.AJ.ProfilePicture:throw Error("cannot upload profile picture via uploadFile");case f.AJ.ContextConnector:case f.AJ.None:return}null!=y&&(r={kind:i.Ei.Gizmo,gizmoId:y}),c.skipUpload||(v?await (0,p.R3)(e,t,r,n,v,c.gizmoId,l):await (0,p.cT)(e,t,l,r,j,a))}},createFileCompleted:(e,t,r,n)=>{let i=h.getState().files,a=i.findIndex(t=>t.tempId===e),s=i[a];if(a>=0&&s.status===f.XX.Uploading){let e=[...i];e.splice(a,1,v(v({},s),{},{progress:10,fileId:t,cdnUrl:r,contextConnector:n})),h.setState({files:e})}},updateProgress:(e,t)=>{let r=h.getState().files,n=r.findIndex(t=>t.tempId===e),i=r[n];if(n>=0&&i.status===f.XX.Uploading){let e=[...r];e.splice(n,1,v(v({},i),{},{progress:t})),h.setState({files:e})}},uploadCompleted:(e,t,r,n,i)=>{let o=h.getState().files,l=o.findIndex(t=>t.tempId===e);if(l>=0&&o[l].status===f.XX.Uploading&&null!=o[l].fileId){var c,d,u;let t=o[l],p=[...o],g=v(v({},t),{},{tempId:e,status:f.XX.Ready,progress:100,fileSpec:v(v({name:t.file.name,id:t.fileId,size:t.file.size,contextConnectorInfo:t.contextConnectorInfo,mimeType:null!==(c=null!==(d=null==n?void 0:n.mimeType)&&void 0!==d?d:t.file.type)&&void 0!==c?c:(0,m.s1)(t.file.name)},r||{}),n||{})});p.splice(l,1,g);let y=v({},h.getState().connectorFileData);i&&(y[null==i?void 0:i.file_id]=i),h.setState({files:p,connectorFileData:y}),a.A.logEvent(s.M.uploadFileCompleted,{status:t.status,fileId:t.fileId,contextConnector:null!==(u=t.contextConnector)&&void 0!==u?u:"local"})}},remove:(e,t,r,n,i)=>{let o=h.getState().files,l=o.findIndex(t=>t.tempId===e);if(l>=0){let e=o[l];"error"===t?a.A.logEvent(s.M.uploadFileError,{status:e.status,fileId:e.fileId,client:"web",errorClassName:null!=r?r:"undefined",useCaseType:n,uploadStatus:null!=i?i:"undefined",contextConnector:e.contextConnector}):a.A.logEvent(s.M.removeFile,{status:e.status,fileId:e.fileId});let c=[...o];c.splice(l,1),h.setState({files:c})}}},j={onFileCreated:x.createFileCompleted,onFileUploadProgress:x.updateProgress,onFileUploaded:x.uploadCompleted,onError:x.remove},w=(0,l.vU)({maxUploadsAtATime:{id:"useFilePickerState.maxUploadsAtATime",defaultMessage:"Unable to upload {fileName}. Max {maxUploads} uploads at a time"},duplicateFileAttached:{id:"useFilePickerState.duplicateFileAttached",defaultMessage:"Unable to upload {fileName} because an identical file has already been attached to this message."}})},31245:function(e,t,r){"use strict";r.d(t,{J:function(){return i},N:function(){return a}});var n=r(68810);let i={label:"Auto",value:""},a=(0,n.Ue)(()=>({forceParagen:!1,forceParagenModel:i,forceNulligen:!1,forceIndepthFeedback:!1,forceIndepthFeedbackPrompt:"The user has opted in to provide additional feedback on the previous response. Encourage the user to share feedback that you can store in a memory to better meet their needs in future. Use no more than 3 turns. If at any point the user indicates no longer wanting to provide feedback, return to the original topic.",forceRateLimit:!1,resetRateLimits:!1,showDebugConversationTurns:!1,rebaseSystemMessageContent:null}))},27328:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return r(74951)}])}},function(e){e.O(0,[2205,4198,9169,4089,5182,7751,5592,8500,1612,3183,2349,3300,7664,737,3280,6879,1894,646,3738,1148,5074,7768,2888,9774,179],function(){return e(e.s=27328)}),_N_E=e.O()}]);
//# sourceMappingURL=admin-2a61ab8d28184ba7.js.map