(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9457],{82920:function(e,t){"use strict";t.ZP=function(e,t){if(t)return e;throw Error("Unhandled discriminated union member: "+JSON.stringify(e))}},75286:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return E},default:function(){return L}});var n=s(82823),r=s(21904),i=s(85734),l=s(5443),o=s(49217),a=s(52868),c=s(83252),d=s(89987),u=s(88454),m=s(56029),f=s(2933),x=s(14816),g=s(48580),j=s(43128),h=s(92379),y=s(25940),p=s(72256),b=s(67165),v=s(66246),w=s(651);let z=e=>{let{gizmoId:t,limit:s,cursor:n}=e;return(0,x.a)({queryFn:async()=>m.U.listVersions({gizmoId:t}),queryKey:["gizmo","versions",{gizmoId:t,limit:s,cursor:n}]})},N=(0,h.memo)(function(e){let{gizmoId:t,onSelectVersion:s}=e,{value:n}=(0,g.sB)("chatgpt-gizmo-version-history");return t&&n?(0,w.jsx)(k,{gizmoId:t,onSelectVersion:s}):null});function k(e){let{gizmoId:t,onSelectVersion:s}=e,n=(0,j.useRouter)(),{data:r}=z({gizmoId:t}),i=r?r.items.reduce((e,t)=>{let s=new Date(t.updated_at),n="".concat(s.getFullYear(),"-").concat(s.getMonth()+1,"-").concat(s.getDate());return e[n]||(e[n]=[]),e[n].push(t),e},{}):null,l=e=>{n.push("/g/".concat(t,"/view?version=").concat(e))};return i?(0,w.jsx)("div",{className:"relative h-full w-screen max-w-2xs",children:(0,w.jsx)("div",{className:"flex h-full max-w-2xs flex-col overflow-y-scroll bg-token-sidebar-surface-primary py-6 shadow-xl",children:(0,w.jsx)("div",{className:"relative flex-1 px-4 sm:px-6",children:Object.keys(i).map((e,t)=>{let n=i[e];return(0,w.jsx)(_,{date:e,entries:n,onSelectVersion:s,onRestoreVersion:l},t)})})})}):null}function _(e){let{date:t,entries:s,onSelectVersion:n,onRestoreVersion:r}=e;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"border-b border-token-border-medium py-2 font-semibold uppercase text-token-text-secondary",children:(0,w.jsx)(y.Ji,{value:t,dateStyle:"medium"})}),(0,w.jsx)("div",{className:"flex flex-col space-y-2",children:s.map((e,t)=>(0,w.jsxs)("div",{className:"flex flex-row items-center justify-between border-b border-token-border-medium",onClick:()=>n(e.version),children:[(0,w.jsx)("span",{className:"grow p-2 hover:cursor-pointer hover:bg-token-sidebar-surface-tertiary",children:(0,w.jsx)(y.Ji,{value:e.updated_at,timeStyle:"short"})}),(0,w.jsx)(O,{onRestoreVersion:()=>{r(e.version)}})]},t))})]})}function O(e){let{onRestoreVersion:t}=e;return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(b.d,{sideOffset:8,triggerButton:(0,w.jsx)("button",{color:"secondary",className:"rounded-lg px-3 py-2 text-token-text-primary duration-100 ease-in hover:bg-token-sidebar-surface-tertiary active:scale-[0.9]",children:(0,w.jsx)(v.nWS,{className:"icon-md"})}),children:(0,w.jsxs)(b.Z.Item,{className:"items-center",disabled:!1,onClick:t,children:[(0,w.jsx)(v.Ezi,{className:"icon-md"}),(0,w.jsx)(p.Z,{id:"gizmoVersionHistory.restoreVersionLabel",defaultMessage:"Restore this version"})]})})})}var Z=s(27860),C=s(61888);let M=e=>{let{gizmoId:t,version:s}=e;return(0,x.a)({queryFn:async()=>m.U.getVersion({gizmoId:t,version:s}),queryKey:["gizmo","version",{gizmoId:t,version:s}]})},I=(e,t)=>"/gpts/editor/".concat(e,"?version=").concat(t);function P(e){var t;let{gizmoId:s}=e,{0:l,1:o}=(0,h.useState)(null),a=(0,j.useRouter)(),{data:c}=(0,n.b9)(s),d=null==c||null===(t=c.gizmo.current_user_permission)||void 0===t?void 0:t.can_write,u=(0,n.YR)(),{0:m,1:x}=(0,h.useState)(!1),g=()=>{l?a.push(I(s,l)):a.push((0,Z.AA)(s))};return(0,w.jsxs)("div",{className:"flex h-screen w-full flex-col items-center",children:[(0,w.jsx)("div",{className:"relative flex h-16 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",children:c&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{className:"flex cursor-pointer items-center gap-2",onClick:()=>a.back(),children:[(0,w.jsx)(v.Y1T,{className:"icon-lg"}),(0,w.jsx)("div",{className:"font-semibold",children:d?(0,w.jsx)(p.Z,{id:"gizmoReadOnly.versionHistoryTitle",defaultMessage:"Version History"}):(0,w.jsx)(p.Z,{id:"gizmoReadOnly.configurationTitle",defaultMessage:"Configuration"})})]}),(0,w.jsx)("div",{className:"mr-4 flex items-center gap-2",children:d?(0,w.jsx)(f.cY,{color:"secondary",onClick:()=>{l&&l!==c.gizmo.live_version&&c.tools.find(e=>{var t;return e.type===r.qK.JIT_PLUGIN&&(null===(t=e.metadata.auth)||void 0===t?void 0:t.type)!==i.Jv.None})?x(!0):g()},children:(0,w.jsx)(p.Z,{id:"gizmo.readonly.restoreVersion",defaultMessage:"Restore this version"})}):(0,w.jsx)(f.cY,{color:"secondary",loading:u.isPending,onClick:async()=>{let e=await u.mutateAsync({gizmoId:s});e.gizmo.id&&a.push("/gpts/editor/".concat(e.gizmo.id))},children:(0,w.jsx)(p.Z,{id:"gizmo.readonly.duplicate",defaultMessage:"Duplicate"})})})]})}),(0,w.jsxs)("div",{className:"flex h-full w-full items-center",children:[d&&(0,w.jsx)(N,{gizmoId:s,onSelectVersion:e=>{o(e)}}),(0,w.jsx)(S,{gizmoId:s,version:l})]}),m&&(0,w.jsx)(R,{onClose:()=>{x(!1)},onContinue:g})]})}function R(e){let{onClose:t,onContinue:s}=e,{0:n,1:r}=(0,h.useState)(!1);return(0,w.jsx)(o.Z,{isOpen:!0,onClose:t,type:"warning",showCloseButton:!0,title:(0,w.jsx)(p.Z,{id:"gizmoReadOnly.authModalWarningTitle",defaultMessage:"Reset Authentication for Custom Actions"}),primaryButton:(0,w.jsx)(l.z,{onClick:()=>{r(!0),s()},loading:n,color:"secondary",children:(0,w.jsx)(p.Z,{id:"gizmoReadOnly.authModalContinueButton",defaultMessage:"Continue"})}),secondaryButton:(0,w.jsx)(l.z,{onClick:t,color:"secondary",children:(0,w.jsx)(p.Z,{id:"gizmoReadOnly.authModalCancelButton",defaultMessage:"Cancel"})}),size:"normal",children:(0,w.jsx)(p.Z,{id:"gizmoReadOnly.authModalWarningBody",defaultMessage:"Restoring this version will reset authentication of your custom actions. You may need to reconfigure each custom action afterwards."})})}function S(e){var t,s,n,i;let{gizmoId:l,version:o}=e,{data:m}=M({gizmoId:l,version:o}),{0:f,1:x}=(0,h.useState)(null);if(!m)return null;let g=m.tools.filter(e=>e.type===r.qK.JIT_PLUGIN);return(0,w.jsx)("div",{className:"flex max-h-[80vh] flex-grow justify-center overflow-y-auto",children:(0,w.jsxs)("div",{className:"flex w-full max-w-2xl flex-col text-sm",children:[(0,w.jsx)(d.hj,{className:"self-center",children:(0,w.jsx)(c.Z,{src:m.gizmo.display.profile_picture_url,isFirstParty:!1,className:"h-12 w-12"})}),(0,w.jsxs)(d.hj,{children:[(0,w.jsx)(d.lX,{label:(0,w.jsx)(p.Z,{id:"gizmo.readonly.nameLabel",defaultMessage:"Name"})}),(0,w.jsx)(d.yt,{type:"text",value:null!==(t=m.gizmo.display.name)&&void 0!==t?t:"",disabled:!0,className:"bg-token-main-surface-secondary"})]}),(0,w.jsxs)(d.hj,{children:[(0,w.jsx)(d.lX,{label:(0,w.jsx)(p.Z,{id:"gizmo.readonly.descriptionLabel",defaultMessage:"Description"})}),(0,w.jsx)(d.yt,{type:"text",value:null!==(s=m.gizmo.display.description)&&void 0!==s?s:"",disabled:!0,className:"bg-token-main-surface-secondary"})]}),(0,w.jsxs)(d.hj,{children:[(0,w.jsx)(d.lX,{label:(0,w.jsx)(p.Z,{id:"gizmo.readonly.instructionsLabel",defaultMessage:"Instructions"})}),(0,w.jsx)(d.B1,{className:"resize-none bg-token-main-surface-secondary",rows:8,value:null!==(n=m.gizmo.instructions)&&void 0!==n?n:"",disabled:!0})]}),m.gizmo.display.prompt_starters&&m.gizmo.display.prompt_starters.length>0&&(0,w.jsxs)(d.hj,{children:[(0,w.jsx)(d.lX,{label:(0,w.jsx)(p.Z,{id:"gizmo.readonly.conversationStartersLabel",defaultMessage:"Conversation starters"})}),m.gizmo.display.prompt_starters.map((e,t)=>(0,w.jsx)(d.yt,{type:"text",value:e,disabled:!0,className:"resize-none bg-token-main-surface-secondary"},t))]}),m.files&&m.files.length>0&&(0,w.jsxs)(d.hj,{children:[(0,w.jsx)(d.lX,{label:(0,w.jsx)(p.Z,{id:"gizmo.readonly.knowledgeLabel",defaultMessage:"Knowledge"})}),m.files.map((e,t)=>(0,w.jsx)(a.Z,{file:e.name,fileId:e.id},t))]}),(0,w.jsxs)(d.hj,{children:[(0,w.jsx)(d.lX,{label:(0,w.jsx)(p.Z,{id:"gizmo.readonly.capabilitiesLabel",defaultMessage:"Capabilities"})}),(0,w.jsx)(u.W,{enabledTools:m.tools,onEnabledToolsChange:C.noop})]}),g&&g.length>0&&(0,w.jsxs)(d.hj,{children:[(0,w.jsx)(d.lX,{label:(0,w.jsx)(p.Z,{id:"gizmo.readonly.actionsLabel",defaultMessage:"Actions"})}),g.map((e,t)=>(0,w.jsx)(d.r,{isDisabled:!1,actionTool:e,onShowActionsEditor:()=>{(null==f?void 0:f.metadata.action_id)===e.metadata.action_id?x(null):x(e)}},t)),f&&(0,w.jsx)("textarea",{readOnly:!0,value:null!==(i=f.metadata.raw_spec)&&void 0!==i?i:"",className:"mb-16 block h-96 w-full border-t-0 border-token-main-surface-tertiary bg-transparent p-2 font-mono text-xs text-token-text-primary"})]})]})})}var T=s(4702),E=!0;function L(){var e,t;let s=(0,T.t)(),r=(0,j.useRouter)(),i=null!==(e=null===(t=r.query)||void 0===t?void 0:t.gizmoId)&&void 0!==e?e:"",l=(0,n.CR)(i),{value:o}=(0,g.sB)("chatgpt-gizmo-version-history");return(0,h.useEffect)(()=>{null!=s&&s.isFree()&&r.push("/")},[s,r]),o?(0,w.jsx)(P,{gizmoId:l}):null}},81816:function(e,t,s){"use strict";s.d(t,{C:function(){return r}});var n=s(4702);function r(e){var t,s;let r=(0,n.hz)();return!(null===(t=(0,n.t)())||void 0===t?void 0:t.isWorkspaceAccount())||null!==(s=null==r?void 0:r.includes(e))&&void 0!==s&&s}},5994:function(e,t,s){"use strict";s.d(t,{Dd:function(){return n},L5:function(){return i},P_:function(){return o},aI:function(){return l},vi:function(){return a},zf:function(){return r}});let n="ChatGPT",r="Untitled",i=10,l=50,o=300,a=8e3},2933:function(e,t,s){"use strict";s.d(t,{QT:function(){return y},Xb:function(){return v},cY:function(){return b},f8:function(){return w},y4:function(){return p}});var n,r=s(17379),i=s(94521),l=s(41141),o=s(71840),a=s(98131),c=s(19841),d=s(92379),u=s(74091),m=s(5443),f=s(62484),x=s(651);let g=["tooltip","className"];function j(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,n)}return s}function h(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?j(Object(s),!0).forEach(function(t){(0,i.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):j(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let y=u.Z.div(n||(n=(0,l.Z)(["sticky top-0 juice:p-3 mb-1.5 flex items-center justify-between z-10 h-14 p-2 font-semibold bg-token-main-surface-primary"])));function p(e){let t=(0,x.jsx)(m.z,h(h({color:"secondary",size:"small"},e),{},{className:(0,c.default)("flex items-center justify-center whitespace-nowrap",e.className)}));return null!=e.label?(0,x.jsx)(f.u,{side:"left",label:e.label,className:"h-fit w-fit",children:t}):t}let b=(0,d.forwardRef)(function(e,t){var s;let{tooltip:n,className:i}=e,l=(0,r.Z)(e,g),o=(0,x.jsx)(m.z,h(h({color:null!==(s=e.color)&&void 0!==s?s:"secondary",size:"medium"},l),{},{className:i,ref:t}));return null!=n?(0,x.jsx)(f.u,{label:n,children:o}):o});function v(e){let{label:t,disabled:s=!1,tooltipText:n,value:r}=e,i=(0,d.useId)();return(0,x.jsx)("div",{className:(0,c.default)("flex items-center gap-2",s?"opacity-50":""),children:(0,x.jsx)(f.E,{disabled:null==n,label:n,side:"right",children:(0,x.jsxs)("label",{htmlFor:i,className:"flex cursor-pointer items-center gap-1",children:[(0,x.jsx)(a.ck,{id:i,value:r,disabled:s,className:"mr-1 flex h-5 w-5 shrink-0 items-center justify-center rounded-full border border-gray-500 bg-white dark:border-gray-600 dark:bg-gray-700",children:(0,x.jsx)(a.z$,{className:"h-2 w-2 rounded-full bg-gray-950 dark:bg-white"})}),t]})})})}function w(e){return(0,x.jsx)(o.Z,h(h({},e),{},{className:(0,c.default)("!rounded border-gray-950 checked:!bg-black dark:border-gray-600 dark:bg-gray-700",e.className)}))}},72465:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/g/[gizmoId]/view",function(){return s(75286)}])}},function(e){e.O(0,[6271,2349,1783,4834,5165,6992,8798,9987,2888,9774,179],function(){return e(e.s=72465)}),_N_E=e.O()}]);
//# sourceMappingURL=view-567dc775b788ced5.js.map