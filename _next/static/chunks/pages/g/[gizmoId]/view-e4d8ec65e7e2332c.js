(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9457],{18939:function(e){e.exports=function(e){for(var t=-1,s=null==e?0:e.length,n=0,r=[];++t<s;){var l=e[t];l&&(r[n++]=l)}return r}},75286:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return V},default:function(){return A}});var n=s(82823),r=s(21904),l=s(85734),i=s(5443),o=s(49217),a=s(52868),c=s(83252),d=s(89987),u=s(88454),m=s(56029),f=s(2933),x=s(14816),g=s(48580),h=s(43128),p=s(92379),j=s(68306),v=s(62984),y=s(67165),b=s(73600),z=s(651);let w=e=>{let{gizmoId:t,limit:s,cursor:n}=e;return(0,x.a)({queryFn:async()=>m.U.listVersions({gizmoId:t}),queryKey:["gizmo","versions",{gizmoId:t,limit:s,cursor:n}]})},N=(0,p.memo)(function(e){let{gizmoId:t,onSelectVersion:s}=e,{value:n}=(0,g.sB)("chatgpt-gizmo-version-history");return t&&n?(0,z.jsx)(_,{gizmoId:t,onSelectVersion:s}):null});function _(e){let{gizmoId:t,onSelectVersion:s}=e,n=(0,h.useRouter)(),{data:r}=w({gizmoId:t}),l=r?r.items.reduce((e,t)=>{let s=new Date(t.updated_at),n="".concat(s.getFullYear(),"-").concat(s.getMonth()+1,"-").concat(s.getDate());return e[n]||(e[n]=[]),e[n].push(t),e},{}):null,i=e=>{n.push("/g/".concat(t,"/view?version=").concat(e))};return l?(0,z.jsx)("div",{className:"relative h-full w-screen max-w-2xs",children:(0,z.jsx)("div",{className:"flex h-full max-w-2xs flex-col overflow-y-scroll bg-token-sidebar-surface-primary py-6 shadow-xl",children:(0,z.jsx)("div",{className:"relative flex-1 px-4 sm:px-6",children:Object.keys(l).map((e,t)=>{let n=l[e];return(0,z.jsx)(k,{date:e,entries:n,onSelectVersion:s,onRestoreVersion:i},t)})})})}):null}function k(e){let{date:t,entries:s,onSelectVersion:n,onRestoreVersion:r}=e;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"border-b border-token-border-medium py-2 font-semibold uppercase text-token-text-secondary",children:(0,z.jsx)(j.Ji,{value:t,dateStyle:"medium"})}),(0,z.jsx)("div",{className:"flex flex-col space-y-2",children:s.map((e,t)=>(0,z.jsxs)("div",{className:"flex flex-row items-center justify-between border-b border-token-border-medium",onClick:()=>n(e.version),children:[(0,z.jsx)("span",{className:"grow p-2 hover:cursor-pointer hover:bg-token-sidebar-surface-tertiary",children:(0,z.jsx)(j.Ji,{value:e.updated_at,timeStyle:"short"})}),(0,z.jsx)(M,{onRestoreVersion:()=>{r(e.version)}})]},t))})]})}function M(e){let{onRestoreVersion:t}=e;return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(y.d,{sideOffset:8,triggerButton:(0,z.jsx)("button",{color:"secondary",className:"rounded-lg px-3 py-2 text-token-text-primary duration-100 ease-in hover:bg-token-sidebar-surface-tertiary active:scale-[0.9]",children:(0,z.jsx)(b.nWS,{className:"icon-md"})}),children:(0,z.jsxs)(y.Z.Item,{className:"items-center",disabled:!1,onClick:t,children:[(0,z.jsx)(b.Ezi,{className:"icon-md"}),(0,z.jsx)(v.Z,{id:"gizmoVersionHistory.restoreVersionLabel",defaultMessage:"Restore this version"})]})})})}var C=s(27860),R=s(91530),Z=s.n(R);let S=e=>{let{gizmoId:t,version:s}=e;return(0,x.a)({queryFn:async()=>m.U.getVersion({gizmoId:t,version:s}),queryKey:["gizmo","version",{gizmoId:t,version:s}]})},I=(e,t)=>"/gpts/editor/".concat(e,"?version=").concat(t);function O(e){var t;let{gizmoId:s}=e,{0:i,1:o}=(0,p.useState)(null),a=(0,h.useRouter)(),{data:c}=(0,n.b9)(s),d=null==c||null===(t=c.gizmo.current_user_permission)||void 0===t?void 0:t.can_write,u=(0,n.YR)(),{0:m,1:x}=(0,p.useState)(!1),g=()=>{i?a.push(I(s,i)):a.push((0,C.AA)(s))};return(0,z.jsxs)("div",{className:"flex h-screen w-full flex-col items-center",children:[(0,z.jsx)("div",{className:"relative flex h-16 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",children:c&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex cursor-pointer items-center gap-2",onClick:()=>a.back(),children:[(0,z.jsx)(b.Y1T,{className:"icon-lg"}),(0,z.jsx)("div",{className:"font-semibold",children:d?(0,z.jsx)(v.Z,{id:"gizmoReadOnly.versionHistoryTitle",defaultMessage:"Version History"}):(0,z.jsx)(v.Z,{id:"gizmoReadOnly.configurationTitle",defaultMessage:"Configuration"})})]}),(0,z.jsx)("div",{className:"mr-4 flex items-center gap-2",children:d?(0,z.jsx)(f.cY,{color:"secondary",onClick:()=>{i&&i!==c.gizmo.live_version&&c.tools.find(e=>{var t;return e.type===r.qK.JIT_PLUGIN&&(null===(t=e.metadata.auth)||void 0===t?void 0:t.type)!==l.Jv.None})?x(!0):g()},children:(0,z.jsx)(v.Z,{id:"gizmo.readonly.restoreVersion",defaultMessage:"Restore this version"})}):(0,z.jsx)(f.cY,{color:"secondary",loading:u.isPending,onClick:async()=>{let e=await u.mutateAsync({gizmoId:s});e.gizmo.id&&a.push("/gpts/editor/".concat(e.gizmo.id))},children:(0,z.jsx)(v.Z,{id:"gizmo.readonly.duplicate",defaultMessage:"Duplicate"})})})]})}),(0,z.jsxs)("div",{className:"flex h-full w-full items-center",children:[d&&(0,z.jsx)(N,{gizmoId:s,onSelectVersion:e=>{o(e)}}),(0,z.jsx)(B,{gizmoId:s,version:i})]}),m&&(0,z.jsx)(E,{onClose:()=>{x(!1)},onContinue:g})]})}function E(e){let{onClose:t,onContinue:s}=e,{0:n,1:r}=(0,p.useState)(!1);return(0,z.jsx)(o.Z,{isOpen:!0,onClose:t,type:"warning",showCloseButton:!0,title:(0,z.jsx)(v.Z,{id:"gizmoReadOnly.authModalWarningTitle",defaultMessage:"Reset Authentication for Custom Actions"}),primaryButton:(0,z.jsx)(i.z,{onClick:()=>{r(!0),s()},loading:n,color:"secondary",children:(0,z.jsx)(v.Z,{id:"gizmoReadOnly.authModalContinueButton",defaultMessage:"Continue"})}),secondaryButton:(0,z.jsx)(i.z,{onClick:t,color:"secondary",children:(0,z.jsx)(v.Z,{id:"gizmoReadOnly.authModalCancelButton",defaultMessage:"Cancel"})}),size:"normal",children:(0,z.jsx)(v.Z,{id:"gizmoReadOnly.authModalWarningBody",defaultMessage:"Restoring this version will reset authentication of your custom actions. You may need to reconfigure each custom action afterwards."})})}function B(e){var t,s,n,l;let{gizmoId:i,version:o}=e,{data:m}=S({gizmoId:i,version:o}),{0:f,1:x}=(0,p.useState)(null);if(!m)return null;let g=m.tools.filter(e=>e.type===r.qK.JIT_PLUGIN);return(0,z.jsx)("div",{className:"flex max-h-[80vh] flex-grow justify-center overflow-y-auto",children:(0,z.jsxs)("div",{className:"flex w-full max-w-2xl flex-col text-sm",children:[(0,z.jsx)(d.hj,{className:"self-center",children:(0,z.jsx)(c.Z,{src:m.gizmo.display.profile_picture_url,isFirstParty:!1,className:"h-12 w-12"})}),(0,z.jsxs)(d.hj,{children:[(0,z.jsx)(d.lX,{label:(0,z.jsx)(v.Z,{id:"gizmo.readonly.nameLabel",defaultMessage:"Name"})}),(0,z.jsx)(d.yt,{type:"text",value:null!==(t=m.gizmo.display.name)&&void 0!==t?t:"",disabled:!0,className:"bg-token-main-surface-secondary"})]}),(0,z.jsxs)(d.hj,{children:[(0,z.jsx)(d.lX,{label:(0,z.jsx)(v.Z,{id:"gizmo.readonly.descriptionLabel",defaultMessage:"Description"})}),(0,z.jsx)(d.yt,{type:"text",value:null!==(s=m.gizmo.display.description)&&void 0!==s?s:"",disabled:!0,className:"bg-token-main-surface-secondary"})]}),(0,z.jsxs)(d.hj,{children:[(0,z.jsx)(d.lX,{label:(0,z.jsx)(v.Z,{id:"gizmo.readonly.instructionsLabel",defaultMessage:"Instructions"})}),(0,z.jsx)(d.B1,{className:"resize-none bg-token-main-surface-secondary",rows:8,value:null!==(n=m.gizmo.instructions)&&void 0!==n?n:"",disabled:!0})]}),m.gizmo.display.prompt_starters&&m.gizmo.display.prompt_starters.length>0&&(0,z.jsxs)(d.hj,{children:[(0,z.jsx)(d.lX,{label:(0,z.jsx)(v.Z,{id:"gizmo.readonly.conversationStartersLabel",defaultMessage:"Conversation starters"})}),m.gizmo.display.prompt_starters.map((e,t)=>(0,z.jsx)(d.yt,{type:"text",value:e,disabled:!0,className:"resize-none bg-token-main-surface-secondary"},t))]}),m.files&&m.files.length>0&&(0,z.jsxs)(d.hj,{children:[(0,z.jsx)(d.lX,{label:(0,z.jsx)(v.Z,{id:"gizmo.readonly.knowledgeLabel",defaultMessage:"Knowledge"})}),m.files.map((e,t)=>(0,z.jsx)(a.Z,{file:e.name,fileId:e.id},t))]}),(0,z.jsxs)(d.hj,{children:[(0,z.jsx)(d.lX,{label:(0,z.jsx)(v.Z,{id:"gizmo.readonly.capabilitiesLabel",defaultMessage:"Capabilities"})}),(0,z.jsx)(u.W,{enabledTools:m.tools,onEnabledToolsChange:Z()})]}),g&&g.length>0&&(0,z.jsxs)(d.hj,{children:[(0,z.jsx)(d.lX,{label:(0,z.jsx)(v.Z,{id:"gizmo.readonly.actionsLabel",defaultMessage:"Actions"})}),g.map((e,t)=>(0,z.jsx)(d.r,{isDisabled:!1,actionTool:e,onShowActionsEditor:()=>{(null==f?void 0:f.metadata.action_id)===e.metadata.action_id?x(null):x(e)}},t)),f&&(0,z.jsx)("textarea",{readOnly:!0,value:null!==(l=f.metadata.raw_spec)&&void 0!==l?l:"",className:"mb-16 block h-96 w-full border-t-0 border-token-main-surface-tertiary bg-transparent p-2 font-mono text-xs text-token-text-primary"})]})]})})}var T=s(4702),V=!0;function A(){var e,t;let s=(0,T.t)(),r=(0,h.useRouter)(),l=null!==(e=null===(t=r.query)||void 0===t?void 0:t.gizmoId)&&void 0!==e?e:"",i=(0,n.CR)(l),{value:o}=(0,g.sB)("chatgpt-gizmo-version-history");return(0,p.useEffect)(()=>{null!=s&&s.isFree()&&r.push("/")},[s,r]),o?(0,z.jsx)(O,{gizmoId:i}):null}},72465:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/g/[gizmoId]/view",function(){return s(75286)}])},24548:function(e,t,s){"use strict";s.d(t,{B:function(){return o}});var n=s(92379),r=s(31541),l=s(59246),i=s(7186);function o(e){let t=e+"CollectionProvider",[s,o]=(0,r.b)(t),[a,c]=s(t,{collectionRef:{current:null},itemMap:new Map}),d=e+"CollectionSlot",u=n.forwardRef((e,t)=>{let{scope:s,children:r}=e,o=c(d,s),a=(0,l.e)(t,o.collectionRef);return n.createElement(i.g7,{ref:a},r)}),m=e+"CollectionItemSlot",f="data-radix-collection-item";return[{Provider:e=>{let{scope:t,children:s}=e,r=n.useRef(null),l=n.useRef(new Map).current;return n.createElement(a,{scope:t,itemMap:l,collectionRef:r},s)},Slot:u,ItemSlot:n.forwardRef((e,t)=>{let{scope:s,children:r,...o}=e,a=n.useRef(null),d=(0,l.e)(t,a),u=c(m,s);return n.useEffect(()=>(u.itemMap.set(a,{ref:a,...o}),()=>void u.itemMap.delete(a))),n.createElement(i.g7,{[f]:"",ref:d},r)})},function(t){let s=c(e+"CollectionConsumer",t);return n.useCallback(()=>{let e=s.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${f}]`));return Array.from(s.itemMap.values()).sort((e,s)=>t.indexOf(e.ref.current)-t.indexOf(s.ref.current))},[s.collectionRef,s.itemMap])},o]}},26468:function(e,t,s){"use strict";s.d(t,{D:function(){return r}});var n=s(92379);function r(e){let t=(0,n.useRef)({value:e,previous:e});return(0,n.useMemo)(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}}},function(e){e.O(0,[3391,6271,6441,5257,7639,5943,5815,9987,2888,9774,179],function(){return e(e.s=72465)}),_N_E=e.O()}]);
//# sourceMappingURL=view-e4d8ec65e7e2332c.js.map