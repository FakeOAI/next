(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2571],{51516:function(e,t,n){"use strict";function o(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return o}})},25672:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return z},default:function(){return W}});var o,i=n(94521),s=n(70657),r=n(21904),a=n(19841),l=n(71126),d=n.n(l),c=n(92379),u=n(72256),f=n(26123),m=n(25940),p=n(5443),g=n(57548),y=n(66246),v=n(67165),b=n(69482),x=n(23212),h=n(46129),j=n(651);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function w(e){let{onRemoveDomainClick:t,onVerifyDomainClick:n}=e;return(0,j.jsxs)(v.Z.Root,{children:[(0,j.jsx)(v.Z.Trigger,{children:(0,j.jsx)(y.nWS,{className:"icon-sm"})}),(0,j.jsx)(v.Z.Portal,{children:(0,j.jsxs)(v.Z.Content,{children:[(0,j.jsx)(v.Z.Item,{onClick:t,children:(0,j.jsx)(u.Z,M({},T.ssoDropdownRemoveButtonText))}),(0,j.jsx)(v.Z.Item,{onClick:n,children:(0,j.jsx)(u.Z,M({},T.ssoDropdownVerifyButtonText))})]})})]})}function k(e){let{domains:t,workspaceId:n}=e,o=(0,f.Z)(),{mutateAsync:i}=(0,h.Bd)(n),{0:s,1:r}=(0,c.useState)(!1),{0:a,1:l}=(0,c.useState)();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(b.Z.Root,{className:"w-full table-auto",children:[(0,j.jsxs)(b.Z.Header,{children:[(0,j.jsx)(b.Z.HeaderCell,{className:"bg-token-main-surface-primary",children:(0,j.jsx)(u.Z,M({},T.domainTableHeader))}),(0,j.jsx)(b.Z.HeaderCell,{className:"bg-token-main-surface-primary",children:(0,j.jsx)(u.Z,M({},T.statusTableHeader))}),(0,j.jsx)(b.Z.HeaderCell,{className:"bg-token-main-surface-primary"})]}),(0,j.jsx)(b.Z.Body,{children:t.map((e,t)=>(0,j.jsxs)("tr",{onClick:()=>l(e),className:"cursor-pointer",children:[(0,j.jsx)(b.Z.Cell,{children:e.hostname}),(0,j.jsx)(b.Z.Cell,{children:o.formatMessage(h.sd[e.status])}),(0,j.jsx)(b.Z.Cell,{textAlign:"right",children:(0,j.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,j.jsx)(w,{onRemoveDomainClick:()=>{i({domainId:e.id})},onVerifyDomainClick:()=>{l(e)}})})})]},t))})]}),(0,j.jsx)(p.z,{color:"secondary",className:"mt-6",onClick:()=>{r(!0)},icon:y.Vz5,children:(0,j.jsx)(u.Z,M({},T.addDomainButton))}),(0,j.jsx)(x.Z,{isOpen:s||void 0!==a,onClose:()=>{r(!1),l(void 0)},workspaceId:n,currentDomain:s?void 0:a,domains:t},null==a?void 0:a.id)]})}let T=(0,m.vU)({ssoDropdownRemoveButtonText:{id:"workspaceIdentity.ssoDropdownRemoveButtonText",defaultMessage:"Remove Domain"},ssoDropdownVerifyButtonText:{id:"workspaceIdentity.ssoDropdownVerifyButtonText",defaultMessage:"Verify"},domainTableHeader:{id:"workspaceIdentity.domainTableHeader",defaultMessage:"Domain"},statusTableHeader:{id:"workspaceIdentity.statusTableHeader",defaultMessage:"Status"},addDomainButton:{id:"workspaceIdentity.addDomainButton.0",defaultMessage:"Add domain"}});var O=n(38417),S=n(65530),C=n(8649),D=n(49217),Z=n(94982),P=n(93322);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let A=async e=>new Promise((t,n)=>{let o=new FileReader;o.readAsText(e),o.onload=function(e){var n;t(null===(n=e.target)||void 0===n?void 0:n.result)},o.onerror=n});function L(e){let{acsId:t,hasSSO:n}=e,o="https://auth0.openai.com/login/callback?connection=".concat(t),i="urn:auth0:openai:".concat(t),s="".concat(location.host,"/auth/login?sso=true&connection=").concat(t),r=(0,f.Z)();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(P.Li,{children:(0,j.jsx)(u.Z,N({},_.setupSSOContent))}),(0,j.jsxs)("div",{className:"mb-6 flex flex-col space-y-4",children:[(0,j.jsx)(O.Z,{label:"Assertion Consumer Service (ACS) URL",value:o,onCopied:()=>{Z.m.success(r.formatMessage(_.copiedACSToClipboard),{duration:3})}}),(0,j.jsx)(O.Z,{label:"Entity ID",value:i,onCopied:()=>{Z.m.success(r.formatMessage(_.copiedEntityToClipboard),{duration:3})}}),n&&(0,j.jsx)(O.Z,{label:r.formatMessage(_.idpSignInURL),value:s,onCopied:()=>{Z.m.success(r.formatMessage(_.copiedIDPUrlToClipboard),{duration:3})}})]})]})}var B=((o=B||{})[o.CREATE=1]="CREATE",o[o.EDIT=2]="EDIT",o);function R(e){let{workspaceId:t,data:n,isOpen:o,onClose:i}=e,s=(0,f.Z)(),{mutateAsync:r}=(0,h.Fc)(t),{mutateAsync:l}=(0,h.OR)(t),{mutateAsync:d}=(0,h.DD)(t),m=(0,c.useRef)(null),g=null==n?void 0:n.connection,{0:v,1:b}=(0,c.useState)(null==g?void 0:g.sign_in_endpoint),{0:x,1:I}=(0,c.useState)(null==g?void 0:g.cert),M=null===n?B.CREATE:B.EDIT,w=async(e,t)=>{let n=await r({signInEndpoint:e,cert:t});await d({connectionId:n.id,active:!0}),i()},k=M===B.CREATE?(0,j.jsx)(C.Z.Button,{title:s.formatMessage(_.doneButton),color:"primary",disabled:void 0===v||void 0===x,onClick:async()=>{void 0!==v&&void 0!==x&&await w(v,x)}}):n&&(0,j.jsx)(C.Z.Button,{title:s.formatMessage(_.doneButton),color:"primary",onClick:async()=>{await d({connectionId:null==n?void 0:n.id,cert:x,signInEndpoint:v,active:!0}),i()}}),T=null===n?(0,j.jsx)(C.Z.Button,{title:s.formatMessage(_.cancelButton),color:"secondary",onClick:()=>i()}):(0,j.jsx)(p.z,{as:"link",color:"danger-outline",onClick:async()=>{await l({connectionId:null==n?void 0:n.id}),i()},children:s.formatMessage(_.deleteButton)});return(0,j.jsx)(D.Z,{isOpen:o,type:"success",title:s.formatMessage(M===B.CREATE?_.createTitle:_.editTitle),primaryButton:k,secondaryButton:T,onClose:i,children:(0,j.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,j.jsx)(h.z0,{children:(0,j.jsx)(u.Z,N({},_.createInstructionsManual))}),(0,j.jsx)("label",{className:"mb-2 flex items-center text-sm",children:(0,j.jsx)(u.Z,N({},_.signInLabel))}),(0,j.jsx)("div",{className:"mb-4",children:(0,j.jsx)(S.Z,{className:"w-full appearance-none rounded border px-3 py-2",name:"Sign-In URL",type:"text",placeholder:"https://your.idp.here/saml2?idpid=123456",value:null!=v?v:"",onChange:e=>{b(e.target.value)}})}),(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,j.jsx)("label",{className:"text-sm",children:(0,j.jsx)(u.Z,N({},_.certLabel))}),(0,j.jsx)("input",{ref:m,type:"file",accept:".csv,.cer,.pem,text/plain",className:"hidden",onChange:async e=>{var t;null!==(t=e.target.files)&&void 0!==t&&t[0]&&I(await A(e.target.files[0]))}}),(0,j.jsx)(p.z,{color:"secondary",onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.click()},icon:y.aAc})]}),(0,j.jsx)("textarea",{rows:10,className:(0,a.default)("w-full resize-none overflow-y-auto rounded border border-gray-300 px-3 py-2","outline-none focus-within:border-green-600 focus-within:ring-1 focus-within:ring-green-600","text-token-text-primary placeholder-gray-500 dark:bg-gray-700"),placeholder:"-----BEGIN CERTIFICATE-----",value:null!=x?x:"",onChange:e=>{I(e.target.value)}})]})]})})}let _=(0,m.vU)({setupSSOContent:{id:"workspaceIdentity.setupSSOContent",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO."},createInstructionsXML:{id:"ssoModal.createInstructionsXML",defaultMessage:"If your Identity Provider offers a metadata URL or an XML file, add it here for the quickest setup option."},createInstructionsManual:{id:"ssoModal.createInstructionsManual",defaultMessage:"Copy your Sign-in endpoint (SSO URL) and the public X.509 certificate from your Identity Provider."},createTitle:{id:"ssoModal.createTitle",defaultMessage:"Create SAML SSO Configuration"},editTitle:{id:"ssoModal.editTitle",defaultMessage:"Edit SAML SSO Configuration"},ssoMetadataLabel:{id:"ssoModal.ssoMetadataLabel",defaultMessage:"App Federation Metadata URL"},signInLabel:{id:"ssoModal.signInLabel",defaultMessage:"SSO URL"},certLabel:{id:"ssoModal.certLabel",defaultMessage:"X.509 Signing Certificate"},doneButton:{id:"ssoModal.doneButton",defaultMessage:"Done"},nextButton:{id:"ssoModal.nextButton",defaultMessage:"Next"},deleteButton:{id:"ssoModal.deleteButton",defaultMessage:"Delete configuration"},cancelButton:{id:"ssoModal.cancelButton",defaultMessage:"Cancel"},acsURLLabel:{id:"workspaceIdentity.acsURLLabel",defaultMessage:"Assertion Consumer Service (ACS) URL"},entityIDLabel:{id:"workspaceIdentity.entityIDLabel",defaultMessage:"Entity ID"},idpSignInURL:{id:"workspaceIdentity.idpSignInURL",defaultMessage:"IDP Tile URL"},copiedACSToClipboard:{id:"workspaceIdentity.copiedACSToClipboard",defaultMessage:"Copied ACS URL to clipboard"},copiedEntityToClipboard:{id:"workspaceIdentity.copiedEntityToClipboard",defaultMessage:"Copied entity ID to clipboard"},copiedIDPUrlToClipboard:{id:"workspaceIdentity.copiedIDPUrlToClipboard",defaultMessage:"Copied IDP URL to clipboard"},orDivider:{id:"workspaceIdentity.orDivider",defaultMessage:"or"},certExtractFailed:{id:"workspaceIdentity.certExtractFailed",defaultMessage:"Unable to find X.509 Certificate in provided XML"},ssoUrlExtractFailed:{id:"workspaceIdentity.ssoUrlExtractFailed",defaultMessage:"Unable to find Entity ID (sign-in endpoint) in provided XML"},ssoLearnMoreLink:{id:"workspaceIdentity.ssoLearnMoreLink",defaultMessage:"Learn more"}});function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let V=e=>{let{title:t,footer:n,children:o}=e;return(0,j.jsxs)(P.i9,{children:[(0,j.jsx)(P.A4,{children:(0,j.jsx)(u.Z,U({},t))}),(0,j.jsx)("div",{children:o}),(0,j.jsx)(P.Li,{children:n})]})},H=e=>{let{icon:t,title:n,body:o,toggle:i}=e;return(0,j.jsxs)(P.i9,{children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(t,{className:"icon-sm"}),(0,j.jsx)(P.A4,{children:(0,j.jsx)(u.Z,U({},n))})]}),(0,j.jsx)("div",{children:i})]}),(0,j.jsx)(P.Li,{children:o})]})};function X(e){var t,n,o,i;let{currentWorkspaceId:l}=e,m=(0,f.Z)(),{data:v,isLoading:b}=(0,h.f_)(l),{mutateAsync:x}=(0,h.DD)(l),{variables:I,mutateAsync:M}=(0,h.Ji)(l),w=(null==v?void 0:v.sso_connection)!==null,T=null==v?void 0:v.domains.some(e=>e.status===r.pT.VERIFIED),O=w?G.ssoEditButton:G.ssoAddButton,{0:S,1:C}=(0,c.useState)(!1),D=(null==v||null===(t=v.sso_connection)||void 0===t?void 0:t.status)==="ACTIVE",Z=null==v||null===(n=v.sso_connection)||void 0===n?void 0:n.id,E=v?(0,j.jsxs)(P.$V,{children:[(0,j.jsx)(V,{title:G.domainSubtitle,footer:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(u.Z,U({},G.verifyDomainInfoText))}),children:(0,j.jsx)(k,{domains:v.domains,workspaceId:l})}),(0,j.jsx)(H,{icon:y.uSF,title:G.autoProvisionTitle,body:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(u.Z,U({},G.autoProvisionBody))}),toggle:(0,j.jsx)(g.Z,{disabled:!T,enabled:null!==(o=null==I?void 0:I.shouldAutoProvision)&&void 0!==o?o:v.should_auto_provision,onChange:e=>{M({shouldAutoProvision:e})},label:m.formatMessage(G.toggleAutoProvisionLabel)})}),(0,j.jsxs)(P.i9,{children:[(0,j.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(y.kaz,{className:(0,a.default)("icon-sm",D?"text-blue-600":"text-token-text-tertiary")}),(0,j.jsx)(P.A4,{children:(0,j.jsx)(u.Z,U({},G.ssoTitle))})]}),w&&(0,j.jsx)("div",{children:(0,j.jsx)(g.Z,{enabled:D,onChange:()=>{x({connectionId:Z,active:!D})},label:m.formatMessage(G.ssoToggleActive)})})]}),T&&(0,j.jsx)(L,{acsId:v.acs_id,hasSSO:w}),(0,j.jsxs)("div",{children:[(0,j.jsx)(p.z,{as:"button",color:"primary",disabled:!T,onClick:()=>{C(!0)},children:(0,j.jsx)(u.Z,U({},O))}),(0,j.jsx)(R,{workspaceId:l,data:v.sso_connection,isOpen:S,onClose:()=>C(!1)})]})]}),v.sso_connection&&(0,j.jsx)(H,{icon:y.oVl,title:G.enforceSSOTitle,body:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(u.Z,U({},G.enforceSSOBody))}),toggle:(0,j.jsx)(g.Z,{disabled:!T,enabled:null===(i=v.sso_connection.auth0_enforced_clients)||void 0===i?void 0:i.includes("chat"),onChange:e=>{x({connectionId:v.sso_connection.id,enforcedClients:e?["chat"]:[]})},label:m.formatMessage(G.enforceSSOLabel)})})]}):null;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d(),{children:(0,j.jsx)("title",{children:m.formatMessage(G.title)})}),(0,j.jsx)(s.yG,{title:m.formatMessage(G.title)}),(0,j.jsx)(s.hb,{showSpinner:b,children:E})]})}let G=(0,m.vU)({title:{id:"workspaceIdentity.title",defaultMessage:"Identity & Provisioning"},domainSubtitle:{id:"workspaceIdentity.domainSubtitle",defaultMessage:"Domain management"},ssoTitle:{id:"workspaceIdentity.ssoTitle",defaultMessage:"Single Sign On"},ssoToggleActive:{id:"WorkspaceIdentityPage.ssoToggleActive",defaultMessage:"Enable SSO for this workspace"},ssoAddButton:{id:"workspaceIdentity.ssoAddButton",defaultMessage:"Add SAML SSO"},ssoEditButton:{id:"workspaceIdentity.ssoEditButton",defaultMessage:"Edit SAML SSO"},autoProvisionTitle:{id:"workspaceIdentity.autoProvisionSubtitle",defaultMessage:"Automatic account creation"},autoProvisionBody:{id:"workspaceIdentity.autoProvisionBody",defaultMessage:"Automatically create ChatGPT Enterprise accounts for new users who log in with a verified domain."},toggleAutoProvisionLabel:{id:"workspaceIdentity.toggleAutoProvisionLabel",defaultMessage:"Toggle to enable or disable auto provisioning"},enforceSSOTitle:{id:"workspaceIdentity.enforceSSOTitle",defaultMessage:"Enforce SSO log in"},enforceSSOBody:{id:"workspaceIdentity.enforceSSOBody",defaultMessage:"When SSO is active, users will no longer be able to use social logins and will be redirected to your SSO portal."},enforceSSOLabel:{id:"workspaceIdentity.enforceSSOLabel",defaultMessage:"Toggle to enable or disable SSO enforcement"},verifyDomainInfoText:{id:"workspaceIdentity.verifyDomainInfoText",defaultMessage:"Verify ownership of an email domain to access advanced security features including single sign-on."},learnMoreLink:{id:"workspaceIdentity.learnMoreLink",defaultMessage:"Learn more"}});function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}var z=!0;function W(e){return(0,j.jsx)(X,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e))}W.getLayout=function(e){return(0,j.jsx)(s.ZP,{mobilePageTitle:"Identity",requireOwnerPrivileges:!0,children:e})}},38417:function(e,t,n){"use strict";var o=n(48538),i=n(5443),s=n(66246),r=n(651);t.Z=e=>{let{label:t,value:n,onCopied:a}=e,l=()=>{(0,o.v)(n),a()};return(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[void 0!==t&&(0,r.jsx)("label",{className:"font-semibold",children:t}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{onClick:l,className:"w-full cursor-pointer break-all rounded-lg bg-token-main-surface-tertiary px-4 py-2 font-mono text-sm text-token-text-primary",children:n}),(0,r.jsx)(i.z,{color:"ghost",onClick:l,icon:s.TIy})]})]})}},23212:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var o,i=n(94521),s=n(21904),r=n(5443),a=n(38417),l=n(65530),d=n(8649),c=n(69482),u=n(66246),f=n(49217),m=n(94982),p=n(93223),g=n(35226),y=n(96053),v=n(92379),b=n(26123),x=n(72256),h=n(25940),j=n(46129),I=n(651);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var k=((o=k||{})[o.INITIAL=0]="INITIAL",o[o.PENDING=1]="PENDING",o[o.FINAL=2]="FINAL",o);function T(e){let{workspaceId:t,isOpen:n,onClose:o,currentDomain:i,domains:r=[],showUnverifiedDomains:l=!1,onVerifyDomain:c}=e,u=(0,b.Z)(),{mutateAsync:h,isPending:j}=function(e){let t=(0,g.NL)();return(0,y.D)({mutationFn:t=>{let{hostname:n}=t;return p.Z.addDomainToWorkspace(e,n)},onSuccess:()=>{t.invalidateQueries({queryKey:["workspace/identity",e]}),t.invalidateQueries({queryKey:["builderProfile"]})},onError:e=>{m.m.danger(e.message)}})}(t),{mutateAsync:M,isPending:T}=function(e){let t=(0,g.NL)();return(0,y.D)({mutationFn:t=>{let{domainId:n}=t;return p.Z.checkDomainForWorkspace(e,n)},onSuccess:()=>{t.invalidateQueries({queryKey:["workspace/identity",e]}),t.invalidateQueries({queryKey:["builderProfile"]})},onError:e=>{m.m.danger(e.message)}})}(t),{0:O,1:D}=(0,v.useState)(null!=i?i:void 0),{0:Z,1:P}=(0,v.useState)(null==i?void 0:i.hostname),{0:E,1:N}=(0,v.useState)((null==i?void 0:i.status)===void 0?k.INITIAL:(null==i?void 0:i.status)===s.pT.PENDING?k.PENDING:k.FINAL),A=()=>{i||(D(void 0),N(k.INITIAL))},L=async()=>{if(void 0===Z)return;let e=r.find(e=>e.hostname===Z&&e.status===s.pT.PENDING);if(e)D(e),N(k.PENDING);else{let e=await h({hostname:Z});"id"in e&&D(e),N(k.PENDING)}},B=(0,I.jsx)(d.Z.Button,{title:u.formatMessage(C.check),color:"primary",disabled:(null==O?void 0:O.id)===void 0||T,onClick:async()=>{if(null!=O&&O.id){let e=await M({domainId:O.id});"error"in e&&m.m.danger(u.formatMessage(C.domainCheckError,{message:e.error.message})),"id"in e&&(c&&c(e),e.status===s.pT.VERIFIED&&N(k.FINAL))}}}),R=(0,I.jsx)(d.Z.Button,{title:u.formatMessage(C.submit),color:"primary",disabled:void 0===Z||j,onClick:L}),_=(0,I.jsx)(d.Z.Button,{title:u.formatMessage(C.done),color:"primary",onClick:()=>{A(),o()}});return(0,I.jsxs)(f.Z,{isOpen:n,onClose:()=>{A(),o()},type:"success",className:"text-token-text-secondary",title:u.formatMessage(E===k.INITIAL?C.newTitle:C.editTitle),primaryButton:E===k.INITIAL?R:E===k.PENDING?B:_,secondaryButton:(0,I.jsx)(d.Z.Button,{title:u.formatMessage(C.cancel),color:"secondary",onClick:()=>{A(),o()}}),children:[E===k.INITIAL&&(0,I.jsx)(S,{hostname:Z,onSetHostname:P,onSubmit:L,unverifiedDomains:l?r:[],onVerifyDomain:e=>{N(k.PENDING),D(e)},workspaceId:t}),E===k.PENDING&&(0,I.jsxs)("div",{className:"flex flex-col gap-3",children:[u.formatMessage(C.verificationTokenMessage,{hostname:null==O?void 0:O.hostname}),(null==O?void 0:O.dns_verification_token_string)&&(0,I.jsx)(a.Z,{value:O.dns_verification_token_string,onCopied:()=>{m.m.success(u.formatMessage(C.copiedTXTRecordToClipboard),{duration:3})}}),(0,I.jsx)(x.Z,w({},C.verificationTokenFooter))]}),E===k.FINAL&&(0,I.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,I.jsx)(x.Z,w(w({},C.successfulVerification),{},{values:{hostname:null==O?void 0:O.hostname}})),(null==O?void 0:O.dns_verification_token_string)&&(0,I.jsx)(a.Z,{value:O.dns_verification_token_string,onCopied:()=>{m.m.success(u.formatMessage(C.copiedTXTRecordToClipboard),{duration:3})}})]})]})}function O(e){let{unverifiedDomains:t,onVerifyDomain:n,workspaceId:o}=e,{mutateAsync:i}=(0,j.Bd)(o);return(0,I.jsxs)(c.Z.Root,{fixed:!0,size:"compact",className:"mb-6 border-b border-token-border-light",children:[(0,I.jsxs)(c.Z.Header,{children:[(0,I.jsx)(c.Z.HeaderCell,{children:(0,I.jsx)(x.Z,w({},C.unverifiedDomainsTableHeader))}),(0,I.jsx)(c.Z.HeaderCell,{textAlign:"right"})]}),t.map(e=>(0,I.jsxs)(c.Z.Row,{children:[(0,I.jsx)(c.Z.Cell,{children:e.hostname}),(0,I.jsx)(c.Z.Cell,{textAlign:"right",children:(0,I.jsxs)("div",{className:"flex gap-2",children:[(0,I.jsx)(r.z,{color:"secondary",size:"small",onClick:()=>n(e),children:(0,I.jsx)(x.Z,w({},C.verifyDomainButton))}),(0,I.jsx)(r.z,{color:"secondary",size:"small",onClick:()=>i({domainId:e.id}),icon:u.XHJ})]})})]},e.id))]})}function S(e){let{hostname:t,onSetHostname:n,onSubmit:o,unverifiedDomains:i,onVerifyDomain:s,workspaceId:r}=e,a=(0,b.Z)();return(0,I.jsxs)(I.Fragment,{children:[i&&i.length>0&&(0,I.jsx)(O,{workspaceId:r,unverifiedDomains:i,onVerifyDomain:s}),(0,I.jsx)("form",{onSubmit:e=>{e.preventDefault(),o()},children:(0,I.jsxs)("div",{className:"mb-4",children:[(0,I.jsx)("label",{className:"mb-2 flex items-center text-sm font-semibold",children:(0,I.jsx)(x.Z,w({},C.domainInput))}),(0,I.jsx)(l.Z,{name:"hostname",placeholder:a.formatMessage(C.placeholder),value:null!=t?t:"",onChange:e=>{n(e.target.value)}})]})})]})}let C=(0,h.vU)({newTitle:{id:"domainModal.newTitle.0",defaultMessage:"Verify a new domain"},editTitle:{id:"domainModal.editTitle",defaultMessage:"Manage Domain"},submit:{id:"domainModal.submit",defaultMessage:"Submit"},check:{id:"domainModal.check",defaultMessage:"Check"},done:{id:"domainModal.done",defaultMessage:"Done"},cancel:{id:"domainModal.cancel",defaultMessage:"Cancel"},domainInput:{id:"domainModal.domainInput.0",defaultMessage:"Add a new domain"},placeholder:{id:"domainModal.placeholder",defaultMessage:"openai.com"},domainCheckError:{id:"domainModal.domainCheckError",defaultMessage:"Your domain could not be verified: {message}"},verificationTokenMessage:{id:"domainModal.verificationTokenMessage",defaultMessage:"To verify ownership of {hostname}, navigate to your DNS provider and add a TXT record with this value:"},verificationTokenFooter:{id:"domainModal.verificationTokenFooter",defaultMessage:"Then, check the record to complete the verification."},successfulVerification:{id:"domainModal.successfulVerification.0",defaultMessage:'Your domain, "{hostname}" has been successfully verified'},copiedTXTRecordToClipboard:{id:"domainModal.copiedTXTRecordToClipboard",defaultMessage:"Copied DNS TXT record to clipboard"},verifyDomainButton:{id:"domainModal.verifyDomainButton",defaultMessage:"Verify"},unverifiedDomainsTableHeader:{id:"domainModal.unverifiedDomainsTableHeader",defaultMessage:"Your unverified domains"}})},46129:function(e,t,n){"use strict";n.d(t,{Bd:function(){return v},DD:function(){return h},Fc:function(){return x},Ji:function(){return y},OR:function(){return j},Wv:function(){return g},f_:function(){return p},sd:function(){return M},z0:function(){return I}});var o,i=n(41141),s=n(21904),r=n(94982),a=n(93223),l=n(24040),d=n(14816),c=n(96053),u=n(35226),f=n(26123),m=n(25940);function p(e,t){return(0,d.a)({queryKey:["workspace/identity",e],queryFn:async()=>{if(void 0!==e)return await a.Z.getWorkspaceIdentitySettings(e)},enabled:t})}function g(){let e=(0,l.ec)(l.F_.workspaceId),{data:t}=p(null!=e?e:void 0,null!=e);return(null==t?void 0:t.domains)&&(null==t?void 0:t.domains.filter(e=>"verified"==e.status))}function y(e){let t=(0,f.Z)();return(0,c.D)({mutationFn:n=>{let{shouldAutoProvision:o}=n;return a.Z.setWorkspaceShouldAutoProvision(e,o).then(e=>{let n=o?w.autoProvisionEnabledToast:w.autoProvisionDisabledToast;return r.m.success(t.formatMessage(n),{duration:3}),e}).catch(e=>{throw r.m.danger(e.message),e})}})}function v(e){let t=(0,u.NL)();return(0,c.D)({mutationFn:t=>{let{domainId:n}=t;return a.Z.removeDomainFromWorkspace(e,n)},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]}),t.refetchQueries({queryKey:["builderProfile"]})}})}function b(e){let t=e;return t.startsWith("-----BEGIN")||(t="-----BEGIN CERTIFICATE-----\n".concat(t)),t.endsWith("CERTIFICATE-----")||(t="".concat(t,"\n-----END CERTIFICATE-----")),t}function x(e){let t=(0,u.NL)();return(0,c.D)({mutationFn:t=>{let{signInEndpoint:n,cert:o}=t;return a.Z.createSAMLConnection(e,n,b(o))},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}function h(e){let t=(0,u.NL)();return(0,c.D)({mutationFn:t=>{let{connectionId:n,signInEndpoint:o,cert:i,active:s,enforcedClients:r}=t;return a.Z.updateSAMLConnection(e,n,{signInEndpoint:o,cert:void 0!==i?b(i):void 0,active:s,enforcedClients:r})},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}function j(e){let t=(0,u.NL)();return(0,c.D)({mutationFn:t=>{let{connectionId:n}=t;return a.Z.deleteSAMLConnection(e,n)},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}let I=n(74091).Z.div(o||(o=(0,i.Z)(["text-md mb-4 text-token-text-secondary"]))),M={[s.pT.VERIFIED]:(0,m.Em)({id:"i7FkyS",defaultMessage:"Verified"}),[s.pT.PENDING]:(0,m.Em)({id:"THBv/l",defaultMessage:"Pending"}),[s.pT.EXPIRED]:(0,m.Em)({id:"+sjWGK",defaultMessage:"Expired"})},w=(0,m.vU)({autoProvisionEnabledToast:{id:"workspaceIdentity.autoProvisionEnabledToast",defaultMessage:"Auto provisioning enabled for this workspace"},autoProvisionDisabledToast:{id:"workspaceIdentity.autoProvisionDisabledToast",defaultMessage:"Auto provisioning disabled for this workspace"}})},93322:function(e,t,n){"use strict";n.d(t,{$V:function(){return m},A4:function(){return p},Li:function(){return b},W8:function(){return h},i$:function(){return g},i9:function(){return v},qQ:function(){return y},vi:function(){return x}});var o,i,s,r,a,l,d,c,u=n(41141),f=n(74091);let m=f.Z.div(o||(o=(0,u.Z)(["text-base text-token-text-primary flex flex-col gap-10 my-10"]))),p=f.Z.div(i||(i=(0,u.Z)(["text-xl font-semibold"]))),g=f.Z.div(s||(s=(0,u.Z)(["text-base font-semibold"]))),y=f.Z.div(r||(r=(0,u.Z)(["flex flex-col divide-y divide-token-border-light border-y border-token-border-light"]))),v=f.Z.div(a||(a=(0,u.Z)(["flex flex-col gap-3 w-full m-auto md:m-0"]))),b=f.Z.div(l||(l=(0,u.Z)(["text-sm"]))),x=f.Z.div(d||(d=(0,u.Z)(["flex justify-between py-4 gap-4"]))),h=f.Z.hr(c||(c=(0,u.Z)(["max-w-xl border-token-border-light"])))},71941:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/identity",function(){return n(25672)}])}},function(e){e.O(0,[7349,6271,3718,4368,5365,2349,1783,4834,7126,8890,9511,0,5165,657,2888,9774,179],function(){return e(e.s=71941)}),_N_E=e.O()}]);
//# sourceMappingURL=identity-8bcd7250f4528f87.js.map