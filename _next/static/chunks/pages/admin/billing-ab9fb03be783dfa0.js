(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3224],{51516:function(e,t,n){"use strict";function a(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return a}})},67629:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(28734),i=n(51516);function s(e){(0,i.Z)(1,arguments);var t=(0,a.Z)(e);return t.setHours(0,0,0,0),t}},28734:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(51516);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){(0,a.Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===i(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(Error().stack)),new Date(NaN))}},29237:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return eB},default:function(){return eL}});var a,i,s,l,r,o,c,d,u=n(68986),f=n(98601),m=n(93465),g=n(59144),p=n(24434),x=n(50454),j=n(24740),b=n(43991),v=n(60806),h=n(92379),y=n(75172),w=n(62984),M=n(68306),P=n(651);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach(function(t){(0,f.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let E=((a={}).FLEXIBLE="month",a.ANNUAL="year",a),N=(0,v.b)(E);function Z(e){let{isOpen:t,onClose:n,initialTeamBillingType:a,renewalDate:i,accountId:s}=e,{0:l,1:r}=(0,h.useState)(a),{0:o,1:c}=(0,h.useState)(!1),{0:d,1:u}=(0,h.useState)(!1),f=k[l],g=(0,y.Z)(),x=(0,m.bm)(s),b=async()=>{u(!0);try{await x.mutateAsync({accountId:s,updatedPriceInterval:l===E.FLEXIBLE?"month":"year",updatedSeats:void 0}),u(!1),j.m.success(g.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),c(!1),n()}catch(e){j.m.warning(g.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{u(!1)}};return(0,P.jsx)(p.Z,{type:"success",isOpen:t,onClose:()=>{c(!1),r(a),n()},size:"custom",className:"max-w-xl",noPadding:!0,title:o?g.formatMessage({id:"teamBilling.changeBillingScheduleConfirmTitle",defaultMessage:"Confirm changes"}):g.formatMessage({id:"teamBilling.changeBillingScheduleTitle",defaultMessage:"Change billing schedule"}),showCloseButton:!0,children:o?(0,P.jsx)(C,{selectedPlan:l,initialTeamBillingType:a,renewalDate:i,selectedPlanData:f,handleUpdate:b,isUpdating:d}):(0,P.jsx)(I,{setSelectedPlan:r,selectedPlan:l,initialTeamBillingType:a,toggleConfirmPage:function(){c(!o)},renewalDate:i})})}function I(e){let{selectedPlan:t,setSelectedPlan:n,initialTeamBillingType:a,toggleConfirmPage:i,renewalDate:s}=e,l=(0,y.Z)();return(0,P.jsxs)("div",{children:[(0,P.jsx)("div",{className:"grid grid-flow-row grid-cols-2",children:(0,P.jsxs)(b.fC,{className:"col-span-2 grid md:col-span-2 md:grid-cols-2",defaultValue:t,onValueChange:e=>{N(e)&&n(e)},children:[(0,P.jsx)(x.IW,S({billingType:E.FLEXIBLE},x.c0)),(0,P.jsx)(x.IW,S({billingType:E.ANNUAL},x.sr))]})}),(0,P.jsx)("hr",{}),(0,P.jsxs)("div",{className:"m-4 flex items-center justify-between",children:[(0,P.jsx)("span",{className:"text-sm text-token-text-secondary",children:(0,P.jsx)(w.Z,S(S({},x.sY.changeEffectDate),{},{values:{date:(0,P.jsx)(M.Ji,{value:s,year:"numeric",month:"long",day:"numeric"})}}))}),(0,P.jsx)(g.m,{title:l.formatMessage(x.sY.continueToPricePreview),disabled:t===a,color:"primary",onClick:()=>{i()}})]})]})}function C(e){let{initialTeamBillingType:t,selectedPlan:n,renewalDate:a,selectedPlanData:i,handleUpdate:s,isUpdating:l}=e,r=(0,y.Z)();return(0,P.jsxs)("div",{className:"p-4",children:[(0,P.jsx)("span",{className:"text-sm",children:(0,P.jsx)(w.Z,S(S({},x.sY.confirmPageChangeEffectDate),{},{values:{current_plan:t===E.FLEXIBLE?"Flexible (monthly)":"Annual",new_plan:n===E.FLEXIBLE?"Flexible (monthly)":"Annual",date:(0,P.jsx)(M.Ji,{value:a,year:"numeric",month:"long",day:"numeric"})}}))}),(0,P.jsxs)("div",{className:"mt-4 flex flex-col bg-token-main-surface-secondary p-4",children:[(0,P.jsx)("span",{className:"font-semibold",children:(0,P.jsx)(w.Z,S({},i.name))}),(0,P.jsx)("span",{className:"text-sm",children:(0,P.jsx)(w.Z,S(S({},i.cost),{},{values:{s:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,P.jsx)(x.Re,{children:t})}}}))}),(0,P.jsx)("span",{className:"text-sm text-token-text-secondary",children:(0,P.jsx)(w.Z,S({},i.structure))})]}),(0,P.jsx)("div",{className:"mt-4 flex justify-end",children:(0,P.jsx)(g.m,{title:r.formatMessage(x.sY.confirmChange),color:"primary",onClick:s,loading:l})})]})}let k={[E.FLEXIBLE]:{name:x.sY.flexiblePlanName,cost:x.sY.flexiblePlanCost,structure:x.sY.teamsCostStructure},[E.ANNUAL]:{name:x.sY.annualPlanName,cost:x.sY.annualPlanCost,structure:x.sY.teamsCostStructure}};var T=n(2721),D=n(93951),_=n(31498),B=n(88667),L=n(19841),F=n(34977),U=n(11550),A=n(92609),z=n(97537),X=n(98095),R=n(94668),Y=n(41619),q=n(59725),G=n(6440);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach(function(t){(0,f.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function J(e){let{isOpen:t,onClose:n}=e,a=(0,y.Z)(),{data:i,isLoading:s}=(0,m.ZP)(),l=(0,D.t)(),r=(0,m.St)(null==l?void 0:l.id),o=(0,_.aF)(),{0:c,1:d}=(0,h.useState)(""),{0:u,1:f}=(0,h.useState)(!1),x=(null==o?void 0:o.email)&&c.toLowerCase()==o.email.toLowerCase(),{0:b,1:v}=(0,h.useState)(i&&!i.will_renew);if(s||!l||!i)return null;let M=async()=>{f(!0);try{await r.mutateAsync(l.id),v(!0)}catch(e){j.m.warning(a.formatMessage(W.errorCancellingSubscription),{hasCloseButton:!0})}finally{f(!1)}};return(0,P.jsx)(p.Z,{type:"success",onClose:n,showCloseButton:!0,isOpen:t,className:"",title:(0,P.jsx)("span",{className:"text-lg",children:(0,P.jsx)(w.Z,$({},W.cancelPlan))}),children:b?(0,P.jsxs)("div",{children:[(0,P.jsx)("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:(0,P.jsx)(w.Z,$({},W.successfullyCanceled))}),null!=i.active_until&&(0,P.jsx)("p",{className:"text-sm text-token-text-primary",children:(0,P.jsx)(w.Z,$($({},W.retainUntil),{},{values:{expiryDate:new Date(i.active_until)}}))}),(0,P.jsx)("div",{className:"mt-6 flex w-full flex-row justify-end",children:(0,P.jsx)(g.m,{title:a.formatMessage(W.doneButton),color:"primary",onClick:n,disabled:u})})]}):(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,P.jsxs)("div",{className:"flex w-full items-center gap-4",children:[(0,P.jsx)(q.B0,{src:l.data.profilePictureUrl,size:"large"}),(0,P.jsxs)("div",{className:"flex-col",children:[(0,P.jsx)("p",{className:"font-semibold",children:l.data.name}),(0,P.jsx)("p",{className:"text-sm text-token-text-secondary",children:(0,P.jsx)(w.Z,$($({},W.membersCount),{},{values:{count:i.seats_entitled}}))})]})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsx)("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:(0,P.jsx)(w.Z,$({},W.areYouSure))}),(0,P.jsxs)("ul",{className:"list-disc pl-5 text-sm text-token-text-secondary",children:[(0,P.jsx)("li",{className:"my-2",children:(0,P.jsx)(w.Z,$({},W.dataUnavailable))}),null!=i.active_until&&(0,P.jsx)("li",{className:"my-2",children:(0,P.jsx)(w.Z,$($({},W.retainUntil),{},{values:{expiryDate:new Date(i.active_until)}}))}),(0,P.jsx)("li",{className:"my-2",children:(0,P.jsx)(w.Z,$({},W.retainEmailAccess))})]})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsx)("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:(0,P.jsx)(w.Z,$({},W.enterEmailToConfirm))}),(0,P.jsx)(G.Z,{type:"text",name:"user-email",placeholder:"abcd@acme.com",onChange:e=>{d(e.target.value)}})]})]}),(0,P.jsxs)("div",{className:"mt-6 flex w-full flex-row justify-end",children:[(0,P.jsx)(g.m,{title:a.formatMessage(W.keepSubscriptionButton),onClick:n,disabled:u}),(0,P.jsx)(g.m,{title:a.formatMessage(W.cancelSubscriptionButton),onClick:M,disabled:!x,loading:u,color:"danger",className:"ml-2"})]})]})})}let W=(0,M.vU)({dataUnavailable:{id:"cancelTeamPlanModal.dataUnavailable",defaultMessage:"All workspace data including chat history and settings will not be available."},cancelPlan:{id:"cancelTeamPlanModal.cancelPlan",defaultMessage:"Cancel subscription"},retainUntil:{id:"cancelTeamPlanModal.retainUntil",defaultMessage:"You will retain access to the workspace until the end of your billing cycle on {expiryDate, date, long}."},retainEmailAccess:{id:"cancelTeamPlanModal.retainEmailAccess",defaultMessage:"You will still be able to use ChatGPT with the other workspaces associated with this email address."},errorCancellingSubscription:{id:"cancelTeamPlanModal.errorCancellingSubscription",defaultMessage:"There was a problem cancelling your subscription."},areYouSure:{id:"cancelTeamPlanModal.areYouSure",defaultMessage:"Are you sure?"},enterEmailToConfirm:{id:"cancelTeamPlanModal.enterEmailToConfirm",defaultMessage:"Enter your Email address to confirm"},emailPlaceholder:{id:"cancelTeamPlanModal.emailPlaceholder",defaultMessage:"abcd@acme.com"},doneButton:{id:"cancelTeamPlanModal.doneButton",defaultMessage:"Done"},keepSubscriptionButton:{id:"cancelTeamPlanModal.keepSubscriptionButton",defaultMessage:"Keep subscription"},cancelSubscriptionButton:{id:"cancelTeamPlanModal.cancelSubscriptionButton",defaultMessage:"Cancel subscription"},successfullyCanceled:{id:"cancelTeamPlanModal.successfullyCanceled",defaultMessage:"You have successfully canceled your subscription."},membersCount:{id:"yourComponent.membersCount",defaultMessage:"{count, plural, one {# member} other {# members}}"}});var Q=n(2346),V=n(32378),K=n(55356),ee=n(15478);function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach(function(t){(0,f.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ea=((i=ea||{}).FLEXIBLE="month",i.ANNUAL="year",i);let ei=ee.Z.p(s||(s=(0,Q.Z)(["text-base font-semibold mb-3 mt-3"])));function es(e){let{isOpen:t,onClose:n,initialTeamBillingType:a,initialSeats:i,accountId:s,renewalDate:l}=e,r=(0,y.Z)(),{0:o,1:c}=(0,h.useState)(i),{0:d,1:u}=(0,h.useState)(!1),{0:f,1:g}=(0,h.useState)(!1),b=eo[a],v=a===ea.FLEXIBLE?x.c0:x.sr,w=(0,m.bm)(s),M=async()=>{g(!0);try{await w.mutateAsync({accountId:s,updatedPriceInterval:void 0,updatedSeats:o}),g(!1),j.m.success(r.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),u(!1),n()}catch(e){j.m.warning(r.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}))}finally{g(!1)}};return(0,P.jsx)(p.Z,{type:"success",isOpen:t,onClose:()=>{u(!1),c(i),n()},size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:d?r.formatMessage({id:"teamsManageSeatsModal.title",defaultMessage:"Manage seats"}):r.formatMessage({id:"teamsManageSeatsModalConfirmPage.title",defaultMessage:"Review"}),children:d?(0,P.jsx)(er,{numSeats:o,initialSeats:i,handleUpdate:M,isUpdating:f,renewalDate:l,accountId:s}):(0,P.jsx)(el,{initialTeamBillingType:a,selectedPlanBillingInfo:v,numSeats:o,initialSeats:i,setNumSeats:c,selectedPlanData:b,toggleConfirmPage:function(){u(!d)}})})}function el(e){let{initialTeamBillingType:t,selectedPlanBillingInfo:n,numSeats:a,initialSeats:i,setNumSeats:s,selectedPlanData:l,toggleConfirmPage:r}=e,o=(0,y.Z)();return(0,P.jsxs)("div",{className:"grid grid-flow-row grid-cols-2",children:[(0,P.jsx)(b.fC,{className:"col-span-2 grid md:col-span-1 md:grid-cols-1",defaultValue:t,children:(0,P.jsx)(x.IW,en({billingType:t},n))}),(0,P.jsxs)("div",{className:"col-span-3 overflow-hidden border-l border-token-main-surface-tertiary bg-token-main-surface-secondary p-6 md:col-span-1",children:[(0,P.jsx)("label",{className:"mb-3 block text-base font-semibold",htmlFor:"seats",children:(0,P.jsx)(w.Z,en({},x.sY.seatsTitle))}),(0,P.jsx)(x.ZY,{numSeats:a,minSeats:i,setNumSeats:s}),(0,P.jsx)(V.b,{}),(0,P.jsx)(ei,{children:(0,P.jsx)(w.Z,en({},x.sY.summaryTitle))}),(0,P.jsxs)("div",{className:"text-sm",children:[(0,P.jsx)("p",{className:"mb-2",children:(0,P.jsx)(w.Z,en({},l.name))}),(0,P.jsxs)(K.QI,{children:[(0,P.jsx)(K.HC,{children:(0,P.jsx)(w.Z,en({},l.billed))}),(0,P.jsx)(K.HC,{children:(0,P.jsx)("b",{children:(0,P.jsx)(w.Z,en(en({},l.total),{},{values:{totalCost:(a||0)*(t===ea.ANNUAL?300:30)}}))})})]})]})]}),(0,P.jsx)("hr",{}),(0,P.jsx)("div",{className:"m-4 flex justify-end",children:(0,P.jsx)(g.m,{title:o.formatMessage({id:"teamsManageSeatsModal.continue",defaultMessage:"Continue"}),disabled:a===i,onClick:()=>{r()},color:"primary"})})]})}function er(e){let{numSeats:t,initialSeats:n,renewalDate:a,handleUpdate:i,isUpdating:s,accountId:l}=e,r=(0,y.Z)(),{data:o,isError:c,isLoading:d}=(0,m.zu)(l,t);return d?(0,P.jsx)("div",{className:"flex items-center justify-center p-6",children:(0,P.jsx)(z.Z,{})}):!c&&o?(0,P.jsxs)("div",{className:"p-6",children:[(0,P.jsxs)("div",{className:"flex justify-between",children:[(0,P.jsx)("span",{className:"font-semibold",children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.additionalSeats",defaultMessage:"{additionalSeats} additional seats",values:{additionalSeats:t-n}})}),(0,P.jsx)("span",{className:"font-semibold",children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.additionalSeatsTotal",defaultMessage:"${totalCost}",values:{totalCost:(o.total_amount/100).toFixed(2)}})})]}),(0,P.jsx)("span",{className:"text-sm text-token-text-secondary",children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.proratedAmountMessage",defaultMessage:"Prorated amount until next billing cycle"})}),(0,P.jsx)("span",{className:"mt-4 flex flex-col bg-token-main-surface-secondary p-4 text-sm text-token-text-secondary",children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.chargeMessage",defaultMessage:"You will be charged for {numSeats} total seats at your next renewal on {date}",values:{numSeats:t,date:(0,P.jsx)(M.Ji,{value:a,year:"numeric",month:"long",day:"numeric"})}})}),(0,P.jsx)("hr",{className:"mt-4"}),(0,P.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,P.jsx)("span",{className:"font-semibold",children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.subTotal",defaultMessage:"Subtotal"})}),(0,P.jsx)("span",{children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.subtotalPrice",defaultMessage:"${totalCost}",values:{totalCost:(o.amount_excluding_tax/100).toFixed(2)}})})]}),(0,P.jsxs)("div",{className:"mt-2 flex justify-between",children:[(0,P.jsx)("span",{className:"font-semibold",children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.tax",defaultMessage:"Tax"})}),(0,P.jsx)("span",{children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.taxAmount",defaultMessage:"${tax}",values:{tax:(o.tax_amount/100).toFixed(2)}})})]}),(0,P.jsxs)("div",{className:"mt-2 flex justify-between",children:[(0,P.jsx)("span",{className:"font-semibold",children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.totalDueToday",defaultMessage:"Total due today"})}),(0,P.jsx)("span",{className:"font-semibold",children:(0,P.jsx)(w.Z,{id:"teamsManageSeatsModal.totalDueTodayAmount",defaultMessage:"${totalCost}",values:{totalCost:(o.total_amount/100).toFixed(2)}})})]}),(0,P.jsx)("hr",{className:"mt-4"}),(0,P.jsx)("div",{className:"mt-6 flex justify-end",children:(0,P.jsx)(g.m,{title:r.formatMessage({id:"teamsManageSeatsModal.payNow",defaultMessage:"Pay now"}),color:"primary",onClick:i,loading:s})})]}):void 0}let eo={[ea.FLEXIBLE]:{name:x.sY.flexiblePlanSelected,billed:{id:"teamManageSeatsModal.flexiblePlanBilled",defaultMessage:"Price billed monthly",description:"Summary billing of selected plan"},total:x.sY.flexiblePlanTotal},[ea.ANNUAL]:{name:x.sY.annualPlanSelected,billed:{id:"teamManageSeatsModal.flexiblePlanBilled",defaultMessage:"Price billed annually",description:"Summary billing of selected plan"},total:x.sY.annualPlanTotal}};var ec=n(30853);function ed(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ed(Object(n),!0).forEach(function(t){(0,f.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ed(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ef(e){var t;let{numInUse:n,numAllocated:a,isTeam:i,subscriptionWillRenew:s,subscriptionBillingPeriod:l,accountId:r,subscriptionRenewalDate:o}=e,c=Math.max(a,n),d=null===(t=(0,B.sB)("3954884439"))||void 0===t?void 0:t.value,{0:u,1:f}=(0,h.useState)(!1),m=function(){f(!u)},g="monthly"===l?E.FLEXIBLE:E.ANNUAL;return(0,P.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,P.jsxs)("div",{className:"flex justify-between",children:[(0,P.jsx)("span",{className:"mt-1 text-left text-sm",children:(0,P.jsx)(w.Z,eu(eu({},ey.description),{},{values:{num:"".concat(n,"/").concat(a)}}))}),i&&s&&d&&(0,P.jsx)(U.z,{color:"secondary",className:"text-right",onClick:m,children:(0,P.jsx)(w.Z,{id:"components.business.NumSeats.manageSeats",defaultMessage:"Manage seats"})}),(0,P.jsx)(es,{isOpen:u,onClose:m,initialTeamBillingType:g,initialSeats:a,accountId:r,renewalDate:o})]}),(0,P.jsx)(c>10?em:eh,{numInUse:n,numAllocated:a})]})}function em(e){let{numAllocated:t,numInUse:n}=e,a=(0,y.Z)(),i=n>t,s=i?100:n/t*100,l=i?t/n*100:100;return(0,P.jsx)("div",{className:(0,L.default)("relative w-full rounded-full",i?"bg-orange-500":"bg-token-main-surface-primary"),children:(0,P.jsxs)("div",{className:"relative h-4",style:{width:"".concat(l,"%")},children:[(0,P.jsx)("div",{className:(0,L.default)("h-4 overflow-hidden rounded-l-full bg-green-600",n===t&&"rounded-r-full"),style:{width:"".concat(s,"%")}}),n!==t&&i&&(0,P.jsx)("div",{className:"absolute right-0 top-[-3px] bg-token-main-surface-primary",children:(0,P.jsx)(ec.u,{label:a.formatMessage(ey.dividerTooltip,{count:t}),children:(0,P.jsx)(eg,{className:"px-1 py-0.5"})})})]})})}let eg=e=>{let{className:t}=e;return(0,P.jsxs)("div",{className:(0,L.default)("flex flex-col gap-0.5",t),children:[(0,P.jsx)(ev,{}),(0,P.jsx)(ev,{}),(0,P.jsx)(ev,{}),(0,P.jsx)(ev,{})]})},ep=ee.Z.div(l||(l=(0,Q.Z)(["h-4 w-4 rounded-full"]))),ex=(0,ee.Z)(ep)(r||(r=(0,Q.Z)(["bg-green-600"]))),ej=(0,ee.Z)(ep)(o||(o=(0,Q.Z)(["bg-token-main-surface-tertiary"]))),eb=(0,ee.Z)(ep)(c||(c=(0,Q.Z)(["bg-orange-500"]))),ev=ee.Z.span(d||(d=(0,Q.Z)(["w-[3px] h-[3px] bg-gray-400 dark:bg-gray-500 rounded-full"])));function eh(e){let{numAllocated:t,numInUse:n}=e,a=(0,y.Z)(),i=n>t,s=(0,h.useMemo)(()=>Array.from(Array(i?n:t).keys()),[i,t,n]);return(0,P.jsx)("div",{className:"flex items-center gap-2",children:s.map(e=>{let s=eb,l=null;return e<n&&!i?s=ex:e<t&&!i&&(s=ej),e===t-1&&(l=(0,P.jsx)(ec.u,{label:a.formatMessage(ey.dividerTooltip,{count:t}),children:(0,P.jsx)(eg,{})})),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(s,{},e),l]})})})}let ey=(0,M.vU)({dividerTooltip:{defaultMessage:"Your team has {count, plural, =0 {no seats} one {# seat} other {# seats}} purchased",id:"components.business.NumSeats.dividerTooltip"},description:{defaultMessage:"{num} seats in use",id:"components.business.NumSeats.description"}});var ew=n(8040),eM=n(84760);function eP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eP(Object(n),!0).forEach(function(t){(0,f.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let eS=(0,M.vU)({invoicesLoadError:{id:"organizationBillingInfo.invoicesLoadError.0",defaultMessage:"Failed to load invoices. Contact support@openai.com if error persists."}});function eE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eE(Object(n),!0).forEach(function(t){(0,f.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eZ(){var e;let{data:t,isLoading:n,isError:a}=(0,m.ZP)(),i=(0,D.t)(),{0:s,1:l}=(0,h.useState)(!1);if(n)return(0,P.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,P.jsx)(z.Z,{})});if(a||!t||!i)return null;let r=null!=t.active_until,o=(null==t?void 0:t.seats_in_use)>(null==t?void 0:t.seats_entitled);return(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)(ew.i9,{children:[(0,P.jsx)(ew.A4,{children:(0,P.jsx)(w.Z,eN({},e_.planTitle))}),(0,P.jsx)("hr",{}),(0,P.jsxs)("div",{className:"flex items-center justify-between",children:[(0,P.jsxs)("div",{children:[(0,P.jsx)(ew.i$,{children:null!=i&&i.isEnterprise()?r?(0,P.jsx)(w.Z,eN({},e_.activeEnterpriseLicense)):null!=i&&i.isResellerHosted()?(0,P.jsx)(w.Z,eN({},e_.resellerHostedEnterpriseLicense)):(0,P.jsx)(w.Z,eN({},e_.pendingEnterpriseLicense)):null!=i&&i.isEdu()?r?(0,P.jsx)(w.Z,eN({},e_.activeEduLicense)):null!=i&&i.isResellerHosted()?(0,P.jsx)(w.Z,eN({},e_.resellerHostedEduLicense)):(0,P.jsx)(w.Z,eN({},e_.pendingEduLicense)):r?t.non_profit_org_discount_applied?(0,P.jsx)(w.Z,eN({},e_.activeTeamLicenseNonProfitOrg)):(0,P.jsx)(w.Z,eN({},e_.activeTeamLicense)):(0,P.jsx)(w.Z,eN({},e_.pendingTeamLicense))}),null!=t.active_until&&(0,P.jsx)(ew.Li,{className:"mt-1",children:null!=i&&i.isEnterprisey()?(0,P.jsx)(w.Z,eN(eN({},e_.licenseExpiry),{},{values:{expiryDate:new Date(t.active_until)}})):t.will_renew?(0,P.jsx)(w.Z,eN(eN({},e_.renewalDate),{},{values:{expiryDate:new Date(t.active_until)}})):(0,P.jsx)(w.Z,eN(eN({},e_.deactivateDate),{},{values:{expiryDate:new Date(t.active_until)}}))})]}),(0,P.jsx)(eI,{isOpen:s,onDropdownOpen:function(){l(!s)}})]}),(0,P.jsx)("hr",{}),r&&(0,P.jsxs)("div",{children:[(0,P.jsx)(ew.i$,{children:(0,P.jsx)(w.Z,eN({},e_.seatsTitle))}),(0,P.jsx)(eT,{isTeam:null!==(e=null==i?void 0:i.isTeam())&&void 0!==e&&e,accountId:i.id}),(null==i?void 0:i.isTeam())&&o&&(0,P.jsxs)("span",{className:"text-sm text-token-text-secondary",children:[(0,P.jsx)(w.Z,eN({},e_.teamsAutochargeMessage)),(0,P.jsx)(A.Z,{className:"pl-1",openNewTab:!0,href:"https://help.openai.com/en/articles/8792536-manage-billing-on-the-chatgpt-team-subscription-plan",children:(0,P.jsx)(w.Z,eN({},e_.billingLearnMore))})]})]}),(0,P.jsx)("hr",{})]})})}function eI(e){var t;let{isOpen:n,onDropdownOpen:a}=e,{0:i,1:s}=(0,h.useState)(!1),l=(0,F.useRouter)(),r=(0,y.Z)(),o=(0,D.t)(),{data:c}=(0,m.ZP)(),{0:d,1:u}=(0,h.useState)(!1),f=function(){u(!d)},{0:g,1:p}=(0,h.useState)(!1),x=function(){p(!g)},b=null===(t=(0,B.sB)("1318146997"))||void 0===t?void 0:t.value;if(!o||!o.isTeam()||!c)return;let v=async()=>{s(!0);try{let e=await T.Z.fetchCustomerPortalUrl(null==o?void 0:o.getWorkspaceId());l.push(e.url)}catch(e){j.m.warning(r.formatMessage(e_.stripeErrorWarning),{hasCloseButton:!0})}finally{s(!1)}},M=(null==c?void 0:c.billing_period)==="monthly"?E.FLEXIBLE:E.ANNUAL;return(0,P.jsxs)(X.d,{open:n,size:"default",triggerButton:(0,P.jsx)(U.z,{color:"secondary",onClick:a,icon:Y.Tg4,children:(0,P.jsx)(w.Z,eN({},e_.manageLicenseBtn))}),children:[(0,P.jsx)(X.Z.Item,{icon:Y.ciH,onClick:v,children:(0,P.jsx)(w.Z,eN({},e_.managePaymentMethod))}),c.will_renew&&b&&(0,P.jsx)(X.Z.Item,{icon:Y.lDw,onClick:()=>{x()},children:(0,P.jsx)(w.Z,eN({},e_.manageBillingSchedule))}),null!=c.active_until&&(0,P.jsx)(Z,{isOpen:g,onClose:x,initialTeamBillingType:M,renewalDate:new Date(c.active_until),accountId:o.id}),(null==c?void 0:c.will_renew)&&(0,P.jsx)(X.Z.Separator,{}),(null==c?void 0:c.will_renew)&&(0,P.jsx)(X.Z.Item,{icon:Y.oOx,color:"danger",onClick:()=>{f()},children:(0,P.jsx)(w.Z,eN({},e_.cancelSubscriptionBtn))}),(0,P.jsx)(J,{isOpen:d,onClose:f})]})}function eC(e){let{invoice:t}=e,n=(null==t?void 0:t.status_transitions.paid_at)!=null&&new Date(1e3*t.status_transitions.paid_at),a=t&&new Date(1e3*t.due_date),i=t&&new Date(1e3*t.created);return(0,P.jsxs)(ew.vi,{className:"items-center",children:[(0,P.jsxs)("div",{className:"flex grow flex-col gap-1",children:[(0,P.jsx)("span",{children:i?(0,P.jsx)(w.Z,eN(eN({},e_.invoiceName),{},{values:{createdDate:i}})):(0,P.jsx)(w.Z,eN({},e_.defaultInvoiceName))}),null!=t&&t.paid&&null!=n?(0,P.jsx)("div",{className:"text-xs text-token-text-secondary",children:(0,P.jsx)(w.Z,eN(eN({},e_.paidInvoice),{},{values:{invoiceDate:n}}))}):t&&(0,P.jsx)("div",{className:"text-xs text-green-600",children:(0,P.jsx)(w.Z,eN(eN({},e_.upcomingInvoice),{},{values:{invoiceDate:a}}))})]}),(0,P.jsx)("a",{href:null==t?void 0:t.hosted_invoice_url,className:(0,L.default)("mx-auto",(null==t?void 0:t.hosted_invoice_url)==void 0&&"cursor-not-allowed opacity-20"),target:"_blank",rel:"noreferrer",children:(0,P.jsx)(Y.Pfi,{className:"icon-sm text-green-600"})})]})}function ek(){let{0:e,1:t}=(0,h.useState)({limit:5}),{data:n,isError:a}=function(e){var t;let n=(0,D.t)(),a=null==n?void 0:n.id,i=null!==(t=null==n?void 0:n.data.organizationId)&&void 0!==t?t:void 0;return function(e,t){let n=(0,y.Z)();return(0,eM.a)({queryKey:["organization-invoices",eO(eO({},e),{},{options:t})],queryFn:async()=>await T.Z.getInvoices(e,t).catch(e=>{throw j.m.danger(n.formatMessage(eS.invoicesLoadError,{error:e.message})),e}),enabled:"account_id"in e||"organization_id"in e})}((null==n?void 0:n.isEnterprisey())?{organization_id:i}:{account_id:a},e)}(e),i=null!=e.startingAfter||null!=e.endingBefore&&(null==n?void 0:n.has_more),s=null!=e.endingBefore||(null==n?void 0:n.has_more)&&null==e.endingBefore;return a||null==n?(0,P.jsxs)(ew.i9,{children:[(0,P.jsx)(ew.A4,{children:(0,P.jsx)(w.Z,eN({},e_.invoicesTitle))}),(0,P.jsx)(R.Z,{children:(0,P.jsx)(w.Z,eN({},e_.noInvoices))})]}):(0,P.jsxs)(ew.i9,{children:[(0,P.jsx)(ew.A4,{children:(0,P.jsx)(w.Z,eN({},e_.invoicesTitle))}),(0,P.jsx)(ew.qQ,{children:n.data.map(e=>(0,P.jsx)(eC,{invoice:e},e.id))}),(0,P.jsxs)("div",{className:"flex",children:[i&&(0,P.jsx)("button",{onClick:()=>{n&&t(e=>eN(eN({},e),{},{endingBefore:n.data[0].id,startingAfter:void 0}))},children:(0,P.jsx)(Y.DUf,{className:"icon-sm"})}),(0,P.jsx)("div",{className:"flex-grow"}),s&&(0,P.jsx)("button",{onClick:()=>{n&&t(e=>eN(eN({},e),{},{startingAfter:n.data[n.data.length-1].id,endingBefore:void 0}))},children:(0,P.jsx)(Y.ob9,{className:"icon-sm"})})]})]})}function eT(e){let{isTeam:t,accountId:n}=e,{data:a,isLoading:i,isError:s}=(0,m.ZP)();return!s&&a&&!i&&a.billing_period&&a.active_until?(0,P.jsx)(ef,{numInUse:a.seats_in_use,numAllocated:a.seats_entitled,isTeam:t,subscriptionWillRenew:a.will_renew,subscriptionBillingPeriod:a.billing_period,subscriptionRenewalDate:new Date(a.active_until),accountId:n}):null}function eD(){let e=(0,_.ec)(e=>e.currentWorkspace),t=null==e?void 0:e.organizationId,n=(0,y.Z)();return void 0===t?null:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(u.yG,{title:n.formatMessage(e_.title),subtitle:n.formatMessage(e_.subtitle)}),(0,P.jsx)(u.hb,{children:(0,P.jsxs)(ew.$V,{children:[(0,P.jsx)(eZ,{}),(0,P.jsx)(ek,{})]})})]})}let e_=(0,M.vU)({title:{id:"organizationBillingInfo.title.1",defaultMessage:"Billing"},subtitle:{id:"organizationBillingInfo.subtitle",defaultMessage:"Only workspace owners can view and change these settings"},planTitle:{id:"organizationBillingInfo.planTitle",defaultMessage:"Plan"},activeEnterpriseLicense:{id:"organizationBillingInfo.activeEnterpriseLicense",defaultMessage:"Enterprise License"},pendingEnterpriseLicense:{id:"organizationBillingInfo.pendingEnterpriseLicense",defaultMessage:"Enterprise License (pending activation)"},resellerHostedEnterpriseLicense:{id:"organizationBillingInfo.resellerHostedEnterpriseLicense",defaultMessage:"Enterprise License"},activeEduLicense:{id:"organizationBillingInfo.activeEduLicense",defaultMessage:"Edu License"},pendingEduLicense:{id:"organizationBillingInfo.pendingEduLicense",defaultMessage:"Edu License (pending activation)"},resellerHostedEduLicense:{id:"organizationBillingInfo.resellerHostedEduLicense",defaultMessage:"Edu License"},activeTeamLicense:{id:"organizationBillingInfo.activeTeamLicense",defaultMessage:"Team License"},activeTeamLicenseNonProfitOrg:{id:"organizationBillingInfo.activeTeamLicenseNonProfitOrg",defaultMessage:"Team License (Non Profit Discount)"},pendingTeamLicense:{id:"organizationBillingInfo.pendingTeamLicense",defaultMessage:"Team License (pending activation)"},licenseExpiry:{id:"organizationBillingInfo.licenseExpiry",defaultMessage:"Active until {expiryDate, date, long}"},renewalDate:{id:"organizationBillingInfo.renewalDate",defaultMessage:"Renews on {expiryDate, date, long}"},deactivateDate:{id:"organizationBillingInfo.deactivateDate",defaultMessage:"Deactivates on {expiryDate, date, long}"},seatsTitle:{id:"organizationBillingInfo.seatsTitle",defaultMessage:"Seats"},seatsInUse:{id:"organizationBillingInfo.seatsInUse",defaultMessage:"{numSeats} in use ({numSeatsPct})"},invoicesTitle:{id:"organizationBillingInfo.invoicesTitle",defaultMessage:"Invoices"},invoiceName:{id:"organizationBillingInfo.invoiceName",defaultMessage:"Invoice: {createdDate, date, long}"},defaultInvoiceName:{id:"organizationBillingInfo.defaultInvoiceName",defaultMessage:"Invoice"},paidInvoice:{id:"organizationBillingInfo.paidInvoice",defaultMessage:"Paid: {invoiceDate, date, long}"},upcomingInvoice:{id:"organizationBillingInfo.upcomingInvoice",defaultMessage:"Due: {invoiceDate, date, long}"},noInvoices:{id:"organizationBillingInfo.noInvoices",defaultMessage:"No invoices found"},manageSubscription:{id:"organizationBillingInfo.manageSubscription",defaultMessage:"Manage subscription"},cancelSubscriptionBtn:{id:"organizationBillingInfo.cancelSubscriptionBtn",defaultMessage:"Cancel subscription"},manageLicenseBtn:{id:"organizationBillingInfo.manageLicenseBtn",defaultMessage:"Manage license"},managePaymentMethod:{id:"organizationBillingInfo.managePaymentMethod",defaultMessage:"Payment method"},manageBillingSchedule:{id:"organizationBillingInfo.manageSchedule",defaultMessage:"Billing schedule"},stripeErrorWarning:{id:"organizationBillingInfo.stripeErrorWarning",defaultMessage:"Error loading account information"},teamsAutochargeMessage:{id:"organizationBillingInfo.teamsAutochargeMessage",defaultMessage:"Your additional seats will be included on your next invoice."},billingLearnMore:{id:"organizationBillingInfo.billingLearnMore",defaultMessage:"Learn more"}});var eB=!0;function eL(){return(0,P.jsx)(eD,{})}eL.getLayout=function(e){return(0,P.jsx)(u.ZP,{mobilePageTitle:"Billing",requireOwnerPrivileges:!0,children:e})}},32378:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var a=n(651);function i(){return(0,a.jsx)("hr",{className:"w-full border-token-border-xheavy"})}},8040:function(e,t,n){"use strict";n.d(t,{$V:function(){return m},A4:function(){return g},Li:function(){return b},W8:function(){return h},i$:function(){return p},i9:function(){return j},qQ:function(){return x},vi:function(){return v}});var a,i,s,l,r,o,c,d,u=n(2346),f=n(15478);let m=f.Z.div(a||(a=(0,u.Z)(["text-base text-token-text-primary flex flex-col gap-10 my-10"]))),g=f.Z.div(i||(i=(0,u.Z)(["text-xl font-semibold"]))),p=f.Z.div(s||(s=(0,u.Z)(["text-base font-semibold"]))),x=f.Z.div(l||(l=(0,u.Z)(["flex flex-col divide-y divide-token-border-light border-y border-token-border-light"]))),j=f.Z.div(r||(r=(0,u.Z)(["flex flex-col gap-3 w-full m-auto md:m-0"]))),b=f.Z.div(o||(o=(0,u.Z)(["text-sm"]))),v=f.Z.div(c||(c=(0,u.Z)(["flex justify-between py-4 gap-4"]))),h=f.Z.hr(d||(d=(0,u.Z)(["max-w-xl border-token-border-light"])))},84082:function(e,t,n){"use strict";n.d(t,{$e:function(){return s},EZ:function(){return l},Ql:function(){return i},dO:function(){return a},xC:function(){return r}});let a=10,i=4,s={duration:20,hasCloseButton:!0},l=512,r=536870912},98628:function(e,t,n){"use strict";n.d(t,{R3:function(){return y},W7:function(){return b},cT:function(){return h},lU:function(){return w},po:function(){return v}});var a=n(98601),i=n(99333),s=n(2721),l=n(92319),r=n(99976),o=n(61619),c=n(82363),d=n(68306),u=n(88815),f=n(24740),m=n(62166),g=n(66114);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let j={duration:20,hasCloseButton:!0};function b(e){return JSON.stringify({file:e.name,modified:e.lastModified,currentTime:new Date().toString()})}function v(e){return new Promise((t,n)=>{let a=new FileReader,i=new Image;a.onload=()=>{i.onload=()=>t(i),i.onerror=e=>n(e),i.src=a.result},a.readAsDataURL(e)})}async function h(e,t,n,a,c,d){var m,g,p;let x=u.N.getState().resetRateLimits,b=i.EG.Initial;r.A.logEvent(o.M.uploadFileInitiated,{client:"web",useCase:a.kind,uploadEntry:"local"});let v=d.usesRetrievalIndex?performance.now():void 0;try{let{file_id:l,upload_url:r}=await s.Z.createFile(t.name,t.size,a,!!x);c.onFileCreated(e,l,r),b=i.EG.FileCreated;let o=a.kind===i.Ei.Gizmo?a.gizmoId:void 0,u=null!==(m=d.shouldUpdateProgress)&&void 0!==m&&m,p=null!==(g=d.usesRetrievalIndex)&&void 0!==g&&g,h=await s.Z.uploadFileToAzureStorage(t,r,t=>{u&&c.onFileUploadProgress(e,10+80*t)});if(c.onFileUploadProgress(e,90),201!==h.status&&P(h,l,p),b=i.EG.FileUploaded,await s.Z.processFileUpload(l,{gizmoId:o}),b=i.EG.FileProcessed,d.usesRetrievalIndex){let t=await M(l,o);(null==t?void 0:t.status)===i.Xf.Skipped&&f.m.danger(n.formatMessage(S.retrievalSkippedFile,{fileName:t.name}),j),c.onFileUploaded(e,l,void 0,{fileTokenSize:t.file_size_tokens}),b=i.EG.RetrievalIndexCreated}else c.onFileUploaded(e,l,d.imageDimensions);null!=v&&s.Z.postRetrievalTiming({e2eLatencyMs:performance.now()-v,type:"file"})}catch(s){O(n,t.name,s);let i="NotInstanceOfError";s instanceof l.gK?i=s.name:s instanceof l.Q0?i="FatalServerError_type_".concat(null!==(p=s.type)&&void 0!==p?p:"undefined"):s instanceof Error?i=s.name:s instanceof l.vq&&(i=s.name),c.onError(e,"error",i,a,b)}}async function y(e,t,n,a,d,u,p){let b=performance.now();r.A.logEvent(o.M.uploadFileInitiated,{client:"web",useCase:n.kind,contextConnector:d.contextConnector,fileSourceType:d.type});let v=i.EG.Initial;n.kind===i.Ei.Gizmo&&(n=x(x({},n),{},{kind:a.includes(t.type)?i.Ei.Multimodal:i.Ei.MyFiles}));try{let a=await s.Z.uploadConnectorAPI(e,d.contextConnector,n,t,u,d.o365DriveId);switch(a.type){case"error":throw function(e){let{status_code:t,error_code:n,error_message:a}=e;if(!t||!(t<500))return new l.Q0(a);{let e="internal_error";return n?e=n:404===t?e="file_not_found":403===t?e="permission_error":413===t&&(e="file_too_large"),new l.vq(a,e)}}(a.error);case"file":switch(m.MP.onFileCreated(e,a.file.id,"",d.contextConnector),v=i.EG.FileProcessed,n.kind){case i.Ei.MyFiles:{m.MP.onFileUploadProgress(e,90);let t=await M(a.file.file_id,u);(null==t?void 0:t.status)===i.Xf.Skipped&&f.m.danger(p.formatMessage(S.retrievalSkippedFile,{fileName:t.name}),j),m.MP.onFileUploaded(e,a.file.file_id,void 0,{fileTokenSize:t.file_size_tokens,mimeType:a.file.mime_type}),v=i.EG.RetrievalIndexCreated;break}case i.Ei.Multimodal:m.MP.onFileUploaded(e,a.file.file_id,{width:512,height:512},{mimeType:a.file.mime_type});break;case i.Ei.AceUpload:m.MP.onFileUploaded(e,a.file.file_id,void 0,{mimeType:a.file.mime_type});break;case i.Ei.DalleAgent:case i.Ei.Gizmo:case i.Ei.ProfilePicture:throw new l.vq("Use case not supported by cloud doc: ".concat(n.kind))}break;case"folder":throw new l.vq("Folder type not supported")}s.Z.postRetrievalTiming({e2eLatencyMs:performance.now()-b,type:d.contextConnector})}catch(a){c.U.addError(Error("Failed to upload connected file by ".concat(d.contextConnector),{cause:a})),O(p,(0,g.Ad)(t.name,null==d?void 0:d.syntheticExtension),a);let n="NotInstanceOfError";if(a instanceof l.Q0){var h;n="FatalServerError_type_".concat(null!==(h=a.type)&&void 0!==h?h:"undefined")}else(a instanceof l.gK||a instanceof Error||a instanceof l.vq)&&(n=a.name);m.MP.onError(e,"error",n,{kind:i.Ei.MyFiles},v)}}async function w(e,t,n,a,i){let{width:s,height:l}=await v(t);return h(e,t,n,{kind:a},i,{imageDimensions:{width:s,height:l}})}async function M(e,t){let n=Date.now()+6e4,a=e=>new Promise(t=>setTimeout(t,e)),r=0;for(;Date.now()<n;){let n=await s.Z.getRetrievalStatus(e,t);if(n.status===i.Xf.Success||n.status===i.Xf.Skipped)return n;if(n.status===i.Xf.Failed)throw new l.vq("Context extraction failed",n.error_code);r++,await a(Math.min(1e3,100*r))}throw new l.vq("Retrieval indexing timed out")}async function P(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a="Unknown error";try{a=await e.data}catch(e){}throw n&&s.Z.markFileUploadFailed(t,{error:a}),new l.vq("File upload to blobstore failed","failed_upload_to_blobstore")}function O(e,t,n){let a=(0,g.kr)(e,"default_upload_error",{fileName:t});n instanceof l.vq&&null!=n.code&&(a=(0,g.kr)(e,n.code)),f.m.danger(a,j)}let S=(0,d.vU)({retrievalSkippedFile:{id:"useFilePickerState.retrievalSkippedFile",defaultMessage:'Unable to extract text from "{fileName}"'}})},62166:function(e,t,n){"use strict";n.d(t,{Dw:function(){return h},HR:function(){return v},MP:function(){return y},gF:function(){return b}});var a=n(98601),i=n(99333),s=n(99976),l=n(61619),r=n(82363),o=n(68306),c=n(68810),d=n(24740),u=n(84082),f=n(93866),m=n(98628),g=n(66114);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let j={files:[],connectorFileData:{}},b=(0,c.Ue)(()=>j),v={hasUploadInProgress:e=>{let{files:t}=e;return t.some(e=>e.status===f.XX.Uploading)},getReadyFiles:e=>{let{files:t}=e;return t.filter(e=>e.status===f.XX.Ready)}},h={reset:()=>{b.setState(j)},uploadFile:async function(e,t,n,a,o){let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},p=arguments.length>6?arguments[6]:void 0,x=arguments.length>7?arguments[7]:void 0,{gizmoId:j}=c,v=b.getState().files,h=(0,g.xs)(n,t.name,t.type,null==x?void 0:x.contextConnector,p),M={tempId:e,gizmoId:c.gizmoId,status:f.XX.Uploading,file:t,progress:1,fileId:null,cdnUrl:null,contextConnectorInfo:x,contextConnector:null==x?void 0:x.contextConnector};if(v.length===u.dO)s.A.logEvent(l.M.uploadedMaxFilesError),d.m.danger(o.formatMessage(w.maxUploadsAtATime,{maxUploads:u.dO,fileName:t.name}),u.$e);else if(v.some(t=>t.tempId===e))s.A.logEvent(l.M.uploadedDuplicateFileError),d.m.danger(o.formatMessage(w.duplicateFileAttached,{fileName:t.name.length>20?t.name.slice(0,19)+"â€¦":t.name}),u.$e);else{let n;b.setState(e=>{let{files:t}=e;return{files:[...t,M]}});let s={};if(a.includes(t.type)){if(n={kind:i.Ei.Multimodal},!x){let{width:e,height:n}=await (0,m.po)(t);if(e>2048||n>2048)try{let a=await (0,g.Tu)(t,2048),i=await (0,m.po)(a);e=i.width,n=i.height,t=a}catch(e){r.U.addError(Error("Error resizing image:",{cause:e}))}s.imageDimensions={width:e,height:n}}}else switch(h){case f.AJ.Multimodal:throw Error("Multimodal file upload not supported mime type, ".concat(t.type,"\nSupported mime types: ")+a.join(", "));case f.AJ.Interpreter:n={kind:i.Ei.AceUpload};break;case f.AJ.Retrieval:n={kind:i.Ei.MyFiles},s.usesRetrievalIndex=!0;break;case f.AJ.ProfilePicture:throw Error("cannot upload profile picture via uploadFile");case f.AJ.ContextConnector:case f.AJ.None:return}null!=j&&(n={kind:i.Ei.Gizmo,gizmoId:j}),c.skipUpload||(x?await (0,m.R3)(e,t,n,a,x,c.gizmoId,o):await (0,m.cT)(e,t,o,n,y,s))}},createFileCompleted:(e,t,n,a)=>{let i=b.getState().files,s=i.findIndex(t=>t.tempId===e),l=i[s];if(s>=0&&l.status===f.XX.Uploading){let e=[...i];e.splice(s,1,x(x({},l),{},{progress:10,fileId:t,cdnUrl:n,contextConnector:a})),b.setState({files:e})}},updateProgress:(e,t)=>{let n=b.getState().files,a=n.findIndex(t=>t.tempId===e),i=n[a];if(a>=0&&i.status===f.XX.Uploading){let e=[...n];e.splice(a,1,x(x({},i),{},{progress:t})),b.setState({files:e})}},uploadCompleted:(e,t,n,a,i)=>{let r=b.getState().files,o=r.findIndex(t=>t.tempId===e);if(o>=0&&r[o].status===f.XX.Uploading&&null!=r[o].fileId){var c,d,u;let t=r[o],m=[...r],p=x(x({},t),{},{tempId:e,status:f.XX.Ready,progress:100,fileSpec:x(x({name:t.file.name,id:t.fileId,size:t.file.size,contextConnectorInfo:t.contextConnectorInfo,mimeType:null!==(c=null!==(d=null==a?void 0:a.mimeType)&&void 0!==d?d:t.file.type)&&void 0!==c?c:(0,g.s1)(t.file.name)},n||{}),a||{})});m.splice(o,1,p);let j=x({},b.getState().connectorFileData);i&&(j[null==i?void 0:i.file_id]=i),b.setState({files:m,connectorFileData:j}),s.A.logEvent(l.M.uploadFileCompleted,{status:t.status,fileId:t.fileId,contextConnector:null!==(u=t.contextConnector)&&void 0!==u?u:"local"})}},remove:(e,t,n,a,i)=>{let r=b.getState().files,o=r.findIndex(t=>t.tempId===e);if(o>=0){let e=r[o];"error"===t?s.A.logEvent(l.M.uploadFileError,{status:e.status,fileId:e.fileId,client:"web",errorClassName:null!=n?n:"undefined",useCaseType:a,uploadStatus:null!=i?i:"undefined",contextConnector:e.contextConnector}):s.A.logEvent(l.M.removeFile,{status:e.status,fileId:e.fileId});let c=[...r];c.splice(o,1),b.setState({files:c})}}},y={onFileCreated:h.createFileCompleted,onFileUploadProgress:h.updateProgress,onFileUploaded:h.uploadCompleted,onError:h.remove},w=(0,o.vU)({maxUploadsAtATime:{id:"useFilePickerState.maxUploadsAtATime",defaultMessage:"Unable to upload {fileName}. Max {maxUploads} uploads at a time"},duplicateFileAttached:{id:"useFilePickerState.duplicateFileAttached",defaultMessage:"Unable to upload {fileName} because an identical file has already been attached to this message."}})},88815:function(e,t,n){"use strict";n.d(t,{J:function(){return i},N:function(){return s}});var a=n(68810);let i={label:"Auto",value:""},s=(0,a.Ue)(()=>({forceParagen:!1,forceParagenModel:i,forceNulligen:!1,forceIndepthFeedback:!1,forceIndepthFeedbackPrompt:"The user has opted in to provide additional feedback on the previous response. Encourage the user to share feedback that you can store in a memory to better meet their needs in future. Use no more than 3 turns. If at any point the user indicates no longer wanting to provide feedback, return to the original topic.",forceRateLimit:!1,resetRateLimits:!1,showDebugConversationTurns:!1,rebaseSystemMessageContent:null}))},60806:function(e,t,n){"use strict";function a(e){let t=Object.values(e);return e=>t.includes(e)}n.d(t,{b:function(){return a}})},51270:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/billing",function(){return n(29237)}])}},function(e){e.O(0,[2205,4198,6636,4089,9504,7137,3088,8500,2406,3183,2349,5162,7437,7035,9725,6803,5385,9417,2230,2879,3662,2888,9774,179],function(){return e(e.s=51270)}),_N_E=e.O()}]);
//# sourceMappingURL=billing-ab9fb03be783dfa0.js.map