(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2571],{10737:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return en},default:function(){return eo}});var o,i=n(98601),a=n(68986),s=n(99333),r=n(59144),l=n(24434),d=n(82821),c=n(42420),u=n(58695),f=n(88667),m=n(19841);class p extends Error{}p.prototype.name="InvalidTokenError";var g=n(38482),b=n.n(g),x=n(11941),y=n.n(x),v=n(92379),h=n(62984),j=n(75172),w=n(68306),I=n(11550),M=n(16779),k=n(77748),O=n(98095),S=n(36792),T=n(88491),C=n(12310),Z=n(651);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function P(e){let{onRemoveDomainClick:t,onVerifyDomainClick:n}=e;return(0,Z.jsxs)(O.Z.Root,{children:[(0,Z.jsx)(O.Z.Trigger,{children:(0,Z.jsx)(k.nWS,{className:"icon-sm"})}),(0,Z.jsx)(O.Z.Portal,{children:(0,Z.jsxs)(O.Z.Content,{children:[(0,Z.jsx)(O.Z.Item,{onClick:t,children:(0,Z.jsx)(h.Z,E({},L.ssoDropdownRemoveButtonText))}),(0,Z.jsx)(O.Z.Item,{onClick:n,children:(0,Z.jsx)(h.Z,E({},L.ssoDropdownVerifyButtonText))})]})})]})}function N(e){let{domains:t,workspaceId:n}=e,o=(0,j.Z)(),{mutateAsync:i}=(0,C.Bd)(n),{0:a,1:s}=(0,v.useState)(!1),{0:r,1:l}=(0,v.useState)();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(S.Z.Root,{className:"w-full table-auto",children:[(0,Z.jsxs)(S.Z.Header,{children:[(0,Z.jsx)(S.Z.HeaderCell,{className:"bg-token-main-surface-primary",children:(0,Z.jsx)(h.Z,E({},L.domainTableHeader))}),(0,Z.jsx)(S.Z.HeaderCell,{className:"bg-token-main-surface-primary",children:(0,Z.jsx)(h.Z,E({},L.statusTableHeader))}),(0,Z.jsx)(S.Z.HeaderCell,{className:"bg-token-main-surface-primary"})]}),(0,Z.jsx)(S.Z.Body,{children:t.map((e,t)=>(0,Z.jsxs)("tr",{onClick:()=>l(e),className:"cursor-pointer",children:[(0,Z.jsx)(S.Z.Cell,{children:e.hostname}),(0,Z.jsx)(S.Z.Cell,{children:o.formatMessage(C.sd[e.status])}),(0,Z.jsx)(S.Z.Cell,{textAlign:"right",children:(0,Z.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,Z.jsx)(P,{onRemoveDomainClick:()=>{i({domainId:e.id})},onVerifyDomainClick:()=>{l(e)}})})})]},t))})]}),(0,Z.jsx)(I.z,{color:"secondary",className:"mt-6",onClick:()=>{s(!0)},icon:k.Vz5,children:(0,Z.jsx)(h.Z,E({},L.addDomainButton))}),(0,Z.jsx)(T.Z,{isOpen:a||void 0!==r,onClose:()=>{s(!1),l(void 0)},workspaceId:n,currentDomain:a?void 0:r,domains:t},null==r?void 0:r.id)]})}let L=(0,w.vU)({ssoDropdownRemoveButtonText:{id:"workspaceIdentity.ssoDropdownRemoveButtonText",defaultMessage:"Remove Domain"},ssoDropdownVerifyButtonText:{id:"workspaceIdentity.ssoDropdownVerifyButtonText",defaultMessage:"Verify"},domainTableHeader:{id:"workspaceIdentity.domainTableHeader",defaultMessage:"Domain"},statusTableHeader:{id:"workspaceIdentity.statusTableHeader",defaultMessage:"Status"},addDomainButton:{id:"workspaceIdentity.addDomainButton.0",defaultMessage:"Add domain"}});var A=n(64216),B=n(6440),_=n(24740),R=n(92319),F=n(8040);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let V=async e=>new Promise((t,n)=>{let o=new FileReader;o.readAsText(e),o.onload=function(e){var n;t(null===(n=e.target)||void 0===n?void 0:n.result)},o.onerror=n});function X(e){let{acsId:t,hasSSO:n}=e,o="https://auth0.openai.com/login/callback?connection=".concat(t),i="urn:auth0:openai:".concat(t),a="".concat(location.host,"/auth/login?sso=true&connection=").concat(t),s=(0,j.Z)();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(F.Li,{children:(0,Z.jsx)(h.Z,H({},G.setupSSOContent))}),(0,Z.jsxs)("div",{className:"mb-6 flex flex-col space-y-4",children:[(0,Z.jsx)(A.Z,{label:"Assertion Consumer Service (ACS) URL",value:o,onCopied:()=>{_.m.success(s.formatMessage(G.copiedACSToClipboard),{duration:3})}}),(0,Z.jsx)(A.Z,{label:"Entity ID",value:i,onCopied:()=>{_.m.success(s.formatMessage(G.copiedEntityToClipboard),{duration:3})}}),n&&(0,Z.jsx)(A.Z,{label:s.formatMessage(G.idpSignInURL),value:a,onCopied:()=>{_.m.success(s.formatMessage(G.copiedIDPUrlToClipboard),{duration:3})}})]})]})}var q=((o=q||{})[o.CREATE=1]="CREATE",o[o.EDIT=2]="EDIT",o);function z(e){let{workspaceId:t,data:n,isOpen:o,onClose:i}=e,a=(0,j.Z)(),s=(0,d.b)(),{mutateAsync:c}=(0,C.Fc)(t),{mutateAsync:u}=(0,C.OR)(t),{mutateAsync:f}=(0,C.DD)(t),p=(0,v.useRef)(null),g=null==n?void 0:n.connection,{0:b,1:x}=(0,v.useState)(null==g?void 0:g.sign_in_endpoint),{0:y,1:w}=(0,v.useState)(!1),{0:M,1:O}=(0,v.useState)(null==g?void 0:g.cert),S=null===n?q.CREATE:q.EDIT,T=async(e,t)=>{let n;try{n=await c({signInEndpoint:e,cert:t})}catch(e){if(e instanceof R.gK&&"reauth_required"===e.code){w(!0);return}throw e}await f({connectionId:n.id,active:!0}),i()},D=S===q.CREATE?(0,Z.jsx)(r.Z.Button,{title:a.formatMessage(G.doneButton),color:"primary",disabled:void 0===b||void 0===M,onClick:async()=>{void 0!==b&&void 0!==M&&await T(b,M)}}):n&&(0,Z.jsx)(r.Z.Button,{title:a.formatMessage(G.doneButton),color:"primary",onClick:async()=>{await f({connectionId:null==n?void 0:n.id,cert:M,signInEndpoint:b,active:!0}),i()}}),E=null===n?(0,Z.jsx)(r.Z.Button,{title:a.formatMessage(G.cancelButton),color:"secondary",onClick:()=>i()}):(0,Z.jsx)(I.z,{as:"link",color:"danger-outline",onClick:async()=>{await u({connectionId:null==n?void 0:n.id}),i()},children:a.formatMessage(G.deleteButton)});return(0,Z.jsx)(l.Z,{isOpen:o,type:"success",title:a.formatMessage(S===q.CREATE?G.createTitle:G.editTitle),primaryButton:D,secondaryButton:E,onClose:i,children:(0,Z.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,Z.jsx)(C.z0,{children:(0,Z.jsx)(h.Z,H({},G.createInstructionsManual))}),(0,Z.jsx)("label",{className:"mb-2 flex items-center text-sm",children:(0,Z.jsx)(h.Z,H({},G.signInLabel))}),(0,Z.jsx)("div",{className:"mb-4",children:(0,Z.jsx)(B.Z,{className:"w-full appearance-none rounded border px-3 py-2",name:"Sign-In URL",type:"text",placeholder:"https://your.idp.here/saml2?idpid=123456",value:null!=b?b:"",onChange:e=>{x(e.target.value)}})}),(0,Z.jsxs)("div",{className:"mb-4",children:[(0,Z.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,Z.jsx)("label",{className:"text-sm",children:(0,Z.jsx)(h.Z,H({},G.certLabel))}),(0,Z.jsx)("input",{ref:p,type:"file",accept:".csv,.cer,.pem,text/plain",className:"hidden",onChange:async e=>{var t;null!==(t=e.target.files)&&void 0!==t&&t[0]&&O(await V(e.target.files[0]))}}),(0,Z.jsx)(I.z,{color:"secondary",onClick:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.click()},icon:k.aAc})]}),(0,Z.jsx)("textarea",{rows:10,className:(0,m.default)("w-full resize-none overflow-y-auto rounded border border-gray-300 px-3 py-2","outline-none focus-within:border-green-600 focus-within:ring-1 focus-within:ring-green-600","text-token-text-primary placeholder-gray-500 dark:bg-gray-700"),placeholder:"-----BEGIN CERTIFICATE-----",value:null!=M?M:"",onChange:e=>{O(e.target.value)}})]}),y&&(0,Z.jsx)("label",{className:"text-token-text-error",children:(0,Z.jsx)(h.Z,{id:"ZfFabW",defaultMessage:"You need to re-authenticate to access this page. Please <login>log in</login> before continuing.",values:{login:e=>(0,Z.jsx)("a",{href:"#",className:"text-token-text-primary underline",onClick:e=>{e.preventDefault(),s({authType:"login",callbackUrl:"/admin/identity"})},children:e})}})})]})})}let G=(0,w.vU)({setupSSOContent:{id:"workspaceIdentity.setupSSOContent",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO."},createInstructionsXML:{id:"ssoModal.createInstructionsXML",defaultMessage:"If your Identity Provider offers a metadata URL or an XML file, add it here for the quickest setup option."},createInstructionsManual:{id:"ssoModal.createInstructionsManual",defaultMessage:"Copy your Sign-in endpoint (SSO URL) and the public X.509 certificate from your Identity Provider."},createTitle:{id:"ssoModal.createTitle",defaultMessage:"Create SAML SSO Configuration"},editTitle:{id:"ssoModal.editTitle",defaultMessage:"Edit SAML SSO Configuration"},ssoMetadataLabel:{id:"ssoModal.ssoMetadataLabel",defaultMessage:"App Federation Metadata URL"},signInLabel:{id:"ssoModal.signInLabel",defaultMessage:"SSO URL"},certLabel:{id:"ssoModal.certLabel",defaultMessage:"X.509 Signing Certificate"},doneButton:{id:"ssoModal.doneButton",defaultMessage:"Done"},nextButton:{id:"ssoModal.nextButton",defaultMessage:"Next"},deleteButton:{id:"ssoModal.deleteButton",defaultMessage:"Delete configuration"},cancelButton:{id:"ssoModal.cancelButton",defaultMessage:"Cancel"},acsURLLabel:{id:"workspaceIdentity.acsURLLabel",defaultMessage:"Assertion Consumer Service (ACS) URL"},entityIDLabel:{id:"workspaceIdentity.entityIDLabel",defaultMessage:"Entity ID"},idpSignInURL:{id:"workspaceIdentity.idpSignInURL",defaultMessage:"IDP Tile URL"},copiedACSToClipboard:{id:"workspaceIdentity.copiedACSToClipboard",defaultMessage:"Copied ACS URL to clipboard"},copiedEntityToClipboard:{id:"workspaceIdentity.copiedEntityToClipboard",defaultMessage:"Copied entity ID to clipboard"},copiedIDPUrlToClipboard:{id:"workspaceIdentity.copiedIDPUrlToClipboard",defaultMessage:"Copied IDP URL to clipboard"},orDivider:{id:"workspaceIdentity.orDivider",defaultMessage:"or"},certExtractFailed:{id:"workspaceIdentity.certExtractFailed",defaultMessage:"Unable to find X.509 Certificate in provided XML"},ssoUrlExtractFailed:{id:"workspaceIdentity.ssoUrlExtractFailed",defaultMessage:"Unable to find Entity ID (sign-in endpoint) in provided XML"},ssoLearnMoreLink:{id:"workspaceIdentity.ssoLearnMoreLink",defaultMessage:"Learn more"}});function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let W=b()(()=>n.e(5622).then(n.bind(n,95622)).then(e=>e.DirectorySyncSection),{loadableGenerated:{webpack:()=>[95622]}}),K=e=>{let{title:t,footer:n,children:o}=e;return(0,Z.jsxs)(F.i9,{children:[(0,Z.jsx)(F.A4,{children:(0,Z.jsx)(h.Z,Q({},t))}),(0,Z.jsx)("div",{children:o}),(0,Z.jsx)(F.Li,{children:n})]})},Y=e=>{let{icon:t,title:n,body:o,toggle:i}=e;return(0,Z.jsxs)(F.i9,{children:[(0,Z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Z.jsx)(t,{className:"icon-sm"}),(0,Z.jsx)(F.A4,{children:(0,Z.jsx)(h.Z,Q({},n))})]}),(0,Z.jsx)("div",{children:i})]}),(0,Z.jsx)(F.Li,{children:o})]})};function J(e){var t,n,o,i,g,b,x,w;let{currentWorkspaceId:O}=e,{value:S}=(0,f.sB)("3999712942"),T=(0,j.Z)(),D=(0,c.NL)(),{data:E,isLoading:P}=(0,C.f_)(O),L=(0,d.b)(),{mutateAsync:A}=(0,C.DD)(O),{variables:B,mutateAsync:_}=(0,C.Ji)(O),{variables:R,mutateAsync:U}=(0,C.HH)(O),H=(null==E?void 0:E.sso_connection)!=null,V=null==E?void 0:E.domains,q=!!(null!=V&&V.some(e=>e.status===s.pT.VERIFIED)),G=H?ee.ssoEditButton:ee.ssoAddButton,{0:$,1:J}=(0,v.useState)(!1),{0:et,1:en}=(0,v.useState)(!1),eo=(null==E||null===(t=E.sso_connection)||void 0===t?void 0:t.status)==="ACTIVE",ei=null!==(n=null==E||null===(o=E.sso_connection)||void 0===o||null===(o=o.connection)||void 0===o||null===(o=o.enabled_client_names)||void 0===o?void 0:o.includes("chat"))&&void 0!==n&&n,ea=eo&&ei,es=null==E||null===(i=E.sso_connection)||void 0===i?void 0:i.id,er=null===(g=null!==(b=null==R?void 0:R.shouldAllowExternalDomainInvites)&&void 0!==b?b:null==E?void 0:E.allow_external_domain_invites)||void 0===g||g,el=E?(0,Z.jsxs)(F.$V,{children:[S&&(0,Z.jsx)(W,{workspaceId:O}),(0,Z.jsx)(K,{title:ee.domainSubtitle,footer:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(h.Z,Q({},ee.verifyDomainInfoText))}),children:(0,Z.jsx)(N,{domains:E.domains,workspaceId:O})}),(0,Z.jsx)(Y,{icon:k.uSF,title:ee.autoProvisionTitle,body:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(h.Z,Q({},ee.autoProvisionBody))}),toggle:(0,Z.jsx)(M.Z,{disabled:!q,enabled:null!==(x=null==B?void 0:B.shouldAutoProvision)&&void 0!==x?x:E.should_auto_provision,onChange:e=>{_({shouldAutoProvision:e})},label:T.formatMessage(ee.toggleAutoProvisionLabel)})}),q&&(0,Z.jsx)(Y,{icon:k.ZyU,title:ee.allowExternalDomainInvitesTitle,body:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(h.Z,Q({},ee.allowExternalDomainInvitesBody))}),toggle:(0,Z.jsx)(M.Z,{disabled:!q&&er,enabled:er,onChange:e=>{U({shouldAllowExternalDomainInvites:e})},label:T.formatMessage(ee.toggleDisableExternalDomainInvitesLabel)})}),(0,Z.jsxs)(F.i9,{children:[(0,Z.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Z.jsx)(k.kaz,{className:(0,m.default)("icon-sm",ea?"text-blue-600":"text-token-text-tertiary")}),(0,Z.jsx)(F.A4,{children:(0,Z.jsx)(h.Z,Q({},ee.ssoTitle))})]}),H&&(0,Z.jsx)("div",{children:(0,Z.jsx)(M.Z,{enabled:ea,onChange:()=>{A({connectionId:es,active:!ea})},label:T.formatMessage(ee.ssoToggleActive)})})]}),q&&(0,Z.jsx)(X,{acsId:E.acs_id,hasSSO:H}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)(I.z,{as:"button",color:"primary",disabled:!q,onClick:()=>{!function(e){var t;let n=null===(t=(0,u.y_)(e))||void 0===t?void 0:t.accessToken,o=n?function(e,t){let n;if("string"!=typeof e)throw new p("Invalid token specified: must be a string");t||(t={});let o=!0===t.header?0:1,i=e.split(".")[o];if("string"!=typeof i)throw new p(`Invalid token specified: missing part #${o+1}`);try{n=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var n;return n=t,decodeURIComponent(atob(n).replace(/(.)/g,(e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}catch(e){return atob(t)}}(i)}catch(e){throw new p(`Invalid token specified: invalid base64 for part #${o+1} (${e.message})`)}try{return JSON.parse(n)}catch(e){throw new p(`Invalid token specified: invalid json for part #${o+1} (${e.message})`)}}(n):null,i=null==o?void 0:o.pwd_auth_time;return null!=i&&Date.now()-i<6e4}(D)?J(!0):en(!0)},children:(0,Z.jsx)(h.Z,Q({},G))}),(0,Z.jsx)(z,{workspaceId:O,data:E.sso_connection,isOpen:et,onClose:()=>{en(!1)}}),(0,Z.jsx)(l.Z,{isOpen:$,onClose:()=>J(!1),type:"warning",title:T.formatMessage(ee.reauthRequiredTitle),icon:k.oVl,primaryButton:(0,Z.jsx)(r.Z.Button,{onClick:()=>{L({authType:"login",callbackUrl:"/admin/identity"})},color:"primary",children:(0,Z.jsx)(h.Z,{id:"qcl4gn",defaultMessage:"Login"})}),secondaryButton:(0,Z.jsx)(r.Z.Button,{onClick:()=>J(!1),children:(0,Z.jsx)(h.Z,{id:"E1vtdZ",defaultMessage:"Close"})}),children:(0,Z.jsx)("label",{className:"mb-2 flex items-center text-sm",children:T.formatMessage(ee.reauthRequiredExplanation)})})]})]}),E.sso_connection&&(0,Z.jsx)(Y,{icon:k.oVl,title:ee.enforceSSOTitle,body:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(h.Z,Q({},ee.enforceSSOBody))}),toggle:(0,Z.jsx)(M.Z,{disabled:!q,enabled:null===(w=E.sso_connection.auth0_enforced_clients)||void 0===w?void 0:w.includes("chat"),onChange:e=>{A({connectionId:E.sso_connection.id,enforcedClients:e?["chat"]:[]})},label:T.formatMessage(ee.enforceSSOLabel)})})]}):null;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(y(),{children:(0,Z.jsx)("title",{children:T.formatMessage(ee.title)})}),(0,Z.jsx)(a.yG,{title:T.formatMessage(ee.title)}),(0,Z.jsx)(a.hb,{showSpinner:P,children:el})]})}let ee=(0,w.vU)({title:{id:"workspaceIdentity.title",defaultMessage:"Identity & Provisioning"},domainSubtitle:{id:"workspaceIdentity.domainSubtitle",defaultMessage:"Domain management"},ssoTitle:{id:"workspaceIdentity.ssoTitle",defaultMessage:"Single Sign On"},ssoToggleActive:{id:"WorkspaceIdentityPage.ssoToggleActive",defaultMessage:"Enable SSO for this workspace"},ssoAddButton:{id:"workspaceIdentity.ssoAddButton",defaultMessage:"Add SAML SSO"},ssoEditButton:{id:"workspaceIdentity.ssoEditButton",defaultMessage:"Edit SAML SSO"},autoProvisionTitle:{id:"workspaceIdentity.autoProvisionSubtitle",defaultMessage:"Automatic account creation"},autoProvisionBody:{id:"workspaceIdentity.autoProvisionBody",defaultMessage:"Automatically create workspace accounts for new users who log in with a verified domain."},toggleAutoProvisionLabel:{id:"workspaceIdentity.toggleAutoProvisionLabel",defaultMessage:"Toggle to enable or disable auto provisioning"},allowExternalDomainInvitesTitle:{id:"RQGwuu",defaultMessage:"Allow External Domain Invites"},allowExternalDomainInvitesBody:{id:"7KRqHk",defaultMessage:"If not checked, future invitations to this workspace will be limited to users from this organization's verified domains"},toggleDisableExternalDomainInvitesLabel:{id:"bQy24Z",defaultMessage:"Toggle to enable or disable external domain invites"},enforceSSOTitle:{id:"workspaceIdentity.enforceSSOTitle",defaultMessage:"Enforce SSO log in"},enforceSSOBody:{id:"workspaceIdentity.enforceSSOBody",defaultMessage:"When SSO is active, users will no longer be able to use social logins and will be redirected to your SSO portal."},enforceSSOLabel:{id:"workspaceIdentity.enforceSSOLabel",defaultMessage:"Toggle to enable or disable SSO enforcement"},verifyDomainInfoText:{id:"workspaceIdentity.verifyDomainInfoText",defaultMessage:"Verify ownership of an email domain to access advanced security features including single sign-on."},learnMoreLink:{id:"workspaceIdentity.learnMoreLink",defaultMessage:"Learn more"},reauthRequiredTitle:{id:"workspaceIdentity.reauthRequiredTitle",defaultMessage:"Please login again"},reauthRequiredExplanation:{id:"workspaceIdentity.reauthRequiredExplanation",defaultMessage:"For security reasons, we need you to reauthenticate before making changes to SSO settings."}});function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}var en=!0;function eo(e){return(0,Z.jsx)(J,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e))}eo.getLayout=function(e){return(0,Z.jsx)(a.ZP,{mobilePageTitle:"Identity",requireOwnerPrivileges:!0,children:e})}},64216:function(e,t,n){"use strict";var o=n(79746),i=n(11550),a=n(77748),s=n(651);t.Z=e=>{let{label:t,value:n,onCopied:r}=e,l=()=>{(0,o.v)(n),r()};return(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[void 0!==t&&(0,s.jsx)("label",{className:"font-semibold",children:t}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{onClick:l,className:"w-full cursor-pointer break-all rounded-lg bg-token-main-surface-tertiary px-4 py-2 font-mono text-sm text-token-text-primary",children:n}),(0,s.jsx)(i.z,{color:"ghost",onClick:l,icon:a.TIy})]})]})}},88491:function(e,t,n){"use strict";n.d(t,{Z:function(){return O}});var o,i=n(98601),a=n(99333),s=n(11550),r=n(64216),l=n(6440),d=n(59144),c=n(36792),u=n(77748),f=n(24434),m=n(24740),p=n(2721),g=n(42420),b=n(56032),x=n(92379),y=n(75172),v=n(62984),h=n(68306),j=n(12310),w=n(651);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var k=((o=k||{})[o.INITIAL=0]="INITIAL",o[o.PENDING=1]="PENDING",o[o.FINAL=2]="FINAL",o);function O(e){let{workspaceId:t,isOpen:n,onClose:o,currentDomain:i,domains:s=[],showUnverifiedDomains:l=!1,onVerifyDomain:c}=e,u=(0,y.Z)(),{mutateAsync:h,isPending:j}=function(e){let t=(0,g.NL)();return(0,b.D)({mutationFn:t=>{let{hostname:n}=t;return p.Z.addDomainToWorkspace(e,n)},onSuccess:()=>{t.invalidateQueries({queryKey:["workspace/identity",e]}),t.invalidateQueries({queryKey:["builderProfile"]})},onError:e=>{m.m.danger(e.message)}})}(t),{mutateAsync:I,isPending:O}=function(e){let t=(0,g.NL)();return(0,b.D)({mutationFn:t=>{let{domainId:n}=t;return p.Z.checkDomainForWorkspace(e,n)},onSuccess:()=>{t.invalidateQueries({queryKey:["workspace/identity",e]}),t.invalidateQueries({queryKey:["builderProfile"]})},onError:e=>{m.m.danger(e.message)}})}(t),{0:S,1:Z}=(0,x.useState)(null!=i?i:void 0),{0:D,1:E}=(0,x.useState)(null==i?void 0:i.hostname),{0:P,1:N}=(0,x.useState)((null==i?void 0:i.status)===void 0?k.INITIAL:(null==i?void 0:i.status)===a.pT.PENDING?k.PENDING:k.FINAL),L=()=>{i||(Z(void 0),N(k.INITIAL))},A=async()=>{if(void 0===D)return;let e=s.find(e=>e.hostname===D&&e.status===a.pT.PENDING);if(e)Z(e),N(k.PENDING);else{let e=await h({hostname:D});"id"in e&&Z(e),N(k.PENDING)}},B=(0,w.jsx)(d.Z.Button,{title:u.formatMessage(C.check),color:"primary",disabled:(null==S?void 0:S.id)===void 0||O,onClick:async()=>{if(null!=S&&S.id){let e=await I({domainId:S.id});"error"in e&&m.m.danger(u.formatMessage(C.domainCheckError,{message:e.error.message})),"id"in e&&(c&&c(e),e.status===a.pT.VERIFIED&&N(k.FINAL))}}}),_=(0,w.jsx)(d.Z.Button,{title:u.formatMessage(C.submit),color:"primary",disabled:void 0===D||j,onClick:A}),R=(0,w.jsx)(d.Z.Button,{title:u.formatMessage(C.done),color:"primary",onClick:()=>{L(),o()}});return(0,w.jsxs)(f.Z,{isOpen:n,onClose:()=>{L(),o()},type:"success",className:"text-token-text-secondary",title:u.formatMessage(P===k.INITIAL?C.newTitle:C.editTitle),primaryButton:P===k.INITIAL?_:P===k.PENDING?B:R,secondaryButton:(0,w.jsx)(d.Z.Button,{title:u.formatMessage(C.cancel),color:"secondary",onClick:()=>{L(),o()}}),children:[P===k.INITIAL&&(0,w.jsx)(T,{hostname:D,onSetHostname:E,onSubmit:A,unverifiedDomains:l?s:[],onVerifyDomain:e=>{N(k.PENDING),Z(e)},workspaceId:t}),P===k.PENDING&&(0,w.jsxs)("div",{className:"flex flex-col gap-3",children:[u.formatMessage(C.verificationTokenMessage,{hostname:null==S?void 0:S.hostname}),(null==S?void 0:S.dns_verification_token_string)&&(0,w.jsx)(r.Z,{value:S.dns_verification_token_string,onCopied:()=>{m.m.success(u.formatMessage(C.copiedTXTRecordToClipboard),{duration:3})}}),(0,w.jsx)(v.Z,M({},C.verificationTokenFooter))]}),P===k.FINAL&&(0,w.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,w.jsx)(v.Z,M(M({},C.successfulVerification),{},{values:{hostname:null==S?void 0:S.hostname}})),(null==S?void 0:S.dns_verification_token_string)&&(0,w.jsx)(r.Z,{value:S.dns_verification_token_string,onCopied:()=>{m.m.success(u.formatMessage(C.copiedTXTRecordToClipboard),{duration:3})}})]})]})}function S(e){let{unverifiedDomains:t,onVerifyDomain:n,workspaceId:o}=e,{mutateAsync:i}=(0,j.Bd)(o);return(0,w.jsxs)(c.Z.Root,{fixed:!0,size:"compact",className:"mb-6 border-b border-token-border-light",children:[(0,w.jsxs)(c.Z.Header,{children:[(0,w.jsx)(c.Z.HeaderCell,{children:(0,w.jsx)(v.Z,M({},C.unverifiedDomainsTableHeader))}),(0,w.jsx)(c.Z.HeaderCell,{textAlign:"right"})]}),t.map(e=>(0,w.jsxs)(c.Z.Row,{children:[(0,w.jsx)(c.Z.Cell,{children:e.hostname}),(0,w.jsx)(c.Z.Cell,{textAlign:"right",children:(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsx)(s.z,{color:"secondary",size:"small",onClick:()=>n(e),children:(0,w.jsx)(v.Z,M({},C.verifyDomainButton))}),(0,w.jsx)(s.z,{color:"secondary",size:"small",onClick:()=>i({domainId:e.id}),icon:u.XHJ})]})})]},e.id))]})}function T(e){let{hostname:t,onSetHostname:n,onSubmit:o,unverifiedDomains:i,onVerifyDomain:a,workspaceId:s}=e,r=(0,y.Z)();return(0,w.jsxs)(w.Fragment,{children:[i&&i.length>0&&(0,w.jsx)(S,{workspaceId:s,unverifiedDomains:i,onVerifyDomain:a}),(0,w.jsx)("form",{onSubmit:e=>{e.preventDefault(),o()},children:(0,w.jsxs)("div",{className:"mb-4",children:[(0,w.jsx)("label",{className:"mb-2 flex items-center text-sm font-semibold",children:(0,w.jsx)(v.Z,M({},C.domainInput))}),(0,w.jsx)(l.Z,{name:"hostname",placeholder:r.formatMessage(C.placeholder),value:null!=t?t:"",onChange:e=>{n(e.target.value)}})]})})]})}let C=(0,h.vU)({newTitle:{id:"domainModal.newTitle.0",defaultMessage:"Verify a new domain"},editTitle:{id:"domainModal.editTitle",defaultMessage:"Manage Domain"},submit:{id:"domainModal.submit",defaultMessage:"Submit"},check:{id:"domainModal.check",defaultMessage:"Check"},done:{id:"domainModal.done",defaultMessage:"Done"},cancel:{id:"domainModal.cancel",defaultMessage:"Cancel"},domainInput:{id:"domainModal.domainInput.0",defaultMessage:"Add a new domain"},placeholder:{id:"domainModal.placeholder",defaultMessage:"openai.com"},domainCheckError:{id:"domainModal.domainCheckError",defaultMessage:"Your domain could not be verified: {message}"},verificationTokenMessage:{id:"domainModal.verificationTokenMessage",defaultMessage:"To verify ownership of {hostname}, navigate to your DNS provider and add a TXT record with this value:"},verificationTokenFooter:{id:"domainModal.verificationTokenFooter",defaultMessage:"Then, check the record to complete the verification."},successfulVerification:{id:"domainModal.successfulVerification.0",defaultMessage:'Your domain, "{hostname}" has been successfully verified'},copiedTXTRecordToClipboard:{id:"domainModal.copiedTXTRecordToClipboard",defaultMessage:"Copied DNS TXT record to clipboard"},verifyDomainButton:{id:"domainModal.verifyDomainButton",defaultMessage:"Verify"},unverifiedDomainsTableHeader:{id:"domainModal.unverifiedDomainsTableHeader",defaultMessage:"Your unverified domains"}})},8040:function(e,t,n){"use strict";n.d(t,{$V:function(){return m},A4:function(){return p},Li:function(){return y},W8:function(){return h},i$:function(){return g},i9:function(){return x},qQ:function(){return b},vi:function(){return v}});var o,i,a,s,r,l,d,c,u=n(2346),f=n(15478);let m=f.Z.div(o||(o=(0,u.Z)(["text-base text-token-text-primary flex flex-col gap-10 my-10"]))),p=f.Z.div(i||(i=(0,u.Z)(["text-xl font-semibold"]))),g=f.Z.div(a||(a=(0,u.Z)(["text-base font-semibold"]))),b=f.Z.div(s||(s=(0,u.Z)(["flex flex-col divide-y divide-token-border-light border-y border-token-border-light"]))),x=f.Z.div(r||(r=(0,u.Z)(["flex flex-col gap-3 w-full m-auto md:m-0"]))),y=f.Z.div(l||(l=(0,u.Z)(["text-sm"]))),v=f.Z.div(d||(d=(0,u.Z)(["flex justify-between py-4 gap-4"]))),h=f.Z.hr(c||(c=(0,u.Z)(["max-w-xl border-token-border-light"])))},83369:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/identity",function(){return n(10737)}])}},function(e){e.O(0,[2205,4198,5158,4089,1133,3718,6481,3088,1318,1612,2349,5162,6013,9830,9725,8442,3752,8110,2879,3662,2888,9774,179],function(){return e(e.s=83369)}),_N_E=e.O()}]);
//# sourceMappingURL=identity-a36ad19906063457.js.map