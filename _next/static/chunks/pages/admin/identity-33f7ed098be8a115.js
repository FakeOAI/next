(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2571],{51516:function(e,t,n){"use strict";function o(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return o}})},18993:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return en},default:function(){return eo}});var o,i=n(94521),r=n(70657),a=n(21904),s=n(8649),l=n(49217),d=n(18454),c=n(35226),u=n(50406),f=n(48580),p=n(19841);class m extends Error{}m.prototype.name="InvalidTokenError";var g=n(86078),y=n.n(g),v=n(71126),h=n.n(v),b=n(92379),x=n(62984),j=n(75172),w=n(68306),I=n(5443),k=n(18102),M=n(3445),S=n(67165),O=n(69482),C=n(23212),E=n(46129),T=n(651);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Z(e){let{onRemoveDomainClick:t,onVerifyDomainClick:n}=e;return(0,T.jsxs)(S.Z.Root,{children:[(0,T.jsx)(S.Z.Trigger,{children:(0,T.jsx)(M.nWS,{className:"icon-sm"})}),(0,T.jsx)(S.Z.Portal,{children:(0,T.jsxs)(S.Z.Content,{children:[(0,T.jsx)(S.Z.Item,{onClick:t,children:(0,T.jsx)(x.Z,D({},N.ssoDropdownRemoveButtonText))}),(0,T.jsx)(S.Z.Item,{onClick:n,children:(0,T.jsx)(x.Z,D({},N.ssoDropdownVerifyButtonText))})]})})]})}function A(e){let{domains:t,workspaceId:n}=e,o=(0,j.Z)(),{mutateAsync:i}=(0,E.Bd)(n),{0:r,1:a}=(0,b.useState)(!1),{0:s,1:l}=(0,b.useState)();return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(O.Z.Root,{className:"w-full table-auto",children:[(0,T.jsxs)(O.Z.Header,{children:[(0,T.jsx)(O.Z.HeaderCell,{className:"bg-token-main-surface-primary",children:(0,T.jsx)(x.Z,D({},N.domainTableHeader))}),(0,T.jsx)(O.Z.HeaderCell,{className:"bg-token-main-surface-primary",children:(0,T.jsx)(x.Z,D({},N.statusTableHeader))}),(0,T.jsx)(O.Z.HeaderCell,{className:"bg-token-main-surface-primary"})]}),(0,T.jsx)(O.Z.Body,{children:t.map((e,t)=>(0,T.jsxs)("tr",{onClick:()=>l(e),className:"cursor-pointer",children:[(0,T.jsx)(O.Z.Cell,{children:e.hostname}),(0,T.jsx)(O.Z.Cell,{children:o.formatMessage(E.sd[e.status])}),(0,T.jsx)(O.Z.Cell,{textAlign:"right",children:(0,T.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,T.jsx)(Z,{onRemoveDomainClick:()=>{i({domainId:e.id})},onVerifyDomainClick:()=>{l(e)}})})})]},t))})]}),(0,T.jsx)(I.z,{color:"secondary",className:"mt-6",onClick:()=>{a(!0)},icon:M.Vz5,children:(0,T.jsx)(x.Z,D({},N.addDomainButton))}),(0,T.jsx)(C.Z,{isOpen:r||void 0!==s,onClose:()=>{a(!1),l(void 0)},workspaceId:n,currentDomain:r?void 0:s,domains:t},null==s?void 0:s.id)]})}let N=(0,w.vU)({ssoDropdownRemoveButtonText:{id:"workspaceIdentity.ssoDropdownRemoveButtonText",defaultMessage:"Remove Domain"},ssoDropdownVerifyButtonText:{id:"workspaceIdentity.ssoDropdownVerifyButtonText",defaultMessage:"Verify"},domainTableHeader:{id:"workspaceIdentity.domainTableHeader",defaultMessage:"Domain"},statusTableHeader:{id:"workspaceIdentity.statusTableHeader",defaultMessage:"Status"},addDomainButton:{id:"workspaceIdentity.addDomainButton.0",defaultMessage:"Add domain"}});var F=n(38417),L=n(65530),_=n(94982),R=n(91208),U=n(93322);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let q=async e=>new Promise((t,n)=>{let o=new FileReader;o.readAsText(e),o.onload=function(e){var n;t(null===(n=e.target)||void 0===n?void 0:n.result)},o.onerror=n});function z(e){let{acsId:t,hasSSO:n}=e,o="https://auth0.openai.com/login/callback?connection=".concat(t),i="urn:auth0:openai:".concat(t),r="".concat(location.host,"/auth/login?sso=true&connection=").concat(t),a=(0,j.Z)();return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(U.Li,{children:(0,T.jsx)(x.Z,X({},H.setupSSOContent))}),(0,T.jsxs)("div",{className:"mb-6 flex flex-col space-y-4",children:[(0,T.jsx)(F.Z,{label:"Assertion Consumer Service (ACS) URL",value:o,onCopied:()=>{_.m.success(a.formatMessage(H.copiedACSToClipboard),{duration:3})}}),(0,T.jsx)(F.Z,{label:"Entity ID",value:i,onCopied:()=>{_.m.success(a.formatMessage(H.copiedEntityToClipboard),{duration:3})}}),n&&(0,T.jsx)(F.Z,{label:a.formatMessage(H.idpSignInURL),value:r,onCopied:()=>{_.m.success(a.formatMessage(H.copiedIDPUrlToClipboard),{duration:3})}})]})]})}var G=((o=G||{})[o.CREATE=1]="CREATE",o[o.EDIT=2]="EDIT",o);function V(e){let{workspaceId:t,data:n,isOpen:o,onClose:i}=e,r=(0,j.Z)(),a=(0,d.b)(),{mutateAsync:c}=(0,E.Fc)(t),{mutateAsync:u}=(0,E.OR)(t),{mutateAsync:f}=(0,E.DD)(t),m=(0,b.useRef)(null),g=null==n?void 0:n.connection,{0:y,1:v}=(0,b.useState)(null==g?void 0:g.sign_in_endpoint),{0:h,1:w}=(0,b.useState)(!1),{0:k,1:S}=(0,b.useState)(null==g?void 0:g.cert),O=null===n?G.CREATE:G.EDIT,C=async(e,t)=>{let n;try{n=await c({signInEndpoint:e,cert:t})}catch(e){if(e instanceof R.gK&&"reauth_required"===e.code){w(!0);return}throw e}await f({connectionId:n.id,active:!0}),i()},P=O===G.CREATE?(0,T.jsx)(s.Z.Button,{title:r.formatMessage(H.doneButton),color:"primary",disabled:void 0===y||void 0===k,onClick:async()=>{void 0!==y&&void 0!==k&&await C(y,k)}}):n&&(0,T.jsx)(s.Z.Button,{title:r.formatMessage(H.doneButton),color:"primary",onClick:async()=>{await f({connectionId:null==n?void 0:n.id,cert:k,signInEndpoint:y,active:!0}),i()}}),D=null===n?(0,T.jsx)(s.Z.Button,{title:r.formatMessage(H.cancelButton),color:"secondary",onClick:()=>i()}):(0,T.jsx)(I.z,{as:"link",color:"danger-outline",onClick:async()=>{await u({connectionId:null==n?void 0:n.id}),i()},children:r.formatMessage(H.deleteButton)});return(0,T.jsx)(l.Z,{isOpen:o,type:"success",title:r.formatMessage(O===G.CREATE?H.createTitle:H.editTitle),primaryButton:P,secondaryButton:D,onClose:i,children:(0,T.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,T.jsx)(E.z0,{children:(0,T.jsx)(x.Z,X({},H.createInstructionsManual))}),(0,T.jsx)("label",{className:"mb-2 flex items-center text-sm",children:(0,T.jsx)(x.Z,X({},H.signInLabel))}),(0,T.jsx)("div",{className:"mb-4",children:(0,T.jsx)(L.Z,{className:"w-full appearance-none rounded border px-3 py-2",name:"Sign-In URL",type:"text",placeholder:"https://your.idp.here/saml2?idpid=123456",value:null!=y?y:"",onChange:e=>{v(e.target.value)}})}),(0,T.jsxs)("div",{className:"mb-4",children:[(0,T.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,T.jsx)("label",{className:"text-sm",children:(0,T.jsx)(x.Z,X({},H.certLabel))}),(0,T.jsx)("input",{ref:m,type:"file",accept:".csv,.cer,.pem,text/plain",className:"hidden",onChange:async e=>{var t;null!==(t=e.target.files)&&void 0!==t&&t[0]&&S(await q(e.target.files[0]))}}),(0,T.jsx)(I.z,{color:"secondary",onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.click()},icon:M.aAc})]}),(0,T.jsx)("textarea",{rows:10,className:(0,p.default)("w-full resize-none overflow-y-auto rounded border border-gray-300 px-3 py-2","outline-none focus-within:border-green-600 focus-within:ring-1 focus-within:ring-green-600","text-token-text-primary placeholder-gray-500 dark:bg-gray-700"),placeholder:"-----BEGIN CERTIFICATE-----",value:null!=k?k:"",onChange:e=>{S(e.target.value)}})]}),h&&(0,T.jsx)("label",{className:"text-token-text-error",children:(0,T.jsx)(x.Z,{id:"ZfFabW",defaultMessage:"You need to re-authenticate to access this page. Please <login>log in</login> before continuing.",values:{login:e=>(0,T.jsx)("a",{href:"#",className:"text-token-text-primary underline",onClick:e=>{e.preventDefault(),a({authType:"login",callbackUrl:"/admin/identity"})},children:e})}})})]})})}let H=(0,w.vU)({setupSSOContent:{id:"workspaceIdentity.setupSSOContent",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO."},createInstructionsXML:{id:"ssoModal.createInstructionsXML",defaultMessage:"If your Identity Provider offers a metadata URL or an XML file, add it here for the quickest setup option."},createInstructionsManual:{id:"ssoModal.createInstructionsManual",defaultMessage:"Copy your Sign-in endpoint (SSO URL) and the public X.509 certificate from your Identity Provider."},createTitle:{id:"ssoModal.createTitle",defaultMessage:"Create SAML SSO Configuration"},editTitle:{id:"ssoModal.editTitle",defaultMessage:"Edit SAML SSO Configuration"},ssoMetadataLabel:{id:"ssoModal.ssoMetadataLabel",defaultMessage:"App Federation Metadata URL"},signInLabel:{id:"ssoModal.signInLabel",defaultMessage:"SSO URL"},certLabel:{id:"ssoModal.certLabel",defaultMessage:"X.509 Signing Certificate"},doneButton:{id:"ssoModal.doneButton",defaultMessage:"Done"},nextButton:{id:"ssoModal.nextButton",defaultMessage:"Next"},deleteButton:{id:"ssoModal.deleteButton",defaultMessage:"Delete configuration"},cancelButton:{id:"ssoModal.cancelButton",defaultMessage:"Cancel"},acsURLLabel:{id:"workspaceIdentity.acsURLLabel",defaultMessage:"Assertion Consumer Service (ACS) URL"},entityIDLabel:{id:"workspaceIdentity.entityIDLabel",defaultMessage:"Entity ID"},idpSignInURL:{id:"workspaceIdentity.idpSignInURL",defaultMessage:"IDP Tile URL"},copiedACSToClipboard:{id:"workspaceIdentity.copiedACSToClipboard",defaultMessage:"Copied ACS URL to clipboard"},copiedEntityToClipboard:{id:"workspaceIdentity.copiedEntityToClipboard",defaultMessage:"Copied entity ID to clipboard"},copiedIDPUrlToClipboard:{id:"workspaceIdentity.copiedIDPUrlToClipboard",defaultMessage:"Copied IDP URL to clipboard"},orDivider:{id:"workspaceIdentity.orDivider",defaultMessage:"or"},certExtractFailed:{id:"workspaceIdentity.certExtractFailed",defaultMessage:"Unable to find X.509 Certificate in provided XML"},ssoUrlExtractFailed:{id:"workspaceIdentity.ssoUrlExtractFailed",defaultMessage:"Unable to find Entity ID (sign-in endpoint) in provided XML"},ssoLearnMoreLink:{id:"workspaceIdentity.ssoLearnMoreLink",defaultMessage:"Learn more"}});function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let Q=y()(()=>Promise.all([n.e(8682),n.e(8936)]).then(n.bind(n,52664)).then(e=>e.DirectorySyncSection),{loadableGenerated:{webpack:()=>[52664]}}),J=e=>{let{title:t,footer:n,children:o}=e;return(0,T.jsxs)(U.i9,{children:[(0,T.jsx)(U.A4,{children:(0,T.jsx)(x.Z,K({},t))}),(0,T.jsx)("div",{children:o}),(0,T.jsx)(U.Li,{children:n})]})},$=e=>{let{icon:t,title:n,body:o,toggle:i}=e;return(0,T.jsxs)(U.i9,{children:[(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsxs)("div",{className:"flex items-center gap-2",children:[(0,T.jsx)(t,{className:"icon-sm"}),(0,T.jsx)(U.A4,{children:(0,T.jsx)(x.Z,K({},n))})]}),(0,T.jsx)("div",{children:i})]}),(0,T.jsx)(U.Li,{children:o})]})};function Y(e){var t,n,o,i;let{currentWorkspaceId:g}=e,{value:y}=(0,f.sB)("3999712942"),v=(0,j.Z)(),w=(0,c.NL)(),{data:S,isLoading:O}=(0,E.f_)(g),C=(0,d.b)(),{mutateAsync:P}=(0,E.DD)(g),{variables:D,mutateAsync:Z}=(0,E.Ji)(g),N=(null==S?void 0:S.sso_connection)!=null,F=null==S?void 0:S.domains.some(e=>e.status===a.pT.VERIFIED),L=N?ee.ssoEditButton:ee.ssoAddButton,{0:_,1:R}=(0,b.useState)(!1),{0:B,1:X}=(0,b.useState)(!1),q=(null==S||null===(t=S.sso_connection)||void 0===t?void 0:t.status)==="ACTIVE",G=null==S||null===(n=S.sso_connection)||void 0===n?void 0:n.id,H=S?(0,T.jsxs)(U.$V,{children:[y&&(0,T.jsx)(Q,{workspaceId:g}),(0,T.jsx)(J,{title:ee.domainSubtitle,footer:(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(x.Z,K({},ee.verifyDomainInfoText))}),children:(0,T.jsx)(A,{domains:S.domains,workspaceId:g})}),(0,T.jsx)($,{icon:M.uSF,title:ee.autoProvisionTitle,body:(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(x.Z,K({},ee.autoProvisionBody))}),toggle:(0,T.jsx)(k.Z,{disabled:!F,enabled:null!==(o=null==D?void 0:D.shouldAutoProvision)&&void 0!==o?o:S.should_auto_provision,onChange:e=>{Z({shouldAutoProvision:e})},label:v.formatMessage(ee.toggleAutoProvisionLabel)})}),(0,T.jsxs)(U.i9,{children:[(0,T.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,T.jsxs)("div",{className:"flex items-center gap-2",children:[(0,T.jsx)(M.kaz,{className:(0,p.default)("icon-sm",q?"text-blue-600":"text-token-text-tertiary")}),(0,T.jsx)(U.A4,{children:(0,T.jsx)(x.Z,K({},ee.ssoTitle))})]}),N&&(0,T.jsx)("div",{children:(0,T.jsx)(k.Z,{enabled:q,onChange:()=>{P({connectionId:G,active:!q})},label:v.formatMessage(ee.ssoToggleActive)})})]}),F&&(0,T.jsx)(z,{acsId:S.acs_id,hasSSO:N}),(0,T.jsxs)("div",{children:[(0,T.jsx)(I.z,{as:"button",color:"primary",disabled:!F,onClick:()=>{!function(e){var t;let n=null===(t=(0,u.y_)(e))||void 0===t?void 0:t.accessToken,o=n?function(e,t){let n;if("string"!=typeof e)throw new m("Invalid token specified: must be a string");t||(t={});let o=!0===t.header?0:1,i=e.split(".")[o];if("string"!=typeof i)throw new m(`Invalid token specified: missing part #${o+1}`);try{n=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var n;return n=t,decodeURIComponent(atob(n).replace(/(.)/g,(e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}catch(e){return atob(t)}}(i)}catch(e){throw new m(`Invalid token specified: invalid base64 for part #${o+1} (${e.message})`)}try{return JSON.parse(n)}catch(e){throw new m(`Invalid token specified: invalid json for part #${o+1} (${e.message})`)}}(n):null,i=null==o?void 0:o.pwd_auth_time;return null!=i&&Date.now()-i<6e4}(w)?R(!0):X(!0)},children:(0,T.jsx)(x.Z,K({},L))}),(0,T.jsx)(V,{workspaceId:g,data:S.sso_connection,isOpen:B,onClose:()=>{X(!1)}}),(0,T.jsx)(l.Z,{isOpen:_,onClose:()=>R(!1),type:"warning",title:v.formatMessage(ee.reauthRequiredTitle),icon:M.oVl,primaryButton:(0,T.jsx)(s.Z.Button,{onClick:()=>{C({authType:"login",callbackUrl:"/admin/identity"})},color:"primary",children:(0,T.jsx)(x.Z,{id:"qcl4gn",defaultMessage:"Login"})}),secondaryButton:(0,T.jsx)(s.Z.Button,{onClick:()=>R(!1),children:(0,T.jsx)(x.Z,{id:"E1vtdZ",defaultMessage:"Close"})}),children:(0,T.jsx)("label",{className:"mb-2 flex items-center text-sm",children:v.formatMessage(ee.reauthRequiredExplanation)})})]})]}),S.sso_connection&&(0,T.jsx)($,{icon:M.oVl,title:ee.enforceSSOTitle,body:(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(x.Z,K({},ee.enforceSSOBody))}),toggle:(0,T.jsx)(k.Z,{disabled:!F,enabled:null===(i=S.sso_connection.auth0_enforced_clients)||void 0===i?void 0:i.includes("chat"),onChange:e=>{P({connectionId:S.sso_connection.id,enforcedClients:e?["chat"]:[]})},label:v.formatMessage(ee.enforceSSOLabel)})})]}):null;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(h(),{children:(0,T.jsx)("title",{children:v.formatMessage(ee.title)})}),(0,T.jsx)(r.yG,{title:v.formatMessage(ee.title)}),(0,T.jsx)(r.hb,{showSpinner:O,children:H})]})}let ee=(0,w.vU)({title:{id:"workspaceIdentity.title",defaultMessage:"Identity & Provisioning"},domainSubtitle:{id:"workspaceIdentity.domainSubtitle",defaultMessage:"Domain management"},ssoTitle:{id:"workspaceIdentity.ssoTitle",defaultMessage:"Single Sign On"},ssoToggleActive:{id:"WorkspaceIdentityPage.ssoToggleActive",defaultMessage:"Enable SSO for this workspace"},ssoAddButton:{id:"workspaceIdentity.ssoAddButton",defaultMessage:"Add SAML SSO"},ssoEditButton:{id:"workspaceIdentity.ssoEditButton",defaultMessage:"Edit SAML SSO"},autoProvisionTitle:{id:"workspaceIdentity.autoProvisionSubtitle",defaultMessage:"Automatic account creation"},autoProvisionBody:{id:"workspaceIdentity.autoProvisionBody",defaultMessage:"Automatically create workspace accounts for new users who log in with a verified domain."},toggleAutoProvisionLabel:{id:"workspaceIdentity.toggleAutoProvisionLabel",defaultMessage:"Toggle to enable or disable auto provisioning"},enforceSSOTitle:{id:"workspaceIdentity.enforceSSOTitle",defaultMessage:"Enforce SSO log in"},enforceSSOBody:{id:"workspaceIdentity.enforceSSOBody",defaultMessage:"When SSO is active, users will no longer be able to use social logins and will be redirected to your SSO portal."},enforceSSOLabel:{id:"workspaceIdentity.enforceSSOLabel",defaultMessage:"Toggle to enable or disable SSO enforcement"},verifyDomainInfoText:{id:"workspaceIdentity.verifyDomainInfoText",defaultMessage:"Verify ownership of an email domain to access advanced security features including single sign-on."},learnMoreLink:{id:"workspaceIdentity.learnMoreLink",defaultMessage:"Learn more"},reauthRequiredTitle:{id:"workspaceIdentity.reauthRequiredTitle",defaultMessage:"Please login again"},reauthRequiredExplanation:{id:"workspaceIdentity.reauthRequiredExplanation",defaultMessage:"For security reasons, we need you to reauthenticate before making changes to SSO settings."}});function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}var en=!0;function eo(e){return(0,T.jsx)(Y,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e))}eo.getLayout=function(e){return(0,T.jsx)(r.ZP,{mobilePageTitle:"Identity",requireOwnerPrivileges:!0,children:e})}},38417:function(e,t,n){"use strict";var o=n(48538),i=n(5443),r=n(3445),a=n(651);t.Z=e=>{let{label:t,value:n,onCopied:s}=e,l=()=>{(0,o.v)(n),s()};return(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[void 0!==t&&(0,a.jsx)("label",{className:"font-semibold",children:t}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{onClick:l,className:"w-full cursor-pointer break-all rounded-lg bg-token-main-surface-tertiary px-4 py-2 font-mono text-sm text-token-text-primary",children:n}),(0,a.jsx)(i.z,{color:"ghost",onClick:l,icon:r.TIy})]})]})}},23212:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var o,i=n(94521),r=n(21904),a=n(5443),s=n(38417),l=n(65530),d=n(8649),c=n(69482),u=n(3445),f=n(49217),p=n(94982),m=n(10852),g=n(35226),y=n(96053),v=n(92379),h=n(75172),b=n(62984),x=n(68306),j=n(46129),w=n(651);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var M=((o=M||{})[o.INITIAL=0]="INITIAL",o[o.PENDING=1]="PENDING",o[o.FINAL=2]="FINAL",o);function S(e){let{workspaceId:t,isOpen:n,onClose:o,currentDomain:i,domains:a=[],showUnverifiedDomains:l=!1,onVerifyDomain:c}=e,u=(0,h.Z)(),{mutateAsync:x,isPending:j}=function(e){let t=(0,g.NL)();return(0,y.D)({mutationFn:t=>{let{hostname:n}=t;return m.Z.addDomainToWorkspace(e,n)},onSuccess:()=>{t.invalidateQueries({queryKey:["workspace/identity",e]}),t.invalidateQueries({queryKey:["builderProfile"]})},onError:e=>{p.m.danger(e.message)}})}(t),{mutateAsync:I,isPending:S}=function(e){let t=(0,g.NL)();return(0,y.D)({mutationFn:t=>{let{domainId:n}=t;return m.Z.checkDomainForWorkspace(e,n)},onSuccess:()=>{t.invalidateQueries({queryKey:["workspace/identity",e]}),t.invalidateQueries({queryKey:["builderProfile"]})},onError:e=>{p.m.danger(e.message)}})}(t),{0:O,1:T}=(0,v.useState)(null!=i?i:void 0),{0:P,1:D}=(0,v.useState)(null==i?void 0:i.hostname),{0:Z,1:A}=(0,v.useState)((null==i?void 0:i.status)===void 0?M.INITIAL:(null==i?void 0:i.status)===r.pT.PENDING?M.PENDING:M.FINAL),N=()=>{i||(T(void 0),A(M.INITIAL))},F=async()=>{if(void 0===P)return;let e=a.find(e=>e.hostname===P&&e.status===r.pT.PENDING);if(e)T(e),A(M.PENDING);else{let e=await x({hostname:P});"id"in e&&T(e),A(M.PENDING)}},L=(0,w.jsx)(d.Z.Button,{title:u.formatMessage(E.check),color:"primary",disabled:(null==O?void 0:O.id)===void 0||S,onClick:async()=>{if(null!=O&&O.id){let e=await I({domainId:O.id});"error"in e&&p.m.danger(u.formatMessage(E.domainCheckError,{message:e.error.message})),"id"in e&&(c&&c(e),e.status===r.pT.VERIFIED&&A(M.FINAL))}}}),_=(0,w.jsx)(d.Z.Button,{title:u.formatMessage(E.submit),color:"primary",disabled:void 0===P||j,onClick:F}),R=(0,w.jsx)(d.Z.Button,{title:u.formatMessage(E.done),color:"primary",onClick:()=>{N(),o()}});return(0,w.jsxs)(f.Z,{isOpen:n,onClose:()=>{N(),o()},type:"success",className:"text-token-text-secondary",title:u.formatMessage(Z===M.INITIAL?E.newTitle:E.editTitle),primaryButton:Z===M.INITIAL?_:Z===M.PENDING?L:R,secondaryButton:(0,w.jsx)(d.Z.Button,{title:u.formatMessage(E.cancel),color:"secondary",onClick:()=>{N(),o()}}),children:[Z===M.INITIAL&&(0,w.jsx)(C,{hostname:P,onSetHostname:D,onSubmit:F,unverifiedDomains:l?a:[],onVerifyDomain:e=>{A(M.PENDING),T(e)},workspaceId:t}),Z===M.PENDING&&(0,w.jsxs)("div",{className:"flex flex-col gap-3",children:[u.formatMessage(E.verificationTokenMessage,{hostname:null==O?void 0:O.hostname}),(null==O?void 0:O.dns_verification_token_string)&&(0,w.jsx)(s.Z,{value:O.dns_verification_token_string,onCopied:()=>{p.m.success(u.formatMessage(E.copiedTXTRecordToClipboard),{duration:3})}}),(0,w.jsx)(b.Z,k({},E.verificationTokenFooter))]}),Z===M.FINAL&&(0,w.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,w.jsx)(b.Z,k(k({},E.successfulVerification),{},{values:{hostname:null==O?void 0:O.hostname}})),(null==O?void 0:O.dns_verification_token_string)&&(0,w.jsx)(s.Z,{value:O.dns_verification_token_string,onCopied:()=>{p.m.success(u.formatMessage(E.copiedTXTRecordToClipboard),{duration:3})}})]})]})}function O(e){let{unverifiedDomains:t,onVerifyDomain:n,workspaceId:o}=e,{mutateAsync:i}=(0,j.Bd)(o);return(0,w.jsxs)(c.Z.Root,{fixed:!0,size:"compact",className:"mb-6 border-b border-token-border-light",children:[(0,w.jsxs)(c.Z.Header,{children:[(0,w.jsx)(c.Z.HeaderCell,{children:(0,w.jsx)(b.Z,k({},E.unverifiedDomainsTableHeader))}),(0,w.jsx)(c.Z.HeaderCell,{textAlign:"right"})]}),t.map(e=>(0,w.jsxs)(c.Z.Row,{children:[(0,w.jsx)(c.Z.Cell,{children:e.hostname}),(0,w.jsx)(c.Z.Cell,{textAlign:"right",children:(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsx)(a.z,{color:"secondary",size:"small",onClick:()=>n(e),children:(0,w.jsx)(b.Z,k({},E.verifyDomainButton))}),(0,w.jsx)(a.z,{color:"secondary",size:"small",onClick:()=>i({domainId:e.id}),icon:u.XHJ})]})})]},e.id))]})}function C(e){let{hostname:t,onSetHostname:n,onSubmit:o,unverifiedDomains:i,onVerifyDomain:r,workspaceId:a}=e,s=(0,h.Z)();return(0,w.jsxs)(w.Fragment,{children:[i&&i.length>0&&(0,w.jsx)(O,{workspaceId:a,unverifiedDomains:i,onVerifyDomain:r}),(0,w.jsx)("form",{onSubmit:e=>{e.preventDefault(),o()},children:(0,w.jsxs)("div",{className:"mb-4",children:[(0,w.jsx)("label",{className:"mb-2 flex items-center text-sm font-semibold",children:(0,w.jsx)(b.Z,k({},E.domainInput))}),(0,w.jsx)(l.Z,{name:"hostname",placeholder:s.formatMessage(E.placeholder),value:null!=t?t:"",onChange:e=>{n(e.target.value)}})]})})]})}let E=(0,x.vU)({newTitle:{id:"domainModal.newTitle.0",defaultMessage:"Verify a new domain"},editTitle:{id:"domainModal.editTitle",defaultMessage:"Manage Domain"},submit:{id:"domainModal.submit",defaultMessage:"Submit"},check:{id:"domainModal.check",defaultMessage:"Check"},done:{id:"domainModal.done",defaultMessage:"Done"},cancel:{id:"domainModal.cancel",defaultMessage:"Cancel"},domainInput:{id:"domainModal.domainInput.0",defaultMessage:"Add a new domain"},placeholder:{id:"domainModal.placeholder",defaultMessage:"openai.com"},domainCheckError:{id:"domainModal.domainCheckError",defaultMessage:"Your domain could not be verified: {message}"},verificationTokenMessage:{id:"domainModal.verificationTokenMessage",defaultMessage:"To verify ownership of {hostname}, navigate to your DNS provider and add a TXT record with this value:"},verificationTokenFooter:{id:"domainModal.verificationTokenFooter",defaultMessage:"Then, check the record to complete the verification."},successfulVerification:{id:"domainModal.successfulVerification.0",defaultMessage:'Your domain, "{hostname}" has been successfully verified'},copiedTXTRecordToClipboard:{id:"domainModal.copiedTXTRecordToClipboard",defaultMessage:"Copied DNS TXT record to clipboard"},verifyDomainButton:{id:"domainModal.verifyDomainButton",defaultMessage:"Verify"},unverifiedDomainsTableHeader:{id:"domainModal.unverifiedDomainsTableHeader",defaultMessage:"Your unverified domains"}})},46129:function(e,t,n){"use strict";n.d(t,{Bd:function(){return v},DD:function(){return x},Fc:function(){return b},Ji:function(){return y},OR:function(){return j},Wv:function(){return g},f_:function(){return m},sd:function(){return I},z0:function(){return w}});var o,i=n(41141),r=n(21904),a=n(94982),s=n(10852),l=n(24040),d=n(14816),c=n(96053),u=n(35226),f=n(75172),p=n(68306);function m(e,t){return(0,d.a)({queryKey:["workspace/identity",e],queryFn:async()=>{if(void 0!==e)return await s.Z.getWorkspaceIdentitySettings(e)},enabled:t})}function g(){let e=(0,l.ec)(l.F_.workspaceId),{data:t}=m(null!=e?e:void 0,null!=e);return(null==t?void 0:t.domains)&&(null==t?void 0:t.domains.filter(e=>"verified"==e.status))}function y(e){let t=(0,f.Z)();return(0,c.D)({mutationFn:n=>{let{shouldAutoProvision:o}=n;return s.Z.setWorkspaceShouldAutoProvision(e,o).then(e=>{let n=o?k.autoProvisionEnabledToast:k.autoProvisionDisabledToast;return a.m.success(t.formatMessage(n),{duration:3}),e}).catch(e=>{throw a.m.danger(e.message),e})}})}function v(e){let t=(0,u.NL)();return(0,c.D)({mutationFn:t=>{let{domainId:n}=t;return s.Z.removeDomainFromWorkspace(e,n)},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]}),t.refetchQueries({queryKey:["builderProfile"]})}})}function h(e){let t=e;return t.startsWith("-----BEGIN")||(t="-----BEGIN CERTIFICATE-----\n".concat(t)),t.endsWith("CERTIFICATE-----")||(t="".concat(t,"\n-----END CERTIFICATE-----")),t}function b(e){let t=(0,u.NL)();return(0,c.D)({mutationFn:t=>{let{signInEndpoint:n,cert:o}=t;return s.Z.createSAMLConnection(e,n,h(o))},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}function x(e){let t=(0,u.NL)();return(0,c.D)({mutationFn:t=>{let{connectionId:n,signInEndpoint:o,cert:i,active:r,enforcedClients:a}=t;return s.Z.updateSAMLConnection(e,n,{signInEndpoint:o,cert:void 0!==i?h(i):void 0,active:r,enforcedClients:a})},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}function j(e){let t=(0,u.NL)();return(0,c.D)({mutationFn:t=>{let{connectionId:n}=t;return s.Z.deleteSAMLConnection(e,n)},onSuccess:()=>{t.refetchQueries({queryKey:["workspace/identity",e]})}})}let w=n(74091).Z.div(o||(o=(0,i.Z)(["text-md mb-4 text-token-text-secondary"]))),I={[r.pT.VERIFIED]:(0,p.Em)({id:"i7FkyS",defaultMessage:"Verified"}),[r.pT.PENDING]:(0,p.Em)({id:"THBv/l",defaultMessage:"Pending"}),[r.pT.EXPIRED]:(0,p.Em)({id:"+sjWGK",defaultMessage:"Expired"})},k=(0,p.vU)({autoProvisionEnabledToast:{id:"workspaceIdentity.autoProvisionEnabledToast",defaultMessage:"Auto provisioning enabled for this workspace"},autoProvisionDisabledToast:{id:"workspaceIdentity.autoProvisionDisabledToast",defaultMessage:"Auto provisioning disabled for this workspace"}})},93322:function(e,t,n){"use strict";n.d(t,{$V:function(){return p},A4:function(){return m},Li:function(){return h},W8:function(){return x},i$:function(){return g},i9:function(){return v},qQ:function(){return y},vi:function(){return b}});var o,i,r,a,s,l,d,c,u=n(41141),f=n(74091);let p=f.Z.div(o||(o=(0,u.Z)(["text-base text-token-text-primary flex flex-col gap-10 my-10"]))),m=f.Z.div(i||(i=(0,u.Z)(["text-xl font-semibold"]))),g=f.Z.div(r||(r=(0,u.Z)(["text-base font-semibold"]))),y=f.Z.div(a||(a=(0,u.Z)(["flex flex-col divide-y divide-token-border-light border-y border-token-border-light"]))),v=f.Z.div(s||(s=(0,u.Z)(["flex flex-col gap-3 w-full m-auto md:m-0"]))),h=f.Z.div(l||(l=(0,u.Z)(["text-sm"]))),b=f.Z.div(d||(d=(0,u.Z)(["flex justify-between py-4 gap-4"]))),x=f.Z.hr(c||(c=(0,u.Z)(["max-w-xl border-token-border-light"])))},18532:function(e,t,n){"use strict";n.d(t,{$e:function(){return r},EZ:function(){return a},Ql:function(){return i},dO:function(){return o},xC:function(){return s}});let o=10,i=4,r={duration:20,hasCloseButton:!0},a=512,s=536870912},37234:function(e,t,n){"use strict";n.d(t,{R3:function(){return j},W7:function(){return h},cT:function(){return x},lU:function(){return w},po:function(){return b}});var o=n(94521),i=n(21904),r=n(10852),a=n(91208),s=n(93747),l=n(15236),d=n(59031),c=n(68306),u=n(34565),f=n(94982),p=n(14161),m=n(58543);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let v={duration:20,hasCloseButton:!0};function h(e){return JSON.stringify({file:e.name,modified:e.lastModified,currentTime:new Date().toString()})}function b(e){return new Promise((t,n)=>{let o=new FileReader,i=new Image;o.onload=()=>{i.onload=()=>t(i),i.onerror=e=>n(e),i.src=o.result},o.readAsDataURL(e)})}async function x(e,t,n,o,d,c){var p,m,g;let y=u.N.getState().resetRateLimits,h=i.EG.Initial;s.A.logEvent(l.M.uploadFileInitiated,{client:"web",useCase:o.kind,uploadEntry:"local"});let b=c.usesRetrievalIndex?performance.now():void 0;try{let{file_id:a,upload_url:s}=await r.Z.createFile(t.name,t.size,o,!!y);d.onFileCreated(e,a,s),h=i.EG.FileCreated;let l=o.kind===i.Ei.Gizmo?o.gizmoId:void 0,u=null!==(p=c.shouldUpdateProgress)&&void 0!==p&&p,g=null!==(m=c.usesRetrievalIndex)&&void 0!==m&&m,x=await r.Z.uploadFileToAzureStorage(t,s,t=>{u&&d.onFileUploadProgress(e,10+80*t)});if(d.onFileUploadProgress(e,90),201!==x.status&&k(x,a,g),h=i.EG.FileUploaded,await r.Z.processFileUpload(a,{gizmoId:l}),h=i.EG.FileProcessed,c.usesRetrievalIndex){let t=await I(a,l);(null==t?void 0:t.status)===i.Xf.Skipped&&f.m.danger(n.formatMessage(S.retrievalSkippedFile,{fileName:t.name}),v),d.onFileUploaded(e,a,void 0,{fileTokenSize:t.file_size_tokens}),h=i.EG.RetrievalIndexCreated}else d.onFileUploaded(e,a,c.imageDimensions);null!=b&&r.Z.postRetrievalTiming({e2eLatencyMs:performance.now()-b,type:"file"})}catch(r){M(n,t.name,r);let i="NotInstanceOfError";r instanceof a.gK?i=r.name:r instanceof a.Q0?i="FatalServerError_type_".concat(null!==(g=r.type)&&void 0!==g?g:"undefined"):r instanceof Error?i=r.name:r instanceof a.vq&&(i=r.name),d.onError(e,"error",i,o,h)}}async function j(e,t,n,o,c,u,g){let h=performance.now();s.A.logEvent(l.M.uploadFileInitiated,{client:"web",useCase:n.kind,contextConnector:c.contextConnector,fileSourceType:c.type});let b=i.EG.Initial;n.kind===i.Ei.Gizmo&&(n=y(y({},n),{},{kind:o.includes(t.type)?i.Ei.Multimodal:i.Ei.MyFiles}));try{let o=await r.Z.uploadConnectorAPI(e,c.contextConnector,n,t,u,c.o365DriveId);switch(o.type){case"error":throw function(e){let{status_code:t,error_code:n,error_message:o}=e;if(!t||!(t<500))return new a.Q0(o);{let e="internal_error";return n?e=n:404===t?e="file_not_found":403===t?e="permission_error":413===t&&(e="file_too_large"),new a.vq(o,e)}}(o.error);case"file":switch(p.MP.onFileCreated(e,o.file.id,"",c.contextConnector),b=i.EG.FileProcessed,n.kind){case i.Ei.MyFiles:{p.MP.onFileUploadProgress(e,90);let t=await I(o.file.file_id,u);(null==t?void 0:t.status)===i.Xf.Skipped&&f.m.danger(g.formatMessage(S.retrievalSkippedFile,{fileName:t.name}),v),p.MP.onFileUploaded(e,o.file.file_id,void 0,{fileTokenSize:t.file_size_tokens,mimeType:o.file.mime_type}),b=i.EG.RetrievalIndexCreated;break}case i.Ei.Multimodal:p.MP.onFileUploaded(e,o.file.file_id,{width:512,height:512},{mimeType:o.file.mime_type});break;case i.Ei.AceUpload:p.MP.onFileUploaded(e,o.file.file_id,void 0,{mimeType:o.file.mime_type});break;case i.Ei.DalleAgent:case i.Ei.Gizmo:case i.Ei.ProfilePicture:throw new a.vq("Use case not supported by cloud doc: ".concat(n.kind))}break;case"folder":throw new a.vq("Folder type not supported")}r.Z.postRetrievalTiming({e2eLatencyMs:performance.now()-h,type:c.contextConnector})}catch(o){d.U.addError(Error("Failed to upload connected file by ".concat(c.contextConnector),{cause:o})),M(g,(0,m.Ad)(t.name,null==c?void 0:c.syntheticExtension),o);let n="NotInstanceOfError";if(o instanceof a.Q0){var x;n="FatalServerError_type_".concat(null!==(x=o.type)&&void 0!==x?x:"undefined")}else(o instanceof a.gK||o instanceof Error||o instanceof a.vq)&&(n=o.name);p.MP.onError(e,"error",n,{kind:i.Ei.MyFiles},b)}}async function w(e,t,n,o,i){let{width:r,height:a}=await b(t);return x(e,t,n,{kind:o},i,{imageDimensions:{width:r,height:a}})}async function I(e,t){let n=Date.now()+6e4,o=e=>new Promise(t=>setTimeout(t,e)),s=0;for(;Date.now()<n;){let n=await r.Z.getRetrievalStatus(e,t);if(n.status===i.Xf.Success||n.status===i.Xf.Skipped)return n;if(n.status===i.Xf.Failed)throw new a.vq("Context extraction failed",n.error_code);s++,await o(Math.min(1e3,100*s))}throw new a.vq("Retrieval indexing timed out")}async function k(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="Unknown error";try{o=await e.data}catch(e){}throw n&&r.Z.markFileUploadFailed(t,{error:o}),new a.vq("File upload to blobstore failed","failed_upload_to_blobstore")}function M(e,t,n){let o=(0,m.kr)(e,"default_upload_error",{fileName:t});n instanceof a.vq&&null!=n.code&&(o=(0,m.kr)(e,n.code)),f.m.danger(o,v)}let S=(0,c.vU)({retrievalSkippedFile:{id:"useFilePickerState.retrievalSkippedFile",defaultMessage:'Unable to extract text from "{fileName}"'}})},14161:function(e,t,n){"use strict";n.d(t,{Dw:function(){return x},HR:function(){return b},MP:function(){return j},gF:function(){return h}});var o=n(94521),i=n(21904),r=n(93747),a=n(15236),s=n(59031),l=n(68306),d=n(68810),c=n(94982),u=n(18532),f=n(61457),p=n(37234),m=n(58543);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let v={files:[],connectorFileData:{}},h=(0,d.Ue)(()=>v),b={hasUploadInProgress:e=>{let{files:t}=e;return t.some(e=>e.status===f.XX.Uploading)},getReadyFiles:e=>{let{files:t}=e;return t.filter(e=>e.status===f.XX.Ready)}},x={reset:()=>{h.setState(v)},uploadFile:async function(e,t,n,o,l){let d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},g=arguments.length>6?arguments[6]:void 0,y=arguments.length>7?arguments[7]:void 0,{gizmoId:v}=d,b=h.getState().files,x=(0,m.xs)(n,t.name,t.type,null==y?void 0:y.contextConnector,g),I={tempId:e,gizmoId:d.gizmoId,status:f.XX.Uploading,file:t,progress:1,fileId:null,cdnUrl:null,contextConnectorInfo:y,contextConnector:null==y?void 0:y.contextConnector};if(b.length===u.dO)r.A.logEvent(a.M.uploadedMaxFilesError),c.m.danger(l.formatMessage(w.maxUploadsAtATime,{maxUploads:u.dO,fileName:t.name}),u.$e);else if(b.some(t=>t.tempId===e))r.A.logEvent(a.M.uploadedDuplicateFileError),c.m.danger(l.formatMessage(w.duplicateFileAttached,{fileName:t.name.length>20?t.name.slice(0,19)+"â€¦":t.name}),u.$e);else{let n;h.setState(e=>{let{files:t}=e;return{files:[...t,I]}});let r={};if(o.includes(t.type)){if(n={kind:i.Ei.Multimodal},!y){let{width:e,height:n}=await (0,p.po)(t);if(e>2048||n>2048)try{let o=await (0,m.Tu)(t,2048),i=await (0,p.po)(o);e=i.width,n=i.height,t=o}catch(e){s.U.addError(Error("Error resizing image:",{cause:e}))}r.imageDimensions={width:e,height:n}}}else switch(x){case f.AJ.Multimodal:throw Error("Multimodal file upload not supported mime type, ".concat(t.type,"\nSupported mime types: ")+o.join(", "));case f.AJ.Interpreter:n={kind:i.Ei.AceUpload};break;case f.AJ.Retrieval:n={kind:i.Ei.MyFiles},r.usesRetrievalIndex=!0;break;case f.AJ.ProfilePicture:throw Error("cannot upload profile picture via uploadFile");case f.AJ.ContextConnector:case f.AJ.None:return}null!=v&&(n={kind:i.Ei.Gizmo,gizmoId:v}),d.skipUpload||(y?await (0,p.R3)(e,t,n,o,y,d.gizmoId,l):await (0,p.cT)(e,t,l,n,j,r))}},createFileCompleted:(e,t,n,o)=>{let i=h.getState().files,r=i.findIndex(t=>t.tempId===e),a=i[r];if(r>=0&&a.status===f.XX.Uploading){let e=[...i];e.splice(r,1,y(y({},a),{},{progress:10,fileId:t,cdnUrl:n,contextConnector:o})),h.setState({files:e})}},updateProgress:(e,t)=>{let n=h.getState().files,o=n.findIndex(t=>t.tempId===e),i=n[o];if(o>=0&&i.status===f.XX.Uploading){let e=[...n];e.splice(o,1,y(y({},i),{},{progress:t})),h.setState({files:e})}},uploadCompleted:(e,t,n,o,i)=>{let s=h.getState().files,l=s.findIndex(t=>t.tempId===e);if(l>=0&&s[l].status===f.XX.Uploading&&null!=s[l].fileId){var d,c,u;let t=s[l],p=[...s],g=y(y({},t),{},{tempId:e,status:f.XX.Ready,progress:100,fileSpec:y(y({name:t.file.name,id:t.fileId,size:t.file.size,contextConnectorInfo:t.contextConnectorInfo,mimeType:null!==(d=null!==(c=null==o?void 0:o.mimeType)&&void 0!==c?c:t.file.type)&&void 0!==d?d:(0,m.s1)(t.file.name)},n||{}),o||{})});p.splice(l,1,g);let v=y({},h.getState().connectorFileData);i&&(v[null==i?void 0:i.file_id]=i),h.setState({files:p,connectorFileData:v}),r.A.logEvent(a.M.uploadFileCompleted,{status:t.status,fileId:t.fileId,contextConnector:null!==(u=t.contextConnector)&&void 0!==u?u:"local"})}},remove:(e,t,n,o,i)=>{let s=h.getState().files,l=s.findIndex(t=>t.tempId===e);if(l>=0){let e=s[l];"error"===t?r.A.logEvent(a.M.uploadFileError,{status:e.status,fileId:e.fileId,client:"web",errorClassName:null!=n?n:"undefined",useCaseType:o,uploadStatus:null!=i?i:"undefined",contextConnector:e.contextConnector}):r.A.logEvent(a.M.removeFile,{status:e.status,fileId:e.fileId});let d=[...s];d.splice(l,1),h.setState({files:d})}}},j={onFileCreated:x.createFileCompleted,onFileUploadProgress:x.updateProgress,onFileUploaded:x.uploadCompleted,onError:x.remove},w=(0,l.vU)({maxUploadsAtATime:{id:"useFilePickerState.maxUploadsAtATime",defaultMessage:"Unable to upload {fileName}. Max {maxUploads} uploads at a time"},duplicateFileAttached:{id:"useFilePickerState.duplicateFileAttached",defaultMessage:"Unable to upload {fileName} because an identical file has already been attached to this message."}})},34565:function(e,t,n){"use strict";n.d(t,{J:function(){return i},N:function(){return r}});var o=n(68810);let i={label:"Auto",value:""},r=(0,o.Ue)(()=>({forceParagen:!1,forceParagenModel:i,forceNulligen:!1,forceIndepthFeedback:!1,forceIndepthFeedbackPrompt:"The user has opted in to provide additional feedback on the previous response. Encourage the user to share feedback that you can store in a memory to better meet their needs in future. Use no more than 3 turns. If at any point the user indicates no longer wanting to provide feedback, return to the original topic.",forceRateLimit:!1,resetRateLimits:!1,showDebugConversationTurns:!1,rebaseSystemMessageContent:null}))},71941:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/identity",function(){return n(18993)}])}},function(e){e.O(0,[3391,7349,5347,6271,3718,6879,4368,7474,5365,506,2349,5257,323,9201,7084,210,4834,7245,4254,9130,1377,657,2888,9774,179],function(){return e(e.s=71941)}),_N_E=e.O()}]);
//# sourceMappingURL=identity-33f7ed098be8a115.js.map