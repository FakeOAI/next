"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8838,5418,6803],{39358:function(e,t,s){s.d(t,{Z:function(){return x}});var r,i=s(2346),a=s(98601),n=s(92379),o=s(68306),l=s(62984),d=s(15478),c=s(15174),u=s(30853),p=s(13490),m=s(651);function g(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function f(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?g(Object(s),!0).forEach(function(t){(0,a.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let h=(0,o.vU)({copy:{id:"CopyButton.copy",defaultMessage:"Copy"},copied:{id:"CopyButton.copied",defaultMessage:"Copied!"}});function x(e){let{buttonText:t,shouldChangeText:s=!0,iconClassName:r="icon-sm",onCopy:i,className:a}=e,{0:o,1:d}=(0,n.useState)(!1),g=(0,c.Z)(),x=(0,n.useCallback)(e=>{e.stopPropagation(),i(),d(!0),setTimeout(()=>{g()&&d(!1)},2e3)},[g,i]),b=t;return s&&o?b=(0,m.jsx)(l.Z,f({},h.copied)):!0===t&&(b=(0,m.jsx)(l.Z,f({},h.copy))),(0,m.jsxs)(m.Fragment,{children:[!o&&(0,m.jsx)(u.u,{label:(0,m.jsx)(l.Z,{id:"CopyButton.copyTooltip",defaultMessage:"Copy"}),sideOffset:0,children:(0,m.jsxs)(v,{onClick:x,className:a,children:[(0,m.jsx)(p.TIy,{className:r}),b]})}),o&&(0,m.jsxs)(v,{className:a,children:[(0,m.jsx)(p.$As,{className:r}),b]})]})}let v=d.Z.button(r||(r=(0,i.Z)(["flex gap-1 items-center"])))},98095:function(e,t,s){s.d(t,{d:function(){return y}});var r=s(98601),i=s(52088),a=s(54089),n=s(19841),o=s(92379),l=s(38838),d=s(13490),c=s(50863),u=s(651);let p=["className","size","align"],m=["onSelect","icon","className","color","size"],g=["className"],f=["onSelect","children"],h=["className"],x=["icon","children"];function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function b(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach(function(t){(0,r.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let j=o.forwardRef(function(e,t){let{className:s,size:r="default",align:o}=e,l=(0,i.Z)(e,p);return(0,u.jsx)(c.w5,b({ref:t,$as:a.VY,sideOffset:4,align:null!=o?o:"start",collisionPadding:10,className:(0,n.default)({"min-w-[280px]":"default"===r,"min-w-[340px]":"large"===r,"min-w-[125px]":"small"===r,"overflow-hidden":!0},s)},l))});function y(e){let{triggerButton:t,children:s,size:r="default",open:i,onOpenChange:n,contentAlign:o,side:l,sideOffset:d=0,alignOffset:c=0,contentClassName:p}=e;return(0,u.jsxs)(a.fC,{modal:!1,open:i,onOpenChange:n,children:[(0,u.jsx)(a.xz,{asChild:!0,children:t}),(0,u.jsx)(a.Uv,{children:(0,u.jsx)(j,{size:r,align:o,alignOffset:c,side:l,sideOffset:d,className:p,children:s})})]})}let w={Root:a.fC,Trigger:function(e){return(0,u.jsx)(c.J7,b(b({$as:a.xz},e),{},{onFocusCapture:t=>{var s;t.stopPropagation(),null===(s=e.onFocusCapture)||void 0===s||s.call(e,t)}}))},Portal:a.Uv,Content:j,Item:o.forwardRef(function(e,t){let{onSelect:s,icon:r,className:l,color:d,size:p="default"}=e,g=(0,i.Z)(e,m);return r?(0,u.jsxs)(c.gG,b(b({$as:a.ck,ref:t,onSelect:s,className:(0,n.default)("danger"===d&&"text-token-text-error","large"===p&&"gap-3",l)},g),{},{children:[(0,u.jsx)("div",{className:(0,n.default)("flex items-center justify-center","danger"===d&&"text-token-text-error","danger"!==d&&"text-token-text-secondary","default"===p&&"h-5 w-5","large"===p&&"h-5 w-7"),children:(0,o.isValidElement)(r)?r:(0,u.jsx)(r,{className:"h-5 w-5 shrink-0"})}),g.children]})):(0,u.jsx)(c.gG,b({$as:a.ck,ref:t,onSelect:s,className:(0,n.default)("danger"===d&&"text-token-text-error",l)},g))}),Separator:function(e){let{className:t}=e,s=(0,i.Z)(e,g);return(0,u.jsx)(a.Z0,b({className:(0,n.default)("mx-5 my-1 h-px bg-token-border-light",t)},s))},RadioGroup:a.Ee,RadioItem:function(e){let{onSelect:t,children:s}=e,r=(0,i.Z)(e,f);return(0,u.jsxs)(c.aF,b(b({$as:a.Rk,onSelect:t},r),{},{children:[(0,u.jsx)(a.wU,{className:"absolute",children:(0,u.jsx)(d.$As,{className:"icon-sm"})}),(0,u.jsx)("span",{className:"ml-6",children:s})]}))},Sub:a.Tr,SubContent:function(e){let{className:t}=e,s=(0,i.Z)(e,h);return(0,u.jsx)(c.w5,b({$as:a.tu,className:(0,n.default)("mt-2 max-h-[calc(100vh-300px)] min-w-[100px] overflow-auto",t),sideOffset:8,alignOffset:-16,collisionPadding:20},s))},SubMenuTrigger:function(e){let{icon:t,children:s}=e,r=(0,i.Z)(e,x);return(0,u.jsxs)(c.gG,b(b({$as:a.fF},r),{},{children:[t&&(0,u.jsx)("div",{className:"flex h-5 w-5 items-center justify-center text-token-text-secondary",children:(0,u.jsx)(t,{className:"h-5 w-5 flex-shrink-0"})}),s,(0,u.jsx)("div",{className:"ml-auto flex items-center text-token-text-tertiary group-data-[disabled]:opacity-50",children:(0,u.jsx)(l.Yf,{className:"icon-md "})})]}))},Label:function(e){let{children:t}=e;return(0,u.jsx)(a.__,{className:"mx-2 my-0 px-2 text-xs font-semibold text-token-text-secondary",children:t})}};t.Z=w},73062:function(e,t,s){s.d(t,{g:function(){return f}});var r=s(98601),i=s(52088),a=s(54198),n=s(19841),o=s(92379),l=s(13490),d=s(50863),c=s(651);let u=["children"],p=["children","className"];function m(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function g(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?m(Object(s),!0).forEach(function(t){(0,r.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function f(e){let{options:t,value:s,onValueChange:r,disabled:i,defaultValue:a,placeholder:n}=e;return(0,c.jsxs)(h.Root,{value:s,onValueChange:r,disabled:i,defaultValue:a,children:[(0,c.jsxs)(h.Trigger,{children:[(0,c.jsx)(h.Value,{placeholder:n}),(0,c.jsx)(h.Icon,{})]}),(0,c.jsx)(h.Portal,{children:(0,c.jsx)(h.Content,{children:t.map(e=>(0,c.jsx)(h.Item,{value:e.value,children:e.label},e.value))})})]})}let h={Root:a.fC,Trigger:function(e){return(0,c.jsx)(d.J7,g({$as:a.xz},e))},Value:a.B4,Icon:function(){return(0,c.jsx)(a.JO,{children:(0,c.jsx)(l.Tg4,{className:"icon-sm"})})},Portal:a.h_,Content:function(e){let{children:t,className:s}=e,r=(0,i.Z)(e,p);return(0,c.jsxs)(d.w5,g(g({$as:a.VY,side:"bottom",sideOffset:4,position:"popper",className:(0,n.default)("min-w-[220px] overflow-auto",s)},r),{},{children:[(0,c.jsx)(a.u_,{className:"flex h-8 cursor-default items-center justify-center text-token-text-primary",children:(0,c.jsx)(l.r0F,{className:"icon-sm"})}),(0,c.jsx)(a.l_,{children:t}),(0,c.jsx)(a.$G,{className:"flex h-8 cursor-default items-center justify-center text-token-text-primary",children:(0,c.jsx)(l.Tg4,{className:"icon-sm"})})]}))},Item:o.forwardRef(function(e,t){let{children:s}=e,r=(0,i.Z)(e,u);return(0,c.jsxs)(d.gG,g(g({$as:a.ck,ref:t,className:"flex justify-between"},r),{},{children:[(0,c.jsx)(a.eT,{children:s}),(0,c.jsx)(a.wU,{className:"",children:(0,c.jsx)(l.kvR,{className:"icon-sm"})})]}))}),ItemText:a.eT,ItemIndicator:a.wU,Separator:function(){return(0,c.jsx)(a.Z0,{className:"mx-5 my-1 h-px bg-token-border-light"})},Label:function(e){let{children:t}=e;return(0,c.jsx)(a.__,{className:"mx-2 my-0 px-2 text-xs font-semibold text-token-text-secondary",children:t})},Group:a.ZA};t.Z=h},36792:function(e,t,s){var r=s(98601),i=s(52088),a=s(19841),n=s(92379),o=s(651);let l=["children"];function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach(function(t){(0,r.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let u=(0,n.createContext)({rootBordered:!1}),p=(0,n.forwardRef)(function(e,t){let{children:s,disabled:r=!1,onClick:i,className:n}=e;return(0,o.jsx)("tr",c(c({ref:t},r?{"data-disabled":!0}:{}),{},{className:(0,a.default)(r?"pointer-events-none":"",n),onClick:i,children:s}))});t.Z={Root:function(e){let{children:t,fixed:s=!1,className:r,size:i="normal",bordered:l=!1}=e,d=(0,n.useRef)(null),c=(0,n.useRef)(null),{0:p,1:m}=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=d.current,t=c.current;if(e&&t){let s=new ResizeObserver(()=>{m(t.scrollHeight>e.clientHeight)});return s.observe(e),()=>s.disconnect()}},[]),(0,o.jsx)(u.Provider,{value:{rootBordered:l},children:(0,o.jsx)("div",{className:(0,a.default)("overflow-y-auto text-token-text-primary",l&&"rounded-lg border border-token-border-light","normal"===i?"text-base":"text-sm",p&&"pr-1",r),ref:d,children:(0,o.jsx)("table",{className:(0,a.default)("w-full border-separate border-spacing-0",s&&"table-fixed"),ref:c,children:t})})})},Header:function(e){let{children:t}=e;return(0,o.jsx)("thead",{children:(0,o.jsx)("tr",{children:t})})},HeaderCell:function(e){let{textAlign:t="left",children:s,className:r=""}=e,{rootBordered:i}=(0,n.useContext)(u);return(0,o.jsx)("th",{className:(0,a.default)("text-token sticky top-0 z-10 border-b-[0.5px] border-token-border-medium bg-token-main-surface-primary py-2 font-semibold",i?"px-3":"pr-4 last:pr-0","left"===t?"text-left":"right"===t?"text-right":"text-center",r),children:s})},Body:function(e){let{children:t}=e,s=(0,i.Z)(e,l);return(0,o.jsx)("tbody",c(c({},s),{},{children:t}))},Row:p,Cell:function(e){let{textAlign:t="left",children:s,className:r,colSpan:i}=e,{rootBordered:l}=(0,n.useContext)(u);return(0,o.jsx)("td",{className:(0,a.default)("border-b-[0.5px] border-token-border-medium align-top",l?"px-3":"pr-4 last:pr-0 [tr:last-child_&]:border-b-0",t&&"text-"+t,r),colSpan:i,children:(0,o.jsx)("div",{className:(0,a.default)("flex min-h-[40px] items-center [tr[data-disabled=true]_&]:opacity-50","right"===t&&"justify-end","center"===t&&"justify-center"),children:s})})},Actions:function(e){let{children:t}=e;return(0,o.jsx)("div",{className:"text-md flex items-center justify-end gap-2",children:t})}}},50863:function(e,t,s){s.d(t,{J7:function(){return c},M4:function(){return g},aF:function(){return u},gG:function(){return p},w5:function(){return m}});var r,i,a,n,o,l=s(2346),d=s(15478);let c=d.Z.button(r||(r=(0,l.Z)(["\ntext-token-text-primary border border-transparent inline-flex h-9 items-center justify-center gap-1 rounded-lg bg-white px-3 text-sm dark:transparent dark:bg-transparent\nleading-none outline-none cursor-pointer\nhover:bg-token-main-surface-secondary dark:hover:bg-token-main-surface-secondary\nfocus-visible:bg-token-main-surface-secondary\nradix-state-active:text-token-text-secondary\nradix-disabled:cursor-auto radix-disabled:bg-transparent radix-disabled:text-token-text-tertiary dark:radix-disabled:bg-transparent\n"]))),u=d.Z.div(i||(i=(0,l.Z)(["flex gap-2 items-center m-1.5 rounded p-2.5 text-sm cursor-pointer focus-visible:outline-0 hover:bg-token-main-surface-secondary focus-visible:bg-token-main-surface-secondary radix-disabled:pointer-events-none radix-disabled:opacity-50 group relative"]))),p=(0,d.Z)(u)(a||(a=(0,l.Z)(["hover:bg-[#f5f5f5] focus-visible:bg-[#f5f5f5] dark:hover:bg-token-main-surface-secondary dark:focus-visible:bg-token-main-surface-secondary rounded-md my-0 px-3 mx-2 radix-state-open:bg-[#f5f5f5] dark:radix-state-open:bg-token-main-surface-secondary gap-2.5 py-3"]))),m=d.Z.div(n||(n=(0,l.Z)(["max-w-xs rounded-2xl popover bg-token-main-surface-primary shadow-lg will-change-[opacity,transform] radix-side-bottom:animate-slideUpAndFade radix-side-left:animate-slideRightAndFade radix-side-right:animate-slideLeftAndFade radix-side-top:animate-slideDownAndFade border border-token-border-light py-2"]))),g=d.Z.div(o||(o=(0,l.Z)(["popover overflow-auto rounded-xl border border-token-border-light bg-token-main-surface-primary p-2 shadow-xl"])))},21025:function(e,t,s){s.d(t,{YK:function(){return a},ai:function(){return n},nJ:function(){return o}});var r=s(10080);function i(e){return e==r.Zz.User||e==r.Zz.Group?r.Zz.Private:e==r.Zz.WorkspaceLink?r.Zz.Workspace:e}function a(e,t){return e=i(e),void 0!==t&&t.some(t=>t.recipient===e&&t.allowed)}function n(e,t){if(void 0===t)return[];e=i(e);let s=t.find(t=>t.recipient===e);return null==s?void 0:s.moderated_fields}function o(e,t){let s=n(e,t);return s&&s.length>0}s(651)},51307:function(e,t,s){s.d(t,{JE:function(){return L},MU:function(){return F},Te:function(){return _},UJ:function(){return T},z$:function(){return I}});var r,i,a,n,o,l=s(98601),d=s(2346),c=s(59144),u=s(24434),p=s(39004),m=s(99555),g=s(10080),f=s(93951),h=s(42420),x=s(88667),v=s(82920),b=s(91530),j=s.n(b),y=s(92379),w=s(68306),k=s(62984),z=s(75172),N=s(15478),O=s(21025),P=s(651);function M(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Z(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?M(Object(s),!0).forEach(function(t){(0,l.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):M(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let C=N.Z.a(n||(n=(0,d.Z)(["bold underline"]))),S=N.Z.textarea(o||(o=(0,d.Z)(["w-full text-sm overflow-y-auto rounded-lg border px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium bg-token-main-surface-primary h-32"]))),T=((r={})[r.None=0]="None",r[r.AppealAvailable=1]="AppealAvailable",r[r.AppealSent=2]="AppealSent",r),_=((i={})[i.None=0]="None",i[i.PublishBlocked=1]="PublishBlocked",i[i.RemovedFromMarketplace=2]="RemovedFromMarketplace",i[i.RemovedFromPublic=3]="RemovedFromPublic",i[i.RemovedFromPrivate=4]="RemovedFromPrivate",i[i.Recategorized=5]="Recategorized",i);function I(e){var t;if(!e)return;let s=(null===(t=e.gizmo.appeal_info)||void 0===t?void 0:t.state.kind)==="appeal_sent",r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=new Set(t.filter(e=>e.allowed).map(e=>e.recipient));if(!e||(e in E&&(e=E[e]),s.has(e)))return _.None;let r=s.has(g.Zz.Private)||s.has(g.Zz.Workspace),i=s.has(g.Zz.Link)||s.has(g.Zz.Marketplace);return e===g.Zz.Marketplace&&i?_.RemovedFromMarketplace:!i&&r?_.RemovedFromPublic:_.RemovedFromPrivate}(e.gizmo.share_recipient,e.gizmo.sharing_targets);return{sharingRecipient:e.gizmo.share_recipient,categories:e.gizmo.categories,gizmoId:e.gizmo.id,moderationType:r,sharingTargets:e.gizmo.sharing_targets,showModal:s?T.AppealSent:r!==_.None?T.AppealAvailable:T.None}}let E={[g.Zz.User]:g.Zz.Private,[g.Zz.Group]:g.Zz.Private,[g.Zz.WorkspaceLink]:g.Zz.Workspace};function A(e){switch(e){case _.None:case _.PublishBlocked:return(0,w.Em)({id:"gizmo.appeals.publishBlockedTitle",defaultMessage:"Your changes couldn’t be published"});case _.RemovedFromMarketplace:return(0,w.Em)({id:"gizmo.appeals.removedFromMarketplaceTitle",defaultMessage:"Your GPT has been removed from the marketplace"});case _.RemovedFromPublic:return(0,w.Em)({id:"gizmo.appeals.removedFromPublicTitle",defaultMessage:"Your GPT has been removed from public view"});case _.Recategorized:return(0,w.Em)({id:"gizmo.appeals.recategorizedTitle",defaultMessage:"Your GPT has been recategorized"});default:(0,v.ZP)(e)}}function L(e){let{sharingRecipient:t,moderatedFields:s,appealAvailable:r}=e,i=s.length;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("p",{children:[(0,P.jsx)(k.Z,Z(Z({},function(e){switch(e){case g.Zz.Private:case g.Zz.Workspace:return(0,w.Em)({id:"gizmo.appeals.privateRecipientModerationText",defaultMessage:"Your GPT can’t be updated because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case g.Zz.Link:return(0,w.Em)({id:"gizmo.appeals.linkRecipientModerationText",defaultMessage:"Your GPT can’t be shared publicly because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case g.Zz.Marketplace:return(0,w.Em)({id:"gizmo.appeals.marketplaceRecipientModerationText",defaultMessage:"Your GPT can’t appear in the Explore GPTs page because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});default:(0,v.ZP)(e)}}(t)),{},{values:{usagePolicyLink:e=>(0,P.jsx)(C,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:e})}}))," ",i>0&&(0,P.jsx)(k.Z,{id:"gizmo.appeals.seeBelowForSpecificIssues",defaultMessage:"{numModeratedFields, plural, one {See below for the specific issue:} other {See below for the specific issues:} }",values:{numModeratedFields:i}})]}),i>0&&(null==s?void 0:s.map(e=>(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("p",{className:"font-bold",children:(0,P.jsx)(k.Z,Z({},function(e){switch(e){case"profile_picture":return(0,w.Em)({id:"gizmo.appeals.profilePictureFieldName",defaultMessage:"Profile Picture"});case"gizmo_name":return(0,w.Em)({id:"gizmo.appeals.gizmoNameFieldName",defaultMessage:"Name"});case"gizmo_description":return(0,w.Em)({id:"gizmo.appeals.gizmoDescriptionFieldName",defaultMessage:"Description"});case"gizmo_instructions":return(0,w.Em)({id:"gizmo.appeals.gizmoInstructionsFieldName",defaultMessage:"Instructions"});case"gizmo_welcome_message":return(0,w.Em)({id:"gizmo.appeals.gizmoWelcomeMessageFieldName",defaultMessage:"Welcome Message"});case"custom_actions":return(0,w.Em)({id:"gizmo.appeals.customActionsFieldName",defaultMessage:"Custom Actions"});case"conversation_starter":return(0,w.Em)({id:"gizmo.appeals.conversationStarterFieldName",defaultMessage:"Conversation Starter"});case"file":return(0,w.Em)({id:"gizmo.appeals.fileFieldName",defaultMessage:"File"});case"gizmo_combined_content":return(0,w.Em)({id:"gizmo.appeals.gizmoCombinedContentFieldName",defaultMessage:"Overall GPT Config"})}}(e.name)))}),(0,P.jsx)("ul",{className:"list-disc pl-5",children:e.reasons.map(e=>(0,P.jsxs)("li",{children:[e.description," ",e.link?(0,P.jsx)(C,{href:e.link,target:"_blank",rel:"noreferrer",children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.learnMore",defaultMessage:"Learn more"})}):""]},e.description))})]}))),r&&(0,P.jsx)("p",{children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.appealAvailableText",defaultMessage:"Alternatively you may appeal this decision and we will get back to you as soon as possible. Or you can publish to “Only me” and use this GPT privately."})})]})}var D=((a=D||{})[a.Initial=0]="Initial",a[a.AppealForm=1]="AppealForm",a[a.SubmittedConfirmation=2]="SubmittedConfirmation",a);function R(e){var t;let{gizmoId:s,sharingRecipient:r,categories:i,moderationType:a,sharingTargets:n,appealAvailable:o,onClose:l,onAppealSubmitted:d}=e,p=(0,z.Z)(),{0:g,1:x}=(0,y.useState)(""),{0:v,1:b}=(0,y.useState)(D.Initial),j=(0,h.NL)(),w=async()=>{await m.U.postGizmoAppeal(j,s,g,r,i),b(D.SubmittedConfirmation),null==d||d()},N=(0,O.ai)(r,n),M=null!==(t=null==N?void 0:N.length)&&void 0!==t?t:0,Z=(0,f.t)();if(0==M&&(null==Z?void 0:Z.isEnterprisey()))return(0,P.jsx)(u.Z,{title:p.formatMessage(A(a)),isOpen:!0,onClose:l,showCloseButton:!0,type:"warning",primaryButton:(0,P.jsx)(c.Z.Button,{color:"primary",onClick:l,children:(0,P.jsx)(k.Z,{id:"wEsAOU",defaultMessage:"OK"})}),children:(0,P.jsx)("p",{className:"text-sm",children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.workspaceSettingsMessage",defaultMessage:"Access to your GPT has been reduced by your workspace's GPT sharing settings. An owner of the workspace can change these settings in the workspace settings page."})})});switch(v){case D.Initial:return(0,P.jsx)(u.Z,{title:p.formatMessage(A(a)),isOpen:!0,onClose:l,showCloseButton:!0,primaryButton:(0,P.jsx)(c.Z.Button,{color:"primary",onClick:l,children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.contunueButton",defaultMessage:"Continue"})}),secondaryButton:o?(0,P.jsx)(c.Z.Button,{onClick:()=>b(D.AppealForm),children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.appealButton",defaultMessage:"Appeal"})}):void 0,type:"warning",children:(0,P.jsx)("div",{className:"flex flex-col gap-2 text-sm",children:(0,P.jsx)(L,{sharingRecipient:r,moderatedFields:null!=N?N:[],appealAvailable:o})})});case D.AppealForm:return(0,P.jsx)(u.Z,{title:p.formatMessage({id:"gizmo.appeals.appealModalTitle",defaultMessage:"Appeal"}),isOpen:!0,onClose:l,showCloseButton:!0,shouldIgnoreClickOutside:!0,primaryButton:(0,P.jsx)(c.Z.Button,{color:"primary",onClick:w,disabled:0===g.trim().length,children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.submitAppealButton",defaultMessage:"Submit"})}),secondaryButton:(0,P.jsx)(c.Z.Button,{onClick:()=>b(D.Initial),children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.backButton",defaultMessage:"Back"})}),type:"warning",children:(0,P.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,P.jsx)("p",{children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.appealReasonText",defaultMessage:"Please provide a reason for why you believe this GPT doesn’t violate our policies and should be published"})}),(0,P.jsx)(S,{value:g,onChange:e=>x(e.target.value)})]})});case D.SubmittedConfirmation:return(0,P.jsx)(P.Fragment,{})}}function G(e){let{onClose:t}=e,s=(0,z.Z)();return(0,P.jsx)(u.Z,{title:s.formatMessage({id:"gizmo.appeals.appealSubmittedModalTitle",defaultMessage:"Appeal submitted"}),isOpen:!0,onClose:t,showCloseButton:!0,primaryButton:(0,P.jsx)(c.Z.Button,{color:"primary",onClick:t,children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.closeButton",defaultMessage:"Close"})}),type:"success",children:(0,P.jsx)("div",{className:"flex flex-col gap-2 text-sm",children:(0,P.jsx)("div",{children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.appealSubmittedText",defaultMessage:"Your appeal has been submitted. We will get back to you as soon as possible."})})})})}function U(e){let{gizmoId:t,onClose:s}=e,{data:r}=(0,p.b9)(t,!0),i=(0,h.NL)(),a=async()=>{await m.U.postGizmoCancelAppeal(i,t)};return(0,P.jsx)(u.Z,{isOpen:!0,onClose:j(),primaryButton:(0,P.jsx)(c.Z.Button,{color:"primary",onClick:()=>{a(),null==s||s()},children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.cancelAppealButton",defaultMessage:"Cancel appeal"})}),type:"warning",children:(0,P.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,P.jsx)("h2",{className:"text-lg font-semibold",children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.appealReviewingHeader",defaultMessage:"Reviewing your appeal"})}),(0,P.jsx)("p",{children:(0,P.jsx)(k.Z,{id:"gizmo.appeals.appealSentModalText",defaultMessage:"During the review you can continue using “{gizmoName}” as your private GPT, but won’t be able to update it or share it with others.",values:{gizmoName:null==r?void 0:r.gizmo.display.name}})})]})})}function F(e){let{appealState:t,onAppealClose:s,onAppealSubmitted:r}=e,{value:i}=(0,x.sB)("4226692983"),{0:a,1:n}=(0,y.useState)(!1);return a?(0,P.jsx)(G,{onClose:()=>{n(!1),null==r||r()}}):(0,P.jsxs)(P.Fragment,{children:[(null==t?void 0:t.showModal)==T.AppealSent&&(0,P.jsx)(U,{gizmoId:t.gizmoId,onClose:s}),(null==t?void 0:t.showModal)==T.AppealAvailable&&(0,P.jsx)(R,{gizmoId:t.gizmoId,sharingRecipient:t.sharingRecipient,categories:t.categories,moderationType:t.moderationType,sharingTargets:t.sharingTargets,appealAvailable:i,onClose:()=>null==s?void 0:s(),onAppealSubmitted:()=>n(!0)})]})}},91124:function(e,t,s){s.d(t,{V9:function(){return tg},yf:function(){return tc}});var r,i,a=s(98601),n=s(99333),o=s(16757),l=s(97537),d=s(98303),c=s(51307),u=s(8320),p=s(39004),m=s(10080),g=s(24740),f=s(67437),h=s(93951),x=s(41987),v=s(92745),b=s(31498),j=s(92319),y=s(13391),w=s(3551),k=s(38724),z=s(43991),N=s(42420),O=s(99976),P=s(61619),M=s(82363),Z=s(13249),C=s(19841),S=s(17806),T=s.n(S),_=s(89678),I=s.n(_),E=s(65925),A=s.n(E),L=s(38482),D=s.n(L),R=s(34977),G=s(92379),U=s(75172),F=s(68306),B=s(2346),K=s(12128),V=s(46702),W=s(71090),Q=s(31438),Y=s(66290),q=s(88667),J=s(62984),H=s(15478),$=s(38838),X=s(98095),ee=s(13490),et=s(76665),es=s(99555),er=s(41177),ei=s(23763),ea=s.n(ei),en=s(11550),eo=s(24434),el=s(30853),ed=s(21025),ec=s(81107),eu=s(651);function ep(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function em(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ep(Object(s),!0).forEach(function(t){(0,a.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ep(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function eg(e){let{gizmo:t,updateGizmo:s,publishedGizmo:r,promoteGizmo:i,appealGizmo:a,setAppealState:n,showActionsModal:o,shareOnly:l,onClose:d}=e,{0:c,1:u}=(0,G.useState)({type:"privacy"});return"privacy"===c.type?(0,eu.jsx)(ef,{gizmo:t,updateGizmo:s,publishedGizmo:r,promoteGizmo:i,appealGizmo:a,setAppealState:n,setStep:u,showActionsModal:o,shareOnly:l,onClose:d}):(0,eu.jsx)(eh,{publishedGizmo:c.publishedGizmo,onClose:d})}function ef(e){var t,s,r,i;let{gizmo:a,publishedGizmo:o,updateGizmo:l,promoteGizmo:d,appealGizmo:u,setAppealState:f,setStep:x,showActionsModal:v,shareOnly:j,onClose:y}=e,{0:w,1:k}=(0,G.useState)(!1),O=(0,b.ec)(b.F_.isBusinessWorkspace),P=(0,U.Z)(),{0:M,1:Z}=(0,G.useState)((0,p.Sg)(a)?O?m.Zz.Workspace:m.Zz.Link:a.sharingRecipient),C=(0,N.NL)(),S=(0,ed.YK)(M,a.sharingTargets),{data:T,isLoading:_}=(0,p.WL)(),I=(0,p.Z1)(),{0:E,1:A}=(0,G.useState)(null!=o&&o.gizmo.display.categories.length>0?null===(t=I.data)||void 0===t||null===(t=t.categories.find(e=>e.id===o.gizmo.display.categories[0]))||void 0===t?void 0:t.id:void 0);(0,G.useEffect)(()=>{A(null==o?void 0:o.gizmo.display.categories[0])},[null==o?void 0:o.gizmo.display.categories]);let{0:L,1:D}=(0,G.useState)(void 0),R=(0,G.useRef)(ea()((e,t)=>es.U.generateCategory(e,t),1e3)),F=null!=T&&T.is_verified?void 0:P.formatMessage({id:"qEQtmt",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile."});M!==m.Zz.Marketplace||null==F||_||Z(m.Zz.Link);let B=O&&!(null!==(s=a.sharingTargets)&&void 0!==s&&s.some(e=>e.recipient===m.Zz.Link)),K=(0,et.bw)(a,M,E),V=K.includes(et.hs.MissingPublicActionPrivacyPolicyURL),W=a.tools.find(e=>e.type===n.qK.JIT_PLUGIN&&!e.metadata.privacy_policy_url),Q=(0,b.ec)(e=>e.currentWorkspace),Y=(0,h.hz)();(0,G.useEffect)(()=>{let e=!0;return(async()=>{try{if(null!=E)return;let t=await R.current(a.name,a.instructions);e&&null==E&&(t?A(t.id):D(!0))}catch(t){e&&null==E&&D(!0)}})(),()=>{e=!1}},[a.instructions,a.name,Y,E]);let{value:H}=(0,q.sB)("4226692983");return(0,eu.jsx)(eo.Z,{type:"success",isOpen:!0,onClose:y,title:(0,eu.jsx)(J.Z,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:S?(0,eu.jsx)(en.z,{color:"primary",disabled:K.length>0,loading:w,onClick:async()=>{try{if(k(!0),j){if(!(null!=o&&o.gizmo.id)){g.m.danger(P.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}));return}let e=await es.U.shareGizmo(o.gizmo.id,E?{sharing:(0,m.Mj)(M,[],m.EL),categories:[E]}:{sharing:(0,m.Mj)(M,[],m.EL)});e.error?(g.m.warning(P.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),l({sharingTargets:e.sharing_targets}),f({gizmoId:o.gizmo.id,sharingRecipient:M,categories:o.gizmo.display.categories,moderationType:c.Te.PublishBlocked,sharingTargets:e.sharing_targets,showModal:c.UJ.AppealAvailable})):(C.setQueryData(["gizmo",{gizmoId:o.gizmo.id},{draft:!1}],t=>e.resource),l(e=>em(em({},e),{},{sharingRecipient:M})),g.m.success(P.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),y())}else{let e=await d({recipient:M,subjects:(0,m.Mj)(M,[],m.EL)},E);e?(x({type:"published",publishedGizmo:e}),l(t=>em(em({},t),{},{id:e.gizmo.id,sharingRecipient:M})),null!=e.gizmo.live_version&&l({liveVersion:e.gizmo.live_version}),g.m.success(P.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}))):(g.m.warning(P.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),y())}}finally{k(!1)}},children:(0,eu.jsx)(J.Z,{id:"SW4DG4",defaultMessage:"Save"})}):H?(0,eu.jsx)(eu.Fragment,{children:(0,eu.jsx)(en.z,{color:"primary",onClick:async()=>{await u(M,E)},children:(0,eu.jsx)(J.Z,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:o?(0,eu.jsx)(en.z,{color:"secondary",onClick:()=>(0,ec.A4)(o,P.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:(0,eu.jsx)(J.Z,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:(0,eu.jsxs)("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[(0,eu.jsx)("div",{className:"space-y-1.5",children:(0,eu.jsxs)(z.fC,{value:M,onValueChange:e=>Z(e),children:[a.sharingTargets&&a.sharingTargets.map((e,t)=>(0,eu.jsx)(ev,{value:e.recipient,disabled:e.recipient===m.Zz.Marketplace&&null!=F,tooltipText:e.recipient===m.Zz.Marketplace?null!=F?F:P.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:e.recipient},t)),B&&(0,eu.jsxs)(eu.Fragment,{children:[(0,eu.jsx)(ev,{value:m.Zz.Link,disabled:!0,tooltipText:P.formatMessage(ex.workspaceDisabledHint),shareLevel:m.Zz.Link,workspaceName:null==Q?void 0:Q.name}),(0,eu.jsx)(ev,{value:m.Zz.Link,disabled:!0,tooltipText:P.formatMessage(ex.workspaceDisabledHint),shareLevel:m.Zz.Marketplace,workspaceName:null==Q?void 0:Q.name})]})]})}),V&&(0,eu.jsx)("div",{className:"text-xs text-red-500",children:(0,eu.jsx)(J.Z,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:e=>(0,eu.jsx)("button",{onClick:()=>{v(null==W?void 0:W.metadata.action_id)},className:"underline",children:e})}})}),M!==m.Zz.Private&&(0,eu.jsx)(er.O2,{gizmo:a,category:E,categories:M===m.Zz.Marketplace?null!==(r=null===(i=I.data)||void 0===i?void 0:i.categories)&&void 0!==r?r:[]:void 0,onCategoryChange:M===m.Zz.Marketplace?e=>A(e.id):void 0}),M===m.Zz.Marketplace&&(L?(0,eu.jsx)("div",{className:"text-xs text-red-500",children:(0,eu.jsx)(J.Z,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!S&&H&&(0,eu.jsx)("div",{className:"flex items-center justify-between text-sm text-token-text-secondary",children:(0,eu.jsx)(J.Z,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function eh(e){let{publishedGizmo:t,onClose:s}=e,r=(0,ec.Rb)(t),i=(0,U.Z)();return(0,eu.jsx)(eo.Z,{type:"success",isOpen:!0,onClose:s,title:(0,eu.jsx)(J.Z,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:(0,eu.jsx)(en.z,{color:"primary",as:"link",to:r,children:(0,eu.jsx)(J.Z,{id:"lyZz44",defaultMessage:"View GPT"})}),children:(0,eu.jsx)("div",{className:"flex flex-col gap-2",children:(0,eu.jsxs)("div",{className:"flex gap-1 rounded bg-token-main-surface-secondary px-2 py-1",children:[(0,eu.jsx)("div",{className:"line-clamp-1 text-ellipsis break-all",children:r}),(0,eu.jsx)("button",{onClick:()=>{(0,ec.A4)(t,i.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary transition hover:text-token-text-primary",children:(0,eu.jsx)(ee.TIy,{className:"icon-sm"})})]})})})}let ex=(0,F.vU)({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function ev(e){let{shareLevel:t,workspaceName:s,value:r,disabled:i=!1,tooltipText:a}=e,n=(0,G.useId)();return(0,eu.jsx)(el.E,{disabled:null==a,label:a,side:"top",children:(0,eu.jsxs)(z.ck,{id:n,value:r,disabled:i,className:"flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold hover:bg-token-main-surface-secondary",children:[(0,eu.jsx)("label",{htmlFor:n,className:"flex cursor-pointer items-center gap-1",children:(0,eu.jsx)(er.C6,{shareLevel:t,workspaceName:null!=s?s:"",hasInviteSharing:!1})}),(0,eu.jsx)(z.z$,{children:(0,eu.jsx)(ee.kvR,{className:"icon-lg mr-1"})})]})})}function eb(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function ej(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?eb(Object(s),!0).forEach(function(t){(0,a.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):eb(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function ey(e){e(window.history.length>1?-1:(0,w.L7)())}function ew(e){var t;let{gizmo:s,publishedGizmo:r,isLoading:i,isUploadingProfilePic:a,isGeneratingProfilePic:n,updateGizmo:o,promoteGizmo:l,appealGizmo:d,setAppealState:c,showActionsModal:u}=e,g=(0,h.t)(),f=null!=s?(0,et.bw)(s):[];(null==s||i)&&f.push(et.hs.Loading),a&&f.push(et.hs.UploadingProfilePic),n&&f.push(et.hs.GeneratingProfilePic);let x=(0,p.Sg)(s),{0:v,1:b}=(0,G.useState)(!1),{0:j,1:y}=(0,G.useState)(!1),w=s.sharingRecipient?er.P6[s.sharingRecipient]:er.P6.private;return(0,eu.jsxs)(eu.Fragment,{children:[x?(0,eu.jsx)(W.cY,{color:"primary",onClick:()=>b("promote"),loading:i,disabled:void 0===s.id||f.length>0,tooltip:f.length>0?f.map(et.sw).join("\n"):void 0,children:(0,eu.jsx)(J.Z,{id:"svUGIb",defaultMessage:"Create"})}):(0,eu.jsxs)(eu.Fragment,{children:[(0,eu.jsxs)(W.cY,{color:"secondary",loading:i||!r,onClick:()=>b("share"),children:[(0,eu.jsx)(w,{className:"icon-sm shrink-0"}),(0,eu.jsx)(J.Z,{id:"aXKW4G",defaultMessage:"Share"})]}),(0,eu.jsx)(W.cY,{color:"primary",onClick:async()=>{var e;let t=s.sharing.subjects.map(er.xH),i=(0,m.H$)(s.sharing.subjects);t=(0,m.Mj)(s.sharing.recipient,t,null!==(e=null==i?void 0:i.capabilities)&&void 0!==e?e:m.EL),await l({recipient:s.sharing.recipient,subjects:t},null==r?void 0:r.gizmo.display.categories[0])&&y(!0)},loading:i||!r,disabled:f.length>0,tooltip:f.length>0?f.map(et.sw).join("\n"):void 0,children:(0,eu.jsx)(J.Z,{id:"84QVoj",defaultMessage:"Update"})})]}),v&&((null==g?void 0:g.getWorkspaceId())==void 0?(0,eu.jsx)(eg,{gizmo:s,publishedGizmo:r,promoteGizmo:l,appealGizmo:d,setAppealState:c,showActionsModal:u,updateGizmo:o,shareOnly:"share"===v,onClose:()=>b(!1)}):(0,eu.jsx)(er.hD,{gizmo:s,publishedGizmo:r,promoteGizmo:l,appealGizmo:d,setAppealState:c,showActionsModal:u,updateGizmo:o,onClose:()=>b(!1),shareOnly:"share"===v})),j&&(0,eu.jsx)(er.uj,{publishedGizmo:r,sharing:r.gizmo.sharing,onClose:()=>y(!1),workspaceName:null!==(t=null==g?void 0:g.data.name)&&void 0!==t?t:""})]})}function ek(e){let{gizmoEditorData:t,publishedGizmo:s,revertDraft:r}=e,i=(0,U.Z)(),a=(0,Y.Z)(),{0:n,1:o}=(0,G.useState)(!1),l=(0,h.hz)(),{value:d}=(0,q.sB)("3645668434");return null!=l&&l.includes("debug")||(null==t?void 0:t.id)!=null?(0,eu.jsxs)(eu.Fragment,{children:[(0,eu.jsxs)(X.d,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:(0,eu.jsx)(W.cY,{color:"ghost",icon:ee.nWS}),children:[null!=s&&(0,eu.jsxs)(X.Z.Item,{onClick:()=>{(0,ec.A4)(s)},children:[(0,eu.jsx)(ee.xPt,{className:"icon-sm"}),(0,eu.jsx)(J.Z,ej({},eM.copyLink))]}),null!=r&&(0,eu.jsxs)(X.Z.Item,{onClick:()=>{window.confirm(i.formatMessage(eM.revertConfirm))&&r()},children:[(0,eu.jsx)(ee.Ezi,{className:"icon-sm"}),(0,eu.jsx)(J.Z,{id:"W2blnV",defaultMessage:"Revert..."})]}),(null==t?void 0:t.id)!=null&&d&&t.liveVersion>0&&(0,eu.jsxs)(eu.Fragment,{children:[(0,eu.jsxs)(X.Z.Item,{onClick:()=>{a("/g/".concat(t.id,"/view"))},children:[(0,eu.jsx)(ee.JJ3,{className:"icon-sm"}),(0,eu.jsx)(J.Z,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),(0,eu.jsxs)(X.Z.Item,{onClick:async()=>{let e=await es.U.copyGizmo({gizmoId:t.id});e.gizmo.id&&a("/gpts/editor/".concat(e.gizmo.id))},children:[(0,eu.jsx)(ee.TIy,{className:"icon-sm"}),(0,eu.jsx)(J.Z,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),(null==t?void 0:t.id)!=null&&(0,eu.jsxs)(X.Z.Item,{color:"danger",onClick:()=>{o(!0)},children:[(0,eu.jsx)(ee.XHJ,{className:"icon-sm"}),(0,eu.jsx)(J.Z,{id:"tNrOLG",defaultMessage:"Delete GPT"})]}),(null==l?void 0:l.includes("debug"))&&(0,eu.jsxs)(eu.Fragment,{children:[(0,eu.jsx)(X.Z.Separator,{}),(0,eu.jsxs)(X.Z.Item,{onClick:()=>{Q.vm.toggleActiveSidebar("debug")},children:[(0,eu.jsx)(ee.reV,{className:"icon-sm"}),"Debug (Internal only)"]})]})]}),n&&(0,eu.jsx)(V.b,{gizmoId:t.id,onSuccess:()=>ey(a),onClose:()=>{o(!1)}})]}):null}let ez=H.Z.div(i||(i=(0,B.Z)(["flex items-center gap-1"])));function eN(e){let{gizmoEditorData:t}=e,s=(0,b.ec)(e=>{var t;return null===(t=e.currentWorkspace)||void 0===t?void 0:t.name});switch(t.sharingRecipient){case m.Zz.Private:return(0,eu.jsxs)(ez,{children:[(0,eu.jsx)(ee.oVl,{className:"icon-xs"}),(0,eu.jsx)(J.Z,ej({},eM.onlyMe))]});case m.Zz.Link:return(0,eu.jsxs)(ez,{children:[(0,eu.jsx)(ee.xPt,{className:"icon-xs"}),(0,eu.jsx)(J.Z,ej({},eM.anyoneWithLink))]});case m.Zz.Workspace:return(0,eu.jsxs)(ez,{children:[(0,eu.jsx)(ee.ZyV,{className:"icon-xs"}),s]});case m.Zz.Marketplace:return(0,eu.jsxs)(ez,{children:[(0,eu.jsx)(ee.frp,{className:"icon-xs"}),(0,eu.jsx)(J.Z,ej({},eM.public))]});default:return(0,eu.jsx)("div",{})}}function eO(e){let{gizmoEditorData:t}=e;return(0,eu.jsxs)("div",{className:"flex items-center gap-2",children:[null!=t.profilePictureUrl?(0,eu.jsx)(K.Z,{isFirstParty:!1,src:t.profilePictureUrl,className:"h-8 w-8"}):(0,eu.jsx)("div",{className:"h-8 w-8 rounded-full border-2 border-dashed border-token-border-medium"}),(0,eu.jsxs)("div",{children:[(0,eu.jsx)("div",{className:"text-sm font-semibold",children:t.name||(0,eu.jsx)(J.Z,ej({},eM.newGPT))}),(0,eu.jsx)("div",{className:"text-xs text-token-text-secondary",children:(0,p.Sg)(t)?(0,eu.jsxs)("div",{className:"flex items-center gap-1",children:[(0,eu.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-token-text-tertiary"}),(0,eu.jsx)(J.Z,ej({},eM.draft))]}):(0,eu.jsxs)("div",{className:"flex items-center gap-1",children:[(0,eu.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-brand-green"}),t.sharingRecipient===m.Zz.Marketplace?(0,eu.jsx)(J.Z,ej({},eM.published)):(0,eu.jsx)(J.Z,{id:"gizmoEditorHeader.live",defaultMessage:"Live"})," \xb7 ",(0,eu.jsx)(eN,{gizmoEditorData:t})]})})]})]})}function eP(e){let{gizmoEditorData:t,isLoading:s,isUploadingProfilePic:r,isGeneratingProfilePic:i,publishedGizmo:a,updateGizmo:n,promoteGizmo:o,appealGizmo:l,setAppealState:d,revertDraft:c,draftMessage:u,className:p,hasUnpublishedChanges:m,showActionsModal:g}=e,f=(0,Y.Z)();return(0,eu.jsxs)("div",{className:(0,C.default)("relative flex h-14 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",p),children:[(0,eu.jsxs)("div",{className:"flex items-center gap-2",children:[(0,eu.jsx)("a",{className:"cursor-pointer text-token-text-primary",onClick:()=>ey(f),children:(0,eu.jsx)($.Dz,{className:"icon-lg"})}),(0,eu.jsx)(eO,{gizmoEditorData:t})]}),(0,eu.jsxs)("div",{className:"flex items-center gap-2",children:[u,(0,eu.jsx)(ek,{gizmoEditorData:t,publishedGizmo:a,revertDraft:c}),(0,eu.jsx)(ew,{gizmo:t,publishedGizmo:a,isLoading:s,isUploadingProfilePic:r,isGeneratingProfilePic:i,updateGizmo:n,promoteGizmo:o,appealGizmo:l,setAppealState:d,hasUnpublishedChanges:m,showActionsModal:g})]})]})}let eM=(0,F.vU)({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"}});var eZ=s(18939),eC=s.n(eZ),eS=s(52531);function eT(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function e_(e){let{upsertDraftError:t}=e,s=function(e,t){let s=e.response,r=(0,j.Ot)(e);if(!Array.isArray(s))return r;let i=eC()(s.map(e=>{if("value_error.any_str.max_length"===e.type)switch(e.loc[1]){case"display":switch(e.loc[2]){case"name":return t.formatMessage(eS.sY.nameTooLong,{length:e.ctx.limit_value});case"description":return t.formatMessage(eS.sY.descriptionTooLong,{length:e.ctx.limit_value})}break;case"instructions":return t.formatMessage(eS.sY.instructionsTooLong,{length:e.ctx.limit_value})}if("string"==typeof e.msg)return e.msg}));return i.length>0?i.join("\n"):r}(t,(0,U.Z)());return(0,eu.jsxs)("div",{className:"flex items-center gap-2 text-red-500",children:[(0,eu.jsx)("div",{children:(0,eu.jsx)(J.Z,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?eT(Object(s),!0).forEach(function(t){(0,a.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):eT(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},eE.errorSavingDraft))}),null!=s&&(0,eu.jsx)(el.u,{label:s,children:(0,eu.jsx)(ee.szr,{className:"icon-sm"})})]})}function eI(e){let{isPublished:t,isSavingDraft:s,hasUnpublishedChanges:r,upsertDraftError:i,className:a}=e;return i instanceof j.Q0?(0,eu.jsx)(e_,{upsertDraftError:i}):r?(0,eu.jsxs)("div",{className:(0,C.default)("flex items-center gap-2",a),children:[(0,eu.jsx)("span",{className:"text-token-text-secondary",children:t?(0,eu.jsx)(J.Z,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):(0,eu.jsx)(J.Z,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),(0,eu.jsx)("div",{className:"w-4 text-token-text-tertiary",children:s&&(0,eu.jsx)(l.Z,{})})]}):null}let eE=(0,F.vU)({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}});var eA=s(90945),eL=s(60825),eD=s(93866),eR=s(62166),eG=s(65418),eU=s(34455),eF=s(92054),eB=s(2319),eK=s(66114),eV=s(74301),eW=s(2721),eQ=s(46900),eY=s(98541),eq=s(79857),eJ=s(38924),eH=s(97834),e$=s(52978),eX=s(68039),e0=s.n(eX),e1=s(46667),e2=s.n(e1);function e3(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function e4(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?e3(Object(s),!0).forEach(function(t){(0,a.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):e3(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}async function e5(e){let t;for(let s of e)if("gizmo_editor.generate_profile_pic"===s.author.name){let e=eQ.U.getImageAssetPointers(s);e.length>0&&(t=e.at(-1))}if(null!=t){let e=(0,eK.Iy)(t.asset_pointer),s=await eW.Z.getFileDownloadLink(e);if(s.status===n.KF.Success)return{id:e,permalink:s.download_url}}}async function e9(e,t,s){var r,i;let a=function(e,t){let s=v.tQ.getThreadCurrentLeafId(e),r=v.tQ.getTree(e),i=[],a=r.getNodeByIdOrMessageId(s);for(;null!=a&&(null==t||a.id!==t);)i.unshift(a.message),a=""!==a.parentId?r.getNodeByIdOrMessageId(a.parentId):void 0;return i}(t,s),o=a.filter(e=>"gizmo_editor.update_behavior"===e.recipient).flatMap(e=>"text"===e.content.content_type?e.content.parts:"code"===e.content.content_type?[e.content.text]:[]).map(e=>JSON.parse(e)).reduce((e,t)=>e4(e4({},e),t),{}),l=await e5(a);if(e0()(o)&&null==l)return;let{name:d,context:c,description:u,profile_pic_file_id:p,prompt_starters:m}=o;if(null!=p)try{let t=await eW.Z.getFileDownloadLink(p,e.id);t.status===n.KF.Success&&(l={id:p,permalink:t.download_url})}catch(e){M.U.addError(Error("Error while retrieving profile pic in update",{cause:e})),g.m.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}let f={name:"string"==typeof d?d:void 0,description:"string"==typeof u?u:void 0,instructions:"string"==typeof c?c:void 0,promptStarters:Array.isArray(m)?m:void 0,profilePictureId:null===(r=l)||void 0===r?void 0:r.id,profilePictureUrl:null===(i=l)||void 0===i?void 0:i.permalink};return e2()(f,e=>null!=e)}function e8(e,t,s,r){var i,a,n,l,d,c,u,p,m,g,f;let h=s.current,x=r.current;if(A()(h,x))return;let b={};h.name!==(null==x?void 0:x.name)&&(b.name=h.name),(null!==(i=h.description)&&void 0!==i?i:"")!==(null!==(a=null==x?void 0:x.description)&&void 0!==a?a:"")&&(b.description=null!==(g=h.description)&&void 0!==g?g:""),h.instructions!==(null!==(n=null==x?void 0:x.instructions)&&void 0!==n?n:"")&&(b.context=null!==(f=h.instructions)&&void 0!==f?f:"");let j=new Set(null!==(l=null==x||null===(d=x.files)||void 0===d?void 0:d.map(e=>e.file_id))&&void 0!==l?l:[]),y=new Set(null!==(c=null===(u=h.files)||void 0===u?void 0:u.map(e=>e.file_id))&&void 0!==c?c:[]),w=(null!==(p=h.files)&&void 0!==p?p:[]).filter(e=>!j.has(e.file_id)),k=(null!==(m=null==x?void 0:x.files)&&void 0!==m?m:[]).filter(e=>!y.has(e.file_id));if(e0()(b)&&0===w.length&&0===k.length)return;let z=[];if(!e0()(b)){let e="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(b,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');z.push(eY.Cv.getTextAsMessage(e,o.uU.System))}k.length>0&&z.push(eY.Cv.getTextAsMessage("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(k.map(e=>e.file_id).join(", ")),o.uU.System)),w.length>0&&z.push(eY.Cv.getTextAsMessage("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(w.map(e=>e.file_id).join(", ")),o.uU.System,{attachments:w.map(e=>({id:e.file_id,name:e.name,size:e.size}))})),z.length>0&&v.tQ.updateTree(e,e=>{let s=e.getNodeByIdOrMessageId(t).parentId;for(let r of z){let i=(0,eF.Z)();e.insertNodeBefore(t,{id:i,children:[],parentId:s,message:r,metadata:{isClientCreatedSystemMessage:!0}}),s=i}})}function e6(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function e7(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?e6(Object(s),!0).forEach(function(t){(0,a.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):e6(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let te=G.memo(function(e){let{gizmoEditorData:t,updateGizmo:s,clientThreadId:r,completionCallbackResponse:i,gizmoEditorDataRef:a,magicMakerBehaviorOverrides:n,magicMakerConversationGizmoEditorDataRef:l,requireGizmoId:d}=e,c=(0,G.useMemo)(()=>({gizmoEditorData:t,gizmoId:t.id,mode:"magic",behaviorOverrides:n,getGizmoId:d}),[d,t,n]),u=(0,eR.gF)(e=>e.files.filter(e=>e.status===eD.XX.Ready&&null!=e.gizmoId)),p=(0,G.useCallback)((e,t)=>{!function(e,t,s){if(0===s.length)return;let r=(0,eF.Z)(),i="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(s.map(e=>'"'.concat(e.fileId,'"')).join(", "));v.tQ.updateTree(e,e=>{let s=e.getNodeByIdOrMessageId(t).parentId;e.insertNodeBefore(t,{id:r,children:[],parentId:s,message:eY.Cv.getTextAsMessage(i,o.uU.System),metadata:{isClientCreatedSystemMessage:!0}})})}(e,t,u),e8(e,t,a,l),function(e,t){let s="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.",r=v.tQ.getThreadCurrentLeafId(e),i=v.tQ.getTree(e),a=i.getNodeByIdOrMessageId(r);for(;null!=a&&a.message.author.role!==o.uU.User;){if("text"===a.message.content.content_type&&a.message.content.parts[0]===s)return;a=""!==a.parentId?i.getNodeByIdOrMessageId(a.parentId):void 0}v.tQ.updateTree(e,e=>{let r=e.getNodeByIdOrMessageId(t).parentId;e.insertNodeBefore(t,{id:(0,eF.Z)(),children:[],parentId:r,message:eY.Cv.getTextAsMessage(s,o.uU.System,{exclude_after_next_user_message:!0}),metadata:{isClientCreatedSystemMessage:!0}})})}(e,t),s(e=>{var t;return e7(e7({},e),{},{files:[...null!==(t=e.files)&&void 0!==t?t:[],...eC()(u.map(e=>{var t;return null!=e.fileId&&{file_id:e.fileId,name:e.file.name,size:e.file.size,type:e.file.type,last_modified:e.file.lastModified,file_size_tokens:null===(t=e.fileSpec)||void 0===t?void 0:t.fileTokenSize}}))]})}),l.current=T()(a.current)},[a,l,u,s]),m=(0,Q.tN)(e=>e.activeSidebar);return(0,eu.jsx)(eB.D.Provider,{value:c,children:(0,eu.jsxs)("div",{className:"relative flex h-full grow overflow-auto",children:[(0,eu.jsx)("div",{className:"grow",children:(0,eu.jsx)(eL.Z,{clientThreadId:r,onCompletionFinished:i,preRequestCompletion:p,hideHeader:!0,prependThreadChildren:(0,eu.jsx)("div",{className:"h-8"})})}),"debug"===m&&(0,eu.jsx)(eG.DebugConversationSidebar,{clientThreadId:r,slideOver:!1,onClose:()=>Q.vm.toggleActiveSidebar("debug"),isOpen:!0})]})})});var tt=s(45334);function ts(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function tr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(s),!0).forEach(function(t){(0,a.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ts(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let ti=D()(()=>Promise.all([s.e(1703),s.e(7147)]).then(s.bind(s,37147)).then(e=>e.GizmoActionsEditor),{loadableGenerated:{webpack:()=>[37147]}});var ta=((r=ta||{}).MAGIC_MAKER="magic",r.ADVANCED="advanced",r.PREVIEW="preview",r);function tn(e){let{value:t,label:s}=e;return(0,eu.jsx)(z.ck,{value:t,className:"text-md w-1/3 flex-grow rounded-lg border-token-border-light p-1.5 font-semibold text-token-text-tertiary transition hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] md:w-1/2",children:s})}function to(e){let{className:t,editorTab:s,setEditorTab:r}=e,i=(0,U.Z)();return(0,eu.jsxs)(z.fC,{className:(0,C.default)("flex w-full overflow-hidden rounded-xl bg-token-main-surface-secondary p-1.5 md:w-1/2",t),value:s,onValueChange:e=>{r(e)},children:[(0,eu.jsx)(tn,{value:ta.MAGIC_MAKER,label:i.formatMessage(tf.magicMakerLabel)}),(0,eu.jsx)(tn,{value:ta.ADVANCED,label:i.formatMessage(tf.configureLabel)}),(0,eu.jsx)("div",{className:"flex w-1/3 md:hidden",children:(0,eu.jsx)(tn,{value:ta.PREVIEW,label:i.formatMessage(tf.previewLabel)})})]})}let tl={id:void 0,instructions:"",name:"",description:"",profilePictureId:void 0,profilePictureUrl:void 0,promptStarters:[],sharing:{recipient:m.Zz.Private,subjects:[]},tools:[{type:n.qK.DALLE}],files:[],trainingDisabled:!1,liveVersion:0},td=tr(tr({},tl),{},{tools:[...tl.tools,{type:n.qK.BROWSER}]});function tc(e){var t,s,r,i,a,n;return{id:e.gizmo.id,instructions:e.gizmo.instructions,name:e.gizmo.display.name,description:null!==(t=e.gizmo.display.description)&&void 0!==t?t:"",profilePictureId:null!==(s=e.gizmo.display.profile_pic_id)&&void 0!==s?s:void 0,profilePictureUrl:null!==(r=e.gizmo.display.profile_picture_url)&&void 0!==r?r:void 0,promptStarters:null!==(i=e.gizmo.display.prompt_starters)&&void 0!==i?i:[],tools:T()(e.tools),files:T()(e.files),sharing:e.gizmo.sharing?T()(e.gizmo.sharing):{subjects:[],recipient:e.gizmo.share_recipient},trainingDisabled:null!==(a=e.gizmo.training_disabled)&&void 0!==a&&a,sharingRecipient:e.gizmo.share_recipient,sharingTargets:T()(e.gizmo.sharing_targets),liveVersion:null!==(n=e.gizmo.live_version)&&void 0!==n?n:0}}let tu=e=>{var t;let{gizmo:s,onNewGizmoId:r}=e,i=(0,N.NL)(),a=(0,d.C)(x.L0.BrowsingAvailable),l=(0,U.Z)(),h=(0,G.useRef)(null!=s?tc(s):a?td:tl),b=(0,G.useRef)(s),y=(0,G.useRef)(h.current),{0:w,1:z}=(0,G.useState)(()=>h.current),{0:S,1:_}=(0,G.useState)(()=>(0,v.OX)()),{0:E}=(0,G.useState)(()=>({context_message:function(e){var t,s,r;let i=new Set;for(let t of e.tools)i.add(t.type);let a=null!==(t=e.name)&&void 0!==t?t:"",n=null!==(s=e.description)&&void 0!==s?s:"",o=null!==(r=e.instructions)&&void 0!==r?r:"",l=Array.from(i).join(","),d=""===a&&""===n&&""===o,c=null!=e.profilePictureUrl;return d?"The GPT you are about to has the following abilities: ".concat(l,"."):"This is the GPT's current set of fields:\n\nname: ".concat(a,"\n\ndescription: ").concat(n,"\n\ncontext: ").concat(o,"\n\nabilities: ").concat(l,"\n\n").concat(c?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}(h.current),model_slug:"unused",enabled_tools:[{tool_id:null!=s?"gizmo_editor":"gizmo_creator"}]}));!function(e,t,s){(0,eU.a)(e,{kind:o.OL.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:s}),(0,G.useEffect)(()=>{v.tQ.updateConversationMode(e,{kind:o.OL.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:s})},[e,t.id,s]);let{0:r}=(0,G.useState)(()=>{let e=null==t.id,s=null!=t.id&&""!==t.name&&null!=t.description&&""!==t.instructions&&null!=t.profilePictureUrl;return e?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':s?"Welcome back! Is there anything ".concat(t.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."});(0,G.useEffect)(()=>{let t=v.tQ.getTree(e);if(t.findNode(e=>{var t;return e.message.author.role===o.uU.User||(null===(t=e.metadata)||void 0===t?void 0:t.isClientCreatedSystemMessage)===!0})||(v.tQ.deleteNodesByFilter(e,e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.isPlaceholderTemplateAssistantWelcomeMessage)===!0}),null==r||0===r.length))return;let s=v.tQ.getThreadCurrentLeafId(e);if(!t.hasNodeOrMessageId(s))return;let i=(0,eF.Z)();v.tQ.updateTree(e,e=>{e.addNode(i,r,s,o.uU.Assistant,{isPlaceholderTemplateAssistantWelcomeMessage:!0})}),v.tQ.setThreadCurrentLeafId(e,i)},[e,r])}(S,y.current,E);let{data:L}=(0,f.Y7)(),D=null!==(t=null==L?void 0:L.modelsList.find(e=>e.tags.includes(o.S.GPT_4)))&&void 0!==t?t:null==L?void 0:L.modelsList.find(e=>e.id===f.mx),{data:R}=(0,p.b9)(h.current.id),F=(0,p.N_)(),{isPending:B,error:K}=F,V=(0,p.ZJ)(),W=(0,G.useMemo)(()=>{var e,t,s,r,i,a;return null!=R&&(!(w.name===R.gizmo.display.name&&w.description===R.gizmo.display.description&&w.instructions===R.gizmo.instructions&&(i=w.tools,a=R.tools,i.length===a.length&&i.every(e=>a.some(t=>t.type===e.type)))&&A()(null!==(e=null===(t=w.files)||void 0===t?void 0:t.map(e=>e.file_id))&&void 0!==e?e:[],null!==(s=null===(r=R.files)||void 0===r?void 0:r.map(e=>e.file_id))&&void 0!==s?s:[]))||w.profilePictureUrl!=R.gizmo.display.profile_picture_url||w.profilePictureId!=R.gizmo.display.profile_pic_id)},[w,R]),Q=async()=>{let e=h.current;try{let t=await F.mutateAsync({editorData:e,gizmoId:e.id});if(b.current=t,null==h.current.id){let e=t.gizmo.id;h.current=tr(tr({},h.current),{},{id:e,sharingTargets:t.gizmo.sharing_targets}),z(h.current),null==r||r(e)}for(let e of t.tools.filter(e=>e.type===n.qK.JIT_PLUGIN)){let t=h.current.tools.find(t=>t.type===n.qK.JIT_PLUGIN&&t.metadata.domain===e.metadata.domain);t&&t.metadata.action_id!==e.metadata.action_id&&(t.metadata=tr(tr({},t.metadata),{},{action_id:e.metadata.action_id}),z(h.current))}return t}catch(s){var t;let e=null!==(t=(0,j.Ot)(s))&&void 0!==t?t:l.formatMessage(eE.errorSavingDraft);throw g.m.warning(e,{duration:2}),s}},Y=(0,G.useRef)(),q=async()=>null!=h.current.id?h.current.id:(null==Y.current&&(Y.current=Q().then(e=>e.gizmo.id).catch(e=>{throw Y.current=void 0,e})),Y.current),{0:J}=(0,G.useState)(()=>I()(()=>Q(),2e3,{trailing:!0}));function H(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],s="function"==typeof e?e(h.current):(0,et.x$)(h.current,e);!A()(s,h.current)&&(h.current=s,z(h.current),t&&J())}let $=(0,G.useRef)(),X=async e=>{if(null==e){em(!1);return}try{let t=await e9(h.current,e,$.current);null!=t&&(H(t),y.current=T()(h.current))}catch(e){M.U.addError(e),g.m.warning("Something went wrong generating your GPT",{duration:3})}finally{$.current=v.tQ.getThreadCurrentLeafId(e),em(!1)}},ee=function(e,t,s){var r;v.tQ.initThread(e,{kind:o.OL.GizmoMagicCreate,gizmo_id:void 0,behavior_overrides:s});let i=(0,f.j8)().id,a=null!==(r=(0,f.Bv)(e))&&void 0!==r?r:i,n=(0,eV.Z)(e,void 0,t);return async(t,r,i)=>{if(0===i.length)return;let l=v.tQ.getThreadCurrentLeafId(e);for(let t of i){let s=(0,eF.Z)();v.tQ.updateTree(e,e=>{e.addNodeToEnd(l,{id:s,children:[],parentId:l,message:eY.Cv.getTextAsMessage(t,o.uU.System),metadata:{isClientCreatedSystemMessage:!0}})}),v.tQ.setThreadCurrentLeafId(e,s),l=s}let d=l;e8(e,d,t,r);let c={conversationMode:{kind:o.OL.GizmoMagicCreate,gizmo_id:t.current.id,behavior_overrides:s}},u=await (0,eH.rS)(),[p,m,g]=await Promise.all([eq.ZP.getEnforcementToken(u),e$.Z.getEnforcementToken(u),eJ.Z.getEnforcementToken(u)]);n({model:a,completionType:o.Os.Next,parentNodeId:d,metadata:{},focusOnNewCompletion:!0,chatReq:u,arkoseToken:p,turnstileToken:m,proofToken:g,preflightTime:0,completionMetadata:c})}}(S,X,E),{0:es,1:er}=(0,G.useState)(void 0);(0,G.useEffect)(()=>{er((0,c.z$)(s))},[null==s?void 0:s.gizmo.id]);let ei=async(e,t)=>{let s=(0,et.bw)(h.current,e.recipient,t);if(s.length>0){g.m.warning("Could not save GPT:\n\n".concat(s.map(e=>"- ".concat((0,et.sw)(e))).join("\n")),{duration:3});return}let r=await Q(),a=r.gizmo.id;try{return O.A.logEvent(P.M.promoteGizmo,{gizmo_id:r.gizmo.id,sharing_recipient:e.recipient,editor_tab:en}),await V.mutateAsync({gizmoId:r.gizmo.id,data:{sharingSubjects:e.subjects,sharingRecipient:e.recipient,categories:null==t?void 0:[t]}},{onSuccess(e){i.setQueryData((0,p.Vw)(i,a).queryKey,e),i.invalidateQueries({queryKey:["gizmos"]}),i.invalidateQueries({queryKey:["gizmo",{gizmoId:a}]}),i.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}catch(t){t instanceof m.DC?er({gizmoId:a,sharingRecipient:e.recipient,moderationType:c.Te.PublishBlocked,sharingTargets:t.response.sharing_targets,showModal:c.UJ.AppealAvailable}):(M.U.addError(t),g.m.warning("Error saving GPT",{duration:2}))}},ea=F.isPending||V.isPending,{0:en,1:eo}=(0,G.useState)(()=>{let e=Z.m.getItem(Z.F.GizmoEditorTab);return Object.values(ta).includes(e)?e:ta.MAGIC_MAKER}),el=k.fY.useState(e=>{let{windowWidth:t}=e;return t});(0,G.useEffect)(()=>{null!=el&&el>=768&&en===ta.PREVIEW&&eo(ta.MAGIC_MAKER)},[el,en]);let{0:ed,1:ec}=(0,G.useState)(!1),{0:ep,1:em}=(0,G.useState)(!1),{0:eg,1:ef}=(0,G.useState)(void 0),{0:eh,1:ex}=(0,G.useState)(!1);return(0,eu.jsxs)("div",{className:"flex h-screen w-full flex-col items-center",children:[(0,eu.jsx)(eP,{gizmoEditorData:w,isLoading:ea,hasUnpublishedChanges:W,isUploadingProfilePic:ed,isGeneratingProfilePic:ep,publishedGizmo:R,updateGizmo:H,promoteGizmo:async(e,t)=>{let s=await ei(e,t);return h.current=tr(tr({},h.current),{},{sharingRecipient:e.recipient}),z(h.current),Z.m.setItem(Z.F.GizmoEditorTab,en),s},appealGizmo:async(e,t)=>{null!=es&&er(tr(tr({},es),{},{sharingRecipient:e,categories:null==t?void 0:[t],showModal:c.UJ.AppealAvailable}))},setAppealState:er,revertDraft:null!=R&&W?()=>{let e=i.getQueryData((0,p.Vw)(i,h.current.id).queryKey);if(null!=e){let t=tc(e);h.current=t,z(t),Q()}}:void 0,draftMessage:(0,eu.jsx)(eI,{isPublished:null!=R&&("marketplace"===R.gizmo.share_recipient||"workspace"===R.gizmo.share_recipient),hasUnpublishedChanges:W,isSavingDraft:B,upsertDraftError:K,className:"text-sm"}),showActionsModal:e=>{ef(e)},className:"flex-shrink-0"}),es&&(0,eu.jsx)(c.MU,{appealState:es,onAppealClose:()=>er(tr(tr({},es),{},{showModal:c.UJ.None})),onAppealSubmitted:()=>er(tr(tr({},es),{},{showModal:c.UJ.AppealSent}))}),(0,eu.jsxs)("div",{className:"relative flex w-full grow overflow-hidden",children:[(0,eu.jsx)("div",{className:"flex w-full justify-center md:w-1/2",children:(0,eu.jsx)("div",{className:"h-full grow overflow-hidden",children:void 0!==eg?(0,eu.jsx)(ti,{currentlyEditingActionDomain:eg,gizmoEditorData:w,updateGizmo:H,onClose:()=>{ef(void 0)}}):eh?(0,eu.jsx)(u.a,{gizmoEditorData:w,updateGizmo:H,onClose:()=>{ex(!1)}}):(0,eu.jsxs)("div",{className:"flex h-full flex-col px-2 pt-2",children:[(0,eu.jsx)("div",{className:"flex w-full flex-row justify-center",children:(0,eu.jsx)(to,{editorTab:en,setEditorTab:eo,className:"mb-2 flex-shrink-0 self-center"})}),(0,eu.jsx)("div",{className:"grow overflow-hidden",children:en===ta.MAGIC_MAKER?(0,eu.jsx)("div",{className:"h-full w-full pb-5",children:(0,eu.jsx)(te,{gizmoEditorData:w,updateGizmo:H,completionCallbackResponse:X,clientThreadId:S,gizmoEditorDataRef:h,magicMakerBehaviorOverrides:E,magicMakerConversationGizmoEditorDataRef:y,requireGizmoId:q},S)}):en===ta.ADVANCED?(0,eu.jsx)(eS.cK,{gizmoEditorData:w,updateGizmo:H,currentModelConfig:D,generateProfilePic:()=>{em(!0),ee(h,y,["Generate a new profile picture for this GPT using gizmo_editor generate_profile_pic. Do not prompt the user for any clarification. Do not send extra text outside of the tool function call. DO NOT CALL update_behavior or otherwise update GPT behavior in your response."])},setIsUploadingProfilePic:ec,isGeneratingProfilePic:ep,setIsGeneratingProfilePic:em,requireGizmoId:q,onShowActionsEditor:e=>{ef(e)},onShowBlocksEditor:()=>{ex(!0)}}):(0,eu.jsx)(eA.P,{gizmoEditorData:w,currentModelConfig:D,isSavingDraft:B,showTitle:!1})})]})})}),(0,eu.jsx)("div",{className:(0,C.default)("hidden w-1/2 justify-center border-l border-token-border-medium bg-token-main-surface-secondary pt-4",en!==ta.PREVIEW&&"md:flex"),children:(0,eu.jsx)("div",{className:"flex-grow pb-5",children:(0,eu.jsx)("div",{className:"h-full",children:(0,eu.jsx)(eA.P,{gizmoEditorData:w,currentModelConfig:D,isSavingDraft:B})})})})]})]})};function tp(e){let{gizmoId:t,version:s}=e,{data:r}=(0,p.DC)({gizmoId:t,draft:!0,version:s}),i=(0,b.ec)(b.F_.accountUserId),a=(0,b.aF)(),n=null==a?void 0:a.id,o=null!=r&&null!=i&&null!=n&&(0,tt.k1)(r);return null!=r&&o?(0,eu.jsx)(tu,{gizmo:r}):null}function tm(e){let{onNewGizmoId:t}=e;return(0,eu.jsx)(tu,{gizmo:void 0,onNewGizmoId:t})}function tg(e){let{gizmoId:t,remixSourceId:s,version:r}=e,i=(0,R.useRouter)(),a=(0,h.t)(),n=(0,G.useRef)(void 0),o=t;return null!=t&&n.current===t&&(o=void 0),(0,y.yx)({resetThreadAction:()=>{i.push("/")}}),(0,eu.jsx)("div",{children:null!=a&&a.data?(0,eu.jsx)("div",{children:void 0!=o?(0,eu.jsx)(tp,{gizmoId:o,version:r},o):(0,eu.jsx)(tm,{remixSourceId:s,onNewGizmoId:e=>{n.current=e,window.history.replaceState(window.history.state,"",(0,w.AA)(e))}})}):(0,eu.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,eu.jsx)(l.Z,{})})})}let tf=(0,F.vU)({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}})},90945:function(e,t,s){s.d(t,{P:function(){return D},gP:function(){return L},f7:function(){return A}});var r,i=s(16757),a=s(92745),n=s(58015),o=s(91530),l=s.n(o),d=s(9364),c=s(67437),u=s(651);function p(e){let{clientThreadId:t}=e,s=(0,a.oq)(t),r=(0,c.Bv)(t),i=(0,a.U0)(t,s),o=[...Array(i).keys()].map(e=>(0,u.jsx)(d.Z,{isFinalTurn:e===i-1,turnIndex:e,clientThreadId:t,conversationLeafId:s,onChangeItemInView:l(),onChangeRating:l(),onRequestMoreCompletions:l(),onRequestCompletion:n.C,currentModelId:null!=r?r:""},e));return(0,u.jsx)(u.Fragment,{children:o})}function m(e){let{clientThreadIds:t}=e;return(0,u.jsx)(u.Fragment,{children:t.map(e=>(0,u.jsx)(p,{clientThreadId:e},e))})}var g=s(60825),f=s(44039),h=s(45334),x=s(65418),v=s(34455),b=s(31438),j=s(43703),y=s(49763),w=s(79857),k=s(38924),z=s(97834),N=s(52978),O=s(19841),P=s(88600),M=s(92379),Z=s(62984),C=s(92054),S=s(13490),T=s(74301),_=s(2319),I=s(10083);function E(){return(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)("div",{className:"border-token-border-secondary flex-grow border-b"}),(0,u.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-2 px-2 py-6 text-sm text-token-text-tertiary",children:[(0,u.jsx)(S.vHI,{className:"icon-sm"}),(0,u.jsx)(Z.Z,{id:"qtaMEG",defaultMessage:"GPT updated"})]}),(0,u.jsx)("div",{className:"border-token-border-secondary flex-grow border-b"})]})}let A=((r={}).TestGizmoAction="test_gizmo_action",r),L=new y.V,D=M.memo(function(e){var t;let{gizmoEditorData:s,isSavingDraft:r,currentModelConfig:n,showTitle:o=!0}=e,{0:d,1:c}=(0,M.useState)(()=>(0,a.OX)()),{0:p,1:y}=(0,M.useState)([]);(0,M.useEffect)(()=>{y(e=>e[e.length-1]===d?e:[...e,d])},[d]);let A=p.slice(0,-1);(0,v.a)(d,{kind:i.OL.GizmoTest,gizmo_id:s.id}),(0,M.useEffect)(()=>{a.tQ.updateConversationMode(d,{kind:i.OL.GizmoTest,gizmo_id:s.id})},[d,s.id]);let D=null===(t=s.files)||void 0===t?void 0:t.map(e=>e.file_id).join();(0,M.useEffect)(()=>{null!=a.tQ.getServerThreadId(d)&&c((0,a.OX)())},[s.id,s.instructions,s.tools,D,d]);let R=(0,b.tN)(e=>e.activeSidebar),G=(0,M.useMemo)(()=>({gizmoEditorData:s,mode:"test"}),[s]),{0:U,1:F}=(0,M.useState)(0),B=()=>{F(e=>e-360)},K=s.id,V=function(e,t){let s=(0,T.Z)(e,void 0,l());return(0,M.useCallback)(async(r,n,o)=>{if(!t)return;let l=a.tQ.getThreadCurrentLeafId(e),d=(0,C.Z)(),c=(0,h.VN)(n);a.tQ.updateTree(e,e=>{e.addNodeToEnd(l,{id:d,children:[],parentId:l,message:{id:d,author:{role:i.uU.User},content:{content_type:i.PX.Text,parts:["Call the ".concat(n," API with the ").concat(o," operation")]},recipient:"all",metadata:{jit_plugin_data:{from_client:{type:"test",operation:o,tool_name:c}}}}})});let u={conversationMode:{kind:i.OL.GizmoTest,gizmo_id:r}},p=await (0,z.rS)(),[m,g,f]=await Promise.all([w.ZP.getEnforcementToken(p),N.Z.getEnforcementToken(p),k.Z.getEnforcementToken(p)]);s({model:t.id,completionType:i.Os.Next,parentNodeId:d,metadata:{},focusOnNewCompletion:!0,chatReq:p,arkoseToken:m,turnstileToken:g,proofToken:f,preflightTime:0,completionMetadata:u})},[e,s,t])}(d,n);return(0,M.useEffect)(()=>(0,j.LW)(L,{test_gizmo_action:e=>{let{rootDomain:t,operationName:s}=e;K&&V(K,t,s)}}),[V,K]),(0,u.jsx)(_.D.Provider,{value:G,children:(0,u.jsxs)("div",{className:(0,O.default)("flex h-full w-full",r&&"cursor-wait opacity-80 transition"),children:[(0,u.jsxs)("div",{className:"flex grow flex-col",children:[(0,u.jsx)("div",{className:"relative mb-2 flex-shrink-0",children:(0,u.jsx)("div",{className:"flex justify-center py-1",children:o&&(0,u.jsxs)("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[(0,u.jsx)("div",{className:"icon-md"}),(0,u.jsxs)("button",{onClick:()=>{B(),y([]),c((0,a.OX)())},className:"flex items-center gap-2",children:[(0,u.jsx)(Z.Z,{id:"2u/6Ja",defaultMessage:"Preview"}),(0,u.jsx)(P.E.div,{className:"text-token-text-primary",animate:{rotate:U},transition:{duration:.3},children:(0,u.jsx)(S.eF8,{className:"icon-md invisible group-hover:visible"})})]})]})})}),(0,u.jsx)("div",{className:(0,O.default)("relative grow overflow-auto px-2",r&&"pointer-events-none"),children:(0,u.jsx)(g.Z,{clientThreadId:d,hideHeader:!0,renderEmptyState:(0,u.jsxs)("div",{className:"relative h-full w-full",children:[null!=A&&A.length>0&&(0,u.jsx)("div",{className:"h-full w-full opacity-20",children:(0,u.jsxs)(f.I,{children:[(0,u.jsx)(m,{clientThreadIds:A}),(0,u.jsx)(E,{})]})}),(0,u.jsx)("div",{className:"absolute left-0 top-0 h-full w-full",children:(0,u.jsx)(I.r,{gizmo:s,hideOwner:!0,showStarterPrompts:!0})})]}),prependThreadChildren:A.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"opacity-50",children:(0,u.jsx)(m,{clientThreadIds:A})}),(0,u.jsx)(E,{})]})})})]}),"debug"===R&&(0,u.jsx)(x.DebugConversationSidebar,{clientThreadId:d,slideOver:!1,onClose:()=>b.vm.toggleActiveSidebar("debug"),isOpen:!0})]})})})},41177:function(e,t,s){s.d(t,{C6:function(){return es},O2:function(){return ei},P6:function(){return et},hD:function(){return J},uj:function(){return er},xH:function(){return q}});var r,i=s(2346),a=s(98601),n=s(99333),o=s(2721),l=s(93951),d=s(31498),c=s(75172),u=s(62984),p=s(68306),m=s(11550),g=s(98095),f=s(24434),h=s(89039),x=s(42420),v=s(84760),b=s(19841),j=s(65925),y=s.n(j),w=s(92379),k=s(15478),z=s(59725),N=s(18898),O=s(13490),P=s(27160),M=s(57849),Z=s(98682),C=s(73062),S=s(30853),T=s(6440),_=s(15122),I=s(24740),E=s(21025),A=s(51307),L=s(83036),D=s(12128),R=s(39004),G=s(76665),U=s(99555),F=s(10080),B=s(81107),K=s(651);function V(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function W(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?V(Object(s),!0).forEach(function(t){(0,a.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):V(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let Q=[F.EL,F.fV],Y={[F.LA.USER]:F.Zz.User,[F.LA.GROUP]:F.Zz.Group,[F.LA.WORKSPACE]:F.Zz.Workspace,[F.LA.ALL]:F.Zz.Marketplace};function q(e){let t=Y[e.type];if(!t)throw Error("Unknown sharing subject type: "+e.type);return W(W({},e),{},{type:t})}function J(e){var t,s,r,i,a,p,h,v,j,k;let{gizmo:N,publishedGizmo:P,updateGizmo:M,promoteGizmo:Z,appealGizmo:T,setAppealState:_,showActionsModal:L,shareOnly:D,onClose:V,workspaceOwner:Y=!1}=e,J=(0,c.Z)(),H=(0,l.t)(),$=null!==(t=null==H||null===(s=H.data)||void 0===s?void 0:s.name)&&void 0!==t?t:"your workspace",et=(0,d.aF)(),ea=(0,R.Z1)(),{0:eo,1:el}=(0,w.useState)(void 0);(0,w.useEffect)(()=>{if(void 0==eo){if(null!=P&&P.gizmo.display.categories&&(null==P?void 0:P.gizmo.display.categories.length)>0){var e;let t=null===(e=ea.data)||void 0===e?void 0:e.categories.find(e=>e.id===(null==P?void 0:P.gizmo.display.categories[0]));t&&el(t)}else void 0!=ea.data&&el(ea.data.categories[ea.data.categories.length-1])}},[ea.data,eo,P]);let{0:ed,1:ec}=(0,w.useState)(null!==(r=N.sharingRecipient)&&void 0!==r?r:F.Zz.Private),{0:eu,1:ep}=(0,w.useState)(null!==(i=null===(a=N.sharing)||void 0===a?void 0:a.subjects)&&void 0!==i?i:[]),{0:em,1:eg}=(0,w.useState)(null),{0:ef,1:eh}=(0,w.useState)(!1),ex=(0,w.useCallback)(()=>{var e;return!y()(null===(e=N.sharing)||void 0===e?void 0:e.subjects,eu)||N.sharingRecipient!==ed},[N.sharing,N.sharingRecipient,ed,eu]),ev=(0,x.NL)(),eb=(0,G.bw)(N,ed,null!==(p=null==eo?void 0:eo.id)&&void 0!==p?p:void 0),ej=eb.includes(G.hs.MissingPublicActionPrivacyPolicyURL),ey=N.tools.find(e=>e.type===n.qK.JIT_PLUGIN&&!e.metadata.privacy_policy_url);if(em)return(0,K.jsx)(er,{publishedGizmo:em,sharing:{recipient:ed,subjects:eu},workspaceName:$,onClose:V});let ew=(0,F.H$)(eu);function ek(e){let t=eu.filter(e=>-1===[F.LA.WORKSPACE,F.LA.ALL].indexOf(e.type));null!=e&&t.push(e),ep(t)}function ez(e){null!=ew&&ep(eu.map(t=>t===ew?W(W({},t),{},{capabilities:e}):t))}function eN(e,t,s){return e.type===F.LA.USER&&-1===e.user_id.indexOf("__")?W(W({},e),{},{user_id:e.user_id+"__"+(null==H?void 0:H.getWorkspaceId())}):e}async function eO(e,t){var s,r;if(ef)return;if(e&&!t)throw Error("Cannot share a gizmo that hasn't been promoted before");if(!eo)return;eh(!0);let i=eu.map(eN).map(q);if(i=(0,F.Mj)(ed,i,null!==(s=null==ew?void 0:ew.capabilities)&&void 0!==s?s:F.EL),Y)return H&&t?(await o.Z.updateWorkspaceGPTSharing(H.id,t,i),I.m.success(J.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),ev.invalidateQueries({queryKey:["workspace"]})):I.m.warning("Unable to change sharing settings"),V();if(e){if(!t||!P)throw Error("No gizmo ID to share");try{let e={sharing:i};eo&&(e.categories=[eo.id]);let s=await U.U.shareGizmo(t,e);s.error?(0,E.nJ)(ed,s.sharing_targets)?(_({gizmoId:P.gizmo.id,sharingRecipient:ed,categories:P.gizmo.display.categories,moderationType:A.Te.PublishBlocked,sharingTargets:s.sharing_targets,showModal:A.UJ.AppealAvailable}),V()):I.m.warning(J.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})):(ev.setQueryData(["gizmo",{gizmoId:P.gizmo.id},{draft:!1}],e=>s.resource),M(e=>W(W({},e),{},{sharingRecipient:ed})),I.m.success(J.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),V())}catch(e){return I.m.warning(J.formatMessage({id:"dKC65l",defaultMessage:"Failed to update sharing settings"})),V()}}else{let e=await Z({subjects:i,recipient:ed},eo.id);t||(t=null==e?void 0:e.gizmo.id),eg(null!=e?e:null),M({liveVersion:null!==(r=null==e?void 0:e.gizmo.live_version)&&void 0!==r?r:void 0}),ev.invalidateQueries({queryKey:["gizmo",{gizmoId:t}]})}eh(!1),ev.invalidateQueries({queryKey:["gizmos"]}),ev.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:t}]}),ev.invalidateQueries({queryKey:["workspace"]}),M({sharing:{recipient:ed,subjects:eu},sharingRecipient:ed},!1)}return(0,K.jsx)(f.Z,{type:"success",className:"max-w-[555px]",size:"custom",isOpen:!0,onClose:V,primaryButton:(0,E.nJ)(ed,N.sharingTargets)?(0,K.jsx)(m.z,{onClick:()=>T(ed,null==eo?void 0:eo.id),children:(0,K.jsx)(u.Z,{id:"HRzqKK",defaultMessage:"Appeal"})}):(0,K.jsx)(m.z,{onClick:()=>eO(D,null==P?void 0:P.gizmo.id),loading:ef,disabled:eb.length>0||!(0,E.YK)(ed,N.sharingTargets),children:D?(0,K.jsx)(u.Z,{id:"BEKjVh",defaultMessage:"Save"}):(0,K.jsx)(u.Z,{id:"24j5ts",defaultMessage:"Update"})}),secondaryButton:(0,K.jsxs)(K.Fragment,{children:[ex()&&(0,K.jsx)("div",{className:"absolute bottom-8 left-6 text-sm text-token-text-secondary",children:(0,K.jsx)(u.Z,{id:"9CkgC4",defaultMessage:"Unsaved changes"})}),P&&(0,K.jsx)(m.z,{color:"secondary",onClick:()=>(0,B.A4)(P,J.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:(0,K.jsx)(u.Z,{id:"wvL15a",defaultMessage:"Copy link"})})]}),title:J.formatMessage({id:"7JggXH",defaultMessage:"Share GPT"}),showCloseButton:!0,children:(0,K.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,K.jsx)(en,{onAdd:e=>{eu.find(t=>t.type===F.LA.USER?t.user_id===e.user_id:t.type===F.LA.GROUP?t.group_id===e.group_id:t.type===e.type)||ep([...eu,e])},publishedGizmo:P}),(0,K.jsx)("h3",{className:"text-base font-semibold",children:(0,K.jsx)(u.Z,{id:"bNQXcV",defaultMessage:"Share with..."})}),(0,K.jsxs)("div",{className:"max-h-[200px] space-y-2 overflow-y-auto",children:[(0,K.jsxs)("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[(0,K.jsx)("div",{className:"shrink-0 grow-0 self-start",children:(0,K.jsx)(z.Yt,{user:et,size:"gizmoConversation",roundedStyle:"rounded-full"})}),(0,K.jsx)("div",{className:"grow",children:P&&(j=null==P?void 0:P.gizmo.author.user_id.split("__")[0],k=null==et?void 0:et.id,void 0===j||void 0===k||j.split("__")[0]!==k.split("__")[0])?(0,K.jsx)("span",{className:"text-base font-semibold",children:(0,K.jsx)(u.Z,{id:"scRZqV",defaultMessage:"{userName} (builder)",values:{userName:null==P?void 0:P.gizmo.author.display_name}})}):(0,K.jsxs)("div",{className:"flex flex-col",children:[(0,K.jsx)("span",{className:"text-base font-semibold",children:(0,K.jsx)(u.Z,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:null==et?void 0:et.name}})}),(0,K.jsx)("span",{className:"-mt-1 text-sm text-token-text-secondary",children:null==et?void 0:et.email})]})})]}),eu.map((e,t)=>(0,F.h)(e)&&(0,K.jsxs)("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[(0,K.jsx)(z.m0,{name:e.type===F.LA.GROUP?e.group_name:"".concat(e.user_name," ").concat(e.user_email),initialsCount:e.type===F.LA.USER?2:1,size:"gizmoConversation",className:(0,b.default)("shrink-0 grow-0",e.type===F.LA.USER&&"self-start")}),(0,K.jsxs)("div",{className:"flex grow flex-col",children:[(0,K.jsx)("span",{className:"text-base font-semibold",children:e.type===F.LA.GROUP?e.group_name:e.user_name}),e.type===F.LA.USER&&(0,K.jsx)("span",{className:"-mt-1 text-sm text-token-text-secondary",children:e.user_email})]}),(0,K.jsxs)(g.Z.Root,{children:[(0,K.jsxs)(g.Z.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[(0,K.jsx)(u.Z,W({},X(e.capabilities))),(0,K.jsx)(O.T2M,{className:"icon-md"})]}),(0,K.jsx)(g.Z.Portal,{children:(0,K.jsxs)(g.Z.Content,{className:"max-w-[280px]",children:[Q.map((t,s)=>(0,K.jsx)(ee,{caps:t,selected:y()(t,e.capabilities),onClick:()=>{ep(eu.map(s=>s===e?W(W({},s),{},{capabilities:t}):s))}},s)),(0,K.jsx)(g.Z.Separator,{}),(0,K.jsx)(g.Z.Item,{onClick:()=>ep(eu.filter(t=>t!==e)),color:"danger",icon:O.XHJ,children:(0,K.jsx)(u.Z,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},t))]}),(0,K.jsx)("hr",{className:"border-token-border-medium"}),(0,K.jsx)("h3",{className:"text-base font-semibold",children:(0,K.jsx)(u.Z,{id:"uqD7Y8",defaultMessage:"Access"})}),(0,K.jsxs)("div",{className:"-ms-3.5 flex flex-row items-center justify-between space-x-3",children:[(0,K.jsxs)(C.Z.Root,{value:ed,onValueChange:e=>(function(e){switch(ec(e),e){case F.Zz.Marketplace:case F.Zz.Link:ek({type:F.LA.ALL,capabilities:F.EL});break;case F.Zz.Workspace:case F.Zz.WorkspaceLink:ek({type:F.LA.WORKSPACE,capabilities:F.EL});break;default:ek(null)}})(e),children:[(0,K.jsxs)(C.Z.Trigger,{children:[(0,K.jsx)(C.Z.Value,{}),(0,K.jsx)(C.Z.Icon,{})]}),(0,K.jsx)(C.Z.Portal,{children:(0,K.jsxs)(C.Z.Content,{children:[(0,K.jsxs)(C.Z.Group,{children:[(0,K.jsx)(C.Z.Label,{children:(0,K.jsx)(u.Z,{id:"YIQwaP",defaultMessage:"Private"})}),(0,K.jsx)(C.Z.Item,{value:F.Zz.Private,children:(0,K.jsx)(es,{shareLevel:F.Zz.Private,workspaceName:$})})]}),(0,K.jsx)(C.Z.Separator,{}),(0,K.jsx)(S.E,{label:J.formatMessage({id:"n0m61x",defaultMessage:"Your workspace has disabled sharing with the workspace."}),side:"bottom",disabled:(0,E.YK)("workspace",N.sharingTargets),children:(0,K.jsxs)(C.Z.Group,{children:[(0,K.jsx)(C.Z.Label,{children:$}),(0,K.jsx)(C.Z.Item,{value:F.Zz.WorkspaceLink,disabled:!(0,E.YK)(F.Zz.WorkspaceLink,N.sharingTargets)&&!(0,E.YK)(F.Zz.Workspace,N.sharingTargets),children:(0,K.jsx)(es,{shareLevel:F.Zz.WorkspaceLink,workspaceName:$})}),(0,K.jsx)(C.Z.Item,{value:F.Zz.Workspace,disabled:!(0,E.YK)("workspace",N.sharingTargets),children:(0,K.jsx)(es,{shareLevel:F.Zz.Workspace,workspaceName:$})})]})}),(0,K.jsx)(C.Z.Separator,{}),(0,K.jsx)(S.E,{label:J.formatMessage({id:"IHnort",defaultMessage:"Your workspace has disabled public sharing."}),side:"bottom",disabled:(0,E.YK)("marketplace",N.sharingTargets),children:(0,K.jsxs)(C.Z.Group,{children:[(0,K.jsx)(C.Z.Label,{children:(0,K.jsx)(u.Z,{id:"PjY9bi",defaultMessage:"Public"})}),(0,K.jsx)(C.Z.Item,{value:F.Zz.Link,disabled:!(0,E.YK)("link",N.sharingTargets),children:(0,K.jsx)(es,{shareLevel:F.Zz.Link,workspaceName:$})}),(0,K.jsx)(C.Z.Item,{disabled:!(0,E.YK)("marketplace",N.sharingTargets),value:F.Zz.Marketplace,children:(0,K.jsx)(es,{shareLevel:F.Zz.Marketplace,workspaceName:$})})]})})]})})]}),ed!==F.Zz.Private&&ed!==F.Zz.User&&(0,K.jsxs)(g.Z.Root,{children:[(0,K.jsxs)(g.Z.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[null==ew?(0,K.jsx)(u.Z,W({},X(F.EL))):(0,K.jsx)(u.Z,W({},X(ew.capabilities))),(0,K.jsx)(O.T2M,{className:"icon-md"})]}),(0,K.jsx)(g.Z.Portal,{children:(0,K.jsxs)(g.Z.Content,{className:"max-w-[280px]",children:[(0,K.jsx)(ee,{onClick:()=>ez(F.EL),caps:F.EL,selected:y()(null==ew?void 0:ew.capabilities,F.EL)}),ed!==F.Zz.Marketplace&&ed!==F.Zz.Link&&(0,K.jsx)(ee,{onClick:()=>ez(F.fV),caps:F.fV,selected:y()(null==ew?void 0:ew.capabilities,F.fV)})]})})]})]}),ej&&(0,K.jsx)("div",{className:"text-xs text-red-500",children:(0,K.jsx)(u.Z,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:e=>(0,K.jsx)("button",{onClick:()=>{L(null==ey?void 0:ey.metadata.action_id),V()},className:"underline",children:e})}})}),(ed===F.Zz.Marketplace||ed===F.Zz.Workspace)&&((0,E.YK)(ed,N.sharingTargets)?(0,K.jsx)(ei,{gizmo:N,category:null==eo?void 0:eo.id,categories:null===(h=ea.data)||void 0===h?void 0:h.categories,onCategoryChange:e=>el(e)}):(0,E.nJ)(ed,N.sharingTargets)?(0,K.jsx)("div",{className:"pb-2 text-xs text-red-500",children:(0,K.jsx)(A.JE,{sharingRecipient:ed,moderatedFields:null!==(v=(0,E.ai)(ed,N.sharingTargets))&&void 0!==v?v:[],appealAvailable:!0})}):(0,K.jsx)("div",{className:"pb-2 text-xs text-red-500",children:(0,K.jsx)(u.Z,{id:"BzqqKH",defaultMessage:"Your workspace's settings don't allow this level of access. An owner of the workspace can change this setting in the workspace's GPTs settings."})}))]})})}let H=(0,p.vU)({private:{id:"pSXBWQ",defaultMessage:"Invite-only"},user:{id:"pSXBWQ",defaultMessage:"Invite-only"},group:{id:"pSXBWQ",defaultMessage:"Invite-only"},workspace_link:{id:"Giaxt1",defaultMessage:"Anyone at {workspaceName} with the link"},workspace:{id:"XLHaTU",defaultMessage:"{workspaceName}"},link:{id:"uP1+Ri",defaultMessage:"Anyone with the link"},marketplace:{id:"82Ilac",defaultMessage:"GPT Store"}}),$=(0,p.vU)({workspace:{id:"1kpopF",defaultMessage:"Published to {workspaceName}"},marketplace:{id:"hdTRpJ",defaultMessage:"Published to GPT Store"}});function X(e){return e.can_write?(0,p.Em)({id:"SubCqD",defaultMessage:"Can edit"}):e.can_view_config?(0,p.Em)({id:"ud3lp4",defaultMessage:"Can view configuration"}):e.can_read?(0,p.Em)({id:"/0j34W",defaultMessage:"Can chat"}):(0,p.Em)({id:"x2E8ET",defaultMessage:"Unknown"})}function ee(e){let{caps:t,selected:s,onClick:r}=e,i=O.vdY;return t.can_view_config?i=O.KAl:t.can_read&&(i=O.kBi),(0,K.jsx)(g.Z.Item,{className:"flex h-auto flex-row items-start space-x-3 px-3 py-3",onClick:r,icon:i,children:t.can_write?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{className:"flex grow flex-col",children:(0,K.jsx)("span",{className:"text-base font-semibold leading-tight",children:(0,K.jsx)(u.Z,W({},X(t)))})}),(0,K.jsx)(O.kvR,{className:(0,b.default)("icon-lg shrink-0",!s&&"invisible")})]}):t.can_view_config?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{className:"flex grow flex-col",children:[(0,K.jsx)("span",{className:"align-baseline text-base font-semibold leading-tight",children:(0,K.jsx)(u.Z,W({},X(t)))}),(0,K.jsx)("span",{className:"text-xs text-token-text-secondary",children:(0,K.jsx)(u.Z,{id:"fL1rWw",defaultMessage:"View configuration settings, duplicate, and chat"})})]}),(0,K.jsx)(O.kvR,{className:(0,b.default)("icon-lg shrink-0",!s&&"invisible")})]}):t.can_read?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{className:"flex grow flex-col",children:[(0,K.jsx)("span",{className:"text-base font-semibold leading-tight",children:(0,K.jsx)(u.Z,W({},X(t)))}),(0,K.jsx)("span",{className:"text-xs text-token-text-secondary",children:(0,K.jsx)(u.Z,{id:"tx5q1o",defaultMessage:"Users can only chat with this GPT"})})]}),(0,K.jsx)(O.kvR,{className:(0,b.default)("icon-lg shrink-0",!s&&"invisible")})]}):null})}let et={private:Z.Z,user:Z.Z,group:Z.Z,workspace_link:M.Z,workspace:P.Z,link:M.Z,marketplace:O.frp};function es(e){let{shareLevel:t,workspaceName:s,hasInviteSharing:r=!0}=e;(t===F.Zz.User||t===F.Zz.Group)&&(t=F.Zz.Private);let i=et[t];return(0,K.jsxs)("div",{className:"flex flex-row items-center gap-3 text-base",children:[(0,K.jsx)(i,{className:"icon-lg"}),(0,K.jsx)("div",{className:"line-clamp-1 pt-px text-start font-semibold",children:r||t!==F.Zz.Private?(0,K.jsx)(u.Z,W(W({},H[t]),{},{values:{workspaceName:s}})):(0,K.jsx)(u.Z,{id:"vVJhYB",defaultMessage:"Only me"})})]})}function er(e){var t,s;let{publishedGizmo:r,sharing:i,workspaceName:a,onClose:n}=e,o=i.recipient,l=et[o],d=(0,c.Z)();return(0,K.jsxs)(f.Z,{isOpen:!0,onClose:n,showCloseButton:!0,className:"w-[304px]",title:(0,K.jsx)(u.Z,{id:"5CEceY",defaultMessage:"GPT Updated"}),primaryButton:(0,K.jsx)(m.z,{onClick:()=>{window.location.href="/g/".concat(r.gizmo.id)},children:(0,K.jsx)(u.Z,{id:"RF75o5",defaultMessage:"View GPT"})}),secondaryButton:(0,K.jsx)(m.z,{color:"secondary",onClick:()=>(0,B.A4)(r,d.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:(0,K.jsx)(u.Z,{id:"9hLOl9",defaultMessage:"Copy link"})}),type:"success",children:[(0,K.jsx)(ei,{gizmo:{profilePictureUrl:null!==(t=r.gizmo.display.profile_picture_url)&&void 0!==t?t:void 0,name:r.gizmo.display.name}}),i.subjects.filter(e=>(0,F.h)(e)).length>0&&(0,K.jsxs)("div",{className:"my-4",children:[(0,K.jsx)("h4",{className:"text-xs font-semibold text-token-text-secondary",children:(0,K.jsx)(u.Z,{id:"/paYH9",defaultMessage:"Shared with"})}),i.subjects&&i.subjects.map((e,t)=>(0,F.h)(e)&&(0,K.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-3 py-2 ",children:[(0,K.jsxs)("div",{children:[(0,K.jsx)("span",{className:"text-base font-semibold",children:e.type===F.LA.GROUP?e.group_name:e.user_name}),e.type===F.LA.USER&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("br",{}),(0,K.jsx)("span",{className:"text-sm text-token-text-secondary",children:e.user_email})]})]}),(0,K.jsx)("span",{className:"text-token-text-secondary",children:(0,K.jsx)(u.Z,W({},X(e.capabilities)))})]},t))]}),(0,K.jsxs)("div",{className:"my-4",children:[(0,K.jsx)("h4",{className:"text-xs font-semibold text-token-text-secondary",children:(0,K.jsx)(u.Z,{id:"q9XNZ7",defaultMessage:"Access"})}),(0,K.jsxs)("div",{className:"ml-[3px] flex flex-row items-center py-3 text-left text-base font-semibold",children:[(0,K.jsx)(l,{className:"md:icon-lg mr-3 h-6 w-6 shrink-0"}),(0,K.jsxs)("div",{className:"flex flex-col",children:[(0,K.jsx)("span",{className:"font-semibold",children:(0,K.jsx)(u.Z,W(W({},null!==(s=$[o])&&void 0!==s?s:H[o]),{},{values:{workspaceName:a}}))}),(o===F.Zz.Workspace||o===F.Zz.Marketplace)&&(0,K.jsx)("span",{className:"text-xs text-token-text-secondary"})]})]})]})]})}function ei(e){let{gizmo:t,category:s,categories:r,onCategoryChange:i}=e,{data:a,isLoading:n}=(0,R.WL)(),o=null==r?void 0:r.find(e=>e.id===s);return(0,K.jsxs)("div",{children:[(0,K.jsxs)("div",{className:(0,b.default)("mb-[1px] flex flex-row items-center space-x-2 bg-token-main-surface-secondary p-4",n&&"invisible",r?"rounded-t-lg":"rounded-lg"),children:[(0,K.jsx)(D.Z,{isFirstParty:!1,className:"h-11 w-11",src:t.profilePictureUrl}),(0,K.jsxs)("div",{className:"flex grow flex-col space-y-0",children:[(0,K.jsx)("span",{className:"text-base font-semibold",children:t.name}),(0,K.jsx)(L.Z,{builderName:null==a?void 0:a.display_name,builderUrl:null==a?void 0:a.website_url,socials:[null==a?void 0:a.socials.linkedin,null==a?void 0:a.socials.github,null==a?void 0:a.socials.twitter].filter(e=>null!=e),className:"text-xs text-token-text-secondary"})]})]}),r&&(0,K.jsxs)("div",{className:"flex min-h-[56px] flex-row items-center justify-between space-x-2 rounded-b-lg bg-token-main-surface-secondary px-4 text-base",children:[(0,K.jsx)("span",{className:"font-semibold",children:(0,K.jsx)(u.Z,{id:"JcA4/t",defaultMessage:"Category"})}),(0,K.jsx)("div",{className:"text-token-text-secondary",children:i?(0,K.jsx)(g.d,{size:"small",triggerButton:(0,K.jsxs)("button",{className:"flex items-center gap-1",children:[null==o?void 0:o.title,(0,K.jsx)(O.T2M,{className:"icon-md"})]}),children:r.map((e,t)=>(0,K.jsx)(g.Z.Item,{onClick:()=>i(e),children:e.title},t))}):(0,K.jsx)("span",{className:"text-token-text-secondary",children:null==o?void 0:o.title})})]})]})}let ea=k.Z.li(r||(r=(0,i.Z)(["flex flex-col rounded-sm p-1 hover:bg-token-main-surface-secondary"])));function en(e){var t,s,r;let{onAdd:i,publishedGizmo:a}=e,n=(0,c.Z)(),d=(0,l.t)(),{0:p,1:m}=(0,w.useState)(""),g=null===(t=(0,N.Z)(null==d?void 0:d.id,0,p,5).data)||void 0===t?void 0:t.items.filter(e=>e.id!==(null==a?void 0:a.gizmo.author.user_id.split("__")[0])),{data:f}=(0,v.a)({queryKey:[null==d?void 0:d.id,"groups","filtered",p],queryFn:()=>o.Z.getWorkspaceGroups(d.id,{query:p,orderby:"@score"}),enabled:""!==p.trim()&&null!=d&&!!d.getWorkspaceId()}),x=(null!==(s=null==g?void 0:g.length)&&void 0!==s?s:0)>0||(null!==(r=null==f?void 0:f.items.length)&&void 0!==r?r:0)>0,{0:b,1:j}=(0,w.useState)(!1);return(0,K.jsx)(K.Fragment,{children:(0,K.jsx)("div",{className:"flex w-full flex-row space-x-3",children:(0,K.jsxs)(h.J,{as:"div",className:"group relative z-10 grow",children:[(0,K.jsx)(T.Z,{list:"suggested-choices",name:"share-with-input",placeholder:null!=d&&d.isEnterprisey()?n.formatMessage({id:"xy/AMO",defaultMessage:"Add people and groups from your workspace"}):n.formatMessage({id:"Lh9njB",defaultMessage:"Add people from your workspace"}),value:p,onChange:e=>m(e.target.value),onFocus:()=>j(!0),onBlur:()=>j(!1)}),(0,K.jsx)(_.m,{show:""!==p.trim()&&x&&b,children:(0,K.jsx)(h.J.Panel,{static:!0,className:"absolute top-8 ml-0 w-full cursor-pointer overflow-y-auto rounded-lg rounded-t-none border border-t-0 border-token-border-light bg-token-main-surface-primary px-1 py-1 group-has-[:focus]:border-token-border-xheavy",children:""!==p.trim()&&(0,K.jsxs)("ul",{id:"suggested-choices",children:[g&&g.map(e=>(0,K.jsxs)(ea,{tabIndex:0,className:"rounded-sm p-1 text-sm hover:bg-token-main-surface-secondary",onClick:()=>{var t,s,r,a;return s=e.id,r=e.name,a=null!==(t=e.email)&&void 0!==t?t:"",void(d&&(i({type:F.LA.USER,user_id:s+"__"+d.getWorkspaceId(),user_name:r,user_email:a,capabilities:W({},F.EL)}),m("")))},children:[(0,K.jsx)("span",{className:"w-full font-semibold",children:e.name}),(0,K.jsx)("span",{className:"text-sm text-token-text-secondary",children:e.email})]},e.id)),(null==f?void 0:f.items)&&f.items.slice(0,5).map(e=>(0,K.jsxs)(ea,{tabIndex:0,onClick:()=>{var t,s;return t=e.id,s=e.name,void(i({type:F.LA.GROUP,group_id:t,group_name:s,capabilities:W({},F.EL)}),m(""))},children:[(0,K.jsx)("span",{className:"font-semibold",children:e.name}),(0,K.jsx)("span",{className:"text-sm text-token-text-secondary",children:(0,K.jsx)(u.Z,{id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}",values:{numMembers:e.num_members}})})]},e.id))]})})})]})})})}F.H$,F.EL,F.fV},65418:function(e,t,s){s.r(t),s.d(t,{DebugConversation:function(){return ep},DebugConversationSidebar:function(){return eu},default:function(){return en},downloadMessages:function(){return em}});var r,i,a,n,o,l=s(2346),d=s(98601),c=s(16757),u=(s(34095),s(55963)),p=s(52531),m=(s(2721),s(93951)),g=s(92745),f=s(22433),h=s(93180),x=s(46900),v=(s(66290),s(30757)),b=(s(56032),s(42420)),j=s(79746),y=s(2423),w=s.n(y),k=s(38482),z=s.n(k),N=s(92379),O=s(75172),P=s(62984),M=s(68306),Z=s(67526),C=s(75853),S=s(15478),T=s(11550),_=s(39358),I=s(94273),E=s(75130),A=s(651);function L(e){let{children:t,sidebarOpen:s,onClose:r}=e;return(0,A.jsx)(I.u.Root,{show:s,as:N.Fragment,children:(0,A.jsxs)(E.V,{as:"div",className:"relative z-10",onClose:r,children:[(0,A.jsx)("div",{className:"fixed inset-0"}),(0,A.jsx)("div",{className:"fixed inset-0 overflow-hidden",children:(0,A.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:(0,A.jsx)("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:(0,A.jsx)(I.u.Child,{as:N.Fragment,enter:"transform transition ease-in-out duration-100 sm:duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-300 sm:duration-500",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,A.jsx)(E.V.Panel,{className:"pointer-events-auto w-screen max-w-md border-l border-gray-100 dark:border-gray-700",children:(0,A.jsx)("div",{className:"h-full overflow-y-auto bg-token-main-surface-primary shadow-xl",children:t})})})})})})]})})}var D=s(30853),R=s(30115),G=s(13490),U=s(24434),F=s(73468),B=s(89678),K=s.n(B),V=s(13859),W=s.n(V),Q=s(24740),Y=s(88815);function q(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function J(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?q(Object(s),!0).forEach(function(t){(0,d.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):q(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function H(e){var t;let{clientThreadId:s}=e,{rebaseSystemMessageContent:r,showDebugConversationTurns:i}=(0,Y.N)(),{0:a,1:n}=(0,N.useState)(()=>r?JSON.stringify(r,null,2):void 0),{0:o,1:l}=(0,N.useState)(!!r),d=(0,g.u9)(s,g.tQ.getThreadCurrentLeafId(s)),p=W()(d,e=>e.content.content_type===c.PX.SystemContent),m=null!==(t=null==p?void 0:p.content)&&void 0!==t?t:null,f=(0,N.useMemo)(()=>K()(e=>{try{e?Y.N.setState({rebaseSystemMessageContent:J(J({},JSON.parse(e)),{},{content_type:c.PX.SystemContent})}):Y.N.setState({rebaseSystemMessageContent:null}),Q.m.closeAll()}catch(e){Q.m.danger("The System Message is not valid JSON")}},500),[]);return(0,N.useEffect)(()=>{o?f(a):(f.cancel(),Y.N.setState({rebaseSystemMessageContent:null}))},[f,o,a]),(0,A.jsxs)("div",{className:"flex flex-col gap-3 px-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)(D.u,{label:"Enable to apply this system message to the current conversation.",children:(0,A.jsx)(u.Z,{id:"enabled",label:"Enabled",checked:o,onChange:e=>l(e.currentTarget.checked)})}),(0,A.jsx)(u.Z,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:i,onChange:()=>{Y.N.setState({showDebugConversationTurns:!i})}})]}),(0,A.jsx)(T.z,{disabled:!m,className:"mt-2",onClick:()=>{n(m?JSON.stringify(m,null,2):"")},size:"small",children:"Load active system message"})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"text-sm",children:"System Message"}),(0,A.jsx)($,{disabled:!o,placeholder:m?"Press `Load active system message` to pre-populate this":"Start a conversation and then press `Load active system message` to pre-populate this",className:"min-h-[75vh] rounded-md border border-gray-400 p-1 font-mono",value:a,onChange:e=>n(e.target.value)})]})]})}let $=S.Z.textarea(r||(r=(0,l.Z)(["w-full rounded-lg border border-token-border-light bg-token-main-surface-primary text-sm text-token-text-primary focus:border-token-text-primary focus:shadow-none focus:outline-none focus:ring-token-text-primary disabled:bg-token-main-surface-tertiary"])));var X=s(19841);function ee(e){let{clientThreadId:t}=e,{0:s,1:r}=(0,N.useState)([]),i=g.tQ.getThreadCurrentLeafId(t),a=g.tQ.getThreadConversationTurns(t,i),n=e=>{let s=g.tQ.getTree(t).getLeafFromNode(e);g.tQ.setThreadCurrentLeafId(t,s.id)},o=e=>{r(e=>[...e,i]),n(e)};return(0,A.jsxs)(A.Fragment,{children:[s.length>0&&(0,A.jsxs)(T.z,{className:"absolute left-2 top-2",color:"secondary",onClick:()=>{n(s[s.length-1]),r(e=>e.slice(0,-1))},children:[(0,A.jsx)(G.eF8,{className:"icon-sm"}),"Go back to ",s[s.length-1]]}),(0,A.jsx)("div",{className:"flex flex-col items-center gap-4 overflow-auto p-4 text-xs",children:a.map((e,s)=>{let r;let i=e.messages[0].nodeId,a=g.tQ.getTree(t),n=0!==s?a.getParent(i):null,l=null!=n?n.children.findIndex(e=>i===e):0,d=null!=n?n.children:[],u=d.slice(0,l),p=d.slice(l+1);switch(e.role){case c.uU.User:r="bg-blue-500";break;case c.uU.Assistant:r="bg-gray-600";break;default:r="bg-gray-400"}return(0,A.jsxs)("div",{className:(0,X.default)("relative p-2",r),children:[(0,A.jsx)("div",{className:"absolute bottom-0 left-0 -ml-2 flex -translate-x-full gap-2 pl-2",children:u.map(e=>(0,A.jsx)(et,{variantId:e,onChangeItemInView:o},e))}),(0,A.jsx)("div",{className:"absolute left-full top-0 ml-2 flex gap-2 pr-2",children:p.map(e=>(0,A.jsx)(et,{variantId:e,onChangeItemInView:o},e))}),(0,A.jsx)("div",{className:"flex flex-col gap-2",children:e.messages.map(e=>(0,A.jsxs)("div",{className:"h-14 w-32 truncate bg-gray-200 p-1 text-black",children:[(0,A.jsx)("div",{className:"font-semibold",children:e.nodeId}),(0,A.jsx)("div",{className:"italic text-token-text-tertiary",children:e.message.author.role}),(0,A.jsx)("div",{children:(0,f.RR)(e.message)})]},e.nodeId))})]},s)})})]})}function et(e){let{variantId:t,onChangeItemInView:s}=e;return(0,A.jsx)("button",{className:"w-32 truncate bg-gray-400 p-2 text-black opacity-50 hover:opacity-100",onClick:()=>{s(t)},children:(0,A.jsx)("span",{className:"bg-gray-200 p-2",children:t})},t)}function es(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function er(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?es(Object(s),!0).forEach(function(t){(0,d.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):es(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}let ei=z()(()=>Promise.all([s.e(3904),s.e(3674)]).then(s.bind(s,16476)).then(e=>e.default),{ssr:!1,loadableGenerated:{webpack:()=>[16476]}}),ea=z()(()=>s.e(1583).then(s.bind(s,51583)).then(e=>e.FramesViewer),{ssr:!1,loadableGenerated:{webpack:()=>[51583]}});function en(e){let{children:t,title:s,icon:r,isOpen:i,slideOver:a,onClose:n}=e,o=(0,A.jsxs)(ex,{children:[(0,A.jsxs)("div",{className:"flex items-start justify-between",children:[(0,A.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 text-lg font-semibold text-gray-900 dark:text-white",children:[(0,A.jsx)(r,{className:"icon-sm"}),s]}),(0,A.jsx)("div",{className:"mr-2 mt-2 flex h-7 items-center",children:(0,A.jsx)(R.P,{onClick:n})})]}),t]});return a?(0,A.jsx)(L,{sidebarOpen:i,onClose:n,children:o}):i?o:null}function eo(e){let{nodes:t,setDebugNodeIndex:s,setFrameSrc:r}=e,i=t.map((e,t)=>{var i;let a=e.message,{role:n,name:o}=a.author,l=w()(a,"metadata.__internal.model_id"),d=w()(a,"metadata.__internal.agent.settings.completion_api.engine"),u=w()(a,"metadata.__internal.model_experiment_name"),p=w()(a,"metadata.__internal.model_experiment_treatment"),m=w()(a,"metadata.__internal.normalized_model_side"),g=w()(a,"metadata.__internal.model_experiment_group_name"),h=w()(a,"metadata.__internal.model_experiment_group_params"),v=w()(a,"metadata.__internal.model_experiment_override"),b=w()(a,"metadata.__internal.model_experiment_eval_seq"),j=null===(i=w()(a,"metadata.__internal.raw_tokens"))||void 0===i?void 0:i.length,y=w()(a,"metadata.request_id"),k=x.U.getAudio(a),z=x.U.getAudioAssetPointers(a),N=x.U.getFrameAssetPointers(a);return(0,A.jsxs)(eb,{role:"button",onClick:()=>s(t),children:[(0,A.jsxs)("div",{className:"text-xs font-semibold uppercase text-token-text-tertiary",children:[n,o&&o!==n&&" (".concat(o,")"),a.recipient&&" -> ",(0,f.Ej)(a)]}),(a.author.role!==c.uU.System||y)&&(0,A.jsxs)("div",{className:"text-xs text-token-text-tertiary",children:[(0,A.jsxs)("div",{children:["ID: ",a.id]}),e.id!==a.id&&(0,A.jsxs)("div",{children:["UI Node ID: ",e.id]}),(0,A.jsxs)("div",{children:["Req ID: ",y||"Reload page to see ID"]})]}),(0,A.jsx)("div",{className:"line-clamp-6",children:(0,f.RR)(a)}),(j||l||d||u||p||m||g||h||v||b)&&(0,A.jsxs)("div",{className:"mt-4 w-full self-start rounded-xl bg-blue-200 px-3 py-0.5 text-xs text-black",children:[void 0!==j&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Tokens Count:"})," ",j]}),l&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Model ID:"})," ",l]}),d&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Engine:"})," ",d]}),u&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Experiment:"})," ",u]}),p&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Treatment:"})," ",p]}),m&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Normalized Side:"})," ",m]}),g&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Group Name:"})," ",g]}),h&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Group Params:"}),(0,A.jsx)("div",{children:JSON.stringify(h,null,2)})]}),v&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Above Params are Overridden By:"})," ",v]}),b&&(0,A.jsxs)("div",{children:[(0,A.jsx)("b",{children:"Experiment Eval Seq:"})," click to see"]})]}),k.length||z.length?(0,A.jsxs)("div",{className:"mt-4 flex flex-col flex-nowrap gap-2",children:[(0,A.jsx)(ef,{frameAssets:N,setFrameSrc:r},t),k.map((e,t)=>(0,A.jsx)(eh,{audio:e},t)),z.map((e,t)=>(0,A.jsx)(eh,{assetPointer:e},t))]}):null]},a.id)});return(0,A.jsx)(ev,{children:i})}let el=e=>(0,A.jsx)(Z.c.Input,er(er({},e),{},{inputClassName:"focus:ring-0"}));function ed(){let e=(0,Y.N)(),t=(0,F.ZP)().map(e=>({label:e.name,options:e.options.map(e=>({label:"".concat(e.value," (").concat(e.name,")"),value:e.value}))}));return(0,A.jsxs)("div",{className:"mt-2 flex flex-col justify-around gap-3 px-4 py-1 text-xs font-semibold ",children:[(0,A.jsx)(u.Z,{id:"force-paragen",label:"Force Parallel Gen",checked:e.forceParagen,onChange:()=>{Y.N.setState({forceParagen:!e.forceParagen})}}),(0,A.jsx)(C.Z,{options:t,name:"force-paragen-model",className:"shadow-none dark:text-gray-800",isDisabled:!e.forceParagen,isLoading:0===t.length,value:e.forceParagenModel,isClearable:!0,isMulti:!1,components:{Input:el},onChange:e=>{Y.N.setState({forceParagenModel:null!=e?e:Y.J})}}),(0,A.jsx)(u.Z,{id:"force-paragen",label:"Force Nulligen",checked:e.forceNulligen,onChange:()=>{Y.N.setState({forceNulligen:!e.forceNulligen})}}),(0,A.jsx)(u.Z,{id:"force-indepth-feedback",label:"Force Indepth Feedback with prompt:",checked:e.forceIndepthFeedback,onChange:()=>{Y.N.setState({forceIndepthFeedback:!e.forceIndepthFeedback})}}),(0,A.jsx)(p.B1,{id:"force-indepth-feedback-prompt",value:e.forceIndepthFeedbackPrompt,disabled:!e.forceIndepthFeedback,className:"font-weight-normal font-mono text-xs",onChange:e=>{Y.N.setState({forceIndepthFeedbackPrompt:e.target.value})}}),(0,A.jsx)(u.Z,{id:"force-rate-limit",label:"Force Rate Limit",checked:e.forceRateLimit,onChange:()=>{Y.N.setState({forceRateLimit:!e.forceRateLimit})}}),(0,A.jsx)(u.Z,{id:"reset-rate-limit",label:"Reset Rate Limits",checked:e.resetRateLimits,onChange:()=>{Y.N.setState({resetRateLimits:!e.resetRateLimits})}}),(0,A.jsx)(D.u,{label:"Enabling this will show debug conversation messages in the chat",children:(0,A.jsx)(u.Z,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:e.showDebugConversationTurns,onChange:()=>{Y.N.setState({showDebugConversationTurns:!e.showDebugConversationTurns})}})})]})}let ec=S.Z.div(i||(i=(0,l.Z)(["px-3 pb-2 text-xs font-semibold uppercase border-b-2 ",""])),e=>{let{$isSelected:t}=e;return t?"border-black dark:border-white":"border-transparent"});function eu(e){let{clientThreadId:t,isOpen:s,slideOver:r,onClose:i}=e,a=(0,O.Z)(),n=(0,m.hz)(),{0:o,1:l}=(0,N.useState)("conversation");return null!=n&&n.includes("debug")?(0,A.jsx)(en,{icon:G.reV,title:a.formatMessage(ej.debugTitle),isOpen:s,slideOver:r,onClose:i,children:(0,A.jsxs)(v.fC,{orientation:"vertical",defaultValue:o,onValueChange:e=>l(e),children:[(0,A.jsxs)(v.aV,{className:"flex items-center justify-center gap-2 px-4 py-1 text-xs font-semibold",children:[(0,A.jsx)(v.xz,{value:"conversation",children:(0,A.jsx)(ec,{$isSelected:"conversation"===o,children:"Conversation"})}),(0,A.jsx)(v.xz,{value:"system-message-editor",className:"p-4",children:(0,A.jsx)(ec,{$isSelected:"system-message-editor"===o,children:"System Message Editor"})})]}),(0,A.jsx)(v.VY,{value:"conversation",children:(0,A.jsx)(ep,{clientThreadId:t})}),(0,A.jsx)(v.VY,{value:"system-message-editor",children:(0,A.jsx)(H,{clientThreadId:t})})]})}):null}function ep(e){let{clientThreadId:t}=e,s=(0,O.Z)(),r=g.tQ.getThreadCurrentLeafId(t),i=(0,g.Fe)(t,r),{0:a,1:n}=(0,N.useState)(),o=(0,m.hz)(),l=(0,N.useCallback)(()=>{n(void 0)},[]),d=(0,N.useCallback)(()=>{let e=g.tQ.getTree(t);(0,j.v)(e.getTextFromThread(r))},[r,t]),{0:c,1:u}=(0,N.useState)(!1),{0:p,1:f}=(0,N.useState)(void 0);return null!=o&&o.includes("debug")?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{className:"mb-2 flex items-center justify-around px-4 py-1 text-xs font-semibold uppercase",children:(0,A.jsx)(eg,{clientThreadId:t,messages:i.map(e=>e.message)})}),!1,(0,A.jsxs)("div",{className:"flex items-center justify-around gap-2 px-4 py-1 text-xs font-semibold uppercase",children:[(0,A.jsx)("div",{children:(0,A.jsx)(_.Z,{onCopy:d,buttonText:s.formatMessage(ej.copyText)})}),(0,A.jsxs)("button",{className:"flex items-center justify-center gap-2",onClick:()=>u(!0),children:[(0,A.jsx)(G.aAc,{className:"icon-sm rotate-90"}),"View tree"]})]}),(0,A.jsx)(ed,{}),(0,A.jsx)(eo,{nodes:i,setDebugNodeIndex:n,setFrameSrc:f}),void 0!==a&&(0,A.jsx)(U.Z,{className:"min-w-[80vw]",isOpen:!0,onClose:l,type:"success",children:(0,A.jsx)("div",{className:"max-h-[80vh] overflow-auto",children:(0,A.jsx)(ei,{json:i[a].message})})},"DebugMessageModal-".concat(a)),c&&(0,A.jsx)(U.Z,{isOpen:!0,onClose:()=>u(!1),type:"success",size:"custom",noPadding:!0,children:(0,A.jsx)(ee,{clientThreadId:t})},"DebugTreeViewer"),p&&(0,A.jsx)(U.Z,{size:"normal",isOpen:!0,onClose:()=>f(void 0),type:"success",children:(0,A.jsx)("img",{src:p,alt:"debug image"})},"DebugFrameViewer")]}):null}function em(e,t){let s=new Blob([JSON.stringify({conversation_id:g.tQ.getServerThreadId(e),messages:t},null,2)],{type:"application/json"}),r=URL.createObjectURL(s),i=document.createElement("a");i.href=r,i.download="messages-".concat(g.tQ.getServerThreadId(e),".json"),i.click(),URL.revokeObjectURL(r)}function eg(e){let{clientThreadId:t,messages:s}=e,r=(0,N.useCallback)(()=>{em(t,s)},[t,s]);return(0,A.jsx)(T.z,{onClick:r,color:"primary",size:"small",icon:G._8t,children:(0,A.jsx)(P.Z,er({},ej.downloadRawConversation))})}function ef(e){let{0:t,1:s}=(0,N.useState)([]),r=(0,b.NL)(),{frameAssets:i}=e;return(0,N.useEffect)(()=>{async function e(){return Promise.all(i.map(async e=>{let{image_asset_pointer:t,timestamp:s}=e;return{src:(await h.j.fetch(r,{asset:t})).url,timestamp:s}}))}i.length>0&&e().then(s)},[i,r]),(0,A.jsx)(ea,{frames:t,setFrameSrc:e.setFrameSrc})}function eh(e){let t=eh.useAssetPointerSource(e.assetPointer),s=eh.useAudioSource(e.audio),r=null!=t?t:s;return r?(0,A.jsx)("audio",{controls:!0,src:r,className:"w-full"}):null}eh.useAssetPointerSource=e=>{let{0:t,1:s}=(0,N.useState)(null),r=(0,b.NL)();return(0,N.useEffect)(()=>{e&&h.j.fetch(r,{asset:e}).then(e=>{s(e.url)})},[r,e]),t},eh.useAudioSource=e=>{let{0:t,1:s}=(0,N.useState)(null);return(0,N.useEffect)(()=>{if(e){let t=atob(e.payload),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let i=new Blob([r],{type:"audio/".concat(e.format)}),a=URL.createObjectURL(i);return s(a),()=>{URL.revokeObjectURL(a)}}},[e]),t};let ex=S.Z.div(a||(a=(0,l.Z)(["overflow-y-auto h-full md:w-[250px] lg:w-[300px] xl:w-[350px] 2xl:w-[400px] md:border-l md:border-gray-100 md:dark:border-gray-700 popover bg-token-main-surface-primary"]))),ev=S.Z.pre(n||(n=(0,l.Z)(["whitespace-pre-wrap text-sm"]))),eb=S.Z.div(o||(o=(0,l.Z)(["px-6 py-4 flex flex-col gap-1 hover:bg-gray-50 dark:hover:bg-gray-500/10 cursor-pointer border-b dark:border-white/10 border-gray-200"]))),ej=(0,M.vU)({debugTitle:{id:"DebugSidebar.debugTitle",defaultMessage:"Debug"},copyText:{id:"DebugSidebar.copyText",defaultMessage:"Copy text"},downloadRawConversation:{id:"DebugSidebar.downloadRawConversation",defaultMessage:"Download raw conversation"},uploadRawConversation:{id:"DebugSidebar.uploadRawConversation",defaultMessage:"Upload conversation dump"},closeSidebar:{id:"DebugSidebar.closeSidebar",defaultMessage:"Close sidebar"}})},34455:function(e,t,s){s.d(t,{a:function(){return z}});var r=s(98601),i=s(99501),a=s(67437),n=s(66290),o=s(34977),l=s(76580),d=s(92379),c=s(9026),u=s(30478),p=s(39004),m=s(24740),g=s(84760),f=s(92745);let h=e=>{let{asPath:t,replace:s}=(0,o.useRouter)(),r=(0,u.V_)(),i=(0,f.h9)();(0,g.a)({queryKey:["conversation",e],queryFn:()=>(0,f.Um)(e).catch(r=>{let i=(0,p.Bw)(t);throw s(null!=i?(0,p.un)(i):"/",void 0,{shallow:!0}),m.m.danger("Unable to load conversation ".concat(e)),r}),enabled:!(0,f.Zz)(e)&&!r&&!i})};var x=s(81107),v=s(2721);let b=e=>["conversation","init",e],j=e=>{let{clientThreadId:t,conversationMode:s,clientModelId:r}=e,i=(0,x.ln)(s),a=(0,f.Zz)(t)?null:t;return{gcTime:0,refetchOnWindowFocus:!0,refetchOnMount:"always",queryKey:b(t),queryFn:()=>v.Z.getConversationDetails({conversationId:a,gizmoId:i,requestedDefaultModel:r})}},y=e=>(0,g.a)(j(e));function w(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}let k=(e,t)=>{var s;for(let r of null!==(s="string"==typeof e?[e]:e)&&void 0!==s?s:[])if(r&&t.has(r))return r;return null},z=(e,t)=>{var s,u,p;let m=(0,a.iu)(),{query:g}=(0,o.useRouter)(),x=(0,a.WK)(g),{modelId:v=null}=null!==(s=(0,i._C)())&&void 0!==s?s:{};h(e);let b=[x,null!==(u=(0,f.GK)(e))&&void 0!==u?u:null,v],j=k(b,m);(0,d.useEffect)(()=>{f.tQ.initThread(e,t,j),c.bZ.reset()},[e]);let z=(0,n.Z)(),N=(0,d.useCallback)(()=>{let e=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?w(Object(s),!0).forEach(function(t){(0,r.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):w(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},g);delete e.model;let t=l.Z.stringify(e);z({search:t.length>0?"?".concat(t):""})},[g,z]),{isLoading:O,data:P}=y({clientThreadId:e,clientModelId:null!==(p=b.find(e=>!!e))&&void 0!==p?p:null,conversationMode:t}),M=(0,c.Sj)();(0,d.useEffect)(()=>{if(x&&!O){if(!m.has(x)||M.find(e=>e.model_slug===x))return N();f.tQ.setThreadModelId(e,x)}},[x,M,m,e]),(0,d.useEffect)(()=>{if(O||!P)return;let{default_model_slug:t}=P;x&&t&&x!==t&&N(),c.bZ.updateDetails(P),t&&f.tQ.setThreadModelId(e,t)},[O,P])}},13391:function(e,t,s){s.d(t,{n:function(){return C},A3:function(){return M},yx:function(){return I},JS:function(){return _}});var r,i=s(98601),a=s(15858),n=s(70879),o=s(99976),l=s(61619),d=s(79746),c=s(82363),u=s(91530),p=s.n(u),m=s(92379),g=s(68306),f=s(16757),h=s(24740),x=s(92745),v=s(31438),b=s(49763),j=s(22433),y=s(45248);let w=m.useLayoutEffect;function k(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}let z=/```.*?\n([\s\S]+?)\n?```[^`]*$/gms;var N=((r=N||{}).Core="Core",r.Chat="Chat",r.Settings="Settings",r);let O=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?k(Object(s),!0).forEach(function(t){(0,i.Z)(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):k(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({Mod:"mod",Comma:","},a.s),P={[O.Mod]:/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"⌘":"Ctrl",[O.Comma]:",",[O.Enter]:"⏎",[O.Escape]:"Esc",[O.ArrowUp]:"↑",[O.ArrowDown]:"↓",[O.ArrowLeft]:"←",[O.ArrowRight]:"→",[O.Backspace]:"⌫",[O.Delete]:"⌦",[O.Tab]:"⇥",[O.Control]:"Ctrl",[O.Shift]:"Shift"},M=e=>e.map(e=>{var t;return null!==(t=P[e])&&void 0!==t?t:e}),Z=(0,g.vU)({newChat:{id:"keyboardActions.newChat",defaultMessage:"Open new chat"},focusPromptTextarea:{id:"keyboardActions.focusPromptTextarea",defaultMessage:"Focus chat input"},copyLastCodeBlock:{id:"keyboardActions.copyLastCodeBlock",defaultMessage:"Copy last code block"},copyLastResponse:{id:"keyboardActions.copyLastResponse",defaultMessage:"Copy last response"},toggleCustomInstructions:{id:"keyboardActions.toggleCustomInstructions",defaultMessage:"Set custom instructions"},navigationToggle:{id:"keyboardActions.navigationToggle",defaultMessage:"Toggle sidebar"},deleteChat:{id:"keyboardActions.deleteChat",defaultMessage:"Delete chat"},archiveChat:{id:"keyboardActions.archiveChat",defaultMessage:"Archive chat"},toggleKeyboardActions:{id:"keyboardActions.toggleKeyboardActions",defaultMessage:"Show shortcuts"}}),C=new b.V,S=e=>{let{resetThreadAction:t,clientThreadId:s}=e;return[{key:"newChat",action:t||p(),actionMessageDescriptor:Z.newChat,group:N.Core,keyboardBinding:[O.Mod,O.Shift,"o"],altKeyboardBindings:[[O.Mod,"k"]]},{key:"focusPromptTextarea",action:n.go,actionMessageDescriptor:Z.focusPromptTextarea,group:N.Chat,keyboardBinding:[O.Shift,O.Escape]},{key:"copyLastCodeBlock",action:()=>{if(null!=s){let e=x.tQ.getThreadCurrentLeafId(s),t=x.tQ.getThreadConversationTurns(s,e);for(let e=t.length-1;e>=0;e--){let{messages:s}=t[e],r=[...s.reduce((e,t)=>null==t.err&&t.message.author.role===f.uU.Assistant&&"all"===t.message.recipient?e+(e?"\n\n":"")+(0,j.RR)(t.message):e,"").matchAll(z)],i=r.length?r[r.length-1][1]:null;if(null!=i){(0,d.v)(i).then(()=>{h.m.success("Copied code block to clipboard")});break}}}},actionMessageDescriptor:Z.copyLastCodeBlock,group:N.Chat,keyboardBinding:[O.Mod,O.Shift,";"],altKeyboardBindings:[[O.Mod,O.Shift,":"]]},{key:"copyLastResponse",action:()=>{null!=s&&x.tQ.copyLastMessageToClipboard(s,"keyboard").then(()=>{h.m.success("Last response copied to clipboard")})},actionMessageDescriptor:Z.copyLastResponse,group:N.Chat,keyboardBinding:[O.Mod,O.Shift,"c"]},{key:"toggleCustomInstructions",action:()=>v.vm.toggleModal(v.B.UserContext),actionMessageDescriptor:Z.toggleCustomInstructions,group:N.Settings,keyboardBinding:[O.Mod,O.Shift,"i"]},{key:"navigationToggle",action:()=>v.vm.toggleDesktopNavCollapsed(),actionMessageDescriptor:Z.navigationToggle,group:N.Core,keyboardBinding:[O.Mod,O.Shift,"s"]},{key:"deleteChat",action:()=>{if(s){let e=x.tQ.getServerThreadId(s);e&&C.publish({kind:"deleteChat",serverThreadId:e})}},actionMessageDescriptor:Z.deleteChat,group:N.Chat,keyboardBinding:[O.Mod,O.Shift,O.Backspace],altKeyboardBindings:[[O.Mod,O.Shift,O.Delete]]},{key:"toggleKeyboardActions",action:()=>v.vm.toggleModal(v.B.KeyboardActions),actionMessageDescriptor:Z.toggleKeyboardActions,group:N.Settings,keyboardBinding:[O.Mod,"/"]}]},T=e=>(function(e,t,s){let r=e.map(e=>{let{keyboardBinding:t}=e,s=t.join("+");if(e.altKeyboardBindings){s=[s];let t=e.altKeyboardBindings.map(e=>e.join("+"));s=s.concat(t)}return(0,y.ZP)(s,{byKey:!0})});w(()=>{if((null==s?void 0:s.enabled)===!1)return;let i=s=>{if(!s.repeat)for(let i=0;i<r.length;i++)r[i](s)&&(void 0===e[i].enabled||e[i].enabled)&&(s.preventDefault(),t(e[i]),e[i].action())},a=e=>{void 0!==e.key&&i(e)},n=document;return n.addEventListener("keydown",a),()=>{n.removeEventListener("keydown",a)}},[e,s])})(e,e=>{o.A.logEvent(l.M.keyboardShortcut,{keyboardActionKey:e.key}),c.U.addAction("chatgpt_keyboard_shortcut",{keyboardActionKey:e.key})},{enabled:!0}),_=function(){let{resetThreadAction:e,clientThreadId:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,m.useMemo)(()=>S({resetThreadAction:e,clientThreadId:t}).filter(e=>{let{enabled:t=!0}=e;return t}),[t,e])},I=e=>{let{resetThreadAction:t,clientThreadId:s}=e;T(_({resetThreadAction:t,clientThreadId:s}))}},58015:function(e,t,s){s.d(t,{C:function(){return r}});async function r(){}}}]);
//# sourceMappingURL=8838-4d6587526eb25324.js.map